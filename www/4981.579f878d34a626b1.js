"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(ae,Rt,v)=>{v.d(Rt,{In:()=>lt,MA:()=>_,Mo:()=>C,NV:()=>O,S3:()=>N,dt:()=>et,h8:()=>u,k0:()=>M});const N={fill:"transparent",stroke:"#129bff",strokeWidth:1},O={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},lt={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},C={fill:"transparent",stroke:"transparent",strokeWidth:1},et={fill:"none",stroke:"#5F6CE1",strokeWidth:1},u={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},_={fill:"transparent"},M={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},9942:(ae,Rt,v)=>{v.d(Rt,{w:()=>Q,I:()=>A});var N=v(4981),O=v(9054),lt=v(5811),C=/^#[a-fA-F0-9]+$/i,et=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,u=/^rgb\((\d+),(\d+),(\d+)\)$/i;const _=G=>{let K=null,q=null;if(G)if("transparent"==G)K="#000000",q=0;else if(G.match(C))K=G;else{let T=(G=G.replace(/\s+/g,"")).match(et);if(T)K="#"+(256|T[1]).toString(16).slice(1)+(256|T[2]).toString(16).slice(1)+(256|T[3]).toString(16).slice(1),q=(0,lt.q)(parseFloat(T[4]),100);else{let Y=G.match(u);Y&&(K="#"+(256|Y[1]).toString(16).slice(1)+(256|Y[2]).toString(16).slice(1)+(256|Y[3]).toString(16).slice(1))}}return{hex:K,alpha:q}},A=G=>S(null==G?void 0:G.url,null==G?void 0:G.path,null==G?void 0:G.src);var S=(G,K,q)=>{var T,Y;let F,ft,ct,dt;var D,Ot;return G&&(F=G.replace(/\\/g,"/")),K&&(ft=K.replace(/\\/g,"/")),q&&(ct=q.replace(/\\/g,"/")),ft&&!F&&(F=(null===(D=N.icdt.config)||void 0===D?void 0:D.readfileuploadurl)+ft),!ct||ft||F||(ft=ct.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),F=(null===(Ot=N.icdt.config)||void 0===Ot?void 0:Ot.readfileuploadurl)+ft),dt=(null!==(T=F)&&void 0!==T?T:"").split("/").pop()||(null!==(Y=ft)&&void 0!==Y?Y:"").split("/").pop()||"",{url:F,path:ft,name:dt}};const Q=G=>{let K={x:0,y:0,width:G.screen.w,height:G.screen.h},q=[];return G.data.forEach((T,Y)=>{var F,ft;let ct={id:"number"==typeof T.id?T.id:N.icdt.data.newSlideId,code:null===(F=T.id)||void 0===F?void 0:F.toString(),name:"string"==typeof T.id?T.id:`Trang ${Y+1}`,svg:{viewBox:K,nodes:[]},test:(dt=T.test2,dt?(dt.audiotrue&&(dt.audiotrue=A({path:dt.audiotrue.path})),dt.audiofalse&&(dt.audiofalse=A({path:dt.audiofalse.path})),dt.effecttrue&&(dt.effecttrue=A({path:dt.effecttrue.path})),dt.effectfalse&&(dt.effectfalse=A({path:dt.effectfalse.path})),dt.icontrue&&(dt.icontrue=A({path:dt.icontrue.path})),dt.iconfalse&&(dt.iconfalse=A({path:dt.iconfalse.path})),dt):{})};var dt;T.background&&ct.svg&&(ct.svg.background=function(G){return G&&(null!==G.match(/#([a-zA-Z0-9]+)/)||null!==G.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==G.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(T.background)?{color:T.background}:function(G){return G&&null!==G.match(/data:[^;]+;base64,/)}(T.background)?{base64:T.background}:function(G){return G&&null!==G.match(/http(s)?:\/\//)}(T.background)?S(T.background):S(void 0,T.background)),jQuery(null!==(ft=T.svg)&&void 0!==ft?ft:"").find(".svg-node").each((dt,D)=>{var Ot,Wt;let Ut=jQuery(D).parents(".indexs"),Lt=Ut.attr("data-index"),Pt=Ut.attr("data-time"),jt=null!==(Ot=D.getAttribute("id"))&&void 0!==Ot?Ot:"0",rt={id:parseInt(jt),code:`${D.nodeName}-${D.getAttribute("id")}`,name:D.nodeName,idx:Lt?parseInt(Lt):0,time:Pt?parseFloat(Pt):0,type:(()=>{switch(D.nodeName){case"polygon":return O.$.POLYGON;case"circle":return O.$.CIRCLE;case"ellipse":return O.$.ELLIPSE;case"line":return O.$.LINE;case"rect":return O.$.RECT;case"foreignObject":return O.$.FOREIGNOBJECT}return 0})(),size:(j=>{let yt=0,St=0,Kt=0,_t=0,le=null,J=null,X=parseFloat((null===(j=D.getAttribute("transform"))||void 0===j?void 0:j.replace("rotate(","").replace(")",""))||"0")||null;switch(D.nodeName){case"polygon":{var d,tt;let bt=[],Et=[],At=999999999,Qt=999999999,Ht=0,Tt=0;le=JSON.parse(D.getAttribute("ratios")||"[]"),J=null!==(d=null===(tt=D.getAttribute("points"))||void 0===tt?void 0:tt.split(",").map(function(vt){return vt.split(" ").map(function($t){return parseFloat($t)})}))&&void 0!==d?d:[],J.forEach(function(vt){bt.push(vt[0]),Et.push(vt[1])}),At=Math.min.apply(null,bt),Qt=Math.min.apply(null,Et),Ht=Math.max.apply(null,bt),Tt=Math.max.apply(null,Et),yt=At,St=Qt,Kt=Ht-yt,_t=Tt-St;break}case"circle":{let bt=parseFloat(D.getAttribute("cx")||"0"),Et=parseFloat(D.getAttribute("cy")||"0"),At=parseFloat(D.getAttribute("r")||"0");yt=bt-At,St=Et-At,Kt=2*At,_t=2*At;break}case"ellipse":{let bt=parseFloat(D.getAttribute("cx")||"0"),Et=parseFloat(D.getAttribute("cy")||"0"),At=parseFloat(D.getAttribute("rx")||"0"),Qt=parseFloat(D.getAttribute("ry")||"0");yt=bt-At,St=Et-Qt,Kt=2*At,_t=2*Qt;break}case"line":{let bt=parseFloat(D.getAttribute("x1")||"0"),Et=parseFloat(D.getAttribute("y1")||"0"),At=parseFloat(D.getAttribute("x2")||"0"),Qt=parseFloat(D.getAttribute("y2")||"0"),Ht=999999999,Tt=999999999,vt=0,$t=0;Ht=Math.min(bt,At),Tt=Math.min(Et,Qt),vt=Math.max(bt,At),$t=Math.max(Et,Qt),yt=Ht,St=Tt,Kt=vt-yt,_t=$t-St,le=[[(bt-yt)/(Kt||1),(Et-St)/(_t||1)],[(At-yt)/(Kt||1),(Qt-St)/(_t||1)]];break}case"rect":case"foreignObject":yt=parseFloat(D.getAttribute("x")||"0"),St=parseFloat(D.getAttribute("y")||"0"),Kt=parseFloat(D.getAttribute("width")||"0"),_t=parseFloat(D.getAttribute("height")||"0")}return Object.assign({},{x:yt,y:St,width:Kt,height:_t,ratios:le,points:J,rotate:X})})(),attribute:(()=>{let j={};switch(D.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var yt,St,Kt,_t,le,J;let X=null!==(yt=D.getAttribute("fill"))&&void 0!==yt?yt:null,d=null!==(St=D.getAttribute("stroke"))&&void 0!==St?St:null,tt=null!==(Kt=parseFloat(D.getAttribute("stroke-width")||"0"))&&void 0!==Kt?Kt:null,bt=null!==(_t=D.getAttribute("stroke-linecap"))&&void 0!==_t?_t:null,Et=null!==(le=D.getAttribute("stroke-linejoin"))&&void 0!==le?le:null,At=null!==(J=parseFloat(D.getAttribute("stroke-dasharray")||"0"))&&void 0!==J?J:null;Object.assign(j,{fill:X,stroke:d,strokeWidth:tt,strokeLinecap:bt,strokeLinejoin:Et,strokeDasharray:At});break}}return j})(),style:(()=>{let j={};switch(D.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let Kt=jQuery(D).find(".svg-container");if(Kt.length){let le=parseFloat(Kt.css("border-width")||"0")||null,J=Kt.css("border-style")||null,X=Kt.css("border-color")||null,d=null,tt=Kt.css("background-color")||null,bt=null;(()=>{let{hex:Et,alpha:At}=_(X);X=Et,d=At})(),(()=>{let{hex:Et,alpha:At}=_(tt);tt=Et,bt=At})(),Object.assign(j,{borderWidth:le,borderStyle:J,borderColor:X,borderOpacity:d,backgroundColor:tt,backgroundOpacity:bt})}let _t=jQuery(D).find(".svg-editor-content");if(_t.length){var yt,St;let le=JSON.parse((_t.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:J,alpha:X}=_(le.TextColor);Object.assign(j,{fontFamily:null!==(yt=le.FontFamily)&&void 0!==yt?yt:null,fontSize:null!==(St=le.FontSize)&&void 0!==St?St:null,color:J,opacity:X})}break}}return j})(),source:(()=>{let j={};switch(D.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Ut.hasClass("editors")){let Tt=jQuery(D).find(".svg-editor-content");if(Tt.length){var yt;let vt=Tt.html(),$t=null!==(yt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==yt?yt:[];Object.assign(j,{type:"html",html:{htmlContent:vt,variableKeywords:$t}})}}else if(Ut.hasClass("inputs")||Ut.hasClass("textareas"))Object.assign(j,{type:"input",input:{input:!!jQuery(D).find("input").length,textarea:!!jQuery(D).find("textarea").length}});else if(Ut.hasClass("tests")){let Tt=jQuery(D).find(".svg-test");if(Ut.hasClass("tests-truefalse")){var St,Kt;let vt=Tt.find(".svg-editor-content").html(),$t=null!==(St=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==St?St:[];Object.assign(j,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Kt=T.test2.truefalse)||void 0===Kt?void 0:Kt.includes(jt)}},html:{htmlContent:vt,variableKeywords:$t}})}else if(Ut.hasClass("tests-singlechoice")){var _t,le;let vt=Tt.find(".svg-editor-content").html(),$t=null!==(_t=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==_t?_t:[];Object.assign(j,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(le=T.test2.singlechoice)||void 0===le?void 0:le.includes(jt)}},html:{htmlContent:vt,variableKeywords:$t}})}else if(Ut.hasClass("tests-multichoice")){var J,X;let vt=Tt.find(".svg-editor-content").html(),$t=null!==(J=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==J?J:[];Object.assign(j,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(X=T.test2.multichoice)||void 0===X?void 0:X.includes(jt)}},html:{htmlContent:vt,variableKeywords:$t}})}else if(Ut.hasClass("tests-fill")){var d,tt;let vt=Tt.find(".svg-editor-content").html(),$t=null!==(d=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[],H=null!==(tt=(null!=vt?vt:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==tt?tt:[];H=H.filter((c,V,at)=>at.indexOf(c)==V),Object.assign(j,{type:"test",test:{type:"fill",fill:H.map(c=>{var V;return{key:c,value:null===(V=T.test2.fill)||void 0===V||null===(V=V.find(at=>at.id==jt))||void 0===V||null===(V=V.vals)||void 0===V?void 0:V.map(at=>at.text).filter(at=>!["",null,void 0,NaN].includes(at))}})},html:{htmlContent:vt,variableKeywords:$t,fillKeywords:H}})}else if(Ut.hasClass("tests-matching")){if(Tt.hasClass("svg-test-empty"))Object.assign(j,{type:"test",test:{type:"matching-empty",matching:{key:Tt.attr("data-name")||null}}});else if(Tt.hasClass("svg-test-content")){var bt;let vt=Tt.find(".svg-editor-content").html(),$t=null!==(bt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==bt?bt:[];Object.assign(j,{type:"test",test:{type:"matching-content",matching:{key:Tt.attr("data-name")||null}},html:{htmlContent:vt,variableKeywords:$t}})}}else if(Ut.hasClass("tests-speech")){var Et;Object.assign(j,{type:"speech",speech:{value:null===(Et=T.test2.speech)||void 0===Et||null===(Et=Et.find(vt=>vt.id==jt))||void 0===Et||null===(Et=Et.vals)||void 0===Et?void 0:Et.map(vt=>vt.text).filter(vt=>!["",null,void 0,NaN].includes(vt))}})}else if(Ut.hasClass("tests-submit")){let vt=jQuery(D).find(".svg-container img");Object.assign(j,{type:"test",test:{type:"submit"},image:S(vt.attr("url"),vt.attr("path"),vt.attr("src"))})}}else if(Ut.hasClass("images")){let Tt=jQuery(D).find(".svg-editor-content img");if(Tt.length)Object.assign(j,{type:"image",image:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});else{let vt=jQuery(D).find("iframe");Object.assign(j,{type:"iframe",iframe:S(vt.attr("url"),vt.attr("path"),vt.attr("src"))})}}else if(Ut.hasClass("sounds")){let Tt=jQuery(D).find(".svg-editor-content img");Tt.length&&Object.assign(j,{type:"image",image:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))})}else if(Ut.hasClass("htmls")){let Tt=jQuery(D).find("iframe");Tt.length&&Object.assign(j,{type:"iframe",iframe:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))})}else if(Ut.hasClass("svgs")){let Tt=jQuery(D).find("svg");var At,Qt;Tt.length&&Object.assign(j,{type:"svg",svg:Object.assign(S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src")),{svgContent:null!==(At=null===(Qt=Tt.get(0))||void 0===Qt?void 0:Qt.outerHTML)&&void 0!==At?At:null})})}else if(Ut.hasClass("medias")){let Tt=jQuery(D).find(".media-item");if(Tt.length)switch(Tt.attr("type")){case"audio":Object.assign(j,{type:"audio",audio:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;case"video":Object.assign(j,{type:"video",video:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;case"file":Object.assign(j,{type:"file",file:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;default:var Ht;Object.assign(j,{type:"link",link:{url:null!==(Ht=Tt.attr("url"))&&void 0!==Ht?Ht:null}})}let vt=jQuery(D).find("img");vt.length&&(Object.assign(j,{image:S(vt.attr("url"),vt.attr("path"),vt.attr("src"))}),j.type||Object.assign(j,{type:"image"}))}}return j})(),animate:(j=>{let yt={},St=null===(j=T.animates)||void 0===j?void 0:j.find(Kt=>Kt.elementId==jt);return St&&Object.assign(yt,{value:St.value}),yt})(),interactive:(()=>{let j={},yt=T.actions.show.filter(Kt=>Kt.elementId==jt&&Kt.active);yt.length&&(j.show={},yt.forEach(Kt=>{let{source:_t}=Kt;switch(null==_t?void 0:_t.type){case"work":var le,J,X,d,tt;j.show.action={},Object.assign(j.show.action,{value:null!==(le=_t.value)&&void 0!==le?le:null,iteration:null!==(J=_t.iteration)&&void 0!==J?J:null,finish:null!==(X=_t.end)&&void 0!==X?X:null,time:null!==(d=_t.time)&&void 0!==d?d:null,points:null!==(tt=_t.points)&&void 0!==tt?tt:null});break;case"audio":var bt,Et,At;j.show.audio={},Object.assign(j.show.audio,{source:S(null,null,_t.url),iteration:null!==(bt=_t.iteration)&&void 0!==bt?bt:null,finish:null!==(Et=_t.end)&&void 0!==Et?Et:null,time:null!==(At=_t.time)&&void 0!==At?At:null,async:-1==_t.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Qt,Ht,Tt,vt,$t,H,c,V,at,ot,Z,U,W,w,R;_t.options.includes("show")&&(j.show.triggershow={},Object.assign(j.show.triggershow,{id:null!==(Qt=parseInt(null!==(Ht=_t.id)&&void 0!==Ht?Ht:"0"))&&void 0!==Qt?Qt:null,ids:null===(Tt=_t.ids)||void 0===Tt?void 0:Tt.map(gt=>parseInt(gt)),async:null!==(vt=_t.async)&&void 0!==vt?vt:null,time:null!==($t=_t.time)&&void 0!==$t?$t:null})),_t.options.includes("run")&&(j.show.triggerrun={},Object.assign(j.show.triggerrun,{id:null!==(H=parseInt(null!==(c=_t.id)&&void 0!==c?c:"0"))&&void 0!==H?H:null,ids:null===(V=_t.ids)||void 0===V?void 0:V.map(gt=>parseInt(gt)),async:null!==(at=_t.async)&&void 0!==at?at:null,time:null!==(ot=_t.time)&&void 0!==ot?ot:null})),_t.options.includes("hide")&&(j.show.triggerhide={},Object.assign(j.show.triggerhide,{id:null!==(Z=parseInt(null!==(U=_t.id)&&void 0!==U?U:"0"))&&void 0!==Z?Z:null,ids:null===(W=_t.ids)||void 0===W?void 0:W.map(gt=>parseInt(gt)),async:null!==(w=_t.async)&&void 0!==w?w:null,time:null!==(R=_t.time)&&void 0!==R?R:null}))}}));let St=T.actions.click.filter(Kt=>Kt.elementId==jt&&Kt.active);return St&&(j.click={},St.forEach(Kt=>{let{source:_t}=Kt;switch(null==_t?void 0:_t.type){case"work":var le,J,X,d,tt;j.click.action={},Object.assign(j.click.action,{value:null!==(le=_t.value)&&void 0!==le?le:null,iteration:null!==(J=_t.iteration)&&void 0!==J?J:null,finish:null!==(X=_t.end)&&void 0!==X?X:null,time:null!==(d=_t.time)&&void 0!==d?d:null,points:null!==(tt=_t.points)&&void 0!==tt?tt:null});break;case"audio":var bt,Et,At;j.click.audio={},Object.assign(j.click.audio,{source:S(null,null,_t.url),iteration:null!==(bt=_t.iteration)&&void 0!==bt?bt:null,finish:null!==(Et=_t.end)&&void 0!==Et?Et:null,time:null!==(At=_t.time)&&void 0!==At?At:null,async:-1==_t.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Qt,Ht,Tt,vt,$t,H,c,V,at,ot,Z,U,W,w,R;_t.options.includes("show")&&(j.click.triggershow={},Object.assign(j.click.triggershow,{id:null!==(Qt=parseInt(null!==(Ht=_t.id)&&void 0!==Ht?Ht:"0"))&&void 0!==Qt?Qt:null,ids:null===(Tt=_t.ids)||void 0===Tt?void 0:Tt.map(kt=>parseInt(kt)),async:null!==(vt=_t.async)&&void 0!==vt?vt:null,time:null!==($t=_t.time)&&void 0!==$t?$t:null})),_t.options.includes("run")&&(j.click.triggerrun={},Object.assign(j.click.triggerrun,{id:null!==(H=parseInt(null!==(c=_t.id)&&void 0!==c?c:"0"))&&void 0!==H?H:null,ids:null===(V=_t.ids)||void 0===V?void 0:V.map(kt=>parseInt(kt)),async:null!==(at=_t.async)&&void 0!==at?at:null,time:null!==(ot=_t.time)&&void 0!==ot?ot:null})),_t.options.includes("hide")&&(j.click.triggerhide={},Object.assign(j.click.triggerhide,{id:null!==(Z=parseInt(null!==(U=_t.id)&&void 0!==U?U:"0"))&&void 0!==Z?Z:null,ids:null===(W=_t.ids)||void 0===W?void 0:W.map(kt=>parseInt(kt)),async:null!==(w=_t.async)&&void 0!==w?w:null,time:null!==(R=_t.time)&&void 0!==R?R:null}));break;case"slide":var gt;j.click.slide={},Object.assign(j.click.slide,{id:parseInt(null!==(gt=_t.id)&&void 0!==gt?gt:"0")||_t.num||null,code:_t.id})}})),j})(),variable:(j=>{let yt={};var St;D.getAttribute("data-variable")&&(yt.input={},Object.assign(yt.input,{variable:null!==(St=D.getAttribute("data-variable"))&&void 0!==St?St:null}));let Kt=null===(j=T.nodes)||void 0===j||null===(j=j.find(d=>d.id==jt))||void 0===j?void 0:j.variable;var _t,le,J,X;return Kt&&(yt.click={},Object.assign(yt.click,{variable:null!==(_t=Kt.variable)&&void 0!==_t?_t:null,operator:null!==(le=Kt.operator)&&void 0!==le?le:null,valuetype:null!==(J=Kt.valuetype)&&void 0!==J?J:null,value:null!==(X=Kt.value)&&void 0!==X?X:null})),yt})()};null===(Wt=ct.svg)||void 0===Wt||Wt.nodes.push(rt)}),q.push(ct)}),console.log(q),{screen:{width:G.screen.w,height:G.screen.h},data:{slides:q},variable:G.variable}}},644:(ae,Rt,v)=>{v.d(Rt,{Dx:()=>u,aY:()=>k,qp:()=>M,qz:()=>et,sV:()=>_,yR:()=>m});var N=v(5861),O=v(9422);O.config({driver:[O.INDEXEDDB,O.LOCALSTORAGE,O.WEBSQL],name:"_localDataDB",version:1});const C={create:(A=(0,N.Z)(function*(){return O}),function(){return A.apply(this,arguments)}),get:function(){var A=(0,N.Z)(function*(S){return O.getItem(S)});return function(Q){return A.apply(this,arguments)}}(),set:function(){var A=(0,N.Z)(function*(S,Q){return O.setItem(S,Q)});return function(Q,G){return A.apply(this,arguments)}}()},et=function(){var A=(0,N.Z)(function*(S){yield C.create();var Q=(yield C.get("icdt-data"))||[];"function"==typeof S.callback&&S.callback(Q)});return function(Q){return A.apply(this,arguments)}}(),u=function(){var A=(0,N.Z)(function*(S){yield C.create(),S.params=S.params||{};try{yield C.set("icdt-data",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(Q){"function"==typeof S.callback&&S.callback(null),console.error(Q)}});return function(Q){return A.apply(this,arguments)}}(),_=function(){var A=(0,N.Z)(function*(S){yield C.create();try{var Q=(yield C.get("icdt-config"))||{};"function"==typeof S.callback&&S.callback(Q)}catch(G){"function"==typeof S.callback&&S.callback(null),console.error(G)}});return function(Q){return A.apply(this,arguments)}}(),M=function(){var A=(0,N.Z)(function*(S){yield C.create(),S.params=S.params||{};try{yield C.set("icdt-config",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(Q){"function"==typeof S.callback&&S.callback(null),console.error(Q)}});return function(Q){return A.apply(this,arguments)}}(),k=function(){var A=(0,N.Z)(function*(S){yield C.create();try{var Q=(yield C.get("icdt-clipboard"))||{};"function"==typeof S.callback&&S.callback(Q)}catch(G){"function"==typeof S.callback&&S.callback(null),console.error(G)}});return function(Q){return A.apply(this,arguments)}}(),m=function(){var A=(0,N.Z)(function*(S){yield C.create(),S.params=S.params||{};try{yield C.set("icdt-clipboard",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(Q){"function"==typeof S.callback&&S.callback(null),console.error(Q)}});return function(Q){return A.apply(this,arguments)}}();var A},9359:(ae,Rt,v)=>{v.d(Rt,{E:()=>N});const N=(O,lt)=>{if(!O)return"";let C=O.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),et=(C&&C[4]||"").trim(),u=C?(256|C[1]).toString(16).slice(1)+(256|C[2]).toString(16).slice(1)+(256|C[3]).toString(16).slice(1):O;if("0"==et)return"transparent";if(lt){let _;_=""!==et?et:"01",_=(255*_|256).toString(16).slice(1),u+=_}return console.log(`lib_rgba2hex: ${O} -> ${u}`),`#${u}`}},1687:(ae,Rt,v)=>{v.d(Rt,{O:()=>N});const N={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(ae,Rt,v)=>{v.d(Rt,{D:()=>N});const N={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(ae,Rt,v)=>{v.d(Rt,{_:()=>N});const N={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(ae,Rt,v)=>{v.d(Rt,{D:()=>N});const N={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(ae,Rt,v)=>{v.d(Rt,{$:()=>N});const N={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(ae,Rt,v)=>{v.d(Rt,{icdt:()=>mt});var N=v(968),O=v(7492),lt=v(1687),C=v(9054),et=v(4318),u=v(6816),_=v(666),M=v(3171);const A=I=>{var i,n,r,a,o;let g=(null===(i=I.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=I.touchEvent)||void 0===n?void 0:n.target),y=(null==g?void 0:g.getAttribute("id"))||"",f=null==g?void 0:g.nodeName,E=(null==g||null===(r=g.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var p,z;if([lt.O.RESIZE_GROUP,lt.O.SELECT_GROUP].includes(E))return null===(p=I.mouseEvent)||void 0===p||p.stopPropagation(),void(null===(z=I.mouseEvent)||void 0===z||z.preventDefault());if(null!==(a=I.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=I.touchEvent)&&void 0!==o&&o.altKey||!y||y.match(/[^0-9]/)||!mt.dataSelect.nodeName.includes(f)){var P;mt.dataSelect.ids.length&&(mt.dataSelect.ids=[]),(0==(null===(P=I.mouseEvent)||void 0===P?void 0:P.button)||I.touchEvent)&&(I=>{let o=(0,O.g1)(lt.O.SCAN_GROUP,"g"),g=(0,et.bH)(0,0,1,1);(0,O.vl)(o,g),((I,i,n)=>{(0,u.A)(I,{start:o=>{},move:(o,g)=>{((o,g,y,f)=>{i=(0,et.bH)(o,g,y,f),(0,O.vl)(n,i)})(g[0][0],g[0][1],o.x,o.y)},end:(o,g)=>{null==n||n.remove(),mt.dataSelect.ids=mt.data.getNodeInArea(Math.min(g[0][0],o.x),Math.min(g[0][1],o.y),Math.max(g[0][0],o.x),Math.max(g[0][1],o.y));let y=mt.dataSelect.nodes;1==y.length?(0,_.y)(y[0]):y.length>1&&(0,M.Q)(y)}})})(I,g,o)})(I)}else{var st,ut;let wt=parseFloat(y||"0");mt.dataSelect.ids=null!==(st=I.mouseEvent)&&void 0!==st&&st.shiftKey||null!==(ut=I.touchEvent)&&void 0!==ut&&ut.shiftKey?[wt].concat(mt.dataSelect.ids).filter((Zt,fe,ge)=>ge.indexOf(Zt)==fe):[wt];let It=mt.dataSelect.nodes;It.length>1||1==It.length&&It[0].type==C.$.PATH?(0,M.Q)(It):1==It.length&&(0,_.y)(It[0])}};class Q{constructor(){let{x:i,y:n}=mt.screen.dislocation;var r=(a,o,g,y)=>{mt.screen.move({x:i,y:n},{x:g-a,y:y-o})};return{start:a=>{},move:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)}}}}var G=v(4714);const K=[{name:"tam gi\xe1c vu\xf4ng",type:G.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:G.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:G.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:G.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:G.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:G.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:G.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:G.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:G.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:G.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:G.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:G.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:G.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var q=v(8619),T=v(5811);class Y{constructor(){let i=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,q._)(Math.ceil(1e9*Math.random())),g=(y,f,E,p)=>{o=(0,et.bH)(y,f,E,p,{ratio:1}),o.x=(0,T.q)(o.x),o.y=(0,T.q)(o.y),o.width=(0,T.q)(o.width),o.height=(0,T.q)(o.height),Object.assign(a,(0,et.sg)(C.$.CIRCLE,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{r.setAttribute("cx",y.x.toString()),r.setAttribute("cy",y.y.toString()),r.setAttribute("r","1")},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y),mt.data.node=Object.assign({id:n,type:C.$.CIRCLE,name:"Circle"},{size:o,attribute:a}),null==i||i.remove()}}}}var F=v(8785);class ft{constructor(){let i=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,F.r)(Math.ceil(1e9*Math.random()));var g=(y,f,E,p)=>{o=(0,et.bH)(y,f,E,p),o.x=(0,T.q)(o.x),o.y=(0,T.q)(o.y),o.width=(0,T.q)(o.width),o.height=(0,T.q)(o.height),Object.assign(a,(0,et.sg)(C.$.ELLIPSE,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{r.setAttribute("cx",y.x.toString()),r.setAttribute("cy",y.y.toString()),r.setAttribute("rx","1"),r.setAttribute("ry","1")},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y),mt.data.node=Object.assign({id:n,type:C.$.ELLIPSE,name:"Ellipse"},{size:o,attribute:a}),null==i||i.remove()}}}}var ct=v(8054);class dt{constructor(){let i=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,ct.f)(Math.ceil(1e9*Math.random()));var g=(y,f,E,p)=>{o=(0,et.bH)(y,f,E,p),o.x=(0,T.q)(o.x),o.y=(0,T.q)(o.y),o.width=(0,T.q)(o.width),o.height=(0,T.q)(o.height),Object.assign(a,(0,et.sg)(C.$.RECT,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{g(y.x,y.y,y.x+o.width,y.y+o.height)},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{o.width>=10&&o.height>=10?mt.data.node=Object.assign({id:n,type:C.$.RECT,name:"Rect"},{size:o,attribute:a}):null==r||r.remove(),null==i||i.remove()}}}}var D=v(2282);class Ot{constructor(i){let n=(0,O.g1)(lt.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:a,element:o,attribute:g,size:y}=(0,D.l)(Math.ceil(1e9*Math.random()));y.ratios=r;var f=(E,p,z,P)=>{y=(0,et.bH)(E,p,z,P,{ratios:r}),y.x=(0,T.q)(y.x),y.y=(0,T.q)(y.y),y.width=(0,T.q)(y.width),y.height=(0,T.q)(y.height),Object.assign(g,(0,et.sg)(C.$.POLYGON,y)),(0,O.__)(o,g),(0,O.g$)(n,y)};return{start:E=>{},move:(E,p)=>{f(p[0][0],p[0][1],E.x,E.y)},end:(E,p)=>{f(p[0][0],p[0][1],E.x,E.y),mt.data.node=Object.assign({id:a,type:C.$.POLYGON,name:"Polygon"},{size:y,attribute:g}),null==n||n.remove()}}}}var Wt=v(4921);class Ut{constructor(){let i=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,Wt.W)(Math.ceil(1e9*Math.random()));var g=(y,f,E,p)=>{o=(0,et.bH)(y,f,E,p),o.x=(0,T.q)(o.x),o.y=(0,T.q)(o.y),o.width=(0,T.q)(o.width),o.height=(0,T.q)(o.height),Object.assign(a,(0,et.sg)(C.$.LINE,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:y=>{},move:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y)},end:(y,f)=>{g(f[0][0],f[0][1],y.x,y.y),mt.data.node=Object.assign({id:n,type:C.$.LINE,name:"Line"},{size:o,attribute:a}),null==i||i.remove()}}}}var Lt=v(8419);class Pt{constructor(){let{nodeId:i,element:n,attribute:r,size:a}=(0,Lt.G)(Math.ceil(1e9*Math.random())),g="";var y=(f,E)=>{g+=` ${f} ${E}`,n.setAttribute("d",g)};return{start:f=>{g=`M ${f.x} ${f.y} L ${f.x} ${f.y}`},move:(f,E)=>{y(f.x,f.y)},end:(f,E)=>{y(f.x,f.y),(f=>{let E=9999,p=9999,z=-9999,P=-9999;f.forEach(st=>{E=Math.min(E,st[0]),p=Math.min(p,st[1]),z=Math.max(z,st[0]),P=Math.max(P,st[1])}),a=(0,et.bH)(E,p,z,P,{points:f}),Object.assign(r,(0,et.sg)(C.$.PATH,a)),(0,O.__)(n,r)})(E),mt.data.node=Object.assign({id:i,type:C.$.PATH,name:"Path"},{size:a,attribute:r})}}}}var jt=v(2875);class rt{constructor(){let i=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:a,attribute:o,style:g,source:y}=(0,jt.e)(Math.ceil(1e9*Math.random()));var f=(E,p,z,P)=>{a=(0,et.bH)(E,p,z,P),a.x=(0,T.q)(a.x),a.y=(0,T.q)(a.y),a.width=(0,T.q)(a.width),a.height=(0,T.q)(a.height),Object.assign(o,(0,et.sg)(C.$.FOREIGNOBJECT,a)),(0,O.__)(r,o),(0,O.g$)(i,a)};return{start:E=>{f(E.x,E.y,E.x+a.width,E.y+a.height)},move:(E,p)=>{f(p[0][0],p[0][1],E.x,E.y)},end:(E,p)=>{a.width>=10&&a.height>=10?mt.data.node=Object.assign({id:n,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:g,source:y}):null==r||r.remove(),null==i||i.remove()}}}}var j=v(7210);class yt{constructor(){var i,n;let r=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:a,element:o,size:g,attribute:y,source:f}=(0,j.G)(Math.ceil(1e9*Math.random())),E=1;(z=>{if(!z)return;let P=new Image;P.onload=()=>{E=(0,T.q)(P.naturalWidth/P.naturalHeight,100)},P.onerror=st=>{console.error(`ImgSrc load failed -> ${z}`,st)},P.src=z})(null!==(i=null===(n=f.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var p=(z,P,st,ut)=>{g=(0,et.bH)(z,P,st,ut,{ratio:E}),g.x=(0,T.q)(g.x),g.y=(0,T.q)(g.y),g.width=(0,T.q)(g.width),g.height=(0,T.q)(g.height),Object.assign(y,(0,et.sg)(C.$.IMAGE,g)),(0,O.__)(o,y),(0,O.g$)(r,g)};return{start:z=>{p(z.x,z.y,z.x+g.width,z.y+g.height)},move:(z,P)=>{p(P[0][0],P[0][1],z.x,z.y)},end:(z,P)=>{g.width>=10&&g.height>=10?mt.data.node=Object.assign({id:a,type:C.$.IMAGE,name:"Image"},{size:g,attribute:y,source:f}):null==o||o.remove(),null==r||r.remove()}}}}var Kt=v(4578),_t=v(9623);function X(I,i,n,r){return Math.sqrt(Math.pow(n-I,2)+Math.pow(r-i,2))}function d(I,i,n,r,a){return X(I,i,n,r)<a?1:0}function bt(I,i,n,r,a,o,g){var y=[];return y.push(d(I,i,n,r,g)),y.push(d(I,i,a,o,g)),y.push(function tt(I,i,n,r,a,o,g){var y=[a-n,o-r],f=[I-n,i-r],E=[-y[1],y[0]],p=Math.sqrt(Math.pow(E[0],2)+Math.pow(E[1],2)),z=[E[0]/p,E[1]/p],P=Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)),st=[y[0]/P,y[1]/P],ut=f[0]*st[0]+f[1]*st[1];if(ut<=0||ut>=P)return 0;var wt=f[0]*z[0]+f[1]*z[1];return wt>=g||wt<=-g?0:1}(I,i,n,r,a,o,g)),y}function Et(I,i,n,r,a){var o=[n-I,r-i],g=[-o[1],o[0]],y=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),f=[g[0]/y,g[1]/y];return[[I+a*f[0],i+a*f[1]],[I-a*f[0],i-a*f[1]],[n-a*f[0],r-a*f[1]],[n+a*f[0],r+a*f[1]]]}function At(I,i,n,r,a,o,g){var ut,y=[a-I,o-i],f=[n-I,r-i],E=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2)),p=[f[0]/E,f[1]/E],z=y[0]*p[0]+y[1]*p[1],P=[I+z*p[0],i+z*p[1]],st=Math.sqrt(Math.pow(a-P[0],2)+Math.pow(o-P[1],2));ut=0===st?g:Math.sqrt(Math.pow(g,2)-Math.pow(st,2));var wt=[I+z*p[0]+ut*p[0],i+z*p[1]+ut*p[1]];return wt[0]===I&&wt[1]===i?null:wt}function Qt(I,i,n,r,a,o,g){var y=[a-I,o-i],f=[n-I,r-i],E=[-f[1],f[0]],p=Math.sqrt(Math.pow(E[0],2)+Math.pow(E[1],2)),z=[E[0]/p,E[1]/p],P=y[0]*z[0]+y[1]*z[1],st=c([I,i],[n,r],[a,o]);if($t([st[0]-a,st[1]-o])>=g)return null;var wt=Math.sqrt(Math.pow(g,2)-Math.pow(P,2)),It=[a-P*z[0],o-P*z[1]],Zt=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2)),fe=[f[0]/Zt,f[1]/Zt],ge=[[It[0]-fe[0]*wt,It[1]-fe[1]*wt],[It[0]+fe[0]*wt,It[1]+fe[1]*wt]];return ge[0][0]===I&&ge[0][1]===i?null:ge}function Ht(I,i,n,r,a,o,g,y){var f,E,p,z,P,st;return-(p=g-a)*(E=r-i)+(f=n-I)*(z=y-o)==0?null:(st=(p*(i-o)-z*(I-a))/(-p*E+f*z),(P=(-E*(I-a)+f*(i-o))/(-p*E+f*z))>=0&&P<=1&&st>=0&&st<=1?[I+st*f,i+st*E]:null)}function Tt(I,i,n,r,a,o,g,y,f,E){var p=Et(o,g,y,f,E),z=[];if(n[0]&&!n[1])z.push(At(I,i,r,a,o,g,E)),z.push(Ht(I,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),z.push(Ht(I,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1])),(P=Qt(I,i,r,a,y,f,E))&&z.push(P[0],P[1]);else if(!n[0]&&n[1])z.push(At(I,i,r,a,y,f,E)),z.push(Ht(I,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),z.push(Ht(I,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1])),(P=Qt(I,i,r,a,o,g,E))&&z.push(P[0],P[1]);else if(n[0]&&n[1])z.push(At(I,i,r,a,o,g,E)),z.push(Ht(I,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),z.push(Ht(I,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1])),z.push(At(I,i,r,a,y,f,E));else{var P=Qt(I,i,r,a,y,f,E),st=Qt(I,i,r,a,o,g,E);P&&z.push(P[0],P[1]),st&&z.push(st[0],st[1]),z.push(Ht(I,i,r,a,p[0][0],p[0][1],p[3][0],p[3][1])),z.push(Ht(I,i,r,a,p[1][0],p[1][1],p[2][0],p[2][1]))}for(var ut=[I,i],wt=0;wt<z.length;wt++)z[wt]&&X(z[wt][0],z[wt][1],r,a)<X(ut[0],ut[1],r,a)&&(ut=z[wt]);return ut[0]===I&&ut[1]===i?null:ut}function vt(I,i,n,r,a,o,g,y,f){var E=Et(a,o,g,y,f),p=[],z=Qt(I,i,n,r,a,o,f);z&&p.push(z[0],z[1]),(z=Qt(I,i,n,r,g,y,f))&&p.push(z[0],z[1]),p.push(Ht(I,i,n,r,E[0][0],E[0][1],E[3][0],E[3][1])),p.push(Ht(I,i,n,r,E[1][0],E[1][1],E[2][0],E[2][1]));for(var P=[n,r],st=[I,i],ut=0;ut<p.length;ut++)p[ut]&&X(p[ut][0],p[ut][1],I,i)<X(P[0],P[1],I,i)&&(P=p[ut]);for(var wt=0;wt<p.length;wt++)p[wt]&&X(p[wt][0],p[wt][1],n,r)<X(st[0],st[1],n,r)&&(st=p[wt]);return P[0]===n&&P[1]===r||st[0]===I&&st[1]===i?null:[P,st]}var $t=function(I){return Math.sqrt(I[0]*I[0]+I[1]*I[1])},c=function(I,i,n){var r=[i[0]-I[0],i[1]-I[1]],a=$t(r);if(a<1e-6)return I;var o=[n[0]-I[0],n[1]-I[1]],g=(r[0]*o[0]+r[1]*o[1])/a;return g<0?I:g>a?i:[I[0]+r[0]*g/a,I[1]+r[1]*g/a]};class V{constructor(){let{element:r,size:o}=(0,Lt.G)(Math.ceil(1e9*Math.random()));(0,O.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let g="";return{start:E=>{g=`M ${E.x} ${E.y} L ${E.x} ${E.y}`},move:(E,p)=>{((E,p)=>{g+=` ${E} ${p}`,r.setAttribute("d",g)})(E.x,E.y)},end:(E,p)=>{r.remove(),(E=>{let p=9999,z=9999,P=-9999,st=-9999;E.forEach(wt=>{p=Math.min(p,wt[0]),z=Math.min(z,wt[1]),P=Math.max(P,wt[0]),st=Math.max(st,wt[1])}),o=(0,et.bH)(p,z,P,st,{points:E}),mt.data.getNodeInArea(0,0,1920,1920,C.$.PATH).forEach(wt=>{let Zt=((I,i,n)=>{n=n||20;var r=[],a=function(p){var z=i[0][0],P=i[0][1],st=0,ut=0;if(1!==p.length||d(p[0][0],p[0][1],z,P,n)){for(var wt;st<p.length-1;){var It=p[st],Zt=p[st+1],fe=d(It[0],It[1],z,P,n),ge=d(Zt[0],Zt[1],z,P,n);if(fe&&ge)ut=++st;else if(fe&&!ge)(we=At(It[0],It[1],Zt[0],Zt[1],z,P,n))?(p[st]=we,ut=st):st++;else if(!fe&&ge){var we;(we=At(Zt[0],Zt[1],It[0],It[1],z,P,n))&&((wt=p.slice(ut,st+1)).push(we),r.push(wt)),ut=++st}else{var ye=Qt(It[0],It[1],Zt[0],Zt[1],z,P,n);ye?(((wt=p.slice(ut,st+1))[wt.length-1][0]!==ye[0][0]||wt[wt.length-1][1]!==ye[0][1])&&wt.push(ye[0]),wt.length>1&&r.push(wt),p[st]=ye[1],p[st+1]&&p[st+1][0]==ye[1][0]&&p[st+1][1]==ye[1][1]&&st++,ut=st):st++}}ut!==st&&(wt=p.slice(ut,p.length))&&r.push(wt)}else r.push(p)},o=function(p,z){var Zt,P=i[z],st=i[z+1],ut=0,wt=0;if(1!==p.length||-1!==(It=bt(p[0][0],p[0][1],P[0],P[1],st[0],st[1],n)).indexOf(1)){for(;ut<p.length-1;){var fe=p[ut],ge=p[ut+1],It=bt(fe[0],fe[1],P[0],P[1],st[0],st[1],n),we=bt(ge[0],ge[1],P[0],P[1],st[0],st[1],n);if(-1!==It.indexOf(1)&&-1!==we.indexOf(1))wt=++ut;else if(-1!==It.indexOf(1)&&-1===we.indexOf(1))(ye=Tt(fe[0],fe[1],It,ge[0],ge[1],P[0],P[1],st[0],st[1],n))?(p[ut]=ye,wt=ut):ut++;else if(-1===It.indexOf(1)&&-1!==we.indexOf(1)){var ye;(ye=Tt(ge[0],ge[1],we,fe[0],fe[1],P[0],P[1],st[0],st[1],n))?((Zt=p.slice(wt,ut+1)).push(ye),r.push(Zt),wt=++ut):ut++}else{var Se=vt(fe[0],fe[1],ge[0],ge[1],P[0],P[1],st[0],st[1],n);Se?(((Zt=p.slice(wt,ut+1))[Zt.length-1][0]!==Se[0][0]||Zt[Zt.length-1][1]!==Se[0][1])&&Zt.push(Se[0]),Zt.length>1&&r.push(Zt),p[ut]=Se[1],p[ut+1]&&p[ut+1][0]==Se[1][0]&&p[ut+1][1]==Se[1][1]&&ut++,wt=ut):ut++}}wt!==ut&&(Zt=p.slice(wt,p.length))&&r.push(Zt)}else r.push(p)};if(i=function J(I){var i=[];if(1===I.length)i=I;else{for(var n=0;n<I.length-1;)(I[n][0]!==I[n+1][0]||I[n][1]!==I[n+1][1])&&i.push(I[n]),n++;0!==I.length&&0===i.length&&i.push(I[0]),(I[I.length-1][0]!==I[i.length-1][0]||I[I.length-1][1]!==I[i.length-1][1])&&i.push(I[n])}return i}(i),1===i.length){for(var g=0;g<I.length;g++)a(I[g]);I=r}else for(var y=0;y<i.length-1;y++){for(g=0;g<I.length;g++)o(I[g],y);I=r,r=[]}for(var f=0;f<I.length;f++)for(var E=0;E<I[f].length;E++)I[f][E][0]=Math.round(I[f][E][0]),I[f][E][1]=Math.round(I[f][E][1]);return I})(mt.data.getNode(wt).size.points,E,2);console.log(Zt)})})(p)}}}}var ot=v(1105);class Z{constructor(){let i=(0,O.g1)(lt.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o,source:g}=(0,ot.$)(Math.ceil(1e9*Math.random())),y=(f,E,p,z)=>{o=(0,et.bH)(f,E,p,z),o.x=(0,T.q)(o.x),o.y=(0,T.q)(o.y),o.width=(0,T.q)(o.width),o.height=(0,T.q)(o.height),Object.assign(a,(0,et.sg)(C.$.TEXT,o)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:f=>{y(f.x,f.y,f.x+o.width,f.y+o.height)},move:(f,E)=>{y(E[0][0],E[0][1],f.x,f.y)},end:(f,E)=>{o.width>=10&&o.height>=10?mt.data.node=Object.assign({id:n,type:C.$.TEXT,name:"Text"},{size:o,attribute:a,source:g}):null==r||r.remove(),null==i||i.remove()}}}}var R=v(4113),gt=v(9125),kt=v(7797);var Mt=v(6358);class zt{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>mt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,a,o,g;null===(n=window.document.getElementById(lt.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(lt.O.SELECT_GROUP))||void 0===r||r.remove(),null===(a=window.document.getElementById(lt.O.SCAN_GROUP))||void 0===a||a.remove(),null===(o=window.document.getElementById(lt.O.CREATE_GROUP))||void 0===o||o.remove(),null===(g=window.document.getElementById(lt.O.INTERACTIVE_GROUP))||void 0===g||g.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(y=>y(i))}deleteNode(){for(let i of this._selected_Ids){let n=mt.data.deleteNode(i);mt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}mt.dataSelect.ids=[]}groupNode(){let i=[];if(mt.dataSelect.ids.length>=2){let n=mt.data.getNode(mt.dataSelect.ids[0]),{nodeId:r,attribute:a,size:o}=(0,Mt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);mt.data.node=Object.assign({id:r,type:C.$.GROUP,name:"G"},{size:o,attribute:a});for(let g of mt.dataSelect.ids)i.push(mt.data.addGroup(g,r))}if(i.length){mt.dataSelect.ids=i;let n=mt.dataSelect.nodes;1==n.length?(0,_.y)(n[0]):n.length>1&&(0,M.Q)(n)}}ungroupNode(){let i=[];for(let n of mt.dataSelect.ids)i.push(mt.data.unGroup(n));if(i.length){mt.dataSelect.ids=i;let n=mt.dataSelect.nodes;1==n.length?(0,_.y)(n[0]):n.length>1&&(0,M.Q)(n)}}}var Gt=v(9942);class Vt{createNodeImage(i,n){var r,a,o,g;let{nodeId:f,element:E,size:p,attribute:z,source:P}=(0,j.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Gt.I)(i)}});(st=>{if(!st)return;let ut=new Image;ut.onload=()=>{let wt=(0,T.q)(ut.naturalWidth/ut.naturalHeight,100);wt>=1?(p.width=Math.min(ut.naturalWidth,512),p.height=(0,T.q)(p.width/wt,100)):(p.height=Math.min(ut.naturalHeight,512),p.width=(0,T.q)(p.height*wt,100)),p.x=(0,T.q)(p.x+50-p.width/2,100),p.y=(0,T.q)(p.y+50-p.height/2,100),Object.assign(z,(0,et.sg)(C.$.IMAGE,p)),(0,O.__)(E,z),mt.data.node=Object.assign({id:f,type:C.$.IMAGE,name:"Image"},{size:p,attribute:z,source:P})},ut.onerror=wt=>{console.error(`ImgSrc load failed -> ${st}`,wt),null==E||E.remove()},ut.src=st})(null!==(o=null===(g=P.image)||void 0===g?void 0:g.url)&&void 0!==o?o:"")}createNodeIframe(i,n){var r,a;let{nodeId:g,element:y,size:f,attribute:E,style:p,source:z}=(0,jt.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Gt.I)(i)}});(P=>{let st=(null===(P=mt.data.slide)||void 0===P||null===(P=P.svg)||void 0===P?void 0:P.viewBox)||{x:0,y:0,width:100,height:100},ut=(0,T.q)(st.width/st.height,100);ut>=1?(f.width=Math.min(st.width,512),f.height=(0,T.q)(f.width/ut,100)):(f.height=Math.min(st.height,512),f.width=(0,T.q)(f.height*ut,100)),f.x=(0,T.q)(f.x+50-f.width/2,100),f.y=(0,T.q)(f.y+50-f.height/2,100),Object.assign(E,(0,et.sg)(C.$.IMAGE,f)),(0,O.__)(y,E),mt.data.node=Object.assign({id:g,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:f,attribute:E,style:p,source:z})})()}createNodeEmbed(i,n){var r,a;let{nodeId:g,element:y,size:f,attribute:E,style:p,source:z}=(0,jt.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Gt.I)(i))}});(P=>{let st=(null===(P=mt.data.slide)||void 0===P||null===(P=P.svg)||void 0===P?void 0:P.viewBox)||{x:0,y:0,width:100,height:100},ut=(0,T.q)(st.width/st.height,100);ut>=1?(f.width=Math.min(st.width,512),f.height=(0,T.q)(f.width/ut,100)):(f.height=Math.min(st.height,512),f.width=(0,T.q)(f.height*ut,100)),f.x=(0,T.q)(f.x+50-f.width/2,100),f.y=(0,T.q)(f.y+50-f.height/2,100),Object.assign(E,(0,et.sg)(C.$.IMAGE,f)),(0,O.__)(y,E),mt.data.node=Object.assign({id:g,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:f,attribute:E,style:p,source:z})})()}createNodeMedia(i,n){var r,a,o,g;let{nodeId:f,element:E,size:p,attribute:z,source:P}=(0,j.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Gt.I)(i.cover)}}),st={click:{media:i.media}};(ut=>{if(!ut)return;let wt=new Image;wt.onload=()=>{let It=(0,T.q)(wt.naturalWidth/wt.naturalHeight,100);It>=1?(p.width=Math.min(wt.naturalWidth,512),p.height=(0,T.q)(p.width/It,100)):(p.height=Math.min(wt.naturalHeight,512),p.width=(0,T.q)(p.height*It,100)),p.x=(0,T.q)(p.x+50-p.width/2,100),p.y=(0,T.q)(p.y+50-p.height/2,100),Object.assign(z,(0,et.sg)(C.$.IMAGE,p)),(0,O.__)(E,z),mt.data.node=Object.assign({id:f,type:C.$.IMAGE,name:"Image"},{size:p,attribute:z,source:P,interactive:st})},wt.onerror=It=>{console.error(`ImgSrc load failed -> ${ut}`,It),null==E||E.remove()},wt.src=ut})(null!==(o=null===(g=P.image)||void 0===g?void 0:g.url)&&void 0!==o?o:"")}insert(i){var n;if(mt.data.insertSlide(mt.data.slideId,1),i.title){let{nodeId:r,size:a,attribute:o,style:g,source:y}=(0,jt.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});mt.data.node=Object.assign({id:r,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:g,source:y})}if(i.description){let{nodeId:r,size:a,attribute:o,style:g,source:y}=(0,jt.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});mt.data.node=Object.assign({id:r,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:g,source:y})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:a,attribute:o}=(0,ct.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});mt.data.node=Object.assign({id:r,type:C.$.RECT,name:"Rect"},{size:a,attribute:o})})(),(r=>{let{nodeId:a,size:o,attribute:g,style:y,source:f}=(0,jt.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});mt.data.node=Object.assign({id:a,type:C.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:g,style:y,source:f})})())}}var qt=v(5226);class ce{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:mt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((o,g)=>g==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let g=[];return o.filter(y=>!y.isdeleted).forEach(y=>{y.type==C.$.GROUP?g=g.concat(a(y.nodes||[])):g.push(y.id)}),g};return a((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(g=>g.type==C.$.GROUP).forEach(g=>{var y;g.nodes=n(null===(y=g.nodes)||void 0===y?void 0:y.filter(f=>!f.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(g=>{var y,f;return g.type!=C.$.GROUP||(null!==(y=null===(f=g.nodes)||void 0===f?void 0:f.length)&&void 0!==y?y:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a,o,g,y,f,E,p,z;n.push(null===(a=r.svg)||void 0===a||null===(a=a.background)||void 0===a?void 0:a.path),null===(o=r.svg)||void 0===o||o.nodes.forEach(P=>{var st,ut,wt,It,Zt,fe,ge,we,ye,Se;n.push(null===(st=P.source)||void 0===st||null===(st=st.image)||void 0===st?void 0:st.path),n.push(null===(ut=P.source)||void 0===ut||null===(ut=ut.audio)||void 0===ut?void 0:ut.path),n.push(null===(wt=P.source)||void 0===wt||null===(wt=wt.video)||void 0===wt?void 0:wt.path),n.push(null===(It=P.source)||void 0===It||null===(It=It.file)||void 0===It?void 0:It.path),n.push(null===(Zt=P.source)||void 0===Zt||null===(Zt=Zt.iframe)||void 0===Zt?void 0:Zt.path),n.push(null===(fe=P.source)||void 0===fe||null===(fe=fe.track)||void 0===fe?void 0:fe.path),n.push(null===(ge=P.interactive)||void 0===ge||null===(ge=ge.show)||void 0===ge||null===(ge=ge.audio)||void 0===ge||null===(ge=ge.source)||void 0===ge?void 0:ge.path),n.push(null===(we=P.interactive)||void 0===we||null===(we=we.click)||void 0===we||null===(we=we.audio)||void 0===we||null===(we=we.source)||void 0===we?void 0:we.path),n.push(null===(ye=P.interactive)||void 0===ye||null===(ye=ye.click)||void 0===ye||null===(ye=ye.image)||void 0===ye||null===(ye=ye.source)||void 0===ye?void 0:ye.path),n.push(null===(Se=P.interactive)||void 0===Se||null===(Se=Se.click)||void 0===Se||null===(Se=Se.video)||void 0===Se||null===(Se=Se.source)||void 0===Se?void 0:Se.path)}),n.push(null===(g=r.test)||void 0===g||null===(g=g.audiotrue)||void 0===g?void 0:g.path),n.push(null===(y=r.test)||void 0===y||null===(y=y.audiofalse)||void 0===y?void 0:y.path),n.push(null===(f=r.test)||void 0===f||null===(f=f.effecttrue)||void 0===f?void 0:f.path),n.push(null===(E=r.test)||void 0===E||null===(E=E.effectfalse)||void 0===E?void 0:E.path),n.push(null===(p=r.test)||void 0===p||null===(p=p.icontrue)||void 0===p?void 0:p.path),n.push(null===(z=r.test)||void 0===z||null===(z=z.iconfalse)||void 0===z?void 0:z.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,a,o)=>o.indexOf(r)==a)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,O.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(g=>g.type==C.$.GROUP).forEach(g=>{var y;g.nodes=n(null===(y=g.nodes)||void 0===y?void 0:y.filter(f=>!f.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(g=>{var y,f;return g.type!=C.$.GROUP||(null!==(y=null===(f=g.nodes)||void 0===f?void 0:f.length)&&void 0!==y?y:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,O.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){(0,O.wM)(),(0,qt.E)(this.slide)}openSlide(i,n){var r,a,o,g;if(i)for(let z=0,P=null!==(y=null===(f=this._dataSource.slides)||void 0===f?void 0:f.length)&&void 0!==y?y:0;z<P;z++){var y,f,E;if((null!==(E=this._dataSource.slides)&&void 0!==E?E:[])[z].id==i){this._slideIdx=z;break}}else if(n&&n>=0&&n<(null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var p;this._slideIdx=0,null!==(p=this._dataSource.slides)&&void 0!==p&&p.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,O.wM)(),(0,qt.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==o?o:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}tryReplaceSlide(i,n,r){var a,o,g,y,f;let E=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(z=>z.id==i);if(!r||!E||null!=E&&null!==(o=E.svg)&&void 0!==o&&o.nodes.filter(z=>!z.isdeleted).length)return this.insertSlide(i,n,r);let p=null!==(g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(E))&&void 0!==g?g:0;null===(f=this._dataSource.slides)||void 0===f||f.splice(p,1,r),this._slideIdx=p,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var a,o,g,y,f;let E=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(P=>P.id==i))&&void 0!==a?a:this._defaultSlide,p=(null!==(g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(E))&&void 0!==g?g:0)+n;var z;r?(r.id=this.newSlideId,r.code=void 0,r.name||(r.name="Trang m\u1edbi"),null!==(z=r.svg)&&void 0!==z&&z.viewBox||r.svg&&(r.svg.viewBox=mt.screen.frameSize)):r=this._defaultSlide,null===(f=this._dataSource.slides)||void 0===f||f.splice(p,0,r),this._slideIdx=p,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,a,o,g,y,f;let E=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(P=>P.id==i))&&void 0!==n?n:this._defaultSlide,p=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(E))&&void 0!==a?a:0)+1,z=Object.assign(JSON.parse(JSON.stringify(E)),{id:this.newSlideId,code:void 0,name:`${E.name} + (Copy)`});null===(g=this._dataSource.slides)||void 0===g||g.splice(p,0,z),this.changeSlide(this.slides,this.slideIdx,null!==(y=null===(f=this._dataSource.slides)||void 0===f?void 0:f.length)&&void 0!==y?y:0,this.slide)}moveSlide(i,n){var r,a,o,g,y,f;let E=null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(z=>z.id==i))&&void 0!==r?r:this._defaultSlide,p=null!==(o=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(E))&&void 0!==o?o:0;null===(y=this._dataSource.slides)||void 0===y||y.splice(p+n,0,null===(f=this._dataSource.slides)||void 0===f?void 0:f.splice(p,1)[0])}deleteSlide(i){var n,r,a,o,g,y;let f=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(P=>P.id==i))&&void 0!==n?n:this._defaultSlide,E=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(f))&&void 0!==a?a:0;if(null===(g=this._dataSource.slides)||void 0===g||g.splice(E,1),null!==(y=this._dataSource.slides)&&void 0!==y&&y.length)if(E<this._slideIdx){var p,z;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(p=null===(z=this._dataSource.slides)||void 0===z?void 0:z.length)&&void 0!==p?p:0,this.slide)}else E==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,a,o,g;let y=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(E=>E.id==i))&&void 0!==n?n:this._defaultSlide,f=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(y))&&void 0!==a?a:0;if(y.isdeleted=!0,null!==(g=this._dataSource.slides)&&void 0!==g&&null!==(g=g.filter(E=>!E.isdeleted))&&void 0!==g&&g.length){let E=!0;for(;y.isdeleted;)E?f++:f--,this._dataSource.slides[f]?y=this._dataSource.slides[f]:E=!E;this.openSlide(y.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,a){this._fnChangeSlides.forEach(o=>o(i,n,r,a))}set node(i){var n,r;let a=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((g,y)=>y==this._slideIdx),o=null==a?void 0:a.svg;null!=o&&o.nodes&&(null==o||o.nodes.push(i)),mt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((P,st)=>st==this._slideIdx),a=null==r?void 0:r.svg,o=(P,st)=>{let ut=null==P?void 0:P.find(Zt=>Zt.id==i);if(ut)return ut.pid=st,ut;let wt=0,It=P.length||0;for(;wt<It&&!ut&&(ut=o(P[wt].nodes||[],P[wt].id),!ut);)wt++;return ut},g=o((null==a?void 0:a.nodes)||[]);var y,f,E,p,z;return g?(g.style=null!==(y=g.style)&&void 0!==y?y:{},g.source=null!==(f=g.source)&&void 0!==f?f:{},g.animate=null!==(E=g.animate)&&void 0!==E?E:{},g.interactive=null!==(p=g.interactive)&&void 0!==p?p:{},g.variable=null!==(z=g.variable)&&void 0!==z?z:{},g):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((y,f)=>f==this._slideIdx),a=null==r?void 0:r.svg,g=y=>{let f=(null==y?void 0:y.find(ut=>ut.id==i))||(y=>{let f=null,E=0,p=y.length||0;for(;E<p&&!f;){if(f=g(y[E].nodes),f){f.pid=y[E].id;break}E++}var z,P,st,ut,wt;return f&&(f.style=null!==(z=f.style)&&void 0!==z?z:{},f.source=null!==(P=f.source)&&void 0!==P?P:{},f.animate=null!==(st=f.animate)&&void 0!==st?st:{},f.interactive=null!==(ut=f.interactive)&&void 0!==ut?ut:{},f.variable=null!==(wt=f.variable)&&void 0!==wt?wt:{}),f})((null==y?void 0:y.filter(ut=>ut.type==C.$.GROUP))||[]);var E,p,z,P,st;return f&&(f.style=null!==(E=f.style)&&void 0!==E?E:{},f.source=null!==(p=f.source)&&void 0!==p?p:{},f.animate=null!==(z=f.animate)&&void 0!==z?z:{},f.interactive=null!==(P=f.interactive)&&void 0!==P?P:{},f.variable=null!==(st=f.variable)&&void 0!==st?st:{}),f};return g((null==a?void 0:a.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,a,o){var g;let y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.find((p,z)=>z==this._slideIdx),f=null==y?void 0:y.svg,E=p=>{let z=[];return p.filter(P=>!P.isdeleted).forEach(P=>{P.type==C.$.GROUP?z=z.concat(E(P.nodes||[])):i>P.size.x||n>P.size.y||r<P.size.x+P.size.width||a<P.size.y+P.size.height||(o?P.type==o&&z.push(P.id):z.push(P.id))}),z};return E((null==f?void 0:f.nodes)||[])}getNodeOnArea(i,n,r,a,o){var g;let y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.find((p,z)=>z==this._slideIdx),f=null==y?void 0:y.svg,E=p=>{let z=[];return p.filter(P=>!P.isdeleted).forEach(P=>{P.type==C.$.GROUP?z=z.concat(E(P.nodes||[])):P.size.x+P.size.width<i||P.size.y+P.size.height<n||P.size.x>r||P.size.y>a||(o?P.type==o&&z.push(P.id):z.push(P.id))}),z};return E((null==f?void 0:f.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,qt.E)(this.slide),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let a=this.getNode(i),o=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:o})),Object.assign(a,{isdeleted:!0}),(0,qt.E)(this.slide),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),o}addGroup(i,n){var r;let a=this.getNode(i),o=this.getNode(n);o.nodes=o.nodes||[];let g=Math.ceil(1e9*Math.random());return o.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:g})),Object.assign(a,{isdeleted:!0}),(0,qt.E)(this.slide),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),g}setNodeP(i,n){var r;let a=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(o=>o.id==i);a&&(a.pid=n||null)}bringToFront(i){this.bringToFrontStep(i,0)}sendToBack(i){this.sendToBackStep(i,0)}bringToFrontStep(i,n){var r,a,o,g;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((p,z)=>{p.index=z+1});let y=(null!==(a=null===(o=this.slide)||void 0===o||null===(o=o.svg)||void 0===o?void 0:o.nodes.length)&&void 0!==a?a:0)+1;var f,E;i.map(p=>{var z,P;return{id:p,index:null!==(z=null===(P=this.slide)||void 0===P||null===(P=P.svg)||void 0===P||null===(P=P.nodes.find(st=>st.id==p))||void 0===P?void 0:P.index)&&void 0!==z?z:0}}).sort((p,z)=>p.index-z.index).forEach(p=>{var P,z;n?null===(P=this.slide)||void 0===P||null===(P=P.svg)||void 0===P||P.nodes.filter((st,ut)=>st.id==p.id).forEach(st=>{st.index=n+p.index+p.index/1e3}):null===(z=this.slide)||void 0===z||null===(z=z.svg)||void 0===z||z.nodes.filter(st=>st.id==p.id).forEach(st=>{st.index=y+p.index})}),null===(g=this.slide)||void 0===g||null===(g=g.svg)||void 0===g||g.nodes.sort((p,z)=>{var P,st;return(null!==(P=p.index)&&void 0!==P?P:0)-(null!==(st=z.index)&&void 0!==st?st:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(f=window.document.getElementById(lt.O.RESIZE_GROUP))||void 0===f||f.remove(),(0,_.y)(mt.dataSelect.nodes[0])):(null===(E=window.document.getElementById(lt.O.SELECT_GROUP))||void 0===E||E.remove(),(0,M.Q)(mt.dataSelect.nodes))}sendToBackStep(i,n){var r,a,o,g;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((y,f)=>{y.index=f+1}),i.map(y=>{var f,E;return{id:y,index:null!==(f=null===(E=this.slide)||void 0===E||null===(E=E.svg)||void 0===E||null===(E=E.nodes.find(p=>p.id==y))||void 0===E?void 0:E.index)&&void 0!==f?f:0}}).sort((y,f)=>y.index-f.index).forEach(y=>{var E,f;n?null===(E=this.slide)||void 0===E||null===(E=E.svg)||void 0===E||E.nodes.filter(p=>p.id==y.id).forEach(p=>{p.index=n+y.index+y.index/1e3}):null===(f=this.slide)||void 0===f||null===(f=f.svg)||void 0===f||f.nodes.filter(p=>p.id==y.id).forEach(p=>{p.index=y.index/100-1})}),null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a||a.nodes.sort((y,f)=>{var E,p;return(null!==(E=y.index)&&void 0!==E?E:0)-(null!==(p=f.index)&&void 0!==p?p:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(o=window.document.getElementById(lt.O.RESIZE_GROUP))||void 0===o||o.remove(),(0,_.y)(mt.dataSelect.nodes[0])):(null===(g=window.document.getElementById(lt.O.SELECT_GROUP))||void 0===g||g.remove(),(0,M.Q)(mt.dataSelect.nodes))}bringToFrontArea(i){var n,r;let a=i.map(ut=>mt.data.getNode(ut)).filter(ut=>!ut.isfake),{x1:o,y1:g,x2:y,y2:f}=pe(a),E=this.getNodeOnArea(o,g,y,f);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ut,wt)=>{ut.index=wt+1});let p=E.map(ut=>{var wt,It;return null!==(wt=null===(It=this.slide)||void 0===It||null===(It=It.svg)||void 0===It||null===(It=It.nodes.find(Zt=>Zt.id==ut))||void 0===It?void 0:It.index)&&void 0!==wt?wt:0}),z=Math.max.apply(null,p);var P,st;i.forEach((ut,wt)=>{var It;null===(It=this.slide)||void 0===It||null===(It=It.svg)||void 0===It||It.nodes.filter(Zt=>Zt.id==ut).forEach(Zt=>{Zt.index=z+(wt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ut,wt)=>{var It,Zt;return(null!==(It=ut.index)&&void 0!==It?It:0)-(null!==(Zt=wt.index)&&void 0!==Zt?Zt:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(P=window.document.getElementById(lt.O.RESIZE_GROUP))||void 0===P||P.remove(),(0,_.y)(mt.dataSelect.nodes[0])):(null===(st=window.document.getElementById(lt.O.SELECT_GROUP))||void 0===st||st.remove(),(0,M.Q)(mt.dataSelect.nodes))}sendToBackArea(i){var n,r;let a=i.map(ut=>mt.data.getNode(ut)).filter(ut=>!ut.isfake),{x1:o,y1:g,x2:y,y2:f}=pe(a),E=this.getNodeOnArea(o,g,y,f);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ut,wt)=>{ut.index=wt+1});let p=E.map(ut=>{var wt,It;return null!==(wt=null===(It=this.slide)||void 0===It||null===(It=It.svg)||void 0===It||null===(It=It.nodes.find(Zt=>Zt.id==ut))||void 0===It?void 0:It.index)&&void 0!==wt?wt:0}),z=Math.min.apply(null,p)-1;var P,st;i.forEach((ut,wt)=>{var It;null===(It=this.slide)||void 0===It||null===(It=It.svg)||void 0===It||It.nodes.filter(Zt=>Zt.id==ut).forEach(Zt=>{Zt.index=z+(wt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ut,wt)=>{var It,Zt;return(null!==(It=ut.index)&&void 0!==It?It:0)-(null!==(Zt=wt.index)&&void 0!==Zt?Zt:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(P=window.document.getElementById(lt.O.RESIZE_GROUP))||void 0===P||P.remove(),(0,_.y)(mt.dataSelect.nodes[0])):(null===(st=window.document.getElementById(lt.O.SELECT_GROUP))||void 0===st||st.remove(),(0,M.Q)(mt.dataSelect.nodes))}}const pe=I=>{let i=999999,n=999999,r=-999999,a=-999999;return I.forEach(o=>{i=Math.min(i,o.size.x),n=Math.min(n,o.size.y),r=Math.max(r,o.size.x+o.size.width),a=Math.max(a,o.size.y+o.size.height)}),{x1:i,y1:n,x2:r,y2:a}};class oe{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":mt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":mt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:a,size:o,attribute:g}=mt.data.getNode(n.from.id);Object.assign(o,n.from.size),Object.assign(g,(0,et.sg)(a,o)),(0,O.__)(window.document.getElementById(r),g);break}case"attribute":{let{id:r,attribute:a}=mt.data.getNode(n.from.id);Object.assign(a,n.from.attribute),(0,O.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=mt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.style),(0,O.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=mt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.source),(0,O.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=mt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=mt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=mt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),mt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":mt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":mt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:a,size:o,attribute:g}=mt.data.getNode(n.to.id);Object.assign(o,n.to.size),Object.assign(g,(0,et.sg)(a,o)),(0,O.__)(window.document.getElementById(r),g);break}case"attribute":{let{id:r,attribute:a}=mt.data.getNode(n.to.id);Object.assign(a,n.to.attribute),(0,O.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=mt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.style),(0,O.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=mt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.source),(0,O.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=mt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=mt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=mt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),mt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class se{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var a;if(!(i<.1||i>10)){if(n=null!==(a=n)&&void 0!==a?a:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var o={x:Math.max(0,Math.min((0,T.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,T.q)(n.y/this._height,1e3),1))},g={x:(this._width/i-this._width/this._scale)*o.x,y:(this._height/i-this._height/this._scale)*o.y};this._dislocation.x+=g.x,this._dislocation.y+=g.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,O.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var xe=v(644);class Qe{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,xe.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,xe.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Pe=v(70),Ve=v(5973),Je=v(4787),Ee=function(I){return I&&JSON.parse(JSON.stringify(I))},De=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Ue=[],Xe={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},Ye={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class He{constructor(){this._data_variables=Ee(De).concat(Ee(Ue)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Ee(De).concat(Ee(Ue)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(a=>a.change||[]).forEach(a=>{r=r.concat(a)}),r))([]),De.forEach(r=>{var a=this._data_variables.filter(o=>o.key==r.key);a.length?a.forEach(function(o,g,y){o.type=r.type,o.readonly=r.readonly,o.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Ee(Xe)}getConditionTemp(){return Ee(Ye)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Ee((I=this._data_variables,i="key",function(n){for(var r of I.map(function(a){return a[i]}).sort())I.filter(function(a){return a[i]==r}).forEach(function(a){n.push(a)}),I=I.filter(function(a){return a[i]!=r});return n}([]))):Ee(De).concat(Ee(Ue));var I,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),De.forEach(n=>{var r=this._data_variables.filter(a=>a.key==n.key);r.length?r.forEach((a,o,g)=>{a.type=n.type,a.readonly=n.readonly,a.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Ee(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(o=>o.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(o=>o.key==i);a.length?a.forEach(function(o,g,y){o.value=n,o.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(g){return g.key==i});if(r.length){var o,a=r[0]||{};switch(this.OnGetActionExecuting(a),n||(n=a.type||null),n){case"string":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":"string"==typeof a.value?a.value||"":a.value.toString().trim();break;case"number":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?0:"number"==typeof a.value?a.value||0:parseFloat(a.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(a.value)>=0?o=!1:"boolean"==typeof a.value?o=a.value:(o=(a.value+"").toLowerCase(),o="1"==a.value||"true"==a.value||"yes"==a.value||"dung"==a.value);break;case"audio-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></audio>`:"";break;case"video-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></video>`:"";break;case"img-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<img style="width:100%;vertical-align:middle;" src="${a.value}"/>`:"";break;default:o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value}return this.OnGetActionExecuted(a),o}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(g){return g.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(function(g){return g.key==i});if(a.length){var o=a[0];this.OnSetActionExecuting(o),o&&(o.value=n),this.OnSetActionExecuted(o)}}}getConditionAll(){return Ee(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Ee(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(a,o){return a+o});case"sub":return n.reduce(function(a,o){return a-o});case"pro":return n.reduce(function(a,o){return a*o});case"div":return n.reduce(function(a,o){return a/o});case"avg":var r=n.reduce(function(a,o){return a+o})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(a,o){return a&&o});case"or":return n.reduce(function(a,o){return a||o});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Ee(n),{variable:r}))?0:1).reduce(function(r,a){return r+a})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Ee(n),{variable:r})));break;case"slide":Pe.$.runSlide(void 0,void 0,n.slide);break;case"node":{var a;(0,Je.L5)({id:n.node,nodeStatus:Pe.$.nodeStatus,slideStatus:Pe.$.slideStatus});let o=Pe.$.findNode(n.node);null!=o&&null!==(a=o.interactive)&&void 0!==a&&a.click&&(0,Ve.F)(o,Pe.$.nodeStatus,Pe.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Ge{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case N._.PEN:this._pen_type=n;break;case N._.SHAPE:this._shape_type=n,r&&n===C.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){this._pointer_type=i,this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(a=>a(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(a=>a(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(a=>a(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(a=>a(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(a=>a(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(a=>a(i,n,r))}}const mt=new class qe{constructor(){this._container="",this._svg="",this._screen=se.prototype,this._data=ce.prototype,this._dataSelect=zt.prototype,this._slide=Vt.prototype,this._history=oe.prototype,this._attribute=Qe.prototype,this._pointer=Ge.prototype,this._variable=He.prototype,this._data=new ce,this._dataSelect=new zt,this._slide=new Vt,this._history=new oe,this._attribute=new Qe,this._pointer=new Ge,this._variable=new He,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,a,o;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(a=null==i?void 0:i.left)&&void 0!==a?a:0,y:null!==(o=null==i?void 0:i.top)&&void 0!==o?o:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new se,(I=>{new O.Mh(I.container,I.target),mt.pointer.onchange=(r,a,o)=>{switch(r){case N._.POINTER:jQuery(I.target).css({cursor:"auto"});break;case N._.HAND:jQuery(I.target).css({cursor:"grab"});break;case N._.PEN:switch(a){case gt.D.DRAW:jQuery(I.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case gt.D.HIGHTLIGH:jQuery(I.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case N._.ERASER:jQuery(I.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case N._.SHAPE:jQuery(I.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case N._.TEXT:case N._.FOREIGNOBJECT:jQuery(I.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(I.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{mt.pointer.pointer_type==N._.HAND&&jQuery(I.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{mt.pointer.pointer_type==N._.HAND&&jQuery(I.target).css({cursor:"grab"})}),jQuery(I.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var a;r.preventDefault();var o=mt.screen.scale,g=(null!==(a=r.originalEvent)&&void 0!==a?a:r).deltaY>0?1:-1;mt.screen.scaleTo(o-.04*o*g,(0,kt.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},mt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{mt.screen.actived=!!jQuery(r.target).parents("app-main").length}),jQuery(I.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{mt.screen.actived=!0}),jQuery(I.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{mt.screen.actived=!1,mt.pointer.pointer_type_temp==N._.HAND&&(mt.pointer.pointer_type_temp=N._.POINTER)}),jQuery(I.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(I.container.includes("#")&&I.container.includes(r.target.getAttribute("id"))||I.container.includes(".")&&I.container.includes(r.target.getAttribute("class"))||I.container.includes(r.target.nodeName))&&(mt.pointer.pointer_type_temp||mt.pointer.pointer_type)===N._.POINTER&&(mt.dataSelect.ids=[])}),jQuery(I.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(mt.pointer.pointer_type_temp||mt.pointer.pointer_type){case N._.POINTER:A(r);break;case N._.HAND:(I=>{(0,u.A)(I,new Q,1,{x:0,y:0})})(r);break;case N._.PEN:(0,_t.i)(r);break;case N._.SHAPE:(I=>{var i=null;switch(mt.pointer.shape_type){case C.$.CIRCLE:i=new Y;break;case C.$.ELLIPSE:i=new ft;break;case C.$.LINE:i=new Ut;break;case C.$.RECT:i=new dt;break;case C.$.POLYGON:var n;i=new Ot(null===(n=K.find(r=>r.type==mt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case C.$.FOREIGNOBJECT:i=new rt;break;case C.$.IMAGE:i=new yt;break;case C.$.TEXT:case C.$.PATH:i=new Pt}i&&(0,u.A)(I,i)})(r);break;case N._.FOREIGNOBJECT:(I=>{(0,u.A)(I,new rt)})(r);break;case N._.IMAGE:(I=>{(0,u.A)(I,new yt)})(r);break;case N._.TEXT:(I=>{(0,u.A)(I,new Z)})(r);break;case N._.ERASER:(I=>{(0,u.A)(I,new V)})(r);break;case N._.INDEX:(0,R.s)(r)}};let n=!1;jQuery(I.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(I.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),I.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{mt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Kt.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{mt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Kt.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4113:(ae,Rt,v)=>{v.d(Rt,{s:()=>M,Q:()=>m});var N=v(1687),O=v(4981),lt=v(4318),C=v(6816),et=v(7492);const M=A=>{var S,Q,G,K;let q=(null===(S=A.mouseEvent)||void 0===S?void 0:S.target)||(null===(Q=A.touchEvent)||void 0===Q?void 0:Q.target),T=(null==q?void 0:q.getAttribute("id"))||"",Y=null==q?void 0:q.nodeName,F=jQuery(q).parents("g[id]").attr("id")||"";if(![N.O.INDEX_GROUP].includes(F))if(null!==(G=A.mouseEvent)&&void 0!==G&&G.altKey||null!==(K=A.touchEvent)&&void 0!==K&&K.altKey||!T||T.match(/[^0-9]/)||!O.icdt.dataSelect.nodeName.includes(Y)){var ft;O.icdt.dataSelect.ids.length&&(O.icdt.dataSelect.ids=[]),(0==(null===(ft=A.mouseEvent)||void 0===ft?void 0:ft.button)||A.touchEvent)&&((A,S)=>{let T=(0,et.g1)(N.O.SCAN_GROUP,"g"),Y=(0,lt.bH)(0,0,1,1);(0,et.vl)(T,Y),((A,S,Q,G)=>{(0,C.A)(A,{start:T=>{},move:(T,Y)=>{((T,Y,F,ft)=>{S=(0,lt.bH)(T,Y,F,ft),(0,et.vl)(Q,S)})(Y[0][0],Y[0][1],T.x,T.y)},end:(T,Y)=>{null==Q||Q.remove(),O.icdt.dataSelect.ids=O.icdt.data.getNodeInArea(Math.min(Y[0][0],T.x),Math.min(Y[0][1],T.y),Math.max(Y[0][0],T.x),Math.max(Y[0][1],T.y)),G(O.icdt.dataSelect.nodes)}})})(A,Y,T,S)})(A,k)}else{var ct,dt;let D=parseFloat(T||"0");O.icdt.dataSelect.ids=null!==(ct=A.mouseEvent)&&void 0!==ct&&ct.shiftKey||null!==(dt=A.touchEvent)&&void 0!==dt&&dt.shiftKey?[D].concat(O.icdt.dataSelect.ids).filter((Wt,Ut,Lt)=>Lt.indexOf(Wt)==Ut):[D],k(O.icdt.dataSelect.nodes)}},k=A=>{var S,Q;let G=1;var K,q;if(A.length&&(G=Math.max.apply(null,null!==(K=null===(q=O.icdt.data.slide)||void 0===q||null===(q=q.svg)||void 0===q?void 0:q.nodes.map(Y=>{var F;return null!==(F=Y.idx)&&void 0!==F?F:0}))&&void 0!==K?K:[0])+1),1==A.length)A[0].idx||(A[0].idx=G,A[0].time=0);else if(A.length>=0){let Y=A.map(ft=>{var ct;return null!==(ct=ft.idx)&&void 0!==ct?ct:0}).filter(ft=>ft>0),F=Y.length?Math.min.apply(null,Y):G;A.forEach(ft=>{var ct;ft.idx=F,ft.time=null!==(ct=ft.time)&&void 0!==ct?ct:0})}let T=(0,et.g1)(N.O.INDEX_GROUP,"g");(0,et.mo)(T,null!==(S=null===(Q=O.icdt.data.slide)||void 0===Q||null===(Q=Q.svg)||void 0===Q?void 0:Q.nodes)&&void 0!==S?S:[])},m=A=>{var S,Q,G;null!=A&&null!==(S=A.svg)&&void 0!==S&&S.nodes&&A.svg.nodes.forEach(q=>{q.idx=0,q.time=null});let K=(0,et.g1)(N.O.INDEX_GROUP,"g");(0,et.mo)(K,null!==(Q=null===(G=O.icdt.data.slide)||void 0===G||null===(G=G.svg)||void 0===G?void 0:G.nodes)&&void 0!==Q?Q:[])}},4578:(ae,Rt,v)=>{v.d(Rt,{h:()=>S,t:()=>Q});var N=v(644),O=v(7308),lt=v(968),C=v(4981),et=v(666),u=v(3171),_=v(5226),M=v(3423),k=v(5811),m=v(3385);const S=new class A{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:O.s.Escape,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:O.s.Delete,fn:()=>{C.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:O.s.Space,fn:()=>{C.icdt.pointer.pointer_type_temp=lt._.HAND}},this.onchange={type:"keyup",key:O.s.Space,fn:()=>{C.icdt.pointer.pointer_type_temp=lt._.POINTER}},this.onchange={type:"keydown",key:O.s.ArrowLeft,fn:()=>{C.icdt.dataSelect.ids.length||C.icdt.data.backSlide()}},this.onchange={type:"keydown",key:O.s.ArrowRight,fn:()=>{C.icdt.dataSelect.ids.length||C.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:O.s.ArrowLeft,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(K=>{(0,m.k6)(K,(0,k.q)(K.size.x-(0,M.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,et.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowRight,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(K=>{(0,m.k6)(K,(0,k.q)(K.size.x+(0,M.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,et.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowUp,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(K=>{(0,m.co)(K,(0,k.q)(K.size.y-(0,M.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,et.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowDown,fn:()=>{C.icdt.dataSelect.ids.length&&(C.icdt.dataSelect.nodes.forEach(K=>{(0,m.co)(K,(0,k.q)(K.size.y+(0,M.v)(1)))}),1==C.icdt.dataSelect.ids.length?(0,et.y)(C.icdt.dataSelect.nodes[0]):(0,u.Q)(C.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.Digit1,fn:K=>{K.shiftKey&&(C.icdt.reloadView(),C.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:O.s.KeyA,fn:K=>{if(K.ctrlKey){C.icdt.dataSelect.ids=C.icdt.data.getNodeAll();let q=C.icdt.dataSelect.nodes;1==q.length?(0,et.y)(q[0]):q.length>1&&(0,u.Q)(q)}}},this.onchange={type:"keydown",key:O.s.KeyC,fn:K=>{if(K.ctrlKey){let q=C.icdt.dataSelect.nodes;q&&(0,N.yR)({params:{type:"nodes",nodes:q}})}}},this.onchange={type:"keydown",key:O.s.KeyV,fn:K=>{K.ctrlKey&&(0,N.aY)({callback:q=>{var T,Y;"nodes"==(null==q?void 0:q.type)&&null!=q&&null!==(T=q.nodes)&&void 0!==T&&T.length&&(null==q||null===(Y=q.nodes)||void 0===Y||Y.forEach(F=>{F.id=Math.ceil(1e9*Math.random()),C.icdt.data.node=F}),(0,_.E)(C.icdt.data.slide))}})}},this.onchange={type:"keydown",key:O.s.KeyZ,fn:K=>{K.ctrlKey&&K.shiftKey?C.icdt.history.redo():K.ctrlKey&&C.icdt.history.undo()}},this.onchange={type:"keydown",key:O.s.BracketLeft,fn:K=>{K.ctrlKey&&K.shiftKey?C.icdt.data.sendToBack(C.icdt.dataSelect.ids):K.ctrlKey?C.icdt.data.sendToBackStep(C.icdt.dataSelect.ids,-2):C.icdt.data.sendToBackArea(C.icdt.dataSelect.ids)}},this.onchange={type:"keydown",key:O.s.BracketRight,fn:K=>{K.ctrlKey&&K.shiftKey?C.icdt.data.bringToFront(C.icdt.dataSelect.ids):K.ctrlKey?C.icdt.data.bringToFrontStep(C.icdt.dataSelect.ids,1):C.icdt.data.bringToFrontArea(C.icdt.dataSelect.ids)}}}set onchange(K){let q=this._fnChanges.find(T=>T.eventType==K.type&&T.eventKey==K.key);q?q.fns.push(K.fn):this._fnChanges.push({eventType:K.type,eventKey:K.key,fns:[K.fn]})}change(K,q,T){var Y;null===(Y=this._fnChanges.find(F=>F.eventType==K&&F.eventKey==q))||void 0===Y||Y.fns.forEach(F=>F(T))}},Q=G=>{S.change(G.type,G.keyCode||G.which||G.charCode||0,G)}},410:(ae,Rt,v)=>{v.d(Rt,{a:()=>m});var N=v(4318),O=v(8419),lt=v(9054),C=v(7492),et=v(511),u=v(3423),_=v(1687),M=v(4981),k=v(8619);class m{constructor(S,Q){var G,K,q,T;let Y={stroke:"#FF0000",strokeWidth:(0,u.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,u.v)(8)},{element:F,attribute:ft,size:ct}=(0,O.G)(Math.ceil(1e9*Math.random()),{size:Q});window.document.getElementById(_.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(Lt=>null==Lt?void 0:Lt.remove()),window.document.getElementById(_.O.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(Lt=>null==Lt?void 0:Lt.remove()),null===(G=window.document.getElementById(_.O.INTERACTIVE_GROUP))||void 0===G||G.appendChild(F);var dt=(Lt,Pt)=>{Lt&&((jt=>{let{element:rt}=(0,k._)(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==Pt?"#FF0000":"#00BA00",strokeWidth:(0,u.v)(1)},size:{x:Lt[0]-5,y:Lt[1]-5,width:10,height:10}});null===(jt=window.document.getElementById(_.O.INTERACTIVE_GROUP))||void 0===jt||jt.prepend(rt)})(),((jt,rt)=>{let{size:j}=null!==(jt=null!=S?S:M.icdt.dataSelect.nodes[0])&&void 0!==jt?jt:{};if(!j)return;let yt=[[Lt[0]-j.width/2,Lt[1]-j.height/2],[Lt[0]+j.width/2,Lt[1]-j.height/2],[Lt[0]+j.width/2,Lt[1]+j.height/2],[Lt[0]-j.width/2,Lt[1]+j.height/2],[Lt[0]-j.width/2,Lt[1]-j.height/2]],{element:St}=(0,O.G)(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:(0,u.v)(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,u.v)(8)},size:{x:0,y:0,width:10,height:10,points:yt}});null===(rt=window.document.getElementById(_.O.INTERACTIVE_GROUP))||void 0===rt||rt.prepend(St)})())};(0,C.__)(F,Y),dt(null!=Q&&null!==(K=Q.points)&&void 0!==K&&K.length?Q.points[0]:void 0),dt(null!=Q&&null!==(q=Q.points)&&void 0!==q&&q.length&&(null==Q||null===(T=Q.points)||void 0===T?void 0:T.length)>=2?Q.points[Q.points.length-1]:void 0);let Ot="";return{start:Lt=>{Ot=`M ${Lt.x} ${Lt.y} L ${Lt.x} ${Lt.y}`},move:(Lt,Pt)=>{((Lt,Pt)=>{Ot+=` ${Lt} ${Pt}`,F.setAttribute("d",Ot)})(Lt.x,Lt.y)},end:(Lt,Pt)=>{(Lt=>{let jt=et.jvg().x(rt=>rt[0]).y(rt=>rt[1]).curve(et.$0Z)(Lt);F.setAttribute("d",jt),Lt.length>=2&&(window.interactivePoints=Lt)})(Pt),(Lt=>{let Pt=9999,jt=9999,rt=-9999,j=-9999;Lt.forEach(yt=>{Pt=Math.min(Pt,yt[0]),jt=Math.min(jt,yt[1]),rt=Math.max(rt,yt[0]),j=Math.max(j,yt[1])}),ct=(0,N.bH)(Pt,jt,rt,j,{points:Lt}),Object.assign(ft,(0,N.sg)(lt.$.PATH,ct),Y)})(Pt),dt(Pt.length?Pt[0]:void 0,"start"),dt(Pt.length>=2?Pt[Pt.length-1]:void 0,"end")}}}}},9623:(ae,Rt,v)=>{v.d(Rt,{U:()=>G,i:()=>Q});var N=v(1687),O=v(9125),lt=v(4981),C=v(6816),et=v(7492),u=v(4318),_=v(8419),M=v(9054),k=v(511);class m{constructor(){let q={strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:T,element:Y,attribute:F,size:ft}=(0,_.G)(Math.ceil(1e9*Math.random()));(0,et.__)(Y,F);let dt="";return{start:Wt=>{dt=`M ${Wt.x} ${Wt.y} L ${Wt.x} ${Wt.y}`},move:(Wt,Ut)=>{((Wt,Ut)=>{dt+=` ${Wt} ${Ut}`,Y.setAttribute("d",dt)})(Wt.x,Wt.y)},end:(Wt,Ut)=>{(Wt=>{let Lt=k.jvg().x(Pt=>Pt[0]).y(Pt=>Pt[1]).curve(k.$0Z)(Wt);Y.setAttribute("d",Lt)})(Ut),(Wt=>{let Ut=9999,Lt=9999,Pt=-9999,jt=-9999;Wt.forEach(rt=>{Ut=Math.min(Ut,rt[0]),Lt=Math.min(Lt,rt[1]),Pt=Math.max(Pt,rt[0]),jt=Math.max(jt,rt[1])}),ft=(0,u.bH)(Ut,Lt,Pt,jt,{points:Wt}),Object.assign(F,(0,u.sg)(M.$.PATH,ft),q)})(Ut),lt.icdt.data.node=Object.assign({id:T,type:M.$.PATH,name:"Path"},{size:ft,attribute:F})}}}}class A{constructor(){let q={strokeOpacity:.4,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:T,element:Y,attribute:F,size:ft}=(0,_.G)(Math.ceil(1e9*Math.random()));(0,et.__)(Y,F);let dt="";var D=(Ot,Wt)=>{dt+=` ${Ot} ${Wt}`,Y.setAttribute("d",dt)};return{start:Ot=>{dt=`M ${Ot.x} ${Ot.y} L ${Ot.x} ${Ot.y}`},move:(Ot,Wt)=>{D(Ot.x,Ot.y)},end:(Ot,Wt)=>{D(Ot.x,Ot.y),(Ot=>{let Wt=9999,Ut=9999,Lt=-9999,Pt=-9999;Ot.forEach(jt=>{Wt=Math.min(Wt,jt[0]),Ut=Math.min(Ut,jt[1]),Lt=Math.max(Lt,jt[0]),Pt=Math.max(Pt,jt[1])}),ft=(0,u.bH)(Wt,Ut,Lt,Pt,{points:Ot}),Object.assign(F,(0,u.sg)(M.$.PATH,ft),q)})(Wt),lt.icdt.data.node=Object.assign({id:T,type:M.$.PATH,name:"Path"},{size:ft,attribute:F})}}}}var S=v(410);const Q=K=>{switch(lt.icdt.pointer.pen_type){case O.D.DRAW:(0,C.A)(K,new m);break;case O.D.HIGHTLIGH:(0,C.A)(K,new A);break;case O.D.INTERACTIVE:G(K)}},G=K=>{var q,T;let Y=(0,et.g1)(N.O.INTERACTIVE_GROUP,"g"),F=null!==(q=null===(T=lt.icdt.data.slide)||void 0===T||null===(T=T.svg)||void 0===T?void 0:T.viewBox)&&void 0!==q?q:(()=>{let{width:ft,height:ct}=lt.icdt.screen.get;return{x:0,y:0,width:ft,height:ct}})();(0,et.XH)(Y,F),K&&(0,C.A)(K,new S.a)}},666:(ae,Rt,v)=>{v.d(Rt,{y:()=>_});var N=v(1687),O=v(4981),lt=v(4318),C=v(6816),et=v(7492),u=v(5811);const _=m=>{let A=(0,et.g1)(N.O.RESIZE_GROUP,"g");(0,et.hJ)(A,m).forEach(S=>{M(S.element,S.posType,m,A)})},M=(m,A,S,Q)=>{let G=!1;null==m||m.addEventListener("touchstart",K=>{G=!0,k({touchEvent:K},A,S,Q)}),null==m||m.addEventListener("mousedown",K=>{if(0==K.button){if(G)return void(G=!1);k({mouseEvent:K},A,S,Q)}})},k=(m,A,S,Q)=>{let D,{id:G,type:K,size:q,attribute:T}=S,{x:Y,y:F,width:ft,height:ct}=q,dt=(ft||1)/(ct||1),Wt=null,Pt=!1;(0,C.A)(m,{start:rt=>{Wt=JSON.parse(JSON.stringify({id:G,size:q,attribute:T}))},move:(rt,j)=>{((rt,j,yt,St)=>{let Kt=yt-rt,_t=St-j;switch(A){case"rect-center":var le,J;D=null!==(le=m.mouseEvent)&&void 0!==le&&le.shiftKey||null!==(J=m.touchEvent)&&void 0!==J&&J.shiftKey?Math.abs(yt-rt)>=Math.abs(St-j)?{x:Y+yt-rt,y:F,width:ft,height:ct}:{x:Y,y:F+St-j,width:ft,height:ct}:{x:Y+yt-rt,y:F+St-j,width:ft,height:ct};break;case"rect-top-left":var X,d,tt,bt,Et,At,Qt,Ht;D=(null!==(X=m.mouseEvent)&&void 0!==X&&X.shiftKey||null!==(d=m.touchEvent)&&void 0!==d&&d.shiftKey)&&(null!==(tt=m.mouseEvent)&&void 0!==tt&&tt.altKey||null!==(bt=m.touchEvent)&&void 0!==bt&&bt.altKey)?dt>=1?{x:Y+(yt-rt),y:F+(yt-rt)/dt,width:ft-2*(yt-rt),height:ct-2*(yt-rt)/dt}:{x:Y+(St-j)*dt,y:F+(St-j),width:ft-2*(St-j)*dt,height:ct-2*(St-j)}:null!==(Et=m.mouseEvent)&&void 0!==Et&&Et.shiftKey||null!==(At=m.touchEvent)&&void 0!==At&&At.shiftKey?dt>=1?{x:Y+(yt-rt),y:F+(yt-rt)/dt,width:ft-(yt-rt),height:ct-(yt-rt)/dt}:{x:Y+(St-j)*dt,y:F+(St-j),width:ft-(St-j)*dt,height:ct-(St-j)}:null!==(Qt=m.mouseEvent)&&void 0!==Qt&&Qt.altKey||null!==(Ht=m.touchEvent)&&void 0!==Ht&&Ht.altKey?{x:Y+(yt-rt),y:F+(St-j),width:ft-2*(yt-rt),height:ct-2*(St-j)}:{x:Y+(yt-rt),y:F+(St-j),width:ft-(yt-rt),height:ct-(St-j)};break;case"rect-top-right":var Tt,vt,$t,H,c,V,at,ot;D=(null!==(Tt=m.mouseEvent)&&void 0!==Tt&&Tt.shiftKey||null!==(vt=m.touchEvent)&&void 0!==vt&&vt.shiftKey)&&(null!==($t=m.mouseEvent)&&void 0!==$t&&$t.altKey||null!==(H=m.touchEvent)&&void 0!==H&&H.altKey)?dt>=1?{x:Y-(yt-rt),y:F-(yt-rt)/dt,width:ft+2*(yt-rt),height:ct+2*(yt-rt)/dt}:{x:Y+(St-j)*dt,y:F+(St-j),width:ft-2*(St-j)*dt,height:ct-2*(St-j)}:null!==(c=m.mouseEvent)&&void 0!==c&&c.shiftKey||null!==(V=m.touchEvent)&&void 0!==V&&V.shiftKey?dt>=1?{x:Y,y:F-(yt-rt)/dt,width:ft+(yt-rt),height:ct+(yt-rt)/dt}:{x:Y,y:F+(St-j),width:ft-(St-j)*dt,height:ct-(St-j)}:null!==(at=m.mouseEvent)&&void 0!==at&&at.altKey||null!==(ot=m.touchEvent)&&void 0!==ot&&ot.altKey?{x:Y-(yt-rt),y:F+(St-j),width:ft+2*(yt-rt),height:ct-2*(St-j)}:{x:Y,y:F+(St-j),width:ft+(yt-rt),height:ct-(St-j)};break;case"rect-bottom-left":var Z,U,W,w,R,gt,kt,pt;D=(null!==(Z=m.mouseEvent)&&void 0!==Z&&Z.shiftKey||null!==(U=m.touchEvent)&&void 0!==U&&U.shiftKey)&&(null!==(W=m.mouseEvent)&&void 0!==W&&W.altKey||null!==(w=m.touchEvent)&&void 0!==w&&w.altKey)?dt>=1?{x:Y+(yt-rt),y:F+(yt-rt)/dt,width:ft-2*(yt-rt),height:ct-2*(yt-rt)/dt}:{x:Y-(St-j)*dt,y:F-(St-j),width:ft+2*(St-j)*dt,height:ct+2*(St-j)}:null!==(R=m.mouseEvent)&&void 0!==R&&R.shiftKey||null!==(gt=m.touchEvent)&&void 0!==gt&&gt.shiftKey?dt>=1?{x:Y+(yt-rt),y:F,width:ft-(yt-rt),height:ct-(yt-rt)/dt}:{x:Y-(St-j)*dt,y:F,width:ft+(St-j)*dt,height:ct+(St-j)}:null!==(kt=m.mouseEvent)&&void 0!==kt&&kt.altKey||null!==(pt=m.touchEvent)&&void 0!==pt&&pt.altKey?{x:Y+(yt-rt),y:F-(St-j),width:ft-2*(yt-rt),height:ct+2*(St-j)}:{x:Y+(yt-rt),y:F,width:ft-(yt-rt),height:ct+(St-j)};break;case"rect-bottom-right":var Mt,zt,Gt,Vt,qt,ce,pe,oe;D=(null!==(Mt=m.mouseEvent)&&void 0!==Mt&&Mt.shiftKey||null!==(zt=m.touchEvent)&&void 0!==zt&&zt.shiftKey)&&(null!==(Gt=m.mouseEvent)&&void 0!==Gt&&Gt.altKey||null!==(Vt=m.touchEvent)&&void 0!==Vt&&Vt.altKey)?dt>=1?{x:Y-(yt-rt),y:F-(yt-rt)/dt,width:ft+2*(yt-rt),height:ct+2*(yt-rt)/dt}:{x:Y-(St-j)*dt,y:F-(St-j),width:ft+2*(St-j)*dt,height:ct+2*(St-j)}:null!==(qt=m.mouseEvent)&&void 0!==qt&&qt.shiftKey||null!==(ce=m.touchEvent)&&void 0!==ce&&ce.shiftKey?dt>=1?{x:Y,y:F,width:ft+(yt-rt),height:ct+(yt-rt)/dt}:{x:Y,y:F,width:ft+(St-j)*dt,height:ct+(St-j)}:null!==(pe=m.mouseEvent)&&void 0!==pe&&pe.altKey||null!==(oe=m.touchEvent)&&void 0!==oe&&oe.altKey?{x:Y-(yt-rt),y:F-(St-j),width:ft+2*(yt-rt),height:ct+2*(St-j)}:{x:Y,y:F,width:ft+(yt-rt),height:ct+(St-j)};break;case"rect-top":var se,xe,Qe,Pe;D=null!==(se=m.mouseEvent)&&void 0!==se&&se.shiftKey||null!==(xe=m.touchEvent)&&void 0!==xe&&xe.shiftKey?{x:Y+_t/2*dt,y:F+_t,width:ft-_t*dt,height:ct-_t}:null!==(Qe=m.mouseEvent)&&void 0!==Qe&&Qe.altKey||null!==(Pe=m.touchEvent)&&void 0!==Pe&&Pe.altKey?{x:Y,y:F+_t,width:ft,height:ct-2*_t}:{x:Y,y:F+_t,width:ft,height:ct-_t};break;case"rect-bottom":var Ve,Je,ei,Ee;D=null!==(Ve=m.mouseEvent)&&void 0!==Ve&&Ve.shiftKey||null!==(Je=m.touchEvent)&&void 0!==Je&&Je.shiftKey?{x:Y-_t/2*dt,y:F,width:ft+_t*dt,height:ct+_t}:null!==(ei=m.mouseEvent)&&void 0!==ei&&ei.altKey||null!==(Ee=m.touchEvent)&&void 0!==Ee&&Ee.altKey?{x:Y,y:F-_t,width:ft,height:ct+2*_t}:{x:Y,y:F,width:ft,height:ct+_t};break;case"rect-left":var Ze,De,Ue,Xe;D=null!==(Ze=m.mouseEvent)&&void 0!==Ze&&Ze.shiftKey||null!==(De=m.touchEvent)&&void 0!==De&&De.shiftKey?{x:Y+Kt,y:F+Kt/2/dt,width:ft-Kt,height:ct-Kt/dt}:null!==(Ue=m.mouseEvent)&&void 0!==Ue&&Ue.altKey||null!==(Xe=m.touchEvent)&&void 0!==Xe&&Xe.altKey?{x:Y+Kt,y:F,width:ft-2*Kt,height:ct}:{x:Y+Kt,y:F,width:ft-Kt,height:ct};break;case"rect-right":var Ye,He,Ge,qe;D=null!==(Ye=m.mouseEvent)&&void 0!==Ye&&Ye.shiftKey||null!==(He=m.touchEvent)&&void 0!==He&&He.shiftKey?{x:Y,y:F-Kt/2/dt,width:ft+Kt,height:ct+Kt/dt}:null!==(Ge=m.mouseEvent)&&void 0!==Ge&&Ge.altKey||null!==(qe=m.touchEvent)&&void 0!==qe&&qe.altKey?{x:Y-Kt,y:F,width:ft+2*Kt,height:ct}:{x:Y,y:F,width:ft+Kt,height:ct};break;default:D={x:Y+yt-rt,y:F+St-j,width:ft,height:ct}}D.width<0&&(D.width=0),D.height<0&&(D.height=0),D.x=(0,u.q)(D.x),D.y=(0,u.q)(D.y),D.width=(0,u.q)(D.width),D.height=(0,u.q)(D.height),Object.assign(q,D),Object.assign(T,(0,lt.sg)(K,q)),(0,et.__)(window.document.getElementById(G),T),(0,et.hJ)(Q,S)})(j[0][0],j[0][1],rt.x,rt.y),Pt=!0},end:(rt,j)=>{Pt&&Wt&&O.icdt.history.push([{type:"size",from:Wt,to:JSON.parse(JSON.stringify({id:G,size:q,attribute:T}))}])}})}},3171:(ae,Rt,v)=>{v.d(Rt,{Q:()=>M});var N=v(1687),O=v(4981),lt=v(4318),C=v(6816),et=v(7492),u=v(3423),_=v(5811);const M=A=>{let S=999999,Q=999999,G=-999999,K=-999999;null==A||A.forEach(Y=>{S=Math.min(S,Y.size.x),Q=Math.min(Q,Y.size.y),G=Math.max(G,Y.size.x+Y.size.width),K=Math.max(K,Y.size.y+Y.size.height)});let q=(0,et.g1)(N.O.SELECT_GROUP,"g"),T=(0,lt.bH)(S,Q,G,K);(0,et.yD)(q,A,T).forEach(Y=>{k(Y.element,Y.posType,T,A,q)})},k=(A,S,Q,G,K)=>{let q=!1;null==A||A.addEventListener("touchstart",T=>{q=!0,m({touchEvent:T},S,Q,G,K)}),null==A||A.addEventListener("mousedown",T=>{if(0==T.button){if(q)return void(q=!1);m({mouseEvent:T},S,Q,G,K)}})},m=(A,S,Q,G,K)=>{let{x:q,y:T,width:Y,height:F}=Q,ft=G.map(Ut=>Object.assign({},Ut.size)),dt=[];(0,C.A)(A,{start:Ut=>{G.forEach((Ut,Lt)=>{let{id:Pt,size:rt,attribute:j}=Ut;dt.push(JSON.parse(JSON.stringify({id:Pt,size:rt,attribute:j})))})},move:(Ut,Lt)=>{((Ut,Lt,Pt,jt)=>{(()=>{let rt;rt="rect-center"===S?{x:q+Pt-Ut,y:T+jt-Lt,width:Y,height:F}:{x:q,y:T,width:Y,height:F},(0,u.v)(O.icdt.screen.width),(0,u.v)(O.icdt.screen.height),rt.width<0&&(rt.width=0),rt.height<0&&(rt.height=0),Object.assign(Q,rt),(0,et.yD)(K,G,Q)})(),G.forEach((rt,j)=>{let tt,{x:yt,y:St,width:Kt,height:_t}=ft[j],{id:le,type:J,size:X,attribute:d}=rt;tt="rect-center"===S?{x:yt+Pt-Ut,y:St+jt-Lt,width:Kt,height:_t}:{x:yt,y:St,width:Kt,height:_t},(0,u.v)(O.icdt.screen.width),(0,u.v)(O.icdt.screen.height),tt.width<0&&(tt.width=0),tt.height<0&&(tt.height=0),tt.x=(0,_.q)(tt.x),tt.y=(0,_.q)(tt.y),tt.width=(0,_.q)(tt.width),tt.height=(0,_.q)(tt.height),Object.assign(X,tt),Object.assign(d,(0,lt.sg)(J,X)),(0,et.__)(window.document.getElementById(le),d)})})(Lt[0][0],Lt[0][1],Ut.x,Ut.y)},end:(Ut,Lt)=>{dt.length&&O.icdt.history.push(G.map((Ut,Lt)=>{let{id:Pt,size:rt,attribute:j}=Ut;return{type:"size",from:dt[Lt],to:JSON.parse(JSON.stringify({id:Pt,size:rt,attribute:j}))}}))}})}},5226:(ae,Rt,v)=>{v.d(Rt,{E:()=>K,T:()=>q});var N=v(1687),O=v(8619),lt=v(8785),C=v(2282),et=v(8054),u=v(4921),_=v(6358),M=v(9054),k=v(8419),m=v(1105),A=v(2875),S=v(7210),Q=v(4981),G=v(7492);const K=(T,Y,F)=>{var ft;if(Y&&!(null!=F?F:window).document.getElementById(Y))return;if("localhost"==location.hostname&&console.log("aaaaaaaaaaaaaaa s\u1ee3 qu\xe1 \u0111iiiiiiiiiiiiiiiiiiiiiiiiiii!",Y),Y){let dt=(null!=F?F:window).document.getElementById(Y);jQuery(dt).find("#"+N.O.BACKGROUND_GROUP).empty();let D=(0,G.g1)(N.O.BACKGROUND_GROUP,"g",void 0,dt);(0,G.x0)(D,T)}else{jQuery(Q.icdt.target).find("#"+N.O.BACKGROUND_GROUP).empty();let dt=(0,G.g1)(N.O.BACKGROUND_GROUP,"g",void 0,Q.icdt.target);(0,G.x0)(dt,T)}let ct=(dt,D)=>{D=D?`${Y}-${D}`:Y,null==dt||dt.forEach(Ot=>{let Wt=Y?`${Y}-${Ot.id}`:Ot.id;var Ut;if(Ot.isdeleted)null===(Ut=(null!=F?F:window).document.getElementById(Wt))||void 0===Ut||Ut.remove();else switch(Ot.type){case M.$.GROUP:(0,_.m)(Wt,{},D?(null!=F?F:window).document.getElementById(D):null),ct(Ot.nodes,Ot.id);break;case M.$.CIRCLE:(0,O._)(Wt,{size:Ot.size,attribute:Ot.attribute},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.ELLIPSE:(0,lt.r)(Wt,{size:Ot.size,attribute:Ot.attribute},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.LINE:(0,u.W)(Wt,{size:Ot.size,attribute:Ot.attribute},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.RECT:(0,et.f)(Wt,{size:Ot.size,attribute:Ot.attribute},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.POLYGON:(0,C.l)(Wt,{size:Ot.size,attribute:Ot.attribute},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.FOREIGNOBJECT:(0,A.e)(Wt,{size:Ot.size,attribute:Ot.attribute,style:Ot.style,source:Ot.source},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.IMAGE:(0,S.G)(Wt,{size:Ot.size,attribute:Ot.attribute,source:Ot.source},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.TEXT:(0,m.$)(Wt,{size:Ot.size,attribute:Ot.attribute,source:Ot.source},D?(null!=F?F:window).document.getElementById(D):null);break;case M.$.PATH:(0,k.G)(Wt,{size:Ot.size,attribute:Ot.attribute},D?(null!=F?F:window).document.getElementById(D):null)}})};ct(null==T||null===(ft=T.svg)||void 0===ft?void 0:ft.nodes)},q=(T,Y)=>{var F;if(Y&&!window.document.getElementById(Y))return;let ft=(ct,dt)=>{dt=dt?`${Y}-${dt}`:Y,null==ct||ct.forEach(D=>{jQuery("#"+(Y?`${Y}-${D.id}`:D.id)).appendTo(dt?window.document.getElementById(dt):Q.icdt.target),D.type==M.$.GROUP&&ft(D.nodes,D.id)})};ft(null==T||null===(F=T.svg)||void 0===F?void 0:F.nodes)}},8619:(ae,Rt,v)=>{v.d(Rt,{_:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(m,(0,lt.sg)(N.$.CIRCLE,k)),{nodeId:u,element:(0,C.it)(u,N.$.CIRCLE,"circle",{size:k,attribute:m},M),size:k,attribute:m}}},8785:(ae,Rt,v)=>{v.d(Rt,{r:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(m,(0,lt.sg)(N.$.ELLIPSE,k)),{nodeId:u,element:(0,C.it)(u,N.$.ELLIPSE,"ellipse",{size:k,attribute:m},M),size:k,attribute:m}}},2875:(ae,Rt,v)=>{v.d(Rt,{e:()=>C});var N=v(9054),O=v(4318),lt=v(7492);const C=(et,u,_)=>{let M=(null==u?void 0:u.size)||{x:0,y:0,width:180,height:180},k=(null==u?void 0:u.attribute)||{};Object.assign(k,(0,O.sg)(N.$.FOREIGNOBJECT,M));let m=(null==u?void 0:u.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},A=(null==u?void 0:u.style)||{};return{nodeId:et,element:(0,lt.it)(et,N.$.FOREIGNOBJECT,"foreignObject",{size:M,attribute:k,style:A,source:m},_),size:M,attribute:k,style:A,source:m}}},6358:(ae,Rt,v)=>{v.d(Rt,{m:()=>C});var N=v(9054),O=v(4318),lt=v(7492);const C=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{};return Object.assign(m,(0,O.sg)(N.$.GROUP,k)),{nodeId:u,element:(0,lt.it)(u,N.$.GROUP,"g",{size:k,attribute:m},M),size:k,attribute:m}}},7210:(ae,Rt,v)=>{v.d(Rt,{G:()=>C});var N=v(9054),O=v(4318),lt=v(7492);const C=(et,u,_)=>{let M=(null==u?void 0:u.size)||{x:0,y:0,width:100,height:100},k=(null==u?void 0:u.attribute)||{preserveAspectRatio:"none"};Object.assign(k,(0,O.sg)(N.$.IMAGE,M));let m=(null==u?void 0:u.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:et,element:(0,lt.it)(et,N.$.IMAGE,"image",{size:M,attribute:k,source:m},_),size:M,attribute:k,source:m}}},4921:(ae,Rt,v)=>{v.d(Rt,{W:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth,strokeLinecap:O.icdt.attribute.strokeLinecap};return Object.assign(m,(0,lt.sg)(N.$.LINE,k)),{nodeId:u,element:(0,C.it)(u,N.$.LINE,"line",{size:k,attribute:m},M),size:k,attribute:m}}},8419:(ae,Rt,v)=>{v.d(Rt,{G:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(m,(0,lt.sg)(N.$.PATH,k)),{nodeId:u,element:(0,C.it)(u,N.$.PATH,"path",{size:k,attribute:m},M),size:k,attribute:m}}},2282:(ae,Rt,v)=>{v.d(Rt,{l:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(m,(0,lt.sg)(N.$.POLYGON,k)),{nodeId:u,element:(0,C.it)(u,N.$.POLYGON,"polygon",{size:k,attribute:m},M),size:k,attribute:m}}},8054:(ae,Rt,v)=>{v.d(Rt,{f:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:10,height:10},m=(null==_?void 0:_.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(m,(0,lt.sg)(N.$.RECT,k)),{nodeId:u,element:(0,C.it)(u,N.$.RECT,"rect",{size:k,attribute:m},M),size:k,attribute:m}}},1105:(ae,Rt,v)=>{v.d(Rt,{$:()=>et});var N=v(9054),O=v(4981),lt=v(4318),C=v(7492);const et=(u,_,M)=>{let k=(null==_?void 0:_.size)||{x:0,y:0,width:100,height:50},m=(null==_?void 0:_.attribute)||{fill:O.icdt.attribute.stroke,fontFamily:O.icdt.attribute.fontFamily,fontSize:O.icdt.attribute.fontSize,textLength:O.icdt.attribute.textLength};Object.assign(m,(0,lt.sg)(N.$.TEXT,k));let A=(null==_?void 0:_.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:u,element:(0,C.it)(u,N.$.TEXT,"text",{size:k,attribute:m,source:A},M),size:k,attribute:m,source:A}}},4318:(ae,Rt,v)=>{v.d(Rt,{bH:()=>O,sg:()=>lt});var N=v(9054);const O=(et,u,_,M,k)=>{let m={x:Math.min(et,_),y:Math.min(u,M),width:Math.abs(_-et)||1,height:Math.abs(M-u)||1};return null!=k&&k.ratio&&(m.width<=m.height?m.height=m.width*(null==k?void 0:k.ratio):m.width=m.height/(null==k?void 0:k.ratio)),Object.assign(m,{ratios:(null==k?void 0:k.ratios)||[[(et-m.x)/(m.width||1),(u-m.y)/(m.height||1)],[(_-m.x)/(m.width||1),(M-m.y)/(m.height||1)]]}),null!=k&&k.points&&(m.points=null==k?void 0:k.points),m},lt=(et,u,_)=>{var M=(()=>{switch(et){case N.$.CIRCLE:return{cx:u.x+u.width/2,cy:u.y+u.height/2,r:Math.min(u.width/2,u.height/2)};case N.$.ELLIPSE:return{cx:u.x+u.width/2,cy:u.y+u.height/2,rx:u.width/2,ry:u.height/2};case N.$.LINE:{var k;let S={};return null===(k=u.ratios)||void 0===k||k.forEach((Q,G)=>{S[`x${G+1}`]=u.x+u.width*Q[0],S[`y${G+1}`]=u.y+u.height*Q[1]}),S}case N.$.RECT:return{x:u.x,y:u.y,width:u.width,height:u.height};case N.$.POLYGON:var m;return{points:((null===(m=u.ratios)||void 0===m?void 0:m.map(S=>[u.x+u.width*S[0],u.y+u.height*S[1]]))||[]).map(S=>S.join(" ")).join(",")};case N.$.FOREIGNOBJECT:case N.$.IMAGE:return{x:u.x,y:u.y,width:u.width,height:u.height};case N.$.TEXT:return{x:u.x,y:u.y};case N.$.PATH:{var A;let S=null!==(A=u.points)&&void 0!==A?A:[];return S.length?{d:`M ${S[0][0]} ${S[0][1]} L `+(S.map(Q=>[Q[0],Q[1]])||[]).map(Q=>Q.join(" ")).join(" ")}:{d:""}}}return{}})();return u.rotate?(M.transform=`rotate(${u.rotate})`,M.transformOrigin=`${u.x+u.width/2} ${u.y+u.height/2}`):(M.transform=null,M.transformOrigin=null),M}},5811:(ae,Rt,v)=>{v.d(Rt,{q:()=>N});const N=(O,lt)=>{var C;return lt=null!==(C=lt)&&void 0!==C?C:100,Math.round((O+Number.EPSILON)*lt)/lt}},3423:(ae,Rt,v)=>{v.d(Rt,{v:()=>lt});var N=v(4981),O=v(5811);const lt=C=>(0,O.q)(C/N.icdt.screen.scale)},3385:(ae,Rt,v)=>{v.d(Rt,{Vs:()=>M,co:()=>u,k6:()=>et,lO:()=>_,mr:()=>k});var N=v(4981),O=v(7492),lt=v(4318),C=v(5811);const et=(m,A)=>{let{id:S,type:Q,size:G,attribute:K}=m,q=JSON.parse(JSON.stringify({id:S,size:G,attribute:K}));G.x=(0,C.q)(A),Object.assign(K,(0,lt.sg)(Q,G)),(0,O.__)(window.document.getElementById(S),K),N.icdt.history.push([{type:"size",from:q,to:JSON.parse(JSON.stringify({id:S,size:G,attribute:K}))}])},u=(m,A)=>{let{id:S,type:Q,size:G,attribute:K}=m,q=JSON.parse(JSON.stringify({id:S,size:G,attribute:K}));G.y=(0,C.q)(A),Object.assign(K,(0,lt.sg)(Q,G)),(0,O.__)(window.document.getElementById(S),K),N.icdt.history.push([{type:"size",from:q,to:JSON.parse(JSON.stringify({id:S,size:G,attribute:K}))}])},_=(m,A,S)=>{let{id:Q,type:G,size:K,attribute:q}=m,T=JSON.parse(JSON.stringify({id:Q,size:K,attribute:q}));S&&(K.height=(0,C.q)(A*K.height/K.width)),K.width=(0,C.q)(A),Object.assign(q,(0,lt.sg)(G,K)),(0,O.__)(window.document.getElementById(Q),q),N.icdt.history.push([{type:"size",from:T,to:JSON.parse(JSON.stringify({id:Q,size:K,attribute:q}))}])},M=(m,A,S)=>{let{id:Q,type:G,size:K,attribute:q}=m,T=JSON.parse(JSON.stringify({id:Q,size:K,attribute:q}));S&&(K.width=(0,C.q)(A*K.width/K.height)),K.height=(0,C.q)(A),Object.assign(q,(0,lt.sg)(G,K)),(0,O.__)(window.document.getElementById(Q),q),N.icdt.history.push([{type:"size",from:T,to:JSON.parse(JSON.stringify({id:Q,size:K,attribute:q}))}])},k=(m,A)=>{let{id:S,type:Q,size:G,attribute:K}=m,q=JSON.parse(JSON.stringify({id:S,size:G,attribute:K}));G.rotate=(0,C.q)(A),Object.assign(K,(0,lt.sg)(Q,G)),(0,O.__)(window.document.getElementById(S),K),N.icdt.history.push([{type:"size",from:q,to:JSON.parse(JSON.stringify({id:S,size:G,attribute:K}))}])}},6816:(ae,Rt,v)=>{v.d(Rt,{A:()=>u});var N=v(968),O=v(4981);class lt{constructor(M){this._points=[],this._options=M}start(M){this._points.length=0,this._points.push([M.x,M.y]),this._options.start(M)}move(M){this._points.push([M.x,M.y]),this._options.move(M,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(M=this._points[0])[0],y:M[1]}:{x:0,y:0};var M}get offsetLast(){return this._points.length>=1?{x:(M=this._points[this._points.length-1])[0],y:M[1]}:{x:0,y:0};var M}}var C=v(7797);const u=(_,M,k,m,A)=>{var S,Q,G;let K=null,q=0,T=0;_.mouseEvent?(K=_.mouseEvent.target,q=_.mouseEvent.offsetX,T=_.mouseEvent.offsetY):_.touchEvent&&(K=_.touchEvent.target,_.touchEvent.touches.length&&(q=_.touchEvent.touches[0].clientX,T=_.touchEvent.touches[0].clientY));let Y=null!=k?k:O.icdt.screen.scale,F=null!=m?m:O.icdt.screen.dislocation,ft=null!=A?A:O.icdt.screen.offset,ct=()=>{};var dt=new lt({start:null!==(S=null==M?void 0:M.start)&&void 0!==S?S:ct,move:null!==(Q=null==M?void 0:M.move)&&void 0!==Q?Q:ct,end:null!==(G=null==M?void 0:M.end)&&void 0!==G?G:ct});_.mouseEvent?dt.start((0,C.p)({x:q,y:T},Y,F,{x:0,y:0})):_.touchEvent&&dt.start((0,C.p)({x:q,y:T},Y,F,ft));let D=rt=>{dt.move((0,C.p)({x:rt.clientX,y:rt.clientY},Y,F,ft))},Ot=rt=>{dt.end(),[N._.SHAPE,N._.FOREIGNOBJECT,N._.IMAGE,N._.TEXT].includes(O.icdt.pointer.pointer_type)&&(rt.shiftKey||(O.icdt.pointer.pointer_type=N._.POINTER))},Wt=rt=>{rt.touches.length&&D({clientX:rt.touches[0].clientX,clientY:rt.touches[0].clientY})},Ut=rt=>{Ot({shiftKey:rt.shiftKey,ctrlKey:rt.ctrlKey,altKey:rt.altKey}),window.removeEventListener("touchmove",Wt,!1),window.removeEventListener("touchend",Ut,!1)},Lt=rt=>{0==rt.button&&D({clientX:rt.clientX,clientY:rt.clientY})},Pt=rt=>{0==rt.button&&(Ot({shiftKey:rt.shiftKey,ctrlKey:rt.ctrlKey,altKey:rt.altKey}),window.removeEventListener("mousemove",Lt,!1),window.removeEventListener("mouseup",Pt,!1))};if(_.mouseEvent)window.addEventListener("mousemove",Lt,!1),window.addEventListener("mouseup",Pt,!1);else if(_.touchEvent){var jt;window.addEventListener("touchmove",Wt,!1),window.addEventListener("touchend",Ut,!1),null===(jt=K)||void 0===jt||jt.addEventListener("touchmove",function(rt){rt.preventDefault()})}}},7797:(ae,Rt,v)=>{v.d(Rt,{p:()=>O});var N=v(5811);const O=(lt,C,et,u)=>(lt.x-=u.x,lt.y-=u.y,lt.x/=C,lt.y/=C,lt.x-=et.x,lt.y-=et.y,lt.x=(0,N.q)(lt.x),lt.y=(0,N.q)(lt.y),lt)},70:(ae,Rt,v)=>{v.d(Rt,{$:()=>vt,U:()=>$t});var N=v(1687),O=v(4981),lt=v(9054),C=v(5973),et=v(2336),u=v(861),_=v(157),M=v(4787),m=v(1105),A=v(6358);var q=v(7267),T=v(7210),Y=v(5811);const F=(H,c,V)=>{var at,ot,Z,U;let W=1,w=new Image;w.onload=()=>{var R,gt,kt,pt;W=(0,Y.q)(w.naturalWidth/w.naturalHeight,100);let Mt=0,zt=0,Gt=0,Vt=0;var qt,ce,pe,oe;W>=1?(Gt=Math.min(w.naturalWidth,null!==(qt=null===(ce=vt.slide.svg)||void 0===ce||null===(ce=ce.viewBox)||void 0===ce?void 0:ce.width)&&void 0!==qt?qt:0),Vt=Gt/W):(Vt=Math.min(w.naturalHeight,null!==(pe=null===(oe=vt.slide.svg)||void 0===oe||null===(oe=oe.viewBox)||void 0===oe?void 0:oe.height)&&void 0!==pe?pe:0),Gt=Vt/W),Mt=((null!==(R=null===(gt=vt.slide.svg)||void 0===gt||null===(gt=gt.viewBox)||void 0===gt?void 0:gt.width)&&void 0!==R?R:0)-Gt)/2,zt=((null!==(kt=null===(pt=vt.slide.svg)||void 0===pt||null===(pt=pt.viewBox)||void 0===pt?void 0:pt.height)&&void 0!==kt?kt:0)-Vt)/2,c.size={x:Mt,y:zt,width:Gt,height:Vt},ft(c,V)},w.onerror=R=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,R)},w.src=(null!==(at=c.source)&&void 0!==at&&at.path?(null===(ot=O.icdt.config)||void 0===ot?void 0:ot.readfileuploadurl)+(null===(Z=c.source)||void 0===Z?void 0:Z.path):null===(U=c.source)||void 0===U?void 0:U.url)||""},ft=(H,c)=>{if(H.slideStatus!=vt.slideStatus)return void c();let{element:V}=(0,T.G)(Math.ceil(1e9*Math.random()),{size:H.size,source:{type:"image",image:null==H?void 0:H.source}});setTimeout(()=>{null==V||V.remove(),c()},3e3)};var ct=v(7492);const dt=(H,c,V)=>{var at,ot,Z,U;let W=new Image;W.onload=()=>{D(H,{width:W.naturalWidth,height:W.naturalHeight},c,V)},W.onerror=w=>{console.error(`ImgSrc load failed -> ${JSON.stringify(c.source)}`,w),V()},W.src=(null!==(at=c.source)&&void 0!==at&&at.path?(null===(ot=O.icdt.config)||void 0===ot?void 0:ot.readfileuploadurl)+(null===(Z=c.source)||void 0===Z?void 0:Z.path):null===(U=c.source)||void 0===U?void 0:U.url)||""},D=(H,c,V,at)=>{if(V.slideStatus!=vt.slideStatus)return void at();let ot=(0,Y.q)(c.width/c.height,100),Z=0,U=0,W=0,w=0;ot>=1?(W=c.width,W=Math.max(W,40),W=Math.min(W,40),w=W/ot):(w=c.height,w=Math.max(w,40),w=Math.min(w,40),W=w/ot);let{size:kt}=H;Z=kt.x+kt.width-W/2,U=kt.y-w/2;let pt=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,T.G)(`icon-${H.id}`,{size:{x:Z,y:U,width:W,height:w},source:{type:"image",image:null==V?void 0:V.source}},pt),setTimeout(()=>{at()},3e3)},Ot=(H,c,V)=>{var at,ot,Z,U,W,w,R;if(c.slideStatus!=vt.slideStatus)return void V();if(!(null!==(at=c.source)&&void 0!==at&&at.path||null!==(ot=c.source)&&void 0!==ot&&ot.url))return console.warn(`${H.id} -> audio no source!`),void V();var gt=jQuery("#"+H.id);let kt=null!==(Z=c.iteration)&&void 0!==Z?Z:0;if(kt<0&&(V(),V=function(){}),!(gt.data("audio-running")&&kt<0)){gt.data("audio-running",!0);var pt=new Audio;return pt.autoplay=!0,pt.loop=0!=kt,pt.preload="auto",pt.controls=!0,pt.setAttributeNode(document.createAttribute("playsinline")),pt.addEventListener("canplay",function(){var Mt=pt.play();Mt&&Mt.then(function(zt){gt.data("audio-running",!0)}).catch(function(zt){gt.data("audio-running",!1),c.slideStatus===vt.slideStatus&&V()})}),pt.addEventListener("timeupdate",function(){var zt;c.slideStatus!==vt.slideStatus&&((zt=this).pause(),zt.remove(),gt.data("audio-running",!1))}),pt.addEventListener("canplaythrough",function(){this.loop&&(kt>0?kt--:0==kt&&(this.loop=!1))}),pt.addEventListener("play",function(){}),pt.addEventListener("pause",function(){}),pt.addEventListener("ended",function(){this.remove(),gt.data("audio-running",!1),c.slideStatus===vt.slideStatus&&V()}),pt.onerror=function(){this.remove(),gt.data("audio-running",!1),c.slideStatus===vt.slideStatus&&V()},pt.src=(null!==(U=c.source)&&void 0!==U&&U.path?(null===(W=O.icdt.config)||void 0===W?void 0:W.readfileuploadurl)+(null===(w=c.source)||void 0===w?void 0:w.path):null===(R=c.source)||void 0===R?void 0:R.url)||"",pt}};var Wt=v(9942);const yt=(H,c,V)=>{var at;null===(at=c.test)||void 0===at||null===(at=at.answer)||void 0===at||null===(at=at.matching)||void 0===at||at.filter(ot=>ot.value==V.key).forEach(ot=>ot.value=""),jQuery(`#node-${H.id}`).remove()},Kt=(H,c,V,at,ot,Z)=>{var U,W,w,R,gt,kt,pt,Mt,zt,Gt,Vt,qt;ot.iscorrect?(null!==(U=c.test)&&void 0!==U&&null!==(U=U.audiotrue)&&void 0!==U&&U.path&&Ot(H,{source:(0,Wt.I)(null===(R=c.test)||void 0===R?void 0:R.audiotrue),iteration:0,nodeStatus:V,slideStatus:at},Z),null!==(W=c.test)&&void 0!==W&&null!==(W=W.icontrue)&&void 0!==W&&W.path&&dt(H,{source:(0,Wt.I)(null===(gt=c.test)||void 0===gt?void 0:gt.icontrue),iteration:0,nodeStatus:V,slideStatus:at},Z),null!==(w=c.test)&&void 0!==w&&null!==(w=w.effecttrue)&&void 0!==w&&w.path&&F(0,{source:(0,Wt.I)(null===(kt=c.test)||void 0===kt?void 0:kt.effecttrue),iteration:0,nodeStatus:V,slideStatus:at},Z)):(null!==(pt=c.test)&&void 0!==pt&&null!==(pt=pt.audiofalse)&&void 0!==pt&&pt.path&&Ot(H,{source:(0,Wt.I)(null===(Gt=c.test)||void 0===Gt?void 0:Gt.audiofalse),iteration:0,nodeStatus:V,slideStatus:at},Z),null!==(Mt=c.test)&&void 0!==Mt&&null!==(Mt=Mt.iconfalse)&&void 0!==Mt&&Mt.path&&dt(H,{source:(0,Wt.I)(null===(Vt=c.test)||void 0===Vt?void 0:Vt.iconfalse),iteration:0,nodeStatus:V,slideStatus:at},Z),null!==(zt=c.test)&&void 0!==zt&&null!==(zt=zt.effectfalse)&&void 0!==zt&&zt.path&&F(0,{source:(0,Wt.I)(null===(qt=c.test)||void 0===qt?void 0:qt.effectfalse),iteration:0,nodeStatus:V,slideStatus:at},Z))},_t=(H,c,V,at)=>{var ot,Z,U,W,w,R,kt,Mt,pt;null!==(ot=c.animate)&&void 0!==ot&&ot.value&&(0,q.Z)(c,V.nodeStatus,V.slideStatus),null!==(Z=c.interactive)&&void 0!==Z&&Z.show?((H,c,V,at)=>{var ot,Z,U;console.log("icdt_Run_Interactive_NodeShow",H,c,V);let W={total:0,counter:0},{triggershow:w,triggerrun:R,triggerhide:gt,action:kt,audio:pt}=null!==(ot=null===(Z=H.interactive)||void 0===Z?void 0:Z.show)&&void 0!==ot?ot:{};if(w){let{id:zt,ids:Gt,time:Vt,async:qt}=w;"asynctrue"==qt?setTimeout(()=>{(0,M.L5)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})}):"time"==qt&&setTimeout(()=>{(0,M.L5)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})},1e3*(null!=Vt?Vt:0))}if(R){let{id:zt,ids:Gt,time:Vt,async:qt}=R;"asynctrue"==qt?setTimeout(()=>{(0,M.Ar)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})}):"time"==qt&&setTimeout(()=>{(0,M.Ar)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})},1e3*(null!=Vt?Vt:0))}if(gt){let{id:zt,ids:Gt,time:Vt,async:qt}=gt;"asynctrue"==qt?setTimeout(()=>{(0,M.WT)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})}):"time"==qt&&setTimeout(()=>{(0,M.WT)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})},1e3*(null!=Vt?Vt:0))}let Mt=()=>{setTimeout(()=>{if(W.counter>=W.total){if(at&&at(),w){let{id:zt,ids:Gt,async:Vt}=w;(!Vt||"asyncfalse"==Vt)&&(0,M.L5)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})}if(R){let{id:zt,ids:Gt,async:Vt}=R;(!Vt||"asyncfalse"==Vt)&&(0,M.Ar)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})}if(gt){let{id:zt,ids:Gt,async:Vt}=gt;(!Vt||"asyncfalse"==Vt)&&(0,M.WT)({id:zt,ids:Gt,nodeStatus:c,slideStatus:V})}}})};if(null!=kt&&kt.value){W.total+=1;let zt=()=>{W.counter+=1,Mt()};switch(null==kt?void 0:kt.value){case"hide":jQuery("#"+H.id).addClass("hide"),zt();break;case"points":{let{points:Gt,time:Vt,iteration:qt,finish:ce}=kt;(0,u.G)(H.id,{node:H,points:Gt,time:Vt,iteration:qt,finish:ce,nodeStatus:c,slideStatus:V},zt);break}default:{let{value:Gt,time:Vt,iteration:qt,finish:ce}=kt;(0,et.Q)(H.id,{node:H,value:Gt,time:Vt,iteration:qt,finish:ce,nodeStatus:c,slideStatus:V},zt);break}}}if(null!=pt&&null!==(U=pt.source)&&void 0!==U&&U.path){W.total+=1;let zt=()=>{W.counter+=1,Mt()},Gt=(0,_.R)(H.id,pt,W,{nodeStatus:c,slideStatus:V},zt);-1==(null==pt?void 0:pt.iteration)&&jQuery("#"+H.id).click(Vt=>{Vt.preventDefault(),Gt&&(Gt.volume=Gt.volume>=1?0:Gt.volume+.25),console.log(null==Gt?void 0:Gt.volume)})}W.total||Mt()})(c,V.nodeStatus,V.slideStatus,at):at&&at(),null!==(U=c.interactive)&&void 0!==U&&U.click&&(Mt=null===(kt=c.interactive)||void 0===kt?void 0:kt.click,Object.keys(null!=Mt?Mt:{}).map(Gt=>Mt[Gt]?1:0).includes(1)&&jQuery("#"+c.id).addClass("interactive-click"),jQuery("#"+c.id).click(Mt=>{Mt.preventDefault(),V.nodeStatus=vt.refreshNodeStatus(),(0,C.F)(c,V.nodeStatus,V.slideStatus)})),null!==(W=c.variable)&&void 0!==W&&W.input&&jQuery("#"+c.id).on("change","input,textarea",Mt=>{Mt.preventDefault(),((H,c,V)=>{var at,ot;O.icdt.variable.setValue(null!==(at=null===(ot=c.variable)||void 0===ot||null===(ot=ot.input)||void 0===ot?void 0:ot.variable)&&void 0!==at?at:"",H),(H=>{var c;let V=(at,ot)=>{null==at||at.forEach(Z=>{switch(Z.type){case lt.$.GROUP:(0,A.m)(Z.id,{},ot?window.document.getElementById(ot):null),V(Z.nodes,Z.id);break;case lt.$.POLYGON:break;case lt.$.TEXT:(0,m.$)(Z.id,{size:Z.size,attribute:Z.attribute,source:Z.source},ot?window.document.getElementById(ot):null)}})};V(null===(c=H.svg)||void 0===c?void 0:c.nodes)})(V)})(Mt.target.value,c,H)}),null!==(w=c.variable)&&void 0!==w&&w.click&&(null!==(pt=c.variable)&&void 0!==pt&&null!==(pt=pt.click)&&void 0!==pt&&pt.variable&&jQuery("#"+c.id).addClass("variable-click"),jQuery("#"+c.id).click(Mt=>{Mt.preventDefault(),((H,c)=>{var V;O.icdt.variable.setValueOperator(null===(V=H.variable)||void 0===V?void 0:V.click),(H=>{var c;let V=(at,ot)=>{null==at||at.forEach(Z=>{switch(Z.type){case lt.$.GROUP:(0,A.m)(Z.id,{},ot?window.document.getElementById(ot):null),V(Z.nodes,Z.id);break;case lt.$.POLYGON:break;case lt.$.TEXT:(0,m.$)(Z.id,{size:Z.size,attribute:Z.attribute,source:Z.source},ot?window.document.getElementById(ot):null)}})};V(null===(c=H.svg)||void 0===c?void 0:c.nodes)})(c)})(c,H)})),"test"==(null===(R=c.source)||void 0===R?void 0:R.type)&&((H,c)=>{var V;let at=()=>{};switch(null===(V=H.source)||void 0===V||null===(V=V.test)||void 0===V?void 0:V.type){case"truefalse":var ot;if(jQuery("#"+H.id).click(w=>{w.preventDefault(),((H,c,V,at,ot)=>{var Z,U;let W=null===(Z=H.source)||void 0===Z||null===(Z=Z.test)||void 0===Z||null===(Z=Z.truefalse)||void 0===Z?void 0:Z.iscorrect;if(c.test?c.test.answer?c.test.answer.truefalse={value:H.id,iscorrect:W}:c.test.answer={truefalse:{value:H.id,iscorrect:W}}:c.test={answer:{truefalse:{value:H.id,iscorrect:W}}},null!==(U=c.svg)&&void 0!==U&&U.nodes.find(w=>{var R;return"submit"==(null===(R=w.source)||void 0===R||null===(R=R.test)||void 0===R?void 0:R.type)})){if(c.test.showselection){let w=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,ct.Yw)(w,c)}}else Kt(H,c,V,at,{iscorrect:W},ot);console.log("node source ->",H.source),console.log("slide test ->",c.test)})(H,c,vt.nodeStatus,vt.slideStatus,at)}),null!==(ot=c.test)&&void 0!==ot&&ot.showselection){let w=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,ct.Yw)(w,c)}break;case"singlechoice":var Z;if(jQuery("#"+H.id).click(w=>{w.preventDefault(),((H,c,V,at,ot)=>{var Z,U;let W=null===(Z=H.source)||void 0===Z||null===(Z=Z.test)||void 0===Z||null===(Z=Z.singlechoice)||void 0===Z?void 0:Z.iscorrect;if(c.test?c.test.answer?c.test.answer.singlechoice={value:H.id,iscorrect:W}:c.test.answer={singlechoice:{value:H.id,iscorrect:W}}:c.test={answer:{singlechoice:{value:H.id,iscorrect:W}}},null!==(U=c.svg)&&void 0!==U&&U.nodes.find(w=>{var R;return"submit"==(null===(R=w.source)||void 0===R||null===(R=R.test)||void 0===R?void 0:R.type)})){if(c.test.showselection){let w=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,ct.Yw)(w,c)}}else Kt(H,c,V,at,{iscorrect:W},ot);console.log("node source ->",H.source),console.log("slide test ->",c.test)})(H,c,vt.nodeStatus,vt.slideStatus,at)}),null!==(Z=c.test)&&void 0!==Z&&Z.showselection){let w=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,ct.Yw)(w,c)}break;case"multichoice":var U;if(jQuery("#"+H.id).click(w=>{w.preventDefault(),((H,c,V,at,ot)=>{var Z,U;let w,W=null===(Z=H.source)||void 0===Z||null===(Z=Z.test)||void 0===Z||null===(Z=Z.multichoice)||void 0===Z?void 0:Z.iscorrect;if(c.test?c.test.answer?c.test.answer.multichoice?c.test.answer.multichoice.find(R=>R.value==H.id)?(c.test.answer.multichoice=c.test.answer.multichoice.filter(R=>R.value!=H.id),w=!0):c.test.answer.multichoice.push({value:H.id,iscorrect:W}):c.test.answer.multichoice=[{value:H.id,iscorrect:W}]:c.test.answer={multichoice:[{value:H.id,iscorrect:W}]}:c.test={answer:{multichoice:[{value:H.id,iscorrect:W}]}},null!==(U=c.svg)&&void 0!==U&&U.nodes.find(R=>{var gt;return"submit"==(null===(gt=R.source)||void 0===gt||null===(gt=gt.test)||void 0===gt?void 0:gt.type)})){if(c.test.showselection){let R=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,ct.Yw)(R,c)}}else Kt(H,c,V,at,{iscorrect:W},ot);console.log("node source ->",H.source),console.log("slide test ->",c.test)})(H,c,vt.nodeStatus,vt.slideStatus,at)}),null!==(U=c.test)&&void 0!==U&&U.showselection){let w=(0,ct.g1)(N.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,ct.Yw)(w,c)}break;case"fill":var W;jQuery("#"+H.id).on("keyup",'input[type="text"]',w=>{var R;let gt=jQuery("<div/>").css({"font-size":jQuery(w.target).css("font-size"),visibility:"hidden",float:"left"}).text(w.target.value).appendTo(window.document.body);jQuery(w.target).css({width:(null!==(R=gt.width())&&void 0!==R?R:0)+30})}).on("keypress",'input[type="text"]',w=>{13===(w.keyCode||w.charCode||w.which)&&(w.preventDefault(),w.stopPropagation(),jQuery(w.target).blur())}).on("change",'input[type="text"]',w=>{var R,gt;let kt=vt.nodeStatus,pt=vt.slideStatus,Mt=null===(R=w.target)||void 0===R?void 0:R.getAttribute("data-key"),zt=null===(gt=w.target)||void 0===gt||null===(gt=gt.value)||void 0===gt?void 0:gt.trim();((H,c,V,at,ot,Z)=>{var U,W,w,R;let{value:gt}=null!==(U=null===(W=H.source)||void 0===W||null===(W=W.test)||void 0===W||null===(W=W.fill)||void 0===W?void 0:W.find(pt=>pt.key==`[[${ot.key}]]`))&&void 0!==U?U:{},kt=gt&&gt.map(pt=>null==pt?void 0:pt.toLocaleLowerCase()).includes(null===(w=ot.value)||void 0===w?void 0:w.toLocaleLowerCase());null!==(R=c.svg)&&void 0!==R&&R.nodes.find(pt=>{var Mt;return"submit"==(null===(Mt=pt.source)||void 0===Mt||null===(Mt=Mt.test)||void 0===Mt?void 0:Mt.type)})||Kt(H,c,V,at,{iscorrect:kt},Z),ot.iscorrect=kt,c.test?c.test.answer?c.test.answer.fill?c.test.answer.fill.find(pt=>pt.key==ot.key)?c.test.answer.fill.filter(pt=>pt.key==ot.key).forEach(pt=>{pt.value=ot.value,pt.iscorrect=ot.iscorrect}):c.test.answer.fill.push(ot):c.test.answer.fill=[ot]:c.test.answer={fill:[ot]}:c.test={answer:{fill:[ot]}},console.log("node source ->",H.source),console.log("slide test ->",c.test)})(H,c,kt,pt,{key:Mt,value:zt},at),jQuery("#"+H.id).find(`input[type="text"][data-key="${Mt}"]`).val(zt)}),null!==(W=c.test)&&void 0!==W&&W.showselection||jQuery("#"+H.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+H.id).on("touchmove",".ondrag-item",function(w){w.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(w){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${H.size.height/H.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${w.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(w){var R;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(R=c.test)&&void 0!==R&&R.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(w){},dragend:function(w){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${H.id} .ondrop-here`).kendoDropTarget({dragenter:function(w){w.dropTarget.hasClass("actived")&&w.dropTarget.addClass("focused")},dragleave:function(w){w.dropTarget.hasClass("actived")&&w.dropTarget.removeClass("focused")},drop:function(w){if(!w.dropTarget.hasClass("actived"))return;w.dropTarget.removeClass("focused");let R=w.dropTarget,gt=w.draggable.currentTarget;R.is(":empty")||R.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),gt.appendTo(R),((H,c,V,at,ot,Z)=>{var U,W,w;let{key:R}=null!==(U=null===(W=H.source)||void 0===W||null===(W=W.test)||void 0===W?void 0:W.matching)&&void 0!==U?U:{key:"KIEN"},gt=ot.key==R;null!==(w=c.svg)&&void 0!==w&&w.nodes.find(pt=>{var Mt;return"submit"==(null===(Mt=pt.source)||void 0===Mt||null===(Mt=Mt.test)||void 0===Mt?void 0:Mt.type)})||Kt(H,c,V,at,{iscorrect:gt},Z),yt(H,c,ot);let kt={key:null!=R?R:"",value:ot.key};c.test?c.test.answer?c.test.answer.matching?c.test.answer.matching.find(pt=>pt.key==R)?c.test.answer.matching.filter(pt=>pt.key==R).forEach(pt=>pt.value=kt.value):c.test.answer.matching.push(kt):c.test.answer.matching=[kt]:c.test.answer={matching:[kt]}:c.test={answer:{matching:[kt]}},console.log("node source ->",H.source),console.log("slide test ->",c.test)})(H,c,vt.nodeStatus,vt.slideStatus,{key:gt.data("key")},at)}});break;case"matching-content":jQuery("#"+H.id).on("touchmove",".ondrag-item",function(w){w.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(w){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${H.size.height/H.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${w.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(w){var R;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(R=c.test)&&void 0!==R&&R.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(w){},dragend:function(w){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${H.id} .ondrop-here`).kendoDropTarget({dragenter:function(w){w.dropTarget.hasClass("actived")&&w.dropTarget.addClass("focused")},dragleave:function(w){w.dropTarget.hasClass("actived")&&w.dropTarget.removeClass("focused")},drop:function(w){if(!w.dropTarget.hasClass("actived"))return;w.dropTarget.removeClass("focused");let gt=w.draggable.currentTarget;gt.appendTo(w.dropTarget),yt(H,c,{key:gt.data("key")})}});break;case"speech":break;case"submit":jQuery("#"+H.id).click(w=>{w.preventDefault(),((H,c,V,at,ot)=>{var Z,U,W,w,R;let gt;var kt;if(null!=c&&null!==(Z=c.test)&&void 0!==Z&&null!==(Z=Z.answer)&&void 0!==Z&&Z.truefalse)gt=null==c||null===(kt=c.test)||void 0===kt||null===(kt=kt.answer)||void 0===kt||null===(kt=kt.truefalse)||void 0===kt?void 0:kt.iscorrect;else if(null!=c&&null!==(U=c.test)&&void 0!==U&&null!==(U=U.answer)&&void 0!==U&&U.singlechoice){var pt;gt=null==c||null===(pt=c.test)||void 0===pt||null===(pt=pt.answer)||void 0===pt||null===(pt=pt.singlechoice)||void 0===pt?void 0:pt.iscorrect}else if(null!=c&&null!==(W=c.test)&&void 0!==W&&null!==(W=W.answer)&&void 0!==W&&W.multichoice){var Mt,zt,Gt;gt=1==[null==c||null===(Mt=c.test)||void 0===Mt||null===(Mt=Mt.answer)||void 0===Mt||null===(Mt=Mt.multichoice)||void 0===Mt?void 0:Mt.length,null==c||null===(zt=c.test)||void 0===zt||null===(zt=zt.answer)||void 0===zt||null===(zt=zt.multichoice)||void 0===zt||null===(zt=zt.map(oe=>oe.iscorrect?1:0))||void 0===zt?void 0:zt.reduce((oe,se)=>oe+se),null==c||null===(Gt=c.svg)||void 0===Gt||null===(Gt=Gt.nodes)||void 0===Gt||null===(Gt=Gt.filter(oe=>{var se,xe;return"multichoice"==(null===(se=oe.source)||void 0===se||null===(se=se.test)||void 0===se?void 0:se.type)&&(null===(xe=oe.source)||void 0===xe||null===(xe=xe.test)||void 0===xe||null===(xe=xe.multichoice)||void 0===xe?void 0:xe.iscorrect)}))||void 0===Gt?void 0:Gt.length].filter((oe,se,xe)=>xe.indexOf(oe)==se).length}else if(null!=c&&null!==(w=c.test)&&void 0!==w&&null!==(w=w.answer)&&void 0!==w&&w.fill){var Vt,qt;gt=(null==c||null===(Vt=c.test)||void 0===Vt||null===(Vt=Vt.answer)||void 0===Vt||null===(Vt=Vt.fill)||void 0===Vt||null===(Vt=Vt.map(oe=>oe.iscorrect?1:0))||void 0===Vt?void 0:Vt.reduce((oe,se)=>oe+se))==(null===(qt=c.svg)||void 0===qt||null===(qt=qt.nodes)||void 0===qt||null===(qt=qt.filter(oe=>{var se;return"fill"==(null===(se=oe.source)||void 0===se||null===(se=se.test)||void 0===se?void 0:se.type)}))||void 0===qt?void 0:qt.length)}else if(null!=c&&null!==(R=c.test)&&void 0!==R&&null!==(R=R.answer)&&void 0!==R&&R.matching){var ce,pe;gt=(null===(ce=c.svg)||void 0===ce||null===(ce=ce.nodes)||void 0===ce||null===(ce=ce.filter(oe=>{var se;return"matching-empty"==(null===(se=oe.source)||void 0===se||null===(se=se.test)||void 0===se?void 0:se.type)}))||void 0===ce?void 0:ce.length)==((null==c||null===(pe=c.test)||void 0===pe||null===(pe=pe.answer)||void 0===pe?void 0:pe.matching)||[]).map(oe=>oe.key==oe.value?1:0).reduce((oe,se)=>oe+se)}Kt(H,c,V,at,{iscorrect:gt},ot),console.log("node source ->",H.source),console.log("slide test ->",c.test)})(H,c,vt.nodeStatus,vt.slideStatus,at)})}})(c,H)};var le=v(8619),J=v(8785),X=v(4921),d=v(8054),tt=v(2282),bt=v(2875),Et=v(8419);const Qt=(H,c,V)=>{if(V.slideStatus!=vt.slideStatus||!c.length)return;let at=c.shift(),ot=H.filter(w=>{var R;return(null!==(R=w.idx)&&void 0!==R?R:0)==at});if(!ot.length)return;let Z=Math.max.apply(null,ot.map(w=>{var R;return null!==(R=w.time)&&void 0!==R?R:0})),U=!1,W=Z<.5?0:setTimeout(()=>{U||(U=!0,Qt(H,c,V))},1e3*Z);Ht(H,c,ot,0,V,{idx:at,total:ot.length,counter:0,isRecursive:U,timeoutRecursive:W,maxTimeCoundown:Z,uid:Math.floor(1e9*Math.random())})},Ht=(H,c,V,at,ot,Z)=>{if(ot.slideStatus!=vt.slideStatus)return;let U=V[at];if(U){switch(U.type){case lt.$.GROUP:break;case lt.$.CIRCLE:(0,le._)(U.id,{size:U.size,attribute:U.attribute},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.ELLIPSE:(0,J.r)(U.id,{size:U.size,attribute:U.attribute},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.LINE:(0,X.W)(U.id,{size:U.size,attribute:U.attribute},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.RECT:(0,d.f)(U.id,{size:U.size,attribute:U.attribute},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.POLYGON:(0,tt.l)(U.id,{size:U.size,attribute:U.attribute},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.FOREIGNOBJECT:(0,bt.e)(U.id,{size:U.size,attribute:U.attribute,style:U.style,source:U.source},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.IMAGE:(0,T.G)(U.id,{size:U.size,attribute:U.attribute,source:U.source},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.TEXT:(0,m.$)(U.id,{size:U.size,attribute:U.attribute,source:U.source},U.pid?window.document.getElementById(U.pid):null);break;case lt.$.PATH:(0,Et.G)(U.id,{size:U.size,attribute:U.attribute},U.pid?window.document.getElementById(U.pid):null)}_t(ot.slide,U,ot,()=>{Z.counter+=1,Z.maxTimeCoundown<.5&&Z.counter>=Z.total&&(Z.total=Z.counter=0,Z.isRecursive||(clearTimeout(Z.timeoutRecursive),Z.isRecursive=!0,setTimeout(()=>{Qt(H,c,ot)},250)))}),Ht(H,c,V,++at,ot,Z)}},vt=new class Tt{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(c){this._dataSource=c.data||{},O.icdt.variable.set=c.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var c,V;return null!==(c=null===(V=this._dataSource)||void 0===V||null===(V=V.slides)||void 0===V?void 0:V.length)&&void 0!==c?c:0}get slides(){var c;return(null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[]}get slide(){var c;return((null===(c=this._dataSource)||void 0===c?void 0:c.slides)||[])[this._slideIdx]||{}}findNode(c){var V;let at=null===(V=this._dataSource)||void 0===V||null===(V=V.slides)||void 0===V?void 0:V.find((pt,Mt)=>Mt==this._slideIdx),ot=null==at?void 0:at.svg,Z=(pt,Mt)=>{let zt=null==pt?void 0:pt.find(qt=>qt.id==c);if(zt)return zt.pid=Mt,zt;let Gt=0,Vt=pt.length||0;for(;Gt<Vt&&!zt&&(zt=Z(pt[Gt].nodes||[],pt[Gt].id),!zt);)Gt++;return zt},U=Z((null==ot?void 0:ot.nodes)||[]);var W,w,R,gt,kt;return U?(U.style=null!==(W=U.style)&&void 0!==W?W:{},U.source=null!==(w=U.source)&&void 0!==w?w:{},U.animate=null!==(R=U.animate)&&void 0!==R?R:{},U.interactive=null!==(gt=U.interactive)&&void 0!==gt?gt:{},U.variable=null!==(kt=U.variable)&&void 0!==kt?kt:{},U):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(c,V,at){var ot;let Z;var U,W;if(this.refreshNodeStatus(),this.refreshSlideStatus(),at)Z=null===(U=this._dataSource)||void 0===U||null===(U=U.slides)||void 0===U?void 0:U.find(kt=>kt.code==at||kt.id==at),Z&&(this._slideIdx=(null===(W=this._dataSource)||void 0===W||null===(W=W.slides)||void 0===W?void 0:W.indexOf(Z))||0);else if(V){var w,R;Z=null===(w=this._dataSource)||void 0===w||null===(w=w.slides)||void 0===w?void 0:w.find(kt=>kt.id==V),Z&&(this._slideIdx=(null===(R=this._dataSource)||void 0===R||null===(R=R.slides)||void 0===R?void 0:R.indexOf(Z))||0)}else this._slideIdx=Math.min(Math.max(c||0,0),this.slideTotal-1),Z=this.slide;if(Z){var gt;$t(O.icdt.container,O.icdt.svg,Z,!0),null===(gt=jQuery(O.icdt.svg).find("#"+N.O.BACKGROUND_GROUP))||void 0===gt||gt.empty();let kt=(0,ct.g1)(N.O.BACKGROUND_GROUP,"g",void 0,O.icdt.svg);(0,ct.x0)(kt,Z),(H=>{var c,V,at,ot;let Z=vt.nodeStatus,U=vt.slideStatus;null===(c=H.svg)||void 0===c||c.nodes.forEach(w=>{w.pid=Math.ceil(1e9*Math.random()),(0,A.m)(w.pid)});let W=null===(V=H.svg)||void 0===V||null===(V=V.nodes)||void 0===V?void 0:V.map(w=>{var R;return null!==(R=w.idx)&&void 0!==R?R:0}).filter((w,R,gt)=>gt.indexOf(w)==R).sort((w,R)=>(null!=w?w:0)-(null!=R?R:0));Qt(null!==(at=null===(ot=H.svg)||void 0===ot?void 0:ot.nodes)&&void 0!==at?at:[],null!=W?W:[],{slide:H,nodeStatus:Z,slideStatus:U})})(Z)}this.changeSlide(this.slides,null===(ot=this.slide)||void 0===ot?void 0:ot.id,this.slideIdx,this.slides.length,Z)}set onChangeSlide(c){this._fnChangeSlides.push(c)}changeSlide(c,V,at,ot,Z){this._fnChangeSlides.forEach(U=>U(c,V,at,ot,Z))}},$t=(H,c,V,at)=>{var ot,Z,U,W;let w=window.document.querySelector(c);var R;w||(w=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(R=window.document.querySelector(H))||void 0===R||R.appendChild(w)),at&&(w.textContent=null);let{x:gt,y:kt,width:pt,height:Mt}=null!==(ot=null==V||null===(Z=V.svg)||void 0===Z?void 0:Z.viewBox)&&void 0!==ot?ot:O.icdt.screen.frameSize;w.setAttributeNS(null,"viewBox",gt+" "+kt+" "+pt+" "+Mt),w.setAttribute("id",c.replace("#",""));var ce,pe,zt=null!==(U=jQuery(H).width())&&void 0!==U?U:1080,Gt=null!==(W=jQuery(H).height())&&void 0!==W?W:1080,qt=pt/Mt;qt>=zt/Gt?pe=(ce=zt)/qt:ce=(pe=Gt)*qt,w.setAttributeNS(null,"width",ce.toString()),w.setAttributeNS(null,"height",pe.toString())}},7267:(ae,Rt,v)=>{v.d(Rt,{E:()=>lt,Z:()=>O});var N=v(70);const O=(et,u,_)=>{var M;let{value:m}=null!==(M=et.animate)&&void 0!==M?M:{};lt(et.id,{node:et,value:m,nodeStatus:u,slideStatus:_},()=>{})},lt=(et,u,_)=>{var M;if(!u.value)return void _();let k=jQuery("#"+et).parents("g");if(!k.length)return void _();let{size:m}=u.node;k.css("transform-origin",`${m.x+m.width/2}px ${m.y+m.height/2}px`);let A="",S=null!==(M=u.iteration)&&void 0!==M?M:0,Q=[];(u.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?Q.push(u.value):u.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(u.value)?(Q.push("animation"),Q.push(`animation-${u.value}`)):(Q.push("animate__animated"),Q.push(`animate__${u.value}`)):(Q.push("animation"),Q.push("animation-fadein")),S<0?(Q.push("animation-iteration-infinite"),_(),_=function(){}):S>0&&Q.push("animation-iteration-"+(S+1)),A=Q.join(" "),function(K){let q=function(){k.data("animate-running")?k.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){k.data("animate-running",!1),setTimeout(function(){K()},100)}):K()};k.hasClass("animation")?setTimeout(function(){q()}):q()}(function(){var K;C(et),(S>0||S<0)&&k.one("animationiteration",function(){u.slideStatus===N.$.slideStatus||(k.data("animate-running",!1),C(et),u.slideStatus===N.$.slideStatus&&_())}),k.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(k.data("animate-running",!1),C(et),u.finish){default:case 0:case 1:break;case 2:var q;lt(et,{node:u.node,value:null===(q=u.node.animate)||void 0===q?void 0:q.out,nodeStatus:u.nodeStatus,slideStatus:u.slideStatus},()=>{k.addClass("hide")})}u.slideStatus===N.$.slideStatus&&_()}),k.attr("data-class",null!==(K=k.attr("class"))&&void 0!==K?K:""),k.addClass(A),k.data("animate-running",!0)})},C=function(et){var u,_,M=jQuery("#"+et).parents("g"),k=null===(u=M.attr("class"))||void 0===u?void 0:u.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),m=null===(_=M.attr("class"))||void 0===_?void 0:_.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);k&&k.forEach(function(S){jQuery(M).removeClass(S)}),m&&m.forEach(function(S){jQuery(M).removeClass(S)});let A=M.attr("data-class");A&&(M.attr("class",A),M.removeAttr("data-class")),jQuery(M).data("animation-running",!1)}},2336:(ae,Rt,v)=>{v.d(Rt,{Q:()=>lt});var N=v(70),O=v(7267);const lt=(et,u,_)=>{var M;if(!u.value)return void _();let k=jQuery("#"+et).parents("g");if(!k.length)return void _();let{size:m}=u.node;k.css("transform-origin",`${m.x+m.width/2}px ${m.y+m.height/2}px`);let A="",S=null!==(M=u.iteration)&&void 0!==M?M:0,Q=[];(u.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?Q.push(u.value):(Q.push("animation"),Q.push(u.value?"animation-"+u.value:"animation-fadein")),S<0?(Q.push("animation-iteration-infinite"),_(),_=function(){}):S>0&&Q.push("animation-iteration-"+(S+1)),A=Q.join(" "),function(K){let q=function(){k.data("animate-running")?k.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){k.data("animate-running",!1),setTimeout(function(){K()},100)}):K()};k.hasClass("animation")?setTimeout(function(){q()}):q()}(function(){var K;C(et),(S>0||S<0)&&k.one("animationiteration",function(){u.slideStatus===N.$.slideStatus||(k.data("animate-running",!1),C(et),u.slideStatus===N.$.slideStatus&&_())}),k.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(k.data("animate-running",!1),C(et),u.finish){default:case 0:case 1:break;case 2:var q;(0,O.E)(et,{node:u.node,value:null===(q=u.node.animate)||void 0===q?void 0:q.out,nodeStatus:u.nodeStatus,slideStatus:u.slideStatus},()=>{k.addClass("hide")})}u.slideStatus===N.$.slideStatus&&_()}),k.attr("data-class",null!==(K=k.attr("class"))&&void 0!==K?K:""),k.addClass(A),k.data("animate-running",!0)})},C=function(et){var u,_=jQuery("#"+et).parents("g"),M=null===(u=_.attr("class"))||void 0===u?void 0:u.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);M&&M.forEach(function(m){jQuery(_).removeClass(m)});let k=_.attr("data-class");k&&(_.attr("class",k),_.removeAttr("data-class")),jQuery(_).data("animation-running",!1)}},861:(ae,Rt,v)=>{v.d(Rt,{G:()=>et});var N=v(4318),O=v(70),lt=v(7492),C=v(7267);const et=(_,M,k)=>{var m;if(!M.points||!M.points.length)return void k();let A=jQuery("#"+_),S=function u(_){let M=[];2===_.length&&_.splice(1,0,[(_[0][0]+_[1][0])/2,(_[0][1]+_[1][1])/2]);let Q,G,K,k=1,m=_.length;for(;k<m;){if(Q=_[k-1],G=_[k],K=_[k+1],(Math.abs(Q[0]-G[0])>=15||Math.abs(Q[1]-G[1])>=15)&&Math.pow(Q[0]-G[0],2)+Math.pow(Q[1]-G[1],2)>=Math.pow(15,2)&&K&&(Math.abs(Q[0]-K[0])<=20||Math.abs(Q[1]-K[1])<=20)&&Math.pow(Q[0]-K[0],2)+Math.pow(Q[1]-K[1],2)<=Math.pow(20,2))M.push(G);else{let T=G[0]-Q[0],Y=G[1]-Q[1],F=Math.max(Math.abs(T),Math.abs(Y));for(var q=0;q<F;q+=15)M.push([Q[0]+T*q/F,Q[1]+Y*q/F])}k++}return m>0&&(M.splice(0,0,_[0]),M.push(_[m-1])),M}(M.points||[]),Q=null!==(m=M.iteration)&&void 0!==m?m:0;if(Q<0&&(k(),k=function(){}),A.data("work-running")&&Q<0)return;A.data("work-running",!0);let ft,G=S.length,K=Math.max(20,1e3*(M.time||3)/G),{id:q,type:T,size:Y,attribute:F}=O.$.findNode(_),ct=function(dt){if(M.slideStatus!==O.$.slideStatus)return A.data("work-running",!1),void(M.slideStatus===O.$.slideStatus&&k());if(dt<G){let Ot=S[dt];Ot&&(ft=Object.assign({},Y,{x:Ot[0]-Y.width/2,y:Ot[1]-Y.height/2}),Object.assign(F,(0,N.sg)(T,ft)),(0,lt.__)(window.document.getElementById(q),F),setTimeout(function(){ct(++dt)},K))}else if(Q>0)Q--,ct(1);else if(Q<0)ct(1);else switch(A.data("work-running",!1),M.slideStatus===O.$.slideStatus&&k(),M.finish){default:case 0:break;case 1:Object.assign(F,(0,N.sg)(T,Y)),(0,lt.__)(window.document.getElementById(q),F);break;case 2:var D;(0,C.E)(M.node.id,{node:M.node,value:null===(D=M.node.animate)||void 0===D?void 0:D.out,nodeStatus:M.nodeStatus,slideStatus:M.slideStatus},()=>{A.addClass("hide")})}};ct(1)}},157:(ae,Rt,v)=>{v.d(Rt,{R:()=>lt});var N=v(4981),O=v(70);const lt=(et,u,_,M,k)=>{var m,A,S,Q,G,K,q;if(M.slideStatus!=O.$.slideStatus)return u.async&&"change-slide"!=u.async?void 0:void k();if(M.nodeStatus!=O.$.nodeStatus&&(!u.async||"change-node"==u.async))return void k();if(!(null!==(m=u.source)&&void 0!==m&&m.path||null!==(A=u.source)&&void 0!==A&&A.url))return console.warn(`${et} -> audio no source!`),k(),void(k=()=>{});var T=jQuery("#"+et);let Y=null!==(S=u.iteration)&&void 0!==S?S:0;if(Y<0&&(k(),k=function(){}),!(T.data("audio-running")&&Y<0)){T.data("audio-running",!0);var F=function(ct){ct.pause(),ct.remove(),T.data("audio-running",!1)},ft=new Audio;return ft.autoplay=!0,ft.loop=0!=Y,ft.preload="auto",ft.controls=!0,ft.setAttributeNode(document.createAttribute("playsinline")),ft.addEventListener("canplay",function(){var ct=ft.play();ct&&ct.then(function(dt){var D;T.data("audio-running",!0),"time"==u.async?setTimeout(()=>{F(ft),k(),k=()=>{}},1e3*(null!==(D=u.time)&&void 0!==D?D:1)):"non-stop"==u.async&&(k(),k=()=>{})}).catch(function(dt){T.data("audio-running",!1),M.slideStatus===O.$.slideStatus&&(k(),k=()=>{})})}),ft.addEventListener("timeupdate",function(){switch(u.async){case"time":case"non-stop":break;case"finish-action":_.total>=2&&_.total-_.counter==1&&(F(this),k(),k=()=>{});break;default:case"change-node":M.nodeStatus!==O.$.nodeStatus&&(F(this),k(),k=()=>{});break;case"change-slide":M.slideStatus!==O.$.slideStatus&&(F(this),k(),k=()=>{})}}),ft.addEventListener("canplaythrough",function(){this.loop&&(Y>0?Y--:0==Y&&(this.loop=!1))}),ft.addEventListener("play",function(){}),ft.addEventListener("pause",function(){}),ft.addEventListener("ended",function(){this.remove(),T.data("audio-running",!1),M.slideStatus===O.$.slideStatus&&(k(),k=()=>{})}),ft.onerror=function(){this.remove(),T.data("audio-running",!1),M.slideStatus===O.$.slideStatus&&(k(),k=()=>{})},ft.src=(null!==(Q=u.source)&&void 0!==Q&&Q.path?(null===(G=N.icdt.config)||void 0===G?void 0:G.readfileuploadurl)+(null===(K=u.source)||void 0===K?void 0:K.path):null===(q=u.source)||void 0===q?void 0:q.url)||"",ft}}},5973:(ae,Rt,v)=>{v.d(Rt,{F:()=>k});var N=v(4981),O=v(70),lt=v(2336),C=v(861),et=v(157),u=v(4787),_=v(370),M=v(7267);const k=(m,A,S,Q)=>{var G,K,q;let T={total:0,counter:0},{triggershow:Y,triggerrun:F,triggerhide:ft,action:ct,audio:dt,slide:D,media:Ot}=null!==(G=null===(K=m.interactive)||void 0===K?void 0:K.click)&&void 0!==G?G:{};if(Y){let{id:jt,ids:rt,time:j,async:yt}=Y;"asynctrue"==yt?(0,u.L5)({id:jt,ids:rt,nodeStatus:A,slideStatus:S}):"time"==yt&&setTimeout(()=>{(0,u.L5)({id:jt,ids:rt,nodeStatus:A,slideStatus:S})},1e3*(null!=j?j:0))}if(F){let{id:jt,ids:rt,time:j,async:yt}=F;"asynctrue"==yt?(0,u.Ar)({id:jt,ids:rt,nodeStatus:A,slideStatus:S}):"time"==yt&&setTimeout(()=>{(0,u.Ar)({id:jt,ids:rt,nodeStatus:A,slideStatus:S})},1e3*(null!=j?j:0))}if(ft){let{id:jt,ids:rt,time:j,async:yt}=ft;"asynctrue"==yt?(0,u.WT)({id:jt,ids:rt,nodeStatus:A,slideStatus:S}):"time"==yt&&setTimeout(()=>{(0,u.WT)({id:jt,ids:rt,nodeStatus:A,slideStatus:S})},1e3*(null!=j?j:0))}let Wt=()=>{setTimeout(()=>{if(T.counter>=T.total){if(Q&&Q(),Y){let{id:jt,ids:rt,async:j}=Y;(!j||"asyncfalse"==j)&&(0,u.L5)({id:jt,ids:rt,nodeStatus:A,slideStatus:S})}if(F){let{id:jt,ids:rt,async:j}=F;(!j||"asyncfalse"==j)&&(0,u.Ar)({id:jt,ids:rt,nodeStatus:A,slideStatus:S})}if(ft){let{id:jt,ids:rt,async:j}=ft;(!j||"asyncfalse"==j)&&(0,u.WT)({id:jt,ids:rt,nodeStatus:A,slideStatus:S})}}})};if(null!=ct&&ct.value){T.total+=1;let jt=()=>{T.counter+=1,Wt()};switch(null==ct?void 0:ct.value){case"hide":var Ut;(0,M.E)(m.id,{node:m,value:null===(Ut=m.animate)||void 0===Ut?void 0:Ut.out,nodeStatus:A,slideStatus:S},()=>{jQuery("#"+m.id).addClass("hide"),jt()});break;case"points":{let{points:rt,time:j,iteration:yt,finish:St}=ct;rt&&(0,C.G)(m.id,{node:m,points:rt,time:j,iteration:yt,finish:St,nodeStatus:A,slideStatus:S},jt);break}default:{let{value:rt,time:j,iteration:yt,finish:St}=ct;(0,lt.Q)(m.id,{node:m,value:rt,time:j,iteration:yt,finish:St,nodeStatus:A,slideStatus:S},jt);break}}}if(null!=dt&&null!==(q=dt.source)&&void 0!==q&&q.path){T.total+=1;let jt=()=>{T.counter+=1,Wt()};(0,et.R)(m.id,dt,T,{nodeStatus:A,slideStatus:S},jt)}if(T.total||Wt(),null!=D&&D.id)switch(console.log(`InteractiveNode #${m.id} slide(undefined,${D.id},${D.code}) success!`),D.id){case-1:O.$.runSlide(O.$.slideIdx-1);break;case-2:O.$.runSlide(O.$.slideIdx+1);break;default:var Lt;O.$.runSlide(void 0,D.id,null===(Lt=D.code)||void 0===Lt?void 0:Lt.toString())}if(null!=Ot&&Ot.type){var Pt;let rt=`<div class="popup-media-viewer"><iframe src="${(0,_.e)({readfileuploadurl:null===(Pt=N.icdt.config)||void 0===Pt?void 0:Pt.readfileuploadurl,type:null==Ot?void 0:Ot.type,oss:null==Ot?void 0:Ot.oss,path:null==Ot?void 0:Ot.path,url:null==Ot?void 0:Ot.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,j=jQuery(rt).appendTo(window.document.body);j.find(".btn-close").click(function(yt){yt.preventDefault(),j.remove()})}}},4787:(ae,Rt,v)=>{v.d(Rt,{Ar:()=>et,L5:()=>C,WT:()=>u});var N=v(70),O=v(5973),lt=v(7267);const C=_=>{console.log("icdt_Run_Interactive_TriggerShow",_),_.id?jQuery("#"+_.id).removeClass("hide"):_.ids&&_.ids.forEach(M=>{jQuery("#"+M).removeClass("hide")})},et=_=>{console.log("icdt_Run_Interactive_TriggerRun",_),_.id?(jQuery("#"+_.id).removeClass("hide"),(0,O.F)(N.$.findNode(_.id),_.nodeStatus,_.slideStatus)):_.ids&&_.ids.forEach(M=>{jQuery("#"+M).removeClass("hide"),(0,O.F)(N.$.findNode(M),_.nodeStatus,_.slideStatus)})},u=_=>{if(console.log("icdt_Run_Interactive_TriggerHide",_),_.id){var M;let k=N.$.findNode(_.id);(0,lt.E)(_.id,{node:k,value:null===(M=k.animate)||void 0===M?void 0:M.out,nodeStatus:_.nodeStatus,slideStatus:_.slideStatus},()=>{jQuery("#"+_.id).addClass("hide")})}else _.ids&&_.ids.forEach(k=>{var m;let A=N.$.findNode(k);(0,lt.E)(k,{node:A,value:null===(m=A.animate)||void 0===m?void 0:m.out,nodeStatus:_.nodeStatus,slideStatus:_.slideStatus},()=>{jQuery("#"+k).addClass("hide")})})}},7492:(ae,Rt,v)=>{v.d(Rt,{Mh:()=>F,wM:()=>dt,xo:()=>ft,it:()=>D,g1:()=>Pt,__:()=>Ot,QI:()=>Ut,DB:()=>Wt,eb:()=>ct,x0:()=>_t,g$:()=>jt,mo:()=>Kt,XH:()=>St,hJ:()=>rt,vl:()=>yt,yD:()=>j,Yw:()=>le});var N=v(9054),O=v(1687),lt=v(9359),et=/^#?[a-fA-F0-9]+$/;const M=(J,X)=>{var d;if("none"==(J=null!==(d=J)&&void 0!==d?d:""))return"none";if("transparent"==J)return"rgba(0,0,0,0)";if(J.includes("rgba("))return J;if(J.includes("rgb(")&&(J=(0,lt.E)(J)),!(J=J.replace(/[^0-9a-fA-F]/g,"")))return"";if(!et.test(J))return console.error(`hex2rgba -> ${J}: first argument has invalid hexadecimal characters`),"";if("#"===J[0]&&(J=J.slice(1)),3===J.length){let bt=J.split("");bt.splice(2,0,J[2]),bt.splice(1,0,J[1]),bt.splice(0,0,J[0]),J=bt.join("")}if(6!==J.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var tt=[parseInt(J.slice(0,2),16),parseInt(J.slice(2,4),16),parseInt(J.slice(4,6),16)];return X="number"==typeof X?X:parseFloat(X),tt.push(X>=0&&X<=1?X:1),"rgba("+tt.join(",")+")"};var k=v(370),m=v(1814),A=v(4981),S=v(3423),Q=v(8054),G=v(7210),K=v(8619),q=v(70),T=v(2875),Y=v(1105);class F{constructor(X,d){let tt=window.document.querySelector(d);var bt;tt||(tt=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(bt=window.document.querySelector(X))||void 0===bt||bt.appendChild(tt));let{svgViewBox:Et,svgSize:At}=A.icdt.screen.init();tt.setAttributeNS(null,"viewBox",`${Et.x} ${Et.y} ${Et.width} ${Et.height}`),tt.setAttribute("id",d.replace("#","")),tt.style.display="block",tt.style.width=`${At.width}px`,tt.style.height=`${At.height}px`,tt.style.backgroundColor="#fafafa",tt.style.cursor="default"}}const ft=J=>{jQuery(A.icdt.target).find("#"+O.O.BACKGROUND_GROUP).empty();let X=Pt(O.O.BACKGROUND_GROUP,"g",void 0,A.icdt.target);_t(X,J),(()=>{let d=window.document.getElementById(null==J?void 0:J.id);jQuery(d).find("#"+O.O.BACKGROUND_GROUP).empty();let tt=Pt(O.O.BACKGROUND_GROUP,"g",void 0,d);_t(tt,J)})()},ct=()=>{let J=A.icdt.screen.svgViewBox,X=A.icdt.screen.svgSize;A.icdt.target&&(A.icdt.target.setAttributeNS(null,"viewBox",`${J.x} ${J.y} ${J.width} ${J.height}`),A.icdt.target.style.left=`${X.x}px`,A.icdt.target.style.top=`${X.y}px`,A.icdt.target.style.width=`${X.width}px`,A.icdt.target.style.height=`${X.height}px`)},dt=()=>{jQuery(A.icdt.target).find(">*:not(defs)").remove()},D=(J,X,d,tt,bt)=>{let Et;return J?(Et=jQuery(bt||A.icdt.target).find("#"+J).get(0),Et||(Et=window.document.createElementNS("http://www.w3.org/2000/svg",d),Et.setAttribute("id",J),X==N.$.FOREIGNOBJECT&&Et.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(Et).appendTo(bt||A.icdt.target))):(Et=window.document.createElementNS("http://www.w3.org/2000/svg",d),jQuery(Et).appendTo(bt||A.icdt.target)),null!=tt&&tt.attribute&&Ot(Et,null==tt?void 0:tt.attribute),null!=tt&&tt.style&&Wt(Et,null==tt?void 0:tt.style),null!=tt&&tt.source&&Ut(Et,X,null==tt?void 0:tt.source),Et},Ot=(J,X)=>{return jQuery(J).attr((d=Object.assign({},X||{}),null===(tt=Object.keys(d))||void 0===tt||tt.forEach(At=>{switch(At){case"fill":break;case"stroke":var Qt;Object.assign(d,{"stroke-width":null!==(Qt=d.strokeWidth)&&void 0!==Qt?Qt:null,strokeWidth:null});break;case"strokeLinecap":var Ht;Object.assign(d,{"stroke-linecap":null!==(Ht=d.strokeLinecap)&&void 0!==Ht?Ht:null,strokeLinecap:null});break;case"strokeLinejoin":var Tt;Object.assign(d,{"stroke-linejoin":null!==(Tt=d.strokeLinejoin)&&void 0!==Tt?Tt:null,strokeLinejoin:null});break;case"strokeDasharray":var vt;Object.assign(d,{"stroke-dasharray":null!==(vt=d.strokeDasharray)&&void 0!==vt?vt:null,strokeDasharray:null});break;case"strokeDasharrays":var $t,H;Object.assign(d,{"stroke-dasharray":null!==($t=null===(H=d.strokeDasharrays)||void 0===H?void 0:H.join(" "))&&void 0!==$t?$t:null,strokeDasharrays:null});break;case"fontFamily":var c;Object.assign(d,{"font-family":null!==(c=d.fontFamily)&&void 0!==c?c:null,fontFamily:null});break;case"fontSize":var V;Object.assign(d,{"font-size":null!==(V=d.fontSize)&&void 0!==V?V:null,fontSize:null});break;case"textLength":Object.assign(d,{textLength:d.textLength?`${d.textLength}px`:null});break;case"transformOrigin":var at;Object.assign(d,{"transform-origin":null!==(at=d.transformOrigin)&&void 0!==at?at:null,transformOrigin:null})}}),Object.assign({},null!=d?d:{},{fill:null!=d&&d.fill?M(d.fill,null!==(bt=null==d?void 0:d.fillOpacity)&&void 0!==bt?bt:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=d&&d.stroke?M(d.stroke,null!==(Et=null==d?void 0:d.strokeOpacity)&&void 0!==Et?Et:1):"rgba(0,0,0,0)",strokeOpacity:null}))),J;var d,tt,bt,Et},Wt=(J,X)=>{return jQuery(J).css((d=Object.assign({},X||{}),null===(tt=Object.keys(d))||void 0===tt||tt.forEach(bt=>{switch(bt){case"padding":Object.assign(d,{padding:d.padding?`${d.padding}px`:null});break;case"borderWidth":var Et;Object.assign(d,d.borderWidth&&d.borderColor?{"border-width":`${d.borderWidth}px`,"border-style":d.borderStyle||"solid","border-color":M(d.borderColor,null!==(Et=d.borderOpacity)&&void 0!==Et?Et:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(d,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(d,{"border-radius":d.borderRadius?`${d.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var At;Object.assign(d,d.backgroundColor?{"background-color":M(d.backgroundColor,null!==(At=d.backgroundOpacity)&&void 0!==At?At:1)}:{"background-color":""}),Object.assign(d,{backgroundColor:null,backgroundOpacity:null})}}),d)),J;var d,tt},Ut=(J,X,d)=>{switch(X){case N.$.TEXT:var tt,bt;jQuery(J).text(null!==(tt=null==d||null===(bt=d.text)||void 0===bt?void 0:bt.textContent)&&void 0!==tt?tt:"");break;case N.$.IMAGE:var Et,At,Qt,Ht,Tt;jQuery(J).attr("href",(null==d||null===(Et=d.image)||void 0===Et?void 0:Et.base64)||(null!=d&&null!==(At=d.image)&&void 0!==At&&At.path?(null===(Qt=A.icdt.config)||void 0===Qt?void 0:Qt.readfileuploadurl)+(null==d||null===(Ht=d.image)||void 0===Ht?void 0:Ht.path):null==d||null===(Tt=d.image)||void 0===Tt?void 0:Tt.url)||"");break;case N.$.FOREIGNOBJECT:switch(null==d?void 0:d.type){case"text":var vt,$t;if(null!==(vt=d.text)&&void 0!==vt&&vt.variableKeywords&&null!==($t=d.text)&&void 0!==$t&&$t.variableKeywords.length){var H;let g=A.icdt.variable.getKeys(),y=(null===(H=d.text)||void 0===H?void 0:H.textContent)||"";d.text.variableKeywords.forEach(f=>{var E=f.replace(/[^a-zA-Z0-9_]/gm,"");if(g.indexOf(E)>=0){var p=A.icdt.variable.getValue(E);y=y.replace(f,p)}}),jQuery(J).text(y)}else{var c;jQuery(J).text((null===(c=d.text)||void 0===c?void 0:c.textContent)||"")}break;case"html":{var V,at,ot;let g=(null==d||null===(V=d.html)||void 0===V?void 0:V.htmlContent)||"";if(null!==(at=d.html)&&void 0!==at&&at.variableKeywords&&null!==(ot=d.html)&&void 0!==ot&&ot.variableKeywords.length){let y=A.icdt.variable.getKeys();d.html.variableKeywords.forEach(f=>{var E=f.replace(/[^a-zA-Z0-9_]/gm,"");if(y.indexOf(E)>=0){var p=A.icdt.variable.getValue(E);g=g.replace(f,p)}})}jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${g}</div>`).find("img[path],video[path],iframe[path]").each((y,f)=>{var E,p;f.setAttribute("src",(null!==(E=null===(p=A.icdt.config)||void 0===p?void 0:p.readfileuploadurl)&&void 0!==E?E:"")+f.getAttribute("path")),f.removeAttribute("path")});break}case"input":var Z,U,W,w;if(null!==(Z=d.input)&&void 0!==Z&&Z.input)jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(W=null===(w=d.input)||void 0===w?void 0:w.placeholder)&&void 0!==W?W:""}" maxlength="100" /></div>`);else if(null!==(U=d.input)&&void 0!==U&&U.textarea){var R,gt;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(R=null===(gt=d.input)||void 0===gt?void 0:gt.placeholder)&&void 0!==R?R:""}" maxlength="1000"></textarea></div>`)}break;case"image":var kt,pt,Mt,zt,Gt;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(kt=d.image)||void 0===kt?void 0:kt.base64)||(null!==(pt=d.image)&&void 0!==pt&&pt.path?(null===(Mt=A.icdt.config)||void 0===Mt?void 0:Mt.readfileuploadurl)+(null===(zt=d.image)||void 0===zt?void 0:zt.path):null===(Gt=d.image)||void 0===Gt?void 0:Gt.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var Vt,qt,ce,pe;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(Vt=d.iframe)&&void 0!==Vt&&Vt.path?(null===(qt=A.icdt.config)||void 0===qt?void 0:qt.readfileuploadurl)+(null===(ce=d.iframe)||void 0===ce?void 0:ce.path):null===(pe=d.iframe)||void 0===pe?void 0:pe.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var oe,se,xe,Qe,Pe;let g=(0,k.e)({readfileuploadurl:null===(oe=A.icdt.config)||void 0===oe?void 0:oe.readfileuploadurl,type:null===(se=d.embed)||void 0===se?void 0:se.type,oss:null===(xe=d.embed)||void 0===xe?void 0:xe.oss,path:null===(Qe=d.embed)||void 0===Qe?void 0:Qe.path,url:null===(Pe=d.embed)||void 0===Pe?void 0:Pe.url});jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${g}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var Ve,Je;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(Ve=null===(Je=d.svg)||void 0===Je?void 0:Je.svgContent)&&void 0!==Ve?Ve:""}</div>`);break;case"test":{var ei,Ee,Ze,De;let g=(null==d||null===(ei=d.html)||void 0===ei?void 0:ei.htmlContent)||"";if(null!==(Ee=d.html)&&void 0!==Ee&&Ee.variableKeywords&&null!==(Ze=d.html)&&void 0!==Ze&&Ze.variableKeywords.length){let y=A.icdt.variable.getKeys();d.html.variableKeywords.forEach(f=>{var E=f.replace(/[^a-zA-Z0-9_]/gm,"");if(y.indexOf(E)>=0){var p=A.icdt.variable.getValue(E);g=g.replace(f,p)}})}switch(null==d||null===(De=d.test)||void 0===De?void 0:De.type){case"truefalse":var Ue;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ue=d.test.truefalse)&&void 0!==Ue&&Ue.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"singlechoice":var Xe;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Xe=d.test.singlechoice)&&void 0!==Xe&&Xe.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"multichoice":var Ye;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ye=d.test.multichoice)&&void 0!==Ye&&Ye.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"matching-empty":var He;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==d||null===(He=d.test.matching)||void 0===He?void 0:He.key}"></div>`);break;case"matching-content":var Ge,qe,mt;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==d||null===(Ge=d.test.matching)||void 0===Ge?void 0:Ge.key}"><div class="ondrag-item" data-key="${null!==(qe=null==d||null===(mt=d.test)||void 0===mt||null===(mt=mt.matching)||void 0===mt?void 0:mt.key)&&void 0!==qe?qe:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div></div>`);break;case"fill":var I;((null===(I=d.html)||void 0===I?void 0:I.fillKeywords)||[]).forEach(y=>{var f=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${y.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;g=g.replace(new RegExp(y.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),f)}),jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${g}</div></div></div>`);break;case"speech":jQuery(J).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var i,n,r,a,o;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(i=null!==(n=d.image)&&void 0!==n&&n.path?(null===(r=A.icdt.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(a=d.image)||void 0===a?void 0:a.path):null===(o=d.image)||void 0===o?void 0:o.url)&&void 0!==i?i:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(J).find("img[path],video[path],iframe[path]").each((y,f)=>{var E,p;f.setAttribute("src",(null!==(E=null===(p=A.icdt.config)||void 0===p?void 0:p.readfileuploadurl)&&void 0!==E?E:"")+f.getAttribute("path")),f.removeAttribute("path")})}}}},Pt=(J,X,d,tt)=>{let bt=jQuery(tt||A.icdt.target).find("#"+J).get(0);return bt||(bt=window.document.createElementNS("http://www.w3.org/2000/svg",X),bt.setAttribute("id",J),jQuery(bt).appendTo(tt||A.icdt.target)),jQuery(bt).attr((null==d?void 0:d.attribute)||{}),jQuery(bt).css((null==d?void 0:d.style)||{}),bt},jt=(J,X)=>{let d=(0,S.v)(2),tt={fill:m.S3.fill,stroke:m.S3.stroke,"stroke-width":(0,S.v)(m.S3.strokeWidth)};return[{element:Pt("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:X.x-d,y:X.y-d,width:X.width+2*d,height:X.height+2*d},tt)},J),posType:"rect-center"}]},rt=(J,X)=>{let{size:d}=X,tt=(0,S.v)(1),bt=(0,S.v)(2),Et=(0,S.v)(5),At={stroke:m.NV.stroke,"stroke-width":(0,S.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},Qt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,S.v)(m.Mo.strokeWidth)},Ht={fill:m.In.fill,stroke:m.In.stroke,"stroke-width":(0,S.v)(m.In.strokeWidth),width:(0,S.v)(m.In.width),height:(0,S.v)(m.In.height)};return Pt("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:d.x-tt,y1:d.y,x2:d.x-tt,y2:d.y+d.height},At)},J),Pt("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-tt,x2:d.x+d.width,y2:d.y-tt},At)},J),Pt("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:d.x+d.width+tt,y1:d.y,x2:d.x+d.width+tt,y2:d.y+d.height},At)},J),Pt("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+tt,x2:d.x+d.width,y2:d.y+d.height+tt},At)},J),[{element:Pt("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Qt),style:{cursor:"move"}},J),posType:"rect-center"},{element:Pt("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:d.x-Et,y:d.y-Et},Ht),style:{cursor:"nw-resize"}},J),posType:"rect-top-left"},{element:Pt("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:d.x+d.width-bt,y:d.y-Et},Ht),style:{cursor:"ne-resize"}},J),posType:"rect-top-right"},{element:Pt("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:d.x-Et,y:d.y+d.height-bt},Ht),style:{cursor:"sw-resize"}},J),posType:"rect-bottom-left"},{element:Pt("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:d.x+d.width-bt,y:d.y+d.height-bt},Ht),style:{cursor:"se-resize"}},J),posType:"rect-bottom-right"},{element:Pt("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:d.x+d.width/2-bt-tt,y:d.y-Et},Ht),style:{cursor:"n-resize"}},J),posType:"rect-top"},{element:Pt("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:d.x+d.width-bt,y:d.y+d.height/2-bt-tt},Ht),style:{cursor:"e-resize"}},J),posType:"rect-right"},{element:Pt("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:d.x+d.width/2-bt-tt,y:d.y+d.height-bt},Ht),style:{cursor:"s-resize"}},J),posType:"rect-bottom"},{element:Pt("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:d.x-Et,y:d.y+d.height/2-bt-tt},Ht),style:{cursor:"w-resize"}},J),posType:"rect-left"}]},j=(J,X,d)=>{let tt=(0,S.v)(1),bt={stroke:m.NV.stroke,"stroke-width":(0,S.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},Et={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,S.v)(m.Mo.strokeWidth)},At={fill:m.dt.fill,stroke:m.dt.stroke,"stroke-width":(0,S.v)(m.dt.strokeWidth)},$t=(Pt("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:d.x-tt,y1:d.y,x2:d.x-tt,y2:d.y+d.height},bt)},J),Pt("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-tt,x2:d.x+d.width,y2:d.y-tt},bt)},J),Pt("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:d.x+d.width+tt,y1:d.y,x2:d.x+d.width+tt,y2:d.y+d.height},bt)},J),Pt("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+tt,x2:d.x+d.width,y2:d.y+d.height+tt},bt)},J),Pt("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Et)},J));return X.forEach(H=>{let{size:c}=H;Pt("icdt-temp-select-rect-node-"+H.id,"rect",{attribute:Object.assign({x:c.x,y:c.y,width:c.width,height:c.height},At)},J)}),[{element:$t,posType:"rect-center"}]},yt=(J,X)=>{let d=(0,S.v)(1),tt={stroke:m.NV.stroke,"stroke-width":(0,S.v)(m.NV.strokeWidth),"stroke-linecap":m.NV.strokeLinecap},bt={fill:m.Mo.fill,stroke:m.Mo.stroke,"stroke-width":(0,S.v)(m.Mo.strokeWidth)};return Pt("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:X.x-d,y1:X.y,x2:X.x-d,y2:X.y+X.height},tt)},J),Pt("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:X.x,y1:X.y-d,x2:X.x+X.width,y2:X.y-d},tt)},J),Pt("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:X.x+X.width+d,y1:X.y,x2:X.x+X.width+d,y2:X.y+X.height},tt)},J),Pt("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:X.x,y1:X.y+X.height+d,x2:X.x+X.width,y2:X.y+X.height+d},tt)},J),[{element:Pt("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:X.x,y:X.y,width:X.width,height:X.height},bt)},J),posType:"rect-center"}]},St=(J,X)=>((0,S.v)(-1),(0,S.v)(m.h8.strokeWidth),(0,S.v)(m.h8.strokeDasharray),Pt("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:X.x,y:X.y,width:X.width,height:X.height,class:"cursor-draw"},{fill:m.MA.fill})},J),[]),Kt=(J,X)=>{let d={fill:m.k0.fill,stroke:m.k0.stroke,"stroke-width":(0,S.v)(m.k0.strokeWidth),"stroke-dasharray":(0,S.v)(m.k0.strokeDasharray)};jQuery(J).empty(),X.forEach(tt=>{var bt,Et;let{size:At}=tt;if(!tt.idx)return;Pt("icdt-temp-index-rect-node-"+tt.id,"rect",{attribute:Object.assign({x:At.x-5,y:At.y-5,width:At.width+10,height:At.height+10},d)},J);let{element:Qt}=(0,T.e)(Math.ceil(1e9*Math.random()),{size:{x:At.x-76,y:At.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(bt=tt.idx)&&void 0!==bt?bt:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(Et=tt.time)&&void 0!==Et?Et:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},J);Qt.classList.add("node-input"),jQuery(Qt).on("change",'input[name="idx"]',Ht=>{var Tt;tt.idx=parseInt(null!==(Tt=Ht.target.value)&&void 0!==Tt?Tt:"0")}).on("change",'input[name="time"]',Ht=>{var Tt;tt.time=parseFloat(null!==(Tt=Ht.target.value)&&void 0!==Tt?Tt:"0")}).on("click",'button[name="remove"]',Ht=>{tt.idx=0,tt.time=null,Kt(J,X)})})},_t=(J,X)=>{var d,tt,bt,Et,At,Qt;let{color:Ht,opacity:Tt,path:vt,url:$t,base64:H}=null!==(d=null==X||null===(tt=X.svg)||void 0===tt?void 0:tt.background)&&void 0!==d?d:{},{x:c,y:V,width:at,height:ot}=null!==(bt=null==X||null===(Et=X.svg)||void 0===Et?void 0:Et.viewBox)&&void 0!==bt?bt:{x:0,y:0,width:0,height:0};(0,Y.$)(void 0,{size:{x:0,y:-7,width:at,height:ot},attribute:{fill:"#999",fontSize:14,class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(At=null!==(Qt=null==X?void 0:X.name)&&void 0!==Qt?Qt:null==X?void 0:X.code)&&void 0!==At?At:void 0}}},J),(0,Q.f)(void 0,{size:{x:c,y:V,width:at,height:ot},attribute:{fill:"#fff",stroke:"#999",strokeWidth:1,strokeDasharray:10,class:"hide-on-viewer"}},J),Ht&&(0,Q.f)(void 0,{size:{x:c,y:V,width:at,height:ot},attribute:{fill:Ht,fillOpacity:Tt}},J),vt&&(0,G.G)(void 0,{size:{x:c,y:V,width:at,height:ot},source:{type:"image",image:{path:vt,url:$t,base64:H}}},J)},le=(J,X)=>{var d;switch(jQuery(J).empty(),null===(d=X.test)||void 0===d?void 0:d.type){case"truefalse":{var tt,bt,Et,At;let Z=null==X||null===(tt=X.test)||void 0===tt||null===(tt=tt.answer)||void 0===tt||null===(tt=tt.truefalse)||void 0===tt?void 0:tt.value,U=null===(bt=X.svg)||void 0===bt?void 0:bt.nodes.find(W=>{var w;return"submit"==(null===(w=W.source)||void 0===w||null===(w=w.test)||void 0===w?void 0:w.type)});null===(Et=X.svg)||void 0===Et||Et.nodes.filter(W=>{var w;return"truefalse"==(null===(w=W.source)||void 0===w||null===(w=w.test)||void 0===w?void 0:w.type)&&(W.id!=Z||!U)}).forEach(W=>{var w;let{x:gt,y:kt,width:pt,height:Mt}=null!==(w=null==W?void 0:W.size)&&void 0!==w?w:{x:0,y:0,width:0,height:0};(0,K._)(Math.ceil(1e9*Math.random()),{size:{x:gt-.5,y:kt-.5,width:pt+1,height:Mt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},J)}),null!=X&&null!==(At=X.test)&&void 0!==At&&null!==(At=At.answer)&&void 0!==At&&At.truefalse&&Z&&U&&(W=>{let w=q.$.findNode(Z),{x:gt,y:kt,width:pt,height:Mt}=null!==(W=null==w?void 0:w.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,K._)(Math.ceil(1e9*Math.random()),{size:{x:gt-2,y:kt-2,width:pt+4,height:Mt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},J)})();break}case"singlechoice":{var Qt,Ht,Tt,vt;let Z=null==X||null===(Qt=X.test)||void 0===Qt||null===(Qt=Qt.answer)||void 0===Qt||null===(Qt=Qt.singlechoice)||void 0===Qt?void 0:Qt.value,U=null===(Ht=X.svg)||void 0===Ht?void 0:Ht.nodes.find(W=>{var w;return"submit"==(null===(w=W.source)||void 0===w||null===(w=w.test)||void 0===w?void 0:w.type)});null===(Tt=X.svg)||void 0===Tt||Tt.nodes.filter(W=>{var w;return"singlechoice"==(null===(w=W.source)||void 0===w||null===(w=w.test)||void 0===w?void 0:w.type)&&(W.id!=Z||!U)}).forEach(W=>{var w;let{x:gt,y:kt,width:pt,height:Mt}=null!==(w=null==W?void 0:W.size)&&void 0!==w?w:{x:0,y:0,width:0,height:0};(0,K._)(Math.ceil(1e9*Math.random()),{size:{x:gt-.5,y:kt-.5,width:pt+1,height:Mt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},J)}),null!=X&&null!==(vt=X.test)&&void 0!==vt&&null!==(vt=vt.answer)&&void 0!==vt&&vt.singlechoice&&Z&&U&&(W=>{let w=q.$.findNode(Z),{x:gt,y:kt,width:pt,height:Mt}=null!==(W=null==w?void 0:w.size)&&void 0!==W?W:{x:0,y:0,width:0,height:0};(0,K._)(Math.ceil(1e9*Math.random()),{size:{x:gt-2,y:kt-2,width:pt+4,height:Mt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},J)})();break}case"multichoice":{var $t,H,c,V,at;let Z=null!==($t=null==X||null===(H=X.test)||void 0===H||null===(H=H.answer)||void 0===H||null===(H=H.multichoice)||void 0===H?void 0:H.map(W=>W.value))&&void 0!==$t?$t:[],U=null===(c=X.svg)||void 0===c?void 0:c.nodes.find(W=>{var w;return"submit"==(null===(w=W.source)||void 0===w||null===(w=w.test)||void 0===w?void 0:w.type)});var ot;null===(V=X.svg)||void 0===V||V.nodes.filter(W=>{var w;return!("multichoice"!=(null===(w=W.source)||void 0===w||null===(w=w.test)||void 0===w?void 0:w.type)||Z.includes(W.id)&&U)}).forEach(W=>{var w;let{x:gt,y:kt,width:pt,height:Mt}=null!==(w=null==W?void 0:W.size)&&void 0!==w?w:{x:0,y:0,width:0,height:0};(0,Q.f)(Math.ceil(1e9*Math.random()),{size:{x:gt-.5,y:kt-.5,width:pt+1,height:Mt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},J)}),null!=X&&null!==(at=X.test)&&void 0!==at&&null!==(at=at.answer)&&void 0!==at&&at.multichoice&&Z.length&&U&&(null==X||null===(ot=X.test)||void 0===ot||null===(ot=ot.answer)||void 0===ot||ot.multichoice.forEach(W=>{var w;let R=q.$.findNode(W.value),{x:kt,y:pt,width:Mt,height:zt}=null!==(w=null==R?void 0:R.size)&&void 0!==w?w:{x:0,y:0,width:0,height:0};(0,Q.f)(Math.ceil(1e9*Math.random()),{size:{x:kt-2,y:pt-2,width:Mt+4,height:zt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},J)}));break}}}},370:(ae,Rt,v)=>{v.d(Rt,{e:()=>lt});const lt=u=>{switch(null==u?void 0:u.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+u.readfileuploadurl+u.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+u.readfileuploadurl+u.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+u.readfileuploadurl+u.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+u.readfileuploadurl+u.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+u.readfileuploadurl+u.path;case 906:case 911:case 910:return""+u.readfileuploadurl+u.path;case 905:case 912:var _;return"imsmanifest.xml"==(null===(_=u.path)||void 0===_||null===(_=_.split("/"))||void 0===_?void 0:_.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+u.readfileuploadurl+u.path:""+u.readfileuploadurl+u.path;case 907:case 900:return""+u.readfileuploadurl+u.path;case 904:switch(u.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+u.url;case 1002:var M;return null!==(M=C(u.url))&&void 0!==M?M:"";case 1005:var k;return null!==(k=u.url)&&void 0!==k?k:"";default:var m;return null!==(m=u.url)&&void 0!==m?m:""}default:return""+u.readfileuploadurl+u.path}},C=u=>{let _=et(u);return _?"https://www.youtube.com/embed/"+_+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},et=u=>{let _=null==u?void 0:u.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return _&&_.length>=2?_[1]:null}},511:(ae,Rt,v)=>{function N(){}function O(t){return null==t?N:function(){return this.querySelector(t)}}function et(){return[]}function u(t){return null==t?et:function(){return this.querySelectorAll(t)}}function k(t){return function(){return this.matches(t)}}function m(t){return function(e){return e.matches(t)}}v.d(Rt,{$0Z:()=>aa,jvg:()=>la});var A=Array.prototype.find;function Q(){return this.firstElementChild}var K=Array.prototype.filter;function q(){return Array.from(this.children)}function ft(t){return new Array(t.length)}function dt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ot(t,e,l,s,h,b){for(var L,x=0,B=e.length,nt=b.length;x<nt;++x)(L=e[x])?(L.__data__=b[x],s[x]=L):l[x]=new dt(t,b[x]);for(;x<B;++x)(L=e[x])&&(h[x]=L)}function Wt(t,e,l,s,h,b,x){var L,B,Xt,nt=new Map,ht=e.length,Dt=b.length,Bt=new Array(ht);for(L=0;L<ht;++L)(B=e[L])&&(Bt[L]=Xt=x.call(B,B.__data__,L,e)+"",nt.has(Xt)?h[L]=B:nt.set(Xt,B));for(L=0;L<Dt;++L)Xt=x.call(t,b[L],L,b)+"",(B=nt.get(Xt))?(s[L]=B,B.__data__=b[L],nt.delete(Xt)):l[L]=new dt(t,b[L]);for(L=0;L<ht;++L)(B=e[L])&&nt.get(Bt[L])===B&&(h[L]=B)}function Ut(t){return t.__data__}function Pt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Kt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}dt.prototype={constructor:dt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var bt="http://www.w3.org/1999/xhtml";const Et={svg:"http://www.w3.org/2000/svg",xhtml:bt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function At(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),Et.hasOwnProperty(e)?{space:Et[e],local:t}:t}function Qt(t){return function(){this.removeAttribute(t)}}function Ht(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Tt(t,e){return function(){this.setAttribute(t,e)}}function vt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function $t(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function H(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function V(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function at(t){return function(){this.style.removeProperty(t)}}function ot(t,e,l){return function(){this.style.setProperty(t,e,l)}}function Z(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function W(t,e){return t.style.getPropertyValue(e)||V(t).getComputedStyle(t,null).getPropertyValue(e)}function w(t){return function(){delete this[t]}}function R(t,e){return function(){this[t]=e}}function gt(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function pt(t){return t.trim().split(/^|\s+/)}function Mt(t){return t.classList||new zt(t)}function zt(t){this._node=t,this._names=pt(t.getAttribute("class")||"")}function Gt(t,e){for(var l=Mt(t),s=-1,h=e.length;++s<h;)l.add(e[s])}function Vt(t,e){for(var l=Mt(t),s=-1,h=e.length;++s<h;)l.remove(e[s])}function qt(t){return function(){Gt(this,t)}}function ce(t){return function(){Vt(this,t)}}function pe(t,e){return function(){(e.apply(this,arguments)?Gt:Vt)(this,t)}}function se(){this.textContent=""}function xe(t){return function(){this.textContent=t}}function Qe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ve(){this.innerHTML=""}function Je(t){return function(){this.innerHTML=t}}function ei(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ze(){this.nextSibling&&this.parentNode.appendChild(this)}function Ue(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ye(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===bt&&e.documentElement.namespaceURI===bt?e.createElement(t):e.createElementNS(l,t)}}function He(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ge(t){var e=At(t);return(e.local?He:Ye)(e)}function mt(){return null}function i(){var t=this.parentNode;t&&t.removeChild(this)}function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function a(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function E(t){return function(){var e=this.__on;if(e){for(var b,l=0,s=-1,h=e.length;l<h;++l)b=e[l],t.type&&b.type!==t.type||b.name!==t.name?e[++s]=b:this.removeEventListener(b.type,b.listener,b.options);++s?e.length=s:delete this.__on}}}function p(t,e,l){return function(){var h,s=this.__on,b=function y(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var x=0,L=s.length;x<L;++x)if((h=s[x]).type===t.type&&h.name===t.name)return this.removeEventListener(h.type,h.listener,h.options),this.addEventListener(h.type,h.listener=b,h.options=l),void(h.value=e);this.addEventListener(t.type,b,l),h={type:t.type,name:t.name,value:e,listener:b,options:l},s?s.push(h):this.__on=[h]}}function P(t,e,l){var s=V(t),h=s.CustomEvent;"function"==typeof h?h=new h(e,l):(h=s.document.createEvent("Event"),l?(h.initEvent(e,l.bubbles,l.cancelable),h.detail=l.detail):h.initEvent(e,!1,!1)),t.dispatchEvent(h)}function st(t,e){return function(){return P(this,t,e)}}function ut(t,e){return function(){return P(this,t,e.apply(this,arguments))}}zt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Zt=[null];function fe(t,e){this._groups=t,this._parents=e}function ge(){return new fe([[document.documentElement]],Zt)}fe.prototype=ge.prototype={constructor:fe,select:function lt(t){"function"!=typeof t&&(t=O(t));for(var e=this._groups,l=e.length,s=new Array(l),h=0;h<l;++h)for(var B,nt,b=e[h],x=b.length,L=s[h]=new Array(x),ht=0;ht<x;++ht)(B=b[ht])&&(nt=t.call(B,B.__data__,ht,b))&&("__data__"in B&&(nt.__data__=B.__data__),L[ht]=nt);return new fe(s,this._parents)},selectAll:function M(t){t="function"==typeof t?function _(t){return function(){return function C(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):u(t);for(var e=this._groups,l=e.length,s=[],h=[],b=0;b<l;++b)for(var B,x=e[b],L=x.length,nt=0;nt<L;++nt)(B=x[nt])&&(s.push(t.call(B,B.__data__,nt,x)),h.push(B));return new fe(s,h)},selectChild:function G(t){return this.select(null==t?Q:function S(t){return function(){return A.call(this.children,t)}}("function"==typeof t?t:m(t)))},selectChildren:function Y(t){return this.selectAll(null==t?q:function T(t){return function(){return K.call(this.children,t)}}("function"==typeof t?t:m(t)))},filter:function F(t){"function"!=typeof t&&(t=k(t));for(var e=this._groups,l=e.length,s=new Array(l),h=0;h<l;++h)for(var B,b=e[h],x=b.length,L=s[h]=[],nt=0;nt<x;++nt)(B=b[nt])&&t.call(B,B.__data__,nt,b)&&L.push(B);return new fe(s,this._parents)},data:function Lt(t,e){if(!arguments.length)return Array.from(this,Ut);var l=e?Wt:Ot,s=this._parents,h=this._groups;"function"!=typeof t&&(t=function D(t){return function(){return t}}(t));for(var b=h.length,x=new Array(b),L=new Array(b),B=new Array(b),nt=0;nt<b;++nt){var ht=s[nt],Dt=h[nt],Bt=Dt.length,Xt=Pt(t.call(ht,ht&&ht.__data__,nt,s)),me=Xt.length,Oe=L[nt]=new Array(me),Nt=x[nt]=new Array(me);l(ht,Dt,Oe,Nt,B[nt]=new Array(Bt),Xt,e);for(var de,ve,ie=0,Yt=0;ie<me;++ie)if(de=Oe[ie]){for(ie>=Yt&&(Yt=ie+1);!(ve=Nt[Yt])&&++Yt<me;);de._next=ve||null}}return(x=new fe(x,s))._enter=L,x._exit=B,x},enter:function ct(){return new fe(this._enter||this._groups.map(ft),this._parents)},exit:function jt(){return new fe(this._exit||this._groups.map(ft),this._parents)},join:function rt(t,e,l){var s=this.enter(),h=this,b=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(h=e(h))&&(h=h.selection()),null==l?b.remove():l(b),s&&h?s.merge(h).order():h},merge:function j(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,h=l.length,x=Math.min(h,s.length),L=new Array(h),B=0;B<x;++B)for(var Xt,nt=l[B],ht=s[B],Dt=nt.length,Bt=L[B]=new Array(Dt),me=0;me<Dt;++me)(Xt=nt[me]||ht[me])&&(Bt[me]=Xt);for(;B<h;++B)L[B]=l[B];return new fe(L,this._parents)},selection:function we(){return this},order:function yt(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var x,s=t[e],h=s.length-1,b=s[h];--h>=0;)(x=s[h])&&(b&&4^x.compareDocumentPosition(b)&&b.parentNode.insertBefore(x,b),b=x);return this},sort:function St(t){function e(Dt,Bt){return Dt&&Bt?t(Dt.__data__,Bt.__data__):!Dt-!Bt}t||(t=Kt);for(var l=this._groups,s=l.length,h=new Array(s),b=0;b<s;++b){for(var nt,x=l[b],L=x.length,B=h[b]=new Array(L),ht=0;ht<L;++ht)(nt=x[ht])&&(B[ht]=nt);B.sort(e)}return new fe(h,this._parents).order()},call:function _t(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function le(){return Array.from(this)},node:function J(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],h=0,b=s.length;h<b;++h){var x=s[h];if(x)return x}return null},size:function X(){let t=0;for(const e of this)++t;return t},empty:function d(){return!this.node()},each:function tt(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var L,h=e[l],b=0,x=h.length;b<x;++b)(L=h[b])&&t.call(L,L.__data__,b,h);return this},attr:function c(t,e){var l=At(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?Ht:Qt:"function"==typeof e?l.local?H:$t:l.local?vt:Tt)(l,e))},style:function U(t,e,l){return arguments.length>1?this.each((null==e?at:"function"==typeof e?Z:ot)(t,e,null==l?"":l)):W(this.node(),t)},property:function kt(t,e){return arguments.length>1?this.each((null==e?w:"function"==typeof e?gt:R)(t,e)):this.node()[t]},classed:function oe(t,e){var l=pt(t+"");if(arguments.length<2){for(var s=Mt(this.node()),h=-1,b=l.length;++h<b;)if(!s.contains(l[h]))return!1;return!0}return this.each(("function"==typeof e?pe:e?qt:ce)(l,e))},text:function Pe(t){return arguments.length?this.each(null==t?se:("function"==typeof t?Qe:xe)(t)):this.node().textContent},html:function Ee(t){return arguments.length?this.each(null==t?Ve:("function"==typeof t?ei:Je)(t)):this.node().innerHTML},raise:function De(){return this.each(Ze)},lower:function Xe(){return this.each(Ue)},append:function qe(t){var e="function"==typeof t?t:Ge(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function I(t,e){var l="function"==typeof t?t:Ge(t),s=null==e?mt:"function"==typeof e?e:O(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function n(){return this.each(i)},clone:function o(t){return this.select(t?a:r)},datum:function g(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function z(t,e,l){var h,x,s=function f(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),b=s.length;if(!(arguments.length<2)){for(L=e?p:E,h=0;h<b;++h)this.each(L(s[h],e,l));return this}var L=this.node().__on;if(L)for(var ht,B=0,nt=L.length;B<nt;++B)for(h=0,ht=L[B];h<b;++h)if((x=s[h]).type===ht.type&&x.name===ht.name)return ht.value},dispatch:function wt(t,e){return this.each(("function"==typeof e?ut:st)(t,e))},[Symbol.iterator]:function*It(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var x,s=t[e],h=0,b=s.length;h<b;++h)(x=s[h])&&(yield x)}};const ye=ge;var Se={value:()=>{}};function vn(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new Ri(l)}function Ri(t){this._=t}function ar(t,e){for(var h,l=0,s=t.length;l<s;++l)if((h=t[l]).name===e)return h.value}function gn(t,e,l){for(var s=0,h=t.length;s<h;++s)if(t[s].name===e){t[s]=Se,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}Ri.prototype=vn.prototype={constructor:Ri,on:function(t,e){var h,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",h=l.indexOf(".");if(h>=0&&(s=l.slice(h+1),l=l.slice(0,h)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),b=-1,x=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++b<x;)if(h=(t=s[b]).type)l[h]=gn(l[h],t.name,e);else if(null==e)for(h in l)l[h]=gn(l[h],t.name,null);return this}for(;++b<x;)if((h=(t=s[b]).type)&&(h=ar(l[h],t.name)))return h},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Ri(t)},call:function(t,e){if((h=arguments.length-2)>0)for(var h,b,l=new Array(h),s=0;s<h;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,h=(b=this._[t]).length;s<h;++s)b[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],h=0,b=s.length;h<b;++h)s[h].value.apply(e,l)}};const or=vn;var Ni,Oi,gi=0,xi=0,Ei=0,yn=1e3,Li=0,ui=0,Di=0,Si="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return ui||(pn(sr),ui=Si.now()+Di)}function sr(){ui=0}function ji(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new ji;return s.restart(t,e,l),s}function _n(){ui=(Li=Si.now())+Di,gi=xi=0;try{!function dr(){Xi(),++gi;for(var e,t=Ni;t;)(e=ui-t._time)>=0&&t._call.call(void 0,e),t=t._next;--gi}()}finally{gi=0,function hr(){for(var t,l,e=Ni,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Ni=l);Oi=t,Yi(s)}(),ui=0}}function ur(){var t=Si.now(),e=t-Li;e>yn&&(Di-=e,Li=t)}function Yi(t){gi||(xi&&(xi=clearTimeout(xi)),t-ui>24?(t<1/0&&(xi=setTimeout(_n,t-Si.now()-Di)),Ei&&(Ei=clearInterval(Ei))):(Ei||(Li=Si.now(),Ei=setInterval(ur,yn)),gi=1,pn(_n)))}function wn(t,e,l){var s=new ji;return s.restart(h=>{s.stop(),t(h+e)},e=null==e?0:+e,l),s}ji.prototype=mn.prototype={constructor:ji,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Xi():+l)+(null==e?0:+e),!this._next&&Oi!==this&&(Oi?Oi._next=this:Ni=this,Oi=this),this._call=t,this._time=l,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,zi=3;function Ki(t,e,l,s,h,b){var x=t.__transition;if(x){if(l in x)return}else t.__transition={};!function vr(t,e,l){var h,s=t.__transition;function x(nt){var ht,Dt,Bt,Xt;if(1!==l.state)return B();for(ht in s)if((Xt=s[ht]).name===l.name){if(Xt.state===zi)return wn(x);4===Xt.state?(Xt.state=6,Xt.timer.stop(),Xt.on.call("interrupt",t,t.__data__,Xt.index,Xt.group),delete s[ht]):+ht<e&&(Xt.state=6,Xt.timer.stop(),Xt.on.call("cancel",t,t.__data__,Xt.index,Xt.group),delete s[ht])}if(wn(function(){l.state===zi&&(l.state=4,l.timer.restart(L,l.delay,l.time),L(nt))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=zi,h=new Array(Bt=l.tween.length),ht=0,Dt=-1;ht<Bt;++ht)(Xt=l.tween[ht].value.call(t,t.__data__,l.index,l.group))&&(h[++Dt]=Xt);h.length=Dt+1}}function L(nt){for(var ht=nt<l.duration?l.ease.call(null,nt/l.duration):(l.timer.restart(B),l.state=5,1),Dt=-1,Bt=h.length;++Dt<Bt;)h[Dt].call(t,ht);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),B())}function B(){for(var nt in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function b(nt){l.state=1,l.timer.restart(x,l.delay,l.time),l.delay<=nt&&x(nt-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:h,on:cr,tween:fr,time:b.time,delay:b.delay,duration:b.duration,ease:b.ease,timer:null,state:bn})}function tn(t,e){var l=$e(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function ii(t,e){var l=$e(t,e);if(l.state>zi)throw new Error("too late; already running");return l}function $e(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function si(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Ui,On=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,h,b){var x,L,B;return(x=Math.sqrt(t*t+e*e))&&(t/=x,e/=x),(B=t*l+e*s)&&(l-=t*B,s-=e*B),(L=Math.sqrt(l*l+s*s))&&(l/=L,s/=L,B/=L),t*s<e*l&&(t=-t,e=-e,B=-B,x=-x),{translateX:h,translateY:b,rotate:Math.atan2(e,t)*On,skewX:Math.atan(B)*On,scaleX:x,scaleY:L}}function kn(t,e,l,s){function h(nt){return nt.length?nt.pop()+" ":""}return function(nt,ht){var Dt=[],Bt=[];return nt=t(nt),ht=t(ht),function b(nt,ht,Dt,Bt,Xt,me){if(nt!==Dt||ht!==Bt){var Oe=Xt.push("translate(",null,e,null,l);me.push({i:Oe-4,x:si(nt,Dt)},{i:Oe-2,x:si(ht,Bt)})}else(Dt||Bt)&&Xt.push("translate("+Dt+e+Bt+l)}(nt.translateX,nt.translateY,ht.translateX,ht.translateY,Dt,Bt),function x(nt,ht,Dt,Bt){nt!==ht?(nt-ht>180?ht+=360:ht-nt>180&&(nt+=360),Bt.push({i:Dt.push(h(Dt)+"rotate(",null,s)-2,x:si(nt,ht)})):ht&&Dt.push(h(Dt)+"rotate("+ht+s)}(nt.rotate,ht.rotate,Dt,Bt),function L(nt,ht,Dt,Bt){nt!==ht?Bt.push({i:Dt.push(h(Dt)+"skewX(",null,s)-2,x:si(nt,ht)}):ht&&Dt.push(h(Dt)+"skewX("+ht+s)}(nt.skewX,ht.skewX,Dt,Bt),function B(nt,ht,Dt,Bt,Xt,me){if(nt!==Dt||ht!==Bt){var Oe=Xt.push(h(Xt)+"scale(",null,",",null,")");me.push({i:Oe-4,x:si(nt,Dt)},{i:Oe-2,x:si(ht,Bt)})}else(1!==Dt||1!==Bt)&&Xt.push(h(Xt)+"scale("+Dt+","+Bt+")")}(nt.scaleX,nt.scaleY,ht.scaleX,ht.scaleY,Dt,Bt),nt=ht=null,function(Xt){for(var Nt,me=-1,Oe=Bt.length;++me<Oe;)Dt[(Nt=Bt[me]).i]=Nt.x(Xt);return Dt.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?en:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Ui||(Ui=document.createElementNS("http://www.w3.org/2000/svg","g")),Ui.setAttribute("transform",t),t=Ui.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):en},", ",")",")");function br(t,e){var l,s;return function(){var h=ii(this,t),b=h.tween;if(b!==l)for(var x=0,L=(s=l=b).length;x<L;++x)if(s[x].name===e){(s=s.slice()).splice(x,1);break}h.tween=s}}function xr(t,e,l){var s,h;if("function"!=typeof l)throw new Error;return function(){var b=ii(this,t),x=b.tween;if(x!==s){h=(s=x).slice();for(var L={name:e,value:l},B=0,nt=h.length;B<nt;++B)if(h[B].name===e){h[B]=L;break}B===nt&&h.push(L)}b.tween=h}}function nn(t,e,l){var s=t._id;return t.each(function(){var h=ii(this,s);(h.value||(h.value={}))[e]=l.apply(this,arguments)}),function(h){return $e(h,s).value[e]}}function rn(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Tn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function ki(){}var Gi=1/.7,yi="\\s*([+-]?\\d+)\\s*",Mi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ni="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),kr=new RegExp(`^rgb\\(${ni},${ni},${ni}\\)$`),Tr=new RegExp(`^rgba\\(${yi},${yi},${yi},${Mi}\\)$`),Mr=new RegExp(`^rgba\\(${ni},${ni},${ni},${Mi}\\)$`),Cr=new RegExp(`^hsl\\(${Mi},${ni},${ni}\\)$`),Ar=new RegExp(`^hsla\\(${Mi},${ni},${ni},${Mi}\\)$`),Mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(){return this.rgb().formatHex()}function An(){return this.rgb().formatRgb()}function Ci(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new ze(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Wi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Wi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new ze(e[1],e[2],e[3],1):(e=kr.exec(t))?new ze(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Tr.exec(t))?Wi(e[1],e[2],e[3],e[4]):(e=Mr.exec(t))?Wi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Cr.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=Ar.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):Mn.hasOwnProperty(t)?In(Mn[t]):"transparent"===t?new ze(NaN,NaN,NaN,0):null}function In(t){return new ze(t>>16&255,t>>8&255,255&t,1)}function Wi(t,e,l,s){return s<=0&&(t=e=l=NaN),new ze(t,e,l,s)}function Fi(t,e,l,s){return 1===arguments.length?function Rr(t){return t instanceof ki||(t=Ci(t)),t?new ze((t=t.rgb()).r,t.g,t.b,t.opacity):new ze}(t):new ze(t,e,l,null==s?1:s)}function ze(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Pn(){return`#${ci(this.r)}${ci(this.g)}${ci(this.b)}`}function Rn(){const t=Qi(this.opacity);return`${1===t?"rgb(":"rgba("}${hi(this.r)}, ${hi(this.g)}, ${hi(this.b)}${1===t?")":`, ${t})`}`}function Qi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function hi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ci(t){return((t=hi(t))<16?"0":"")+t.toString(16)}function Nn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new ti(t,e,l,s)}function Ln(t){if(t instanceof ti)return new ti(t.h,t.s,t.l,t.opacity);if(t instanceof ki||(t=Ci(t)),!t)return new ti;if(t instanceof ti)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,h=Math.min(e,l,s),b=Math.max(e,l,s),x=NaN,L=b-h,B=(b+h)/2;return L?(x=e===b?(l-s)/L+6*(l<s):l===b?(s-e)/L+2:(e-l)/L+4,L/=B<.5?b+h:2-b-h,x*=60):L=B>0&&B<1?0:x,new ti(x,L,B,t.opacity)}function ti(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Hi(t){return Math.max(0,Math.min(1,t||0))}function ln(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,h){var b=t*t,x=b*t;return((1-3*t+3*b-x)*e+(4-6*b+3*x)*l+(1+3*t+3*b-3*x)*s+x*h)/6}rn(ki,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Cn,formatHex:Cn,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Pr(){return Ln(this).formatHsl()},formatRgb:An,toString:An}),rn(ze,Fi,Tn(ki,{brighter(t){return t=null==t?Gi:Math.pow(Gi,t),new ze(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ze(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ze(hi(this.r),hi(this.g),hi(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function Nr(){return`#${ci(this.r)}${ci(this.g)}${ci(this.b)}${ci(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rn,toString:Rn})),rn(ti,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new ti(t,e,l,null==s?1:s)},Tn(ki,{brighter(t){return t=null==t?Gi:Math.pow(Gi,t),new ti(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ti(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,h=2*l-s;return new ze(ln(t>=240?t-240:t+120,h,s),ln(t,h,s),ln(t<120?t+240:t-120,h,s),this.opacity)},clamp(){return new ti(Dn(this.h),Hi(this.s),Hi(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Hi(this.s)}%, ${100*Hi(this.l)}%${1===t?")":`, ${t})`}`}}));const zn=t=>()=>t;function Kn(t,e){var l=e-t;return l?function Bn(t,e){return function(l){return t+l*e}}(t,l):zn(isNaN(t)?e:t)}const Un=function t(e){var l=function Br(t){return 1==(t=+t)?Kn:function(e,l){return l-e?function zr(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):zn(isNaN(e)?l:e)}}(e);function s(h,b){var x=l((h=Fi(h)).r,(b=Fi(b)).r),L=l(h.g,b.g),B=l(h.b,b.b),nt=Kn(h.opacity,b.opacity);return function(ht){return h.r=x(ht),h.g=L(ht),h.b=B(ht),h.opacity=nt(ht),h+""}}return s.gamma=t,s}(1);function Gn(t){return function(e){var x,L,l=e.length,s=new Array(l),h=new Array(l),b=new Array(l);for(x=0;x<l;++x)L=Fi(e[x]),s[x]=L.r||0,h[x]=L.g||0,b[x]=L.b||0;return s=t(s),h=t(h),b=t(b),L.opacity=1,function(B){return L.r=s(B),L.g=h(B),L.b=b(B),L+""}}}Gn(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),h=t[s],b=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*h-b,h,b,s<e-1?t[s+2]:2*b-h)}}),Gn(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var an=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(an.source,"g");function Gr(t,e){var s,h,b,l=an.lastIndex=on.lastIndex=0,x=-1,L=[],B=[];for(t+="",e+="";(s=an.exec(t))&&(h=on.exec(e));)(b=h.index)>l&&(b=e.slice(l,b),L[x]?L[x]+=b:L[++x]=b),(s=s[0])===(h=h[0])?L[x]?L[x]+=h:L[++x]=h:(L[++x]=null,B.push({i:x,x:si(s,h)})),l=on.lastIndex;return l<e.length&&(b=e.slice(l),L[x]?L[x]+=b:L[++x]=b),L.length<2?B[0]?function Ur(t){return function(e){return t(e)+""}}(B[0].x):function Kr(t){return function(){return t}}(e):(e=B.length,function(nt){for(var Dt,ht=0;ht<e;++ht)L[(Dt=B[ht]).i]=Dt.x(nt);return L.join("")})}function Wn(t,e){var l;return("number"==typeof e?si:e instanceof Ci?Un:(l=Ci(e))?(e=l,Un):Gr)(t,e)}function Wr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,b,h=l+"";return function(){var x=this.getAttribute(t);return x===h?null:x===s?b:b=e(s=x,l)}}function Hr(t,e,l){var s,b,h=l+"";return function(){var x=this.getAttributeNS(t.space,t.local);return x===h?null:x===s?b:b=e(s=x,l)}}function Vr(t,e,l){var s,h,b;return function(){var x,B,L=l(this);return null==L?void this.removeAttribute(t):(x=this.getAttribute(t))===(B=L+"")?null:x===s&&B===h?b:(h=B,b=e(s=x,L))}}function Jr(t,e,l){var s,h,b;return function(){var x,B,L=l(this);return null==L?void this.removeAttributeNS(t.space,t.local):(x=this.getAttributeNS(t.space,t.local))===(B=L+"")?null:x===s&&B===h?b:(h=B,b=e(s=x,L))}}function qr(t,e){var l,s;function h(){var b=e.apply(this,arguments);return b!==s&&(l=(s=b)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,b)),l}return h._value=e,h}function $r(t,e){var l,s;function h(){var b=e.apply(this,arguments);return b!==s&&(l=(s=b)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,b)),l}return h._value=e,h}function el(t,e){return function(){tn(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){tn(this,t).delay=e}}function rl(t,e){return function(){ii(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){ii(this,t).duration=e}}var wl=ye.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var zl=0;function li(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++zl}var ai=ye.prototype;li.prototype=function Bl(t){return ye().transition(t)}.prototype={constructor:li,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=O(t));for(var s=this._groups,h=s.length,b=new Array(h),x=0;x<h;++x)for(var ht,Dt,L=s[x],B=L.length,nt=b[x]=new Array(B),Bt=0;Bt<B;++Bt)(ht=L[Bt])&&(Dt=t.call(ht,ht.__data__,Bt,L))&&("__data__"in ht&&(Dt.__data__=ht.__data__),nt[Bt]=Dt,Ki(nt[Bt],e,l,Bt,nt,$e(ht,l)));return new li(b,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=u(t));for(var s=this._groups,h=s.length,b=[],x=[],L=0;L<h;++L)for(var ht,B=s[L],nt=B.length,Dt=0;Dt<nt;++Dt)if(ht=B[Dt]){for(var Xt,Bt=t.call(ht,ht.__data__,Dt,B),me=$e(ht,l),Oe=0,Nt=Bt.length;Oe<Nt;++Oe)(Xt=Bt[Oe])&&Ki(Xt,e,l,Oe,Bt,me);b.push(Bt),x.push(ht)}return new li(b,x,e,l)},selectChild:ai.selectChild,selectChildren:ai.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=k(t));for(var e=this._groups,l=e.length,s=new Array(l),h=0;h<l;++h)for(var B,b=e[h],x=b.length,L=s[h]=[],nt=0;nt<x;++nt)(B=b[nt])&&t.call(B,B.__data__,nt,b)&&L.push(B);return new li(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,b=Math.min(s,l.length),x=new Array(s),L=0;L<b;++L)for(var Bt,B=e[L],nt=l[L],ht=B.length,Dt=x[L]=new Array(ht),Xt=0;Xt<ht;++Xt)(Bt=B[Xt]||nt[Xt])&&(Dt[Xt]=Bt);for(;L<s;++L)x[L]=e[L];return new li(x,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,h=s.length,b=0;b<h;++b)for(var B,x=s[b],L=x.length,nt=0;nt<L;++nt)if(B=x[nt]){var ht=$e(B,e);Ki(B,t,l,nt,x,{time:ht.time+ht.delay+ht.duration,delay:0,duration:ht.duration,ease:ht.ease})}return new li(s,this._parents,t,l)},call:ai.call,nodes:ai.nodes,node:ai.node,size:ai.size,empty:ai.empty,each:ai.each,on:function gl(t,e){var l=this._id;return arguments.length<2?$e(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,h,b=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?tn:ii;return function(){var x=b(this,t),L=x.on;L!==s&&(h=(s=L).copy()).on(e,l),x.on=h}}(l,t,e))},attr:function Zr(t,e){var l=At(t),s="transform"===l?wr:Wn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,nn(this,"attr."+t,e)):null==e?(l.local?Fr:Wr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=At(t);return this.tween(l,(s.local?qr:$r)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Wn;return null==e?this.styleTween(t,function xl(t,e){var l,s,h;return function(){var b=W(this,t),x=(this.style.removeProperty(t),W(this,t));return b===x?null:b===l&&x===s?h:h=e(l=b,s=x)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,h,b;return function(){var x=W(this,t),L=l(this),B=L+"";return null==L&&(this.style.removeProperty(t),B=L=W(this,t)),x===B?null:x===s&&B===h?b:(h=B,b=e(s=x,L))}}(t,s,nn(this,"style."+t,e))).each(function Sl(t,e){var l,s,h,L,b="style."+e,x="end."+b;return function(){var B=ii(this,t),nt=B.on,ht=null==B.value[b]?L||(L=Fn(e)):void 0;(nt!==l||h!==ht)&&(s=(l=nt).copy()).on(x,h=ht),B.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,b,h=l+"";return function(){var x=W(this,t);return x===h?null:x===s?b:b=e(s=x,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Cl(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Ml(t,e,l){var s,h;function b(){var x=e.apply(this,arguments);return x!==h&&(s=(h=x)&&function Tl(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,x,l)),s}return b._value=e,b}(t,e,null==l?"":l))},text:function Pl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(nn(this,"text",t)):function Al(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Nl(t){var e,l;function s(){var h=t.apply(this,arguments);return h!==l&&(e=(l=h)&&function Rl(t){return function(e){this.textContent=t.call(this,e)}}(h)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var x,s=$e(this.node(),l).tween,h=0,b=s.length;h<b;++h)if((x=s[h]).name===t)return x.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):$e(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):$e(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){ii(this,t).ease=e}}(e,t)):$e(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;ii(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,h=l.size();return new Promise(function(b,x){var L={value:x},B={value:function(){0==--h&&b()}};l.each(function(){var nt=ii(this,s),ht=nt.on;ht!==t&&((e=(t=ht).copy())._.cancel.push(L),e._.interrupt.push(L),e._.end.push(B)),nt.on=e}),0===h&&b()})},[Symbol.iterator]:ai[Symbol.iterator]};var Ul={time:null,delay:0,duration:250,ease:function Kl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Gl(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}ye.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,h,x,l=t.__transition,b=!0;if(l){for(x in e=null==e?null:e+"",l)(s=l[x]).name===e?(h=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(h?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[x]):b=!1;b&&delete t.__transition}}(this,t)})},ye.prototype.transition=function Wl(t){var e,l;t instanceof li?(e=t._id,t=t._name):(e=Qn(),(l=Ul).time=Xi(),t=null==t?null:t+"");for(var s=this._groups,h=s.length,b=0;b<h;++b)for(var B,x=s[b],L=x.length,nt=0;nt<L;++nt)(B=x[nt])&&Ki(B,t,e,nt,x,l||Gl(B,e));return new li(s,this._parents,t,e)};Math;function Ai(t){return{type:t}}function _i(t){return function(){return t}}function Yn(t){this._context=t}function ql(t){return new Yn(t)}["w","e"].map(Ai),["n","s"].map(Ai),["n","w","e","s","nw","ne","sw","se"].map(Ai),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const cn=Math.PI,fn=2*cn,fi=1e-6,$l=fn-fi;function qn(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Zi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?qn:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return qn;const l=10**e;return function(s){this._+=s[0];for(let h=1,b=s.length;h<b;++h)this._+=Math.round(arguments[h]*l)/l+s[h]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,h){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+h}`}bezierCurveTo(e,l,s,h,b,x){this._append`C${+e},${+l},${+s},${+h},${this._x1=+b},${this._y1=+x}`}arcTo(e,l,s,h,b){if(e=+e,l=+l,s=+s,h=+h,(b=+b)<0)throw new Error(`negative radius: ${b}`);let x=this._x1,L=this._y1,B=s-e,nt=h-l,ht=x-e,Dt=L-l,Bt=ht*ht+Dt*Dt;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Bt>fi)if(Math.abs(Dt*B-nt*ht)>fi&&b){let Xt=s-x,me=h-L,Oe=B*B+nt*nt,Nt=Xt*Xt+me*me,Ct=Math.sqrt(Oe),ie=Math.sqrt(Bt),Yt=b*Math.tan((cn-Math.acos((Oe+Bt-Nt)/(2*Ct*ie)))/2),de=Yt/ie,ve=Yt/Ct;Math.abs(de-1)>fi&&this._append`L${e+de*ht},${l+de*Dt}`,this._append`A${b},${b},0,0,${+(Dt*Xt>ht*me)},${this._x1=e+ve*B},${this._y1=l+ve*nt}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,h,b,x){if(e=+e,l=+l,x=!!x,(s=+s)<0)throw new Error(`negative radius: ${s}`);let L=s*Math.cos(h),B=s*Math.sin(h),nt=e+L,ht=l+B,Dt=1^x,Bt=x?h-b:b-h;null===this._x1?this._append`M${nt},${ht}`:(Math.abs(this._x1-nt)>fi||Math.abs(this._y1-ht)>fi)&&this._append`L${nt},${ht}`,s&&(Bt<0&&(Bt=Bt%fn+fn),Bt>$l?this._append`A${s},${s},0,1,${Dt},${e-L},${l-B}A${s},${s},0,1,${Dt},${this._x1=nt},${this._y1=ht}`:Bt>fi&&this._append`A${s},${s},0,${+(Bt>=cn)},${Dt},${this._x1=e+s*Math.cos(b)},${this._y1=l+s*Math.sin(b)}`)}rect(e,l,s,h){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+h}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=_i(!0),s=null,h=ql,b=null,x=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Zi(e)}(L);function L(B){var nt,Dt,Xt,ht=(B=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(B)).length,Bt=!1;for(null==s&&(b=h(Xt=x())),nt=0;nt<=ht;++nt)!(nt<ht&&l(Dt=B[nt],nt,B))===Bt&&((Bt=!Bt)?b.lineStart():b.lineEnd()),Bt&&b.point(+t(Dt,nt,B),+e(Dt,nt,B));if(Xt)return b=null,Xt+""||null}return t="function"==typeof t?t:void 0===t?na:_i(t),e="function"==typeof e?e:void 0===e?ra:_i(e),L.x=function(B){return arguments.length?(t="function"==typeof B?B:_i(+B),L):t},L.y=function(B){return arguments.length?(e="function"==typeof B?B:_i(+B),L):e},L.defined=function(B){return arguments.length?(l="function"==typeof B?B:_i(!!B),L):l},L.curve=function(B){return arguments.length?(h=B,null!=s&&(b=h(s)),L):h},L.context=function(B){return arguments.length?(null==B?s=b=null:b=h(s=B),L):s},L}function $n(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function wi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$n(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$n(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wi.prototype={constructor:wi,scale:function(t){return 1===t?this:new wi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wi(1,0,0)}}]);