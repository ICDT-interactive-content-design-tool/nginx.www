"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(oe,Lt,p)=>{p.d(Lt,{In:()=>st,MA:()=>h,Mo:()=>z,NV:()=>O,S3:()=>A,dt:()=>gt,h8:()=>b,k0:()=>R});const A={fill:"transparent",stroke:"#129bff",strokeWidth:1},O={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},st={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},z={fill:"transparent",stroke:"transparent",strokeWidth:1},gt={fill:"none",stroke:"#5F6CE1",strokeWidth:1},b={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},h={fill:"transparent"},R={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},7851:(oe,Lt,p)=>{p.d(Lt,{BG:()=>b,IX:()=>gt,Q8:()=>f,RZ:()=>R,SS:()=>h,T1:()=>S,Ug:()=>P,n2:()=>O,yo:()=>z});var A=p(5811);const O=_=>{var I;return null===(I=_.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===I?void 0:I.map(u=>{let K={type:u.substring(0,1)},L=(X=u.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?X.split(/\s/).map(et=>(0,A.q)(parseFloat(et),1e6)):[];var X;return L.length&&(K.points=L),K})},z=_=>{let I=[],u=[],K=[],L=[];return _.forEach(X=>{switch(["M","L","C","S","Q","T"].includes(X.type)&&X.points&&X.points.forEach((St,it)=>{it%2==0?I.push(St):u.push(St)}),X.type){case"A":var et;7==(null===(et=X.points)||void 0===et?void 0:et.length)&&(K.push(X.points[5]),L.push(X.points[6]));break;case"H":var ot;null!==(ot=X.points)&&void 0!==ot&&ot.length&&(I.push(X.points[0]),K.push(X.points[0]));break;case"V":var j;null!==(j=X.points)&&void 0!==j&&j.length&&(u.push(X.points[0]),L.push(X.points[0]));break;case"a":var _t;if(7==(null===(_t=X.points)||void 0===_t?void 0:_t.length)){let St=I[I.length-1];I.push(St+X.points[5]),K.push(St+X.points[5]);let it=u[u.length-1];u.push(it+X.points[6]),L.push(it+X.points[6])}break;case"h":var Bt;if(null!==(Bt=X.points)&&void 0!==Bt&&Bt.length){let St=I[I.length-1];I.push(St+X.points[0]),K.push(St+X.points[0])}break;case"v":var Gt;if(null!==(Gt=X.points)&&void 0!==Gt&&Gt.length){let St=u[u.length-1];u.push(St+X.points[0]),L.push(St+X.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":var Mt;null===(Mt=X.points)||void 0===Mt||Mt.forEach((St,it)=>{it%2==0?K.push(St):L.push(St)});break;case"m":case"l":case"c":case"s":case"q":case"t":var It;null===(It=X.points)||void 0===It||It.forEach((St,it)=>{if(it%2==0){let B=I[I.length-1];I.push(B+St),K.push(B+St)}else{let B=u[u.length-1];u.push(B+St),L.push(B+St)}})}}),{minX:Math.min.apply(null,K),minY:Math.min.apply(null,L),maxX:Math.max.apply(null,K),maxY:Math.max.apply(null,L)}},gt=(_,I)=>I.map(u=>{let K=[];switch(u.type){case"a":var L;7==(null===(L=u.points)||void 0===L?void 0:L.length)&&K.push([(0,A.q)(u.points[0]/_.width,1e6),(0,A.q)(u.points[1]/_.height,1e6),u.points[2],u.points[3],u.points[4],(0,A.q)(u.points[5]/_.width,1e6),(0,A.q)(u.points[6]/_.height,1e6)]);break;case"A":var X;7==(null===(X=u.points)||void 0===X?void 0:X.length)&&K.push([(0,A.q)(u.points[0]/_.width,1e6),(0,A.q)(u.points[1]/_.height,1e6),u.points[2],u.points[3],u.points[4],(0,A.q)((u.points[5]-_.x)/_.width,1e6),(0,A.q)((u.points[6]-_.y)/_.height,1e6)]);break;case"h":var et;null!==(et=u.points)&&void 0!==et&&et.length&&K.push([(0,A.q)(u.points[0]/_.width,1e6)]);break;case"H":var ot;null!==(ot=u.points)&&void 0!==ot&&ot.length&&K.push([(0,A.q)((u.points[0]-_.x)/_.width,1e6)]);break;case"v":var j;null!==(j=u.points)&&void 0!==j&&j.length&&K.push([(0,A.q)(u.points[0]/_.height,1e6)]);break;case"V":var _t;null!==(_t=u.points)&&void 0!==_t&&_t.length&&K.push([(0,A.q)((u.points[0]-_.y)/_.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":var Bt;if(null!==(Bt=u.points)&&void 0!==Bt&&Bt.length)for(let Mt=0,It=u.points.length-1;Mt<It;Mt+=2)K.push([(0,A.q)((u.points[Mt]-_.x)/_.width,1e6),(0,A.q)((u.points[Mt+1]-_.y)/_.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":var Gt;if(null!==(Gt=u.points)&&void 0!==Gt&&Gt.length)for(let Mt=0,It=u.points.length-1;Mt<It;Mt+=2)K.push([(0,A.q)(u.points[Mt]/_.width,1e6),(0,A.q)(u.points[Mt+1]/_.height,1e6)])}return K.length?{type:u.type,ratios:K}:{type:u.type}}),b=(_,I)=>I.map(u=>{switch(u.type){case"a":var K,L;return`${u.type}${null!==(K=null===(L=u.ratios)||void 0===L||null===(L=L.map(Ot=>{var rt,qt,J,tt,d,nt,Et;return[(0,A.q)(_.width*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6),(0,A.q)(_.height*(null!==(qt=Ot[1])&&void 0!==qt?qt:0),1e6),null!==(J=Ot[2])&&void 0!==J?J:0,null!==(tt=Ot[3])&&void 0!==tt?tt:0,null!==(d=Ot[4])&&void 0!==d?d:0,(0,A.q)(_.width*(null!==(nt=Ot[5])&&void 0!==nt?nt:0),1e6),(0,A.q)(_.height*(null!==(Et=Ot[6])&&void 0!==Et?Et:0),1e6)]}))||void 0===L||null===(L=L.map(Ot=>Ot.join(" ")))||void 0===L?void 0:L.join(" "))&&void 0!==K?K:""}`;case"A":var X,et;return`${u.type}${null!==(X=null===(et=u.ratios)||void 0===et||null===(et=et.map(Ot=>{var rt,qt,J,tt,d,nt,Et;return[(0,A.q)(_.width*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6),(0,A.q)(_.height*(null!==(qt=Ot[1])&&void 0!==qt?qt:0),1e6),null!==(J=Ot[2])&&void 0!==J?J:0,null!==(tt=Ot[3])&&void 0!==tt?tt:0,null!==(d=Ot[4])&&void 0!==d?d:0,(0,A.q)(_.x+_.width*(null!==(nt=Ot[5])&&void 0!==nt?nt:0),1e6),(0,A.q)(_.y+_.height*(null!==(Et=Ot[6])&&void 0!==Et?Et:0),1e6)]}))||void 0===et||null===(et=et.map(Ot=>Ot.join(" ")))||void 0===et?void 0:et.join(" "))&&void 0!==X?X:""}`;case"h":var ot,j;return`${u.type}${null!==(ot=null===(j=u.ratios)||void 0===j||null===(j=j.map(Ot=>{var rt;return(0,A.q)(_.width*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6)}))||void 0===j?void 0:j.join(" "))&&void 0!==ot?ot:""}`;case"H":var _t,Bt;return`${u.type}${null!==(_t=null===(Bt=u.ratios)||void 0===Bt||null===(Bt=Bt.map(Ot=>{var rt;return(0,A.q)(_.x+_.width*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6)}))||void 0===Bt?void 0:Bt.join(" "))&&void 0!==_t?_t:""}`;case"v":var Gt,Mt;return`${u.type}${null!==(Gt=null===(Mt=u.ratios)||void 0===Mt||null===(Mt=Mt.map(Ot=>{var rt;return(0,A.q)(_.height*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6)}))||void 0===Mt?void 0:Mt.join(" "))&&void 0!==Gt?Gt:""}`;case"V":var It,St;return`${u.type}${null!==(It=null===(St=u.ratios)||void 0===St||null===(St=St.map(Ot=>{var rt;return(0,A.q)(_.y+_.height*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6)}))||void 0===St?void 0:St.join(" "))&&void 0!==It?It:""}`;case"z":case"Z":return u.type;case"M":case"L":case"C":case"S":case"Q":case"T":var it,B;return`${u.type}${null!==(it=null===(B=u.ratios)||void 0===B||null===(B=B.map(Ot=>{var rt,qt;return[(0,A.q)(_.x+_.width*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6),(0,A.q)(_.y+_.height*(null!==(qt=Ot[1])&&void 0!==qt?qt:0),1e6)]}))||void 0===B||null===(B=B.map(Ot=>Ot.join(" ")))||void 0===B?void 0:B.join(" "))&&void 0!==it?it:""}`;case"m":case"l":case"c":case"s":case"q":case"t":var yt,wt;return`${u.type}${null!==(yt=null===(wt=u.ratios)||void 0===wt||null===(wt=wt.map(Ot=>{var rt,qt;return[(0,A.q)(_.width*(null!==(rt=Ot[0])&&void 0!==rt?rt:0),1e6),(0,A.q)(_.height*(null!==(qt=Ot[1])&&void 0!==qt?qt:0),1e6)]}))||void 0===wt||null===(wt=wt.map(Ot=>Ot.join(" ")))||void 0===wt?void 0:wt.join(" "))&&void 0!==yt?yt:""}`;default:return""}}).join(""),h=_=>{return(I=_.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?I.split(/\s/).map(u=>parseFloat(u)):[];var I},R=_=>{let I=[],u=[];return _.forEach((K,L)=>{L%2==0?I.push(K):u.push(K)}),{minX:Math.min.apply(null,I),minY:Math.min.apply(null,u),maxX:Math.max.apply(null,I),maxY:Math.max.apply(null,u)}},P=(_,I)=>{let u=[];for(let K=0,L=I.length-1;K<L;K+=2)u.push([(I[K]-_.x)/_.width,(I[K+1]-_.y)/_.height]);return u},f=(_,I)=>I.map(u=>[(0,A.q)(_.x+_.width*u[0],1e6),(0,A.q)(_.y+_.height*u[1],1e6)]).map(u=>u.join(" ")).join(" "),S=(_,I)=>{let u=(_=>{let I=_.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map(u=>(0,A.q)(parseFloat(u),1e6));if(6==I.length)return{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}})(I);return u?window.Snap.path.map(_,new window.Snap.Matrix(u.a,u.b,u.c,u.d,u.e,u.f)).toString():_}},9942:(oe,Lt,p)=>{p.d(Lt,{w:()=>T,I:()=>M});var A=p(4981),O=p(9054),st=p(5811),z=/^#[a-fA-F0-9]+$/i,gt=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,b=/^rgb\((\d+),(\d+),(\d+)\)$/i;const h=Z=>{let _=null,I=null;if(Z)if("transparent"==Z)_="#000000",I=0;else if(Z.match(z))_=Z;else{let u=(Z=Z.replace(/\s+/g,"")).match(gt);if(u)_="#"+(256|u[1]).toString(16).slice(1)+(256|u[2]).toString(16).slice(1)+(256|u[3]).toString(16).slice(1),I=(0,st.q)(parseFloat(u[4]),100);else{let K=Z.match(b);K&&(_="#"+(256|K[1]).toString(16).slice(1)+(256|K[2]).toString(16).slice(1)+(256|K[3]).toString(16).slice(1))}}return{hex:_,alpha:I}},M=Z=>S(null==Z?void 0:Z.url,null==Z?void 0:Z.path,null==Z?void 0:Z.src);var S=(Z,_,I)=>{var u,K;let L,X,et,ot;var j,_t;return Z&&(L=Z.replace(/\\/g,"/")),_&&(X=_.replace(/\\/g,"/")),I&&(et=I.replace(/\\/g,"/")),X&&!L&&(L=(null===(j=A.icdt.config)||void 0===j?void 0:j.readfileuploadurl)+X),!et||X||L||(X=et.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),L=(null===(_t=A.icdt.config)||void 0===_t?void 0:_t.readfileuploadurl)+X),ot=(null!==(u=L)&&void 0!==u?u:"").split("/").pop()||(null!==(K=X)&&void 0!==K?K:"").split("/").pop()||"",{url:L,path:X,name:ot}};const T=Z=>{let _={x:0,y:0,width:Z.screen.w,height:Z.screen.h},I=[];return Z.data.forEach((u,K)=>{var L,X;let et={id:"number"==typeof u.id?u.id:A.icdt.data.newSlideId,code:null===(L=u.id)||void 0===L?void 0:L.toString(),name:"string"==typeof u.id?u.id:`Trang ${K+1}`,svg:{viewBox:_,nodes:[]},test:(ot=u.test2,ot?(ot.audiotrue&&(ot.audiotrue=M({path:ot.audiotrue.path})),ot.audiofalse&&(ot.audiofalse=M({path:ot.audiofalse.path})),ot.effecttrue&&(ot.effecttrue=M({path:ot.effecttrue.path})),ot.effectfalse&&(ot.effectfalse=M({path:ot.effectfalse.path})),ot.icontrue&&(ot.icontrue=M({path:ot.icontrue.path})),ot.iconfalse&&(ot.iconfalse=M({path:ot.iconfalse.path})),ot):{})};var ot;u.background&&et.svg&&(et.svg.background=function(Z){return Z&&(null!==Z.match(/#([a-zA-Z0-9]+)/)||null!==Z.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==Z.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(u.background)?{color:u.background}:function(Z){return Z&&null!==Z.match(/data:[^;]+;base64,/)}(u.background)?{base64:u.background}:function(Z){return Z&&null!==Z.match(/http(s)?:\/\//)}(u.background)?S(u.background):S(void 0,u.background)),jQuery(null!==(X=u.svg)&&void 0!==X?X:"").find(".svg-node").each((ot,j)=>{var _t,Bt;let Gt=jQuery(j).parents(".indexs"),Mt=Gt.attr("data-index"),It=Gt.attr("data-time"),St=null!==(_t=j.getAttribute("id"))&&void 0!==_t?_t:"0",it={id:parseInt(St),code:`${j.nodeName}-${j.getAttribute("id")}`,name:j.nodeName,idx:Mt?parseInt(Mt):0,time:It?parseFloat(It):0,type:(()=>{switch(j.nodeName){case"polygon":return O.$.POLYGON;case"circle":return O.$.CIRCLE;case"ellipse":return O.$.ELLIPSE;case"line":return O.$.LINE;case"rect":return O.$.RECT;case"foreignObject":return O.$.FOREIGNOBJECT}return 0})(),size:(B=>{let yt=0,wt=0,Ot=0,rt=0,qt=null,J=null,tt=parseFloat((null===(B=j.getAttribute("transform"))||void 0===B?void 0:B.replace("rotate(","").replace(")",""))||"0")||null;switch(j.nodeName){case"polygon":{var d,nt;let Et=[],At=[],Dt=999999999,Vt=999999999,Jt=0,Tt=0;qt=JSON.parse(j.getAttribute("ratios")||"[]"),J=null!==(d=null===(nt=j.getAttribute("points"))||void 0===nt?void 0:nt.split(",").map(function(vt){return vt.split(" ").map(function(te){return parseFloat(te)})}))&&void 0!==d?d:[],J.forEach(function(vt){Et.push(vt[0]),At.push(vt[1])}),Dt=Math.min.apply(null,Et),Vt=Math.min.apply(null,At),Jt=Math.max.apply(null,Et),Tt=Math.max.apply(null,At),yt=Dt,wt=Vt,Ot=Jt-yt,rt=Tt-wt;break}case"circle":{let Et=parseFloat(j.getAttribute("cx")||"0"),At=parseFloat(j.getAttribute("cy")||"0"),Dt=parseFloat(j.getAttribute("r")||"0");yt=Et-Dt,wt=At-Dt,Ot=2*Dt,rt=2*Dt;break}case"ellipse":{let Et=parseFloat(j.getAttribute("cx")||"0"),At=parseFloat(j.getAttribute("cy")||"0"),Dt=parseFloat(j.getAttribute("rx")||"0"),Vt=parseFloat(j.getAttribute("ry")||"0");yt=Et-Dt,wt=At-Vt,Ot=2*Dt,rt=2*Vt;break}case"line":{let Et=parseFloat(j.getAttribute("x1")||"0"),At=parseFloat(j.getAttribute("y1")||"0"),Dt=parseFloat(j.getAttribute("x2")||"0"),Vt=parseFloat(j.getAttribute("y2")||"0"),Jt=999999999,Tt=999999999,vt=0,te=0;Jt=Math.min(Et,Dt),Tt=Math.min(At,Vt),vt=Math.max(Et,Dt),te=Math.max(At,Vt),yt=Jt,wt=Tt,Ot=vt-yt,rt=te-wt,qt=[[(Et-yt)/(Ot||1),(At-wt)/(rt||1)],[(Dt-yt)/(Ot||1),(Vt-wt)/(rt||1)]];break}case"rect":case"foreignObject":yt=parseFloat(j.getAttribute("x")||"0"),wt=parseFloat(j.getAttribute("y")||"0"),Ot=parseFloat(j.getAttribute("width")||"0"),rt=parseFloat(j.getAttribute("height")||"0")}return Object.assign({},{x:yt,y:wt,width:Ot,height:rt,ratios:qt,points:J,rotate:tt})})(),attribute:(()=>{let B={};switch(j.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var yt,wt,Ot,rt,qt,J;let tt=null!==(yt=j.getAttribute("fill"))&&void 0!==yt?yt:null,d=null!==(wt=j.getAttribute("stroke"))&&void 0!==wt?wt:null,nt=null!==(Ot=parseFloat(j.getAttribute("stroke-width")||"0"))&&void 0!==Ot?Ot:null,Et=null!==(rt=j.getAttribute("stroke-linecap"))&&void 0!==rt?rt:null,At=null!==(qt=j.getAttribute("stroke-linejoin"))&&void 0!==qt?qt:null,Dt=null!==(J=parseFloat(j.getAttribute("stroke-dasharray")||"0"))&&void 0!==J?J:null;Object.assign(B,{fill:tt,stroke:d,strokeWidth:nt,strokeLinecap:Et,strokeLinejoin:At,strokeDasharray:Dt});break}}return B})(),style:(()=>{let B={};switch(j.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let Ot=jQuery(j).find(".svg-container");if(Ot.length){let qt=parseFloat(Ot.css("border-width")||"0")||null,J=Ot.css("border-style")||null,tt=Ot.css("border-color")||null,d=null,nt=Ot.css("background-color")||null,Et=null;(()=>{let{hex:At,alpha:Dt}=h(tt);tt=At,d=Dt})(),(()=>{let{hex:At,alpha:Dt}=h(nt);nt=At,Et=Dt})(),Object.assign(B,{borderWidth:qt,borderStyle:J,borderColor:tt,borderOpacity:d,backgroundColor:nt,backgroundOpacity:Et})}let rt=jQuery(j).find(".svg-editor-content");if(rt.length){var yt,wt;let qt=JSON.parse((rt.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:J,alpha:tt}=h(qt.TextColor);Object.assign(B,{fontFamily:null!==(yt=qt.FontFamily)&&void 0!==yt?yt:null,fontSize:null!==(wt=qt.FontSize)&&void 0!==wt?wt:null,color:J,opacity:tt})}break}}return B})(),source:(()=>{let B={};switch(j.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Gt.hasClass("editors")){let Tt=jQuery(j).find(".svg-editor-content");if(Tt.length){var yt;let vt=Tt.html(),te=null!==(yt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==yt?yt:[];Object.assign(B,{type:"html",html:{htmlContent:vt,variableKeywords:te}})}}else if(Gt.hasClass("inputs")||Gt.hasClass("textareas"))Object.assign(B,{type:"input",input:{input:!!jQuery(j).find("input").length,textarea:!!jQuery(j).find("textarea").length}});else if(Gt.hasClass("tests")){let Tt=jQuery(j).find(".svg-test");if(Gt.hasClass("tests-truefalse")){var wt,Ot;let vt=Tt.find(".svg-editor-content").html(),te=null!==(wt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==wt?wt:[];Object.assign(B,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Ot=u.test2.truefalse)||void 0===Ot?void 0:Ot.includes(St)}},html:{htmlContent:vt,variableKeywords:te}})}else if(Gt.hasClass("tests-singlechoice")){var rt,qt;let vt=Tt.find(".svg-editor-content").html(),te=null!==(rt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==rt?rt:[];Object.assign(B,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(qt=u.test2.singlechoice)||void 0===qt?void 0:qt.includes(St)}},html:{htmlContent:vt,variableKeywords:te}})}else if(Gt.hasClass("tests-multichoice")){var J,tt;let vt=Tt.find(".svg-editor-content").html(),te=null!==(J=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==J?J:[];Object.assign(B,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(tt=u.test2.multichoice)||void 0===tt?void 0:tt.includes(St)}},html:{htmlContent:vt,variableKeywords:te}})}else if(Gt.hasClass("tests-fill")){var d,nt;let vt=Tt.find(".svg-editor-content").html(),te=null!==(d=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[],Y=null!==(nt=(null!=vt?vt:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==nt?nt:[];Y=Y.filter((v,H,ft)=>ft.indexOf(v)==H),Object.assign(B,{type:"test",test:{type:"fill",fill:Y.map(v=>{var H;return{key:v,value:null===(H=u.test2.fill)||void 0===H||null===(H=H.find(ft=>ft.id==St))||void 0===H||null===(H=H.vals)||void 0===H?void 0:H.map(ft=>ft.text).filter(ft=>!["",null,void 0,NaN].includes(ft))}})},html:{htmlContent:vt,variableKeywords:te,fillKeywords:Y}})}else if(Gt.hasClass("tests-matching")){if(Tt.hasClass("svg-test-empty"))Object.assign(B,{type:"test",test:{type:"matching-empty",matching:{key:Tt.attr("data-name")||null}}});else if(Tt.hasClass("svg-test-content")){var Et;let vt=Tt.find(".svg-editor-content").html(),te=null!==(Et=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==Et?Et:[];Object.assign(B,{type:"test",test:{type:"matching-content",matching:{key:Tt.attr("data-name")||null}},html:{htmlContent:vt,variableKeywords:te}})}}else if(Gt.hasClass("tests-speech")){var At;Object.assign(B,{type:"speech",speech:{value:null===(At=u.test2.speech)||void 0===At||null===(At=At.find(vt=>vt.id==St))||void 0===At||null===(At=At.vals)||void 0===At?void 0:At.map(vt=>vt.text).filter(vt=>!["",null,void 0,NaN].includes(vt))}})}else if(Gt.hasClass("tests-submit")){let vt=jQuery(j).find(".svg-container img");Object.assign(B,{type:"test",test:{type:"submit"},image:S(vt.attr("url"),vt.attr("path"),vt.attr("src"))})}}else if(Gt.hasClass("images")){let Tt=jQuery(j).find(".svg-editor-content img");if(Tt.length)Object.assign(B,{type:"image",image:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});else{let vt=jQuery(j).find("iframe");Object.assign(B,{type:"iframe",iframe:S(vt.attr("url"),vt.attr("path"),vt.attr("src"))})}}else if(Gt.hasClass("sounds")){let Tt=jQuery(j).find(".svg-editor-content img");Tt.length&&Object.assign(B,{type:"image",image:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))})}else if(Gt.hasClass("htmls")){let Tt=jQuery(j).find("iframe");Tt.length&&Object.assign(B,{type:"iframe",iframe:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))})}else if(Gt.hasClass("svgs")){let Tt=jQuery(j).find("svg");var Dt,Vt;Tt.length&&Object.assign(B,{type:"svg",svg:Object.assign(S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src")),{svgContent:null!==(Dt=null===(Vt=Tt.get(0))||void 0===Vt?void 0:Vt.outerHTML)&&void 0!==Dt?Dt:null})})}else if(Gt.hasClass("medias")){let Tt=jQuery(j).find(".media-item");if(Tt.length)switch(Tt.attr("type")){case"audio":Object.assign(B,{type:"audio",audio:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;case"video":Object.assign(B,{type:"video",video:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;case"file":Object.assign(B,{type:"file",file:S(Tt.attr("url"),Tt.attr("path"),Tt.attr("src"))});break;default:var Jt;Object.assign(B,{type:"link",link:{url:null!==(Jt=Tt.attr("url"))&&void 0!==Jt?Jt:null}})}let vt=jQuery(j).find("img");vt.length&&(Object.assign(B,{image:S(vt.attr("url"),vt.attr("path"),vt.attr("src"))}),B.type||Object.assign(B,{type:"image"}))}}return B})(),animate:(B=>{let yt={},wt=null===(B=u.animates)||void 0===B?void 0:B.find(Ot=>Ot.elementId==St);return wt&&Object.assign(yt,{value:wt.value}),yt})(),interactive:(()=>{let B={},yt=u.actions.show.filter(Ot=>Ot.elementId==St&&Ot.active);yt.length&&(B.show={},yt.forEach(Ot=>{let{source:rt}=Ot;switch(null==rt?void 0:rt.type){case"work":var qt,J,tt,d,nt;B.show.action={},Object.assign(B.show.action,{value:null!==(qt=rt.value)&&void 0!==qt?qt:null,iteration:null!==(J=rt.iteration)&&void 0!==J?J:null,finish:null!==(tt=rt.end)&&void 0!==tt?tt:null,time:null!==(d=rt.time)&&void 0!==d?d:null,points:null!==(nt=rt.points)&&void 0!==nt?nt:null});break;case"audio":var Et,At,Dt;B.show.audio={},Object.assign(B.show.audio,{source:S(null,null,rt.url),iteration:null!==(Et=rt.iteration)&&void 0!==Et?Et:null,finish:null!==(At=rt.end)&&void 0!==At?At:null,time:null!==(Dt=rt.time)&&void 0!==Dt?Dt:null,async:-1==rt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Vt,Jt,Tt,vt,te,Y,v,H,ft,ut,q,Q,V,x,U;rt.options.includes("show")&&(B.show.triggershow={},Object.assign(B.show.triggershow,{id:null!==(Vt=parseInt(null!==(Jt=rt.id)&&void 0!==Jt?Jt:"0"))&&void 0!==Vt?Vt:null,ids:null===(Tt=rt.ids)||void 0===Tt?void 0:Tt.map(pt=>parseInt(pt)),async:null!==(vt=rt.async)&&void 0!==vt?vt:null,time:null!==(te=rt.time)&&void 0!==te?te:null})),rt.options.includes("run")&&(B.show.triggerrun={},Object.assign(B.show.triggerrun,{id:null!==(Y=parseInt(null!==(v=rt.id)&&void 0!==v?v:"0"))&&void 0!==Y?Y:null,ids:null===(H=rt.ids)||void 0===H?void 0:H.map(pt=>parseInt(pt)),async:null!==(ft=rt.async)&&void 0!==ft?ft:null,time:null!==(ut=rt.time)&&void 0!==ut?ut:null})),rt.options.includes("hide")&&(B.show.triggerhide={},Object.assign(B.show.triggerhide,{id:null!==(q=parseInt(null!==(Q=rt.id)&&void 0!==Q?Q:"0"))&&void 0!==q?q:null,ids:null===(V=rt.ids)||void 0===V?void 0:V.map(pt=>parseInt(pt)),async:null!==(x=rt.async)&&void 0!==x?x:null,time:null!==(U=rt.time)&&void 0!==U?U:null}))}}));let wt=u.actions.click.filter(Ot=>Ot.elementId==St&&Ot.active);return wt&&(B.click={},wt.forEach(Ot=>{let{source:rt}=Ot;switch(null==rt?void 0:rt.type){case"work":var qt,J,tt,d,nt;B.click.action={},Object.assign(B.click.action,{value:null!==(qt=rt.value)&&void 0!==qt?qt:null,iteration:null!==(J=rt.iteration)&&void 0!==J?J:null,finish:null!==(tt=rt.end)&&void 0!==tt?tt:null,time:null!==(d=rt.time)&&void 0!==d?d:null,points:null!==(nt=rt.points)&&void 0!==nt?nt:null});break;case"audio":var Et,At,Dt;B.click.audio={},Object.assign(B.click.audio,{source:S(null,null,rt.url),iteration:null!==(Et=rt.iteration)&&void 0!==Et?Et:null,finish:null!==(At=rt.end)&&void 0!==At?At:null,time:null!==(Dt=rt.time)&&void 0!==Dt?Dt:null,async:-1==rt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Vt,Jt,Tt,vt,te,Y,v,H,ft,ut,q,Q,V,x,U;rt.options.includes("show")&&(B.click.triggershow={},Object.assign(B.click.triggershow,{id:null!==(Vt=parseInt(null!==(Jt=rt.id)&&void 0!==Jt?Jt:"0"))&&void 0!==Vt?Vt:null,ids:null===(Tt=rt.ids)||void 0===Tt?void 0:Tt.map(Ct=>parseInt(Ct)),async:null!==(vt=rt.async)&&void 0!==vt?vt:null,time:null!==(te=rt.time)&&void 0!==te?te:null})),rt.options.includes("run")&&(B.click.triggerrun={},Object.assign(B.click.triggerrun,{id:null!==(Y=parseInt(null!==(v=rt.id)&&void 0!==v?v:"0"))&&void 0!==Y?Y:null,ids:null===(H=rt.ids)||void 0===H?void 0:H.map(Ct=>parseInt(Ct)),async:null!==(ft=rt.async)&&void 0!==ft?ft:null,time:null!==(ut=rt.time)&&void 0!==ut?ut:null})),rt.options.includes("hide")&&(B.click.triggerhide={},Object.assign(B.click.triggerhide,{id:null!==(q=parseInt(null!==(Q=rt.id)&&void 0!==Q?Q:"0"))&&void 0!==q?q:null,ids:null===(V=rt.ids)||void 0===V?void 0:V.map(Ct=>parseInt(Ct)),async:null!==(x=rt.async)&&void 0!==x?x:null,time:null!==(U=rt.time)&&void 0!==U?U:null}));break;case"slide":var pt;B.click.slide={},Object.assign(B.click.slide,{id:parseInt(null!==(pt=rt.id)&&void 0!==pt?pt:"0")||rt.num||null,code:rt.id})}})),B})(),variable:(B=>{let yt={};var wt;j.getAttribute("data-variable")&&(yt.input={},Object.assign(yt.input,{variable:null!==(wt=j.getAttribute("data-variable"))&&void 0!==wt?wt:null}));let Ot=null===(B=u.nodes)||void 0===B||null===(B=B.find(d=>d.id==St))||void 0===B?void 0:B.variable;var rt,qt,J,tt;return Ot&&(yt.click={},Object.assign(yt.click,{variable:null!==(rt=Ot.variable)&&void 0!==rt?rt:null,operator:null!==(qt=Ot.operator)&&void 0!==qt?qt:null,valuetype:null!==(J=Ot.valuetype)&&void 0!==J?J:null,value:null!==(tt=Ot.value)&&void 0!==tt?tt:null})),yt})()};null===(Bt=et.svg)||void 0===Bt||Bt.nodes.push(it)}),I.push(et)}),{screen:{width:Z.screen.w,height:Z.screen.h},data:{slides:I},variable:Z.variable}}},644:(oe,Lt,p)=>{p.d(Lt,{Dx:()=>b,aY:()=>P,qp:()=>R,qz:()=>gt,sV:()=>h,yR:()=>f});var A=p(5861),O=p(9422);O.config({driver:[O.INDEXEDDB,O.LOCALSTORAGE,O.WEBSQL],name:"_localDataDB",version:1});const z={create:(M=(0,A.Z)(function*(){return O}),function(){return M.apply(this,arguments)}),get:function(){var M=(0,A.Z)(function*(S){return O.getItem(S)});return function(T){return M.apply(this,arguments)}}(),set:function(){var M=(0,A.Z)(function*(S,T){return O.setItem(S,T)});return function(T,Z){return M.apply(this,arguments)}}()},gt=function(){var M=(0,A.Z)(function*(S){yield z.create();var T=(yield z.get("icdt-data"))||[];"function"==typeof S.callback&&S.callback(T)});return function(T){return M.apply(this,arguments)}}(),b=function(){var M=(0,A.Z)(function*(S){yield z.create(),S.params=S.params||{};try{yield z.set("icdt-data",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(T){"function"==typeof S.callback&&S.callback(null),console.error(T)}});return function(T){return M.apply(this,arguments)}}(),h=function(){var M=(0,A.Z)(function*(S){yield z.create();try{var T=(yield z.get("icdt-config"))||{};"function"==typeof S.callback&&S.callback(T)}catch(Z){"function"==typeof S.callback&&S.callback(null),console.error(Z)}});return function(T){return M.apply(this,arguments)}}(),R=function(){var M=(0,A.Z)(function*(S){yield z.create(),S.params=S.params||{};try{yield z.set("icdt-config",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(T){"function"==typeof S.callback&&S.callback(null),console.error(T)}});return function(T){return M.apply(this,arguments)}}(),P=function(){var M=(0,A.Z)(function*(S){yield z.create();try{var T=(yield z.get("icdt-clipboard"))||{};"function"==typeof S.callback&&S.callback(T)}catch(Z){"function"==typeof S.callback&&S.callback(null),console.error(Z)}});return function(T){return M.apply(this,arguments)}}(),f=function(){var M=(0,A.Z)(function*(S){yield z.create(),S.params=S.params||{};try{yield z.set("icdt-clipboard",S.params),"function"==typeof S.callback&&S.callback(S.params)}catch(T){"function"==typeof S.callback&&S.callback(null),console.error(T)}});return function(T){return M.apply(this,arguments)}}();var M},9359:(oe,Lt,p)=>{p.d(Lt,{E:()=>A});const A=(O,st)=>{if(!O)return"";let z=O.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),gt=(z&&z[4]||"").trim(),b=z?(256|z[1]).toString(16).slice(1)+(256|z[2]).toString(16).slice(1)+(256|z[3]).toString(16).slice(1):O;if("0"==gt)return"transparent";if(st){let h;h=""!==gt?gt:"01",h=(255*h|256).toString(16).slice(1),b+=h}return console.log(`lib_rgba2hex: ${O} -> ${b}`),`#${b}`}},1687:(oe,Lt,p)=>{p.d(Lt,{O:()=>A});const A={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(oe,Lt,p)=>{p.d(Lt,{D:()=>A});const A={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(oe,Lt,p)=>{p.d(Lt,{_:()=>A});const A={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(oe,Lt,p)=>{p.d(Lt,{D:()=>A});const A={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(oe,Lt,p)=>{p.d(Lt,{$:()=>A});const A={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(oe,Lt,p)=>{p.d(Lt,{icdt:()=>bt});var A=p(968),O=p(7492),st=p(1687),z=p(4318),gt=p(6816),b=p(666),h=p(3171);const f=D=>{var i,n,r,o,a;let y=(null===(i=D.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=D.touchEvent)||void 0===n?void 0:n.target),g=(null==y?void 0:y.getAttribute("id"))||"",m=null==y?void 0:y.nodeName,C=(null==y||null===(r=y.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var w,G;if([st.O.RESIZE_GROUP,st.O.SELECT_GROUP].includes(C))return null===(w=D.mouseEvent)||void 0===w||w.stopPropagation(),void(null===(G=D.mouseEvent)||void 0===G||G.preventDefault());if(null!==(o=D.mouseEvent)&&void 0!==o&&o.altKey||null!==(a=D.touchEvent)&&void 0!==a&&a.altKey||!g||g.match(/[^0-9]/)||!bt.dataSelect.nodeName.includes(m)){var N;bt.dataSelect.ids.length&&(bt.dataSelect.ids=[]),(0==(null===(N=D.mouseEvent)||void 0===N?void 0:N.button)||D.touchEvent)&&(D=>{let a=(0,O.g1)(st.O.SCAN_GROUP,"g"),y=(0,z.bH)(0,0,1,1);(0,O.vl)(a,y),((D,i,n)=>{(0,gt.A)(D,{start:a=>{},move:(a,y)=>{((a,y,g,m)=>{i=(0,z.bH)(a,y,g,m),(0,O.vl)(n,i)})(y[0][0],y[0][1],a.x,a.y)},end:(a,y)=>{null==n||n.remove(),bt.dataSelect.ids=bt.data.getNodeInArea(Math.min(y[0][0],a.x),Math.min(y[0][1],a.y),Math.max(y[0][0],a.x),Math.max(y[0][1],a.y));let g=bt.dataSelect.nodes;1==g.length?(0,b.y)(g[0]):g.length>1&&(0,h.Q)(g)}})})(D,y,a)})(D)}else{var dt,ht;let xt=parseFloat(g||"0");bt.dataSelect.ids=null!==(dt=D.mouseEvent)&&void 0!==dt&&dt.shiftKey||null!==(ht=D.touchEvent)&&void 0!==ht&&ht.shiftKey?[xt].concat(bt.dataSelect.ids).filter((Ft,ge,ve)=>ve.indexOf(Ft)==ge):[xt];let Nt=bt.dataSelect.nodes;Nt.length>1?(0,h.Q)(Nt):1==Nt.length&&(0,b.y)(Nt[0])}};class S{constructor(){let{x:i,y:n}=bt.screen.dislocation;var r=(o,a,y,g)=>{bt.screen.move({x:i,y:n},{x:y-o,y:g-a})};return{start:o=>{},move:(o,a)=>{r(a[0][0],a[0][1],o.x,o.y)},end:(o,a)=>{r(a[0][0],a[0][1],o.x,o.y)}}}}var T=p(9054),Z=p(4714);const _=[{name:"tam gi\xe1c vu\xf4ng",type:Z.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:Z.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:Z.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:Z.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:Z.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:Z.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:Z.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:Z.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:Z.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:Z.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:Z.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:Z.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:Z.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var I=p(8619),u=p(5811);class K{constructor(){let i=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,I._)(Math.ceil(1e9*Math.random())),y=(g,m,C,w)=>{a=(0,z.bH)(g,m,C,w,{ratio:1}),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,z.sg)(T.$.CIRCLE,a,o)),(0,O.__)(r,o),(0,O.g$)(i,a)};return{start:g=>{y(g.x,g.y,g.x+a.width,g.y+a.height)},move:(g,m)=>{y(m[0][0],m[0][1],g.x,g.y)},end:(g,m)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,z.sg)(T.$.CIRCLE,a,o)),(0,O.__)(r,o)),bt.data.node=Object.assign({id:n,type:T.$.CIRCLE,name:"Circle"},{size:a,attribute:o}),null==i||i.remove()}}}}var L=p(8785);class X{constructor(){let i=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,L.r)(Math.ceil(1e9*Math.random()));var y=(g,m,C,w)=>{a=(0,z.bH)(g,m,C,w),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,z.sg)(T.$.ELLIPSE,a,o)),(0,O.__)(r,o),(0,O.g$)(i,a)};return{start:g=>{y(g.x,g.y,g.x+a.width,g.y+a.height)},move:(g,m)=>{y(m[0][0],m[0][1],g.x,g.y)},end:(g,m)=>{(a.width<=16||a.height<=16)&&(a.width=90,a.height=60,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,z.sg)(T.$.ELLIPSE,a,o)),(0,O.__)(r,o)),bt.data.node=Object.assign({id:n,type:T.$.ELLIPSE,name:"Ellipse"},{size:a,attribute:o}),null==i||i.remove()}}}}var et=p(8054);class ot{constructor(){let i=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,et.f)(Math.ceil(1e9*Math.random()));var y=(g,m,C,w)=>{a=(0,z.bH)(g,m,C,w),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,z.sg)(T.$.RECT,a,o)),(0,O.__)(r,o),(0,O.g$)(i,a)};return{start:g=>{y(g.x,g.y,g.x+a.width,g.y+a.height)},move:(g,m)=>{y(m[0][0],m[0][1],g.x,g.y)},end:(g,m)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,z.sg)(T.$.RECT,a,o)),(0,O.__)(r,o)),bt.data.node=Object.assign({id:n,type:T.$.RECT,name:"Rect"},{size:a,attribute:o}),null==i||i.remove()}}}}var j=p(2282);class _t{constructor(i){let n=(0,O.g1)(st.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:o,element:a,attribute:y,size:g}=(0,j.l)(Math.ceil(1e9*Math.random()));g.ratios=r;var m=(C,w,G,N)=>{g=(0,z.bH)(C,w,G,N,{ratios:r}),g.x=(0,u.q)(g.x),g.y=(0,u.q)(g.y),g.width=(0,u.q)(g.width),g.height=(0,u.q)(g.height),Object.assign(y,(0,z.sg)(T.$.POLYGON,g,y)),(0,O.__)(a,y),(0,O.g$)(n,g)};return{start:C=>{m(C.x,C.y,C.x+g.width,C.y+g.height)},move:(C,w)=>{m(w[0][0],w[0][1],C.x,C.y)},end:(C,w)=>{(g.width<=16||g.height<=16)&&(g.width=80,g.height=80,g.x=g.x-g.width/2,g.y=g.y-g.height/2,Object.assign(y,(0,z.sg)(T.$.POLYGON,g,y)),(0,O.__)(a,y)),bt.data.node=Object.assign({id:o,type:T.$.POLYGON,name:"Polygon"},{size:g,attribute:y}),null==n||n.remove()}}}}var Bt=p(4921);class Gt{constructor(){let i=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a}=(0,Bt.W)(Math.ceil(1e9*Math.random()));return{start:g=>{},move:(g,m)=>{((g,m,C,w)=>{a=(0,z.bH)(g,m,C,w),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,z.sg)(T.$.LINE,a,o)),(0,O.__)(r,o),(0,O.g$)(i,a)})(m[0][0],m[0][1],g.x,g.y)},end:(g,m)=>{m.length>=2?((a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,z.sg)(T.$.LINE,a,o)),(0,O.__)(r,o)),bt.data.node=Object.assign({id:n,type:T.$.LINE,name:"Line"},{size:a,attribute:o})):null==r||r.remove(),null==i||i.remove()}}}}var Mt=p(7851),It=p(9322);class St{constructor(){let{nodeId:i,element:n,attribute:r,size:o}=(0,It.G)(Math.ceil(1e9*Math.random())),y="";return{start:m=>{y=`M ${m.x} ${m.y} L ${m.x} ${m.y}`},move:(m,C)=>{((m,C)=>{y+=` ${m} ${C}`,n.setAttribute("d",y)})(m.x,m.y)},end:(m,C)=>{let w=(0,Mt.n2)(y),{minX:G,minY:N,maxX:dt,maxY:ht}=(0,Mt.yo)(w);o.x=G,o.y=N,o.width=dt-G||1,o.height=ht-N||1,o.ratioMaps=(0,Mt.IX)(o,w),bt.data.node=Object.assign({id:i,type:T.$.PATH,name:"Path"},{size:o,attribute:r})}}}}var it=p(2875);class B{constructor(){let i=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:o,attribute:a,style:y,source:g}=(0,it.e)(Math.ceil(1e9*Math.random()));var m=(C,w,G,N)=>{o=(0,z.bH)(C,w,G,N),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,z.sg)(T.$.FOREIGNOBJECT,o,a)),(0,O.__)(r,a),(0,O.g$)(i,o)};return{start:C=>{m(C.x,C.y,C.x+o.width,C.y+o.height)},move:(C,w)=>{m(w[0][0],w[0][1],C.x,C.y)},end:(C,w)=>{(o.width<=16||o.height<=16)&&(o.width=90,o.height=60,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(a,(0,z.sg)(T.$.FOREIGNOBJECT,o,a)),(0,O.__)(r,a)),bt.data.node=Object.assign({id:n,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:a,style:y,source:g}),null==i||i.remove()}}}}var yt=p(7210);class wt{constructor(){var i,n;let r=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:o,element:a,size:y,attribute:g,source:m}=(0,yt.G)(Math.ceil(1e9*Math.random())),C=1;(G=>{if(!G)return;let N=new Image;N.onload=()=>{C=(0,u.q)(N.naturalWidth/N.naturalHeight,100)},N.onerror=dt=>{console.error(`ImgSrc load failed -> ${G}`,dt)},N.src=G})(null!==(i=null===(n=m.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var w=(G,N,dt,ht)=>{y=(0,z.bH)(G,N,dt,ht,{ratio:C}),y.x=(0,u.q)(y.x),y.y=(0,u.q)(y.y),y.width=(0,u.q)(y.width),y.height=(0,u.q)(y.height),Object.assign(g,(0,z.sg)(T.$.IMAGE,y,g)),(0,O.__)(a,g),(0,O.g$)(r,y)};return{start:G=>{w(G.x,G.y,G.x+y.width,G.y+y.height)},move:(G,N)=>{w(N[0][0],N[0][1],G.x,G.y)},end:(G,N)=>{(y.width<=16||y.height<=16)&&(y.width=80,y.height=80,y.x=y.x-y.width/2,y.y=y.y-y.height/2,Object.assign(g,(0,z.sg)(T.$.IMAGE,y,g)),(0,O.__)(a,g)),bt.data.node=Object.assign({id:o,type:T.$.IMAGE,name:"Image"},{size:y,attribute:g,source:m}),null==r||r.remove()}}}}var rt=p(4578),qt=p(9623);function d(D,i,n,r){return Math.sqrt(Math.pow(n-D,2)+Math.pow(r-i,2))}function nt(D,i,n,r,o){return d(D,i,n,r)<o?1:0}function At(D,i,n,r,o,a,y){var g=[];return g.push(nt(D,i,n,r,y)),g.push(nt(D,i,o,a,y)),g.push(function Et(D,i,n,r,o,a,y){var g=[o-n,a-r],m=[D-n,i-r],C=[-g[1],g[0]],w=Math.sqrt(Math.pow(C[0],2)+Math.pow(C[1],2)),G=[C[0]/w,C[1]/w],N=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),dt=[g[0]/N,g[1]/N],ht=m[0]*dt[0]+m[1]*dt[1];if(ht<=0||ht>=N)return 0;var xt=m[0]*G[0]+m[1]*G[1];return xt>=y||xt<=-y?0:1}(D,i,n,r,o,a,y)),g}function Dt(D,i,n,r,o){var a=[n-D,r-i],y=[-a[1],a[0]],g=Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)),m=[y[0]/g,y[1]/g];return[[D+o*m[0],i+o*m[1]],[D-o*m[0],i-o*m[1]],[n-o*m[0],r-o*m[1]],[n+o*m[0],r+o*m[1]]]}function Vt(D,i,n,r,o,a,y){var ht,g=[o-D,a-i],m=[n-D,r-i],C=Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2)),w=[m[0]/C,m[1]/C],G=g[0]*w[0]+g[1]*w[1],N=[D+G*w[0],i+G*w[1]],dt=Math.sqrt(Math.pow(o-N[0],2)+Math.pow(a-N[1],2));ht=0===dt?y:Math.sqrt(Math.pow(y,2)-Math.pow(dt,2));var xt=[D+G*w[0]+ht*w[0],i+G*w[1]+ht*w[1]];return xt[0]===D&&xt[1]===i?null:xt}function Jt(D,i,n,r,o,a,y){var g=[o-D,a-i],m=[n-D,r-i],C=[-m[1],m[0]],w=Math.sqrt(Math.pow(C[0],2)+Math.pow(C[1],2)),G=[C[0]/w,C[1]/w],N=g[0]*G[0]+g[1]*G[1],dt=H([D,i],[n,r],[o,a]);if(Y([dt[0]-o,dt[1]-a])>=y)return null;var xt=Math.sqrt(Math.pow(y,2)-Math.pow(N,2)),Nt=[o-N*G[0],a-N*G[1]],Ft=Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2)),ge=[m[0]/Ft,m[1]/Ft],ve=[[Nt[0]-ge[0]*xt,Nt[1]-ge[1]*xt],[Nt[0]+ge[0]*xt,Nt[1]+ge[1]*xt]];return ve[0][0]===D&&ve[0][1]===i?null:ve}function Tt(D,i,n,r,o,a,y,g){var m,C,w,G,N,dt;return-(w=y-o)*(C=r-i)+(m=n-D)*(G=g-a)==0?null:(dt=(w*(i-a)-G*(D-o))/(-w*C+m*G),(N=(-C*(D-o)+m*(i-a))/(-w*C+m*G))>=0&&N<=1&&dt>=0&&dt<=1?[D+dt*m,i+dt*C]:null)}function vt(D,i,n,r,o,a,y,g,m,C){var w=Dt(a,y,g,m,C),G=[];if(n[0]&&!n[1])G.push(Vt(D,i,r,o,a,y,C)),G.push(Tt(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),G.push(Tt(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1])),(N=Jt(D,i,r,o,g,m,C))&&G.push(N[0],N[1]);else if(!n[0]&&n[1])G.push(Vt(D,i,r,o,g,m,C)),G.push(Tt(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),G.push(Tt(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1])),(N=Jt(D,i,r,o,a,y,C))&&G.push(N[0],N[1]);else if(n[0]&&n[1])G.push(Vt(D,i,r,o,a,y,C)),G.push(Tt(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),G.push(Tt(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1])),G.push(Vt(D,i,r,o,g,m,C));else{var N=Jt(D,i,r,o,g,m,C),dt=Jt(D,i,r,o,a,y,C);N&&G.push(N[0],N[1]),dt&&G.push(dt[0],dt[1]),G.push(Tt(D,i,r,o,w[0][0],w[0][1],w[3][0],w[3][1])),G.push(Tt(D,i,r,o,w[1][0],w[1][1],w[2][0],w[2][1]))}for(var ht=[D,i],xt=0;xt<G.length;xt++)G[xt]&&d(G[xt][0],G[xt][1],r,o)<d(ht[0],ht[1],r,o)&&(ht=G[xt]);return ht[0]===D&&ht[1]===i?null:ht}function te(D,i,n,r,o,a,y,g,m){var C=Dt(o,a,y,g,m),w=[],G=Jt(D,i,n,r,o,a,m);G&&w.push(G[0],G[1]),(G=Jt(D,i,n,r,y,g,m))&&w.push(G[0],G[1]),w.push(Tt(D,i,n,r,C[0][0],C[0][1],C[3][0],C[3][1])),w.push(Tt(D,i,n,r,C[1][0],C[1][1],C[2][0],C[2][1]));for(var N=[n,r],dt=[D,i],ht=0;ht<w.length;ht++)w[ht]&&d(w[ht][0],w[ht][1],D,i)<d(N[0],N[1],D,i)&&(N=w[ht]);for(var xt=0;xt<w.length;xt++)w[xt]&&d(w[xt][0],w[xt][1],n,r)<d(dt[0],dt[1],n,r)&&(dt=w[xt]);return N[0]===n&&N[1]===r||dt[0]===D&&dt[1]===i?null:[N,dt]}var Y=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},H=function(D,i,n){var r=[i[0]-D[0],i[1]-D[1]],o=Y(r);if(o<1e-6)return D;var a=[n[0]-D[0],n[1]-D[1]],y=(r[0]*a[0]+r[1]*a[1])/o;return y<0?D:y>o?i:[D[0]+r[0]*y/o,D[1]+r[1]*y/o]};class ft{constructor(){let{element:r,size:a}=(0,It.G)(Math.ceil(1e9*Math.random()));(0,O.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let y="";return{start:C=>{y=`M ${C.x} ${C.y} L ${C.x} ${C.y}`},move:(C,w)=>{((C,w)=>{y+=` ${C} ${w}`,r.setAttribute("d",y)})(C.x,C.y)},end:(C,w)=>{r.remove(),(C=>{let w=9999,G=9999,N=-9999,dt=-9999;C.forEach(xt=>{w=Math.min(w,xt[0]),G=Math.min(G,xt[1]),N=Math.max(N,xt[0]),dt=Math.max(dt,xt[1])}),a=(0,z.bH)(w,G,N,dt,{points:C}),bt.data.getNodeInArea(0,0,1920,1920,T.$.PATH).forEach(xt=>{let Ft=((D,i,n)=>{n=n||20;var r=[],o=function(w){var G=i[0][0],N=i[0][1],dt=0,ht=0;if(1!==w.length||nt(w[0][0],w[0][1],G,N,n)){for(var xt;dt<w.length-1;){var Nt=w[dt],Ft=w[dt+1],ge=nt(Nt[0],Nt[1],G,N,n),ve=nt(Ft[0],Ft[1],G,N,n);if(ge&&ve)ht=++dt;else if(ge&&!ve)(ye=Vt(Nt[0],Nt[1],Ft[0],Ft[1],G,N,n))?(w[dt]=ye,ht=dt):dt++;else if(!ge&&ve){var ye;(ye=Vt(Ft[0],Ft[1],Nt[0],Nt[1],G,N,n))&&((xt=w.slice(ht,dt+1)).push(ye),r.push(xt)),ht=++dt}else{var me=Jt(Nt[0],Nt[1],Ft[0],Ft[1],G,N,n);me?(((xt=w.slice(ht,dt+1))[xt.length-1][0]!==me[0][0]||xt[xt.length-1][1]!==me[0][1])&&xt.push(me[0]),xt.length>1&&r.push(xt),w[dt]=me[1],w[dt+1]&&w[dt+1][0]==me[1][0]&&w[dt+1][1]==me[1][1]&&dt++,ht=dt):dt++}}ht!==dt&&(xt=w.slice(ht,w.length))&&r.push(xt)}else r.push(w)},a=function(w,G){var Ft,N=i[G],dt=i[G+1],ht=0,xt=0;if(1!==w.length||-1!==(Nt=At(w[0][0],w[0][1],N[0],N[1],dt[0],dt[1],n)).indexOf(1)){for(;ht<w.length-1;){var ge=w[ht],ve=w[ht+1],Nt=At(ge[0],ge[1],N[0],N[1],dt[0],dt[1],n),ye=At(ve[0],ve[1],N[0],N[1],dt[0],dt[1],n);if(-1!==Nt.indexOf(1)&&-1!==ye.indexOf(1))xt=++ht;else if(-1!==Nt.indexOf(1)&&-1===ye.indexOf(1))(me=vt(ge[0],ge[1],Nt,ve[0],ve[1],N[0],N[1],dt[0],dt[1],n))?(w[ht]=me,xt=ht):ht++;else if(-1===Nt.indexOf(1)&&-1!==ye.indexOf(1)){var me;(me=vt(ve[0],ve[1],ye,ge[0],ge[1],N[0],N[1],dt[0],dt[1],n))?((Ft=w.slice(xt,ht+1)).push(me),r.push(Ft),xt=++ht):ht++}else{var Se=te(ge[0],ge[1],ve[0],ve[1],N[0],N[1],dt[0],dt[1],n);Se?(((Ft=w.slice(xt,ht+1))[Ft.length-1][0]!==Se[0][0]||Ft[Ft.length-1][1]!==Se[0][1])&&Ft.push(Se[0]),Ft.length>1&&r.push(Ft),w[ht]=Se[1],w[ht+1]&&w[ht+1][0]==Se[1][0]&&w[ht+1][1]==Se[1][1]&&ht++,xt=ht):ht++}}xt!==ht&&(Ft=w.slice(xt,w.length))&&r.push(Ft)}else r.push(w)};if(i=function tt(D){var i=[];if(1===D.length)i=D;else{for(var n=0;n<D.length-1;)(D[n][0]!==D[n+1][0]||D[n][1]!==D[n+1][1])&&i.push(D[n]),n++;0!==D.length&&0===i.length&&i.push(D[0]),(D[D.length-1][0]!==D[i.length-1][0]||D[D.length-1][1]!==D[i.length-1][1])&&i.push(D[n])}return i}(i),1===i.length){for(var y=0;y<D.length;y++)o(D[y]);D=r}else for(var g=0;g<i.length-1;g++){for(y=0;y<D.length;y++)a(D[y],g);D=r,r=[]}for(var m=0;m<D.length;m++)for(var C=0;C<D[m].length;C++)D[m][C][0]=Math.round(D[m][C][0]),D[m][C][1]=Math.round(D[m][C][1]);return D})(bt.data.getNode(xt).size.points,C,2);console.log(Ft)})})(w)}}}}var q=p(1105);class Q{constructor(){let i=(0,O.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:o,size:a,source:y}=(0,q.$)(Math.ceil(1e9*Math.random())),g=(m,C,w,G)=>{a=(0,z.bH)(m,C,w,G),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,z.sg)(T.$.TEXT,a,o)),(0,O.__)(r,o),(0,O.g$)(i,a)};return{start:m=>{g(m.x,m.y,m.x+a.width,m.y+a.height)},move:(m,C)=>{g(C[0][0],C[0][1],m.x,m.y)},end:(m,C)=>{(a.width<=16||a.height<=16)&&(a.width=80,a.height=80,a.x=a.x-a.width/2,a.y=a.y-a.height/2,Object.assign(o,(0,z.sg)(T.$.TEXT,a,o)),(0,O.__)(r,o)),bt.data.node=Object.assign({id:n,type:T.$.TEXT,name:"Text"},{size:a,attribute:o,source:y}),null==i||i.remove()}}}}var pt=p(4531),Ct=p(9125),mt=p(7797);var zt=p(6358);class Wt{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>bt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,o,a,y;null===(n=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(st.O.SELECT_GROUP))||void 0===r||r.remove(),null===(o=window.document.getElementById(st.O.SCAN_GROUP))||void 0===o||o.remove(),null===(a=window.document.getElementById(st.O.CREATE_GROUP))||void 0===a||a.remove(),null===(y=window.document.getElementById(st.O.INTERACTIVE_GROUP))||void 0===y||y.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(g=>g(i))}deleteNode(){for(let i of this._selected_Ids){let n=bt.data.deleteNode(i);bt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}bt.dataSelect.ids=[]}groupNode(){let i=[];if(bt.dataSelect.ids.length>=2){let n=bt.data.getNode(bt.dataSelect.ids[0]),{nodeId:r,attribute:o,size:a}=(0,zt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);bt.data.node=Object.assign({id:r,type:T.$.GROUP,name:"G"},{size:a,attribute:o});for(let y of bt.dataSelect.ids)i.push(bt.data.addGroup(y,r))}if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,b.y)(n[0]):n.length>1&&(0,h.Q)(n)}}ungroupNode(){let i=[];for(let n of bt.dataSelect.ids)i.push(bt.data.unGroup(n));if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,b.y)(n[0]):n.length>1&&(0,h.Q)(n)}}}var Ht=p(9942);class ne{createNodeImage(i,n){var r,o,a,y;let{nodeId:m,element:C,size:w,attribute:G,source:N}=(0,yt.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},source:{type:"image",image:(0,Ht.I)(i)}});(dt=>{if(!dt)return;let ht=new Image;ht.onload=()=>{let xt=(0,u.q)(ht.naturalWidth/ht.naturalHeight,100);xt>=1?(w.width=Math.min(ht.naturalWidth,512),w.height=(0,u.q)(w.width/xt,100)):(w.height=Math.min(ht.naturalHeight,512),w.width=(0,u.q)(w.height*xt,100)),w.x=(0,u.q)(w.x+50-w.width/2,100),w.y=(0,u.q)(w.y+50-w.height/2,100),Object.assign(G,(0,z.sg)(T.$.IMAGE,w,G)),(0,O.__)(C,G),bt.data.node=Object.assign({id:m,type:T.$.IMAGE,name:"Image"},{size:w,attribute:G,source:N})},ht.onerror=xt=>{console.error(`ImgSrc load failed -> ${dt}`,xt),null==C||C.remove()},ht.src=dt})(null!==(a=null===(y=N.image)||void 0===y?void 0:y.url)&&void 0!==a?a:"")}createNodeIframe(i,n){var r,o;let{nodeId:y,element:g,size:m,attribute:C,style:w,source:G}=(0,it.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Ht.I)(i)}});(N=>{let dt=(null===(N=bt.data.slide)||void 0===N||null===(N=N.svg)||void 0===N?void 0:N.viewBox)||{x:0,y:0,width:100,height:100},ht=(0,u.q)(dt.width/dt.height,100);ht>=1?(m.width=Math.min(dt.width,512),m.height=(0,u.q)(m.width/ht,100)):(m.height=Math.min(dt.height,512),m.width=(0,u.q)(m.height*ht,100)),m.x=(0,u.q)(m.x+50-m.width/2,100),m.y=(0,u.q)(m.y+50-m.height/2,100),Object.assign(C,(0,z.sg)(T.$.IMAGE,m,C)),(0,O.__)(g,C),bt.data.node=Object.assign({id:y,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:m,attribute:C,style:w,source:G})})()}createNodeEmbed(i,n){var r,o;let{nodeId:y,element:g,size:m,attribute:C,style:w,source:G}=(0,it.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Ht.I)(i))}});(N=>{let dt=(null===(N=bt.data.slide)||void 0===N||null===(N=N.svg)||void 0===N?void 0:N.viewBox)||{x:0,y:0,width:100,height:100},ht=(0,u.q)(dt.width/dt.height,100);ht>=1?(m.width=Math.min(dt.width,512),m.height=(0,u.q)(m.width/ht,100)):(m.height=Math.min(dt.height,512),m.width=(0,u.q)(m.height*ht,100)),m.x=(0,u.q)(m.x+50-m.width/2,100),m.y=(0,u.q)(m.y+50-m.height/2,100),Object.assign(C,(0,z.sg)(T.$.IMAGE,m,C)),(0,O.__)(g,C),bt.data.node=Object.assign({id:y,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:m,attribute:C,style:w,source:G})})()}createNodeMedia(i,n){var r,o,a,y;let{nodeId:m,element:C,size:w,attribute:G,source:N}=(0,yt.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(o=null==n?void 0:n.y)&&void 0!==o?o:50)-50,width:100,height:100},source:{type:"image",image:(0,Ht.I)(i.cover)}}),dt={click:{media:i.media}};(ht=>{if(!ht)return;let xt=new Image;xt.onload=()=>{let Nt=(0,u.q)(xt.naturalWidth/xt.naturalHeight,100);Nt>=1?(w.width=Math.min(xt.naturalWidth,512),w.height=(0,u.q)(w.width/Nt,100)):(w.height=Math.min(xt.naturalHeight,512),w.width=(0,u.q)(w.height*Nt,100)),w.x=(0,u.q)(w.x+50-w.width/2,100),w.y=(0,u.q)(w.y+50-w.height/2,100),Object.assign(G,(0,z.sg)(T.$.IMAGE,w,G)),(0,O.__)(C,G),bt.data.node=Object.assign({id:m,type:T.$.IMAGE,name:"Image"},{size:w,attribute:G,source:N,interactive:dt})},xt.onerror=Nt=>{console.error(`ImgSrc load failed -> ${ht}`,Nt),null==C||C.remove()},xt.src=ht})(null!==(a=null===(y=N.image)||void 0===y?void 0:y.url)&&void 0!==a?a:"")}insert(i){var n;if(bt.data.insertSlide(bt.data.slideId,1),i.title){let{nodeId:r,size:o,attribute:a,style:y,source:g}=(0,it.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});bt.data.node=Object.assign({id:r,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:a,style:y,source:g})}if(i.description){let{nodeId:r,size:o,attribute:a,style:y,source:g}=(0,it.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});bt.data.node=Object.assign({id:r,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:a,style:y,source:g})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:o,attribute:a}=(0,et.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});bt.data.node=Object.assign({id:r,type:T.$.RECT,name:"Rect"},{size:o,attribute:a})})(),(r=>{let{nodeId:o,size:a,attribute:y,style:g,source:m}=(0,it.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});bt.data.node=Object.assign({id:o,type:T.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:y,style:g,source:m})})())}}var re=p(5226);class pe{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:bt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((a,y)=>y==this._slideIdx),r=null==n?void 0:n.svg,o=a=>{let y=[];return a.filter(g=>!g.isdeleted).forEach(g=>{g.type==T.$.GROUP?y=y.concat(o(g.nodes||[])):y.push(g.id)}),y};return o((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var o,a;return null===(o=r)||void 0===o||o.filter(y=>y.type==T.$.GROUP).forEach(y=>{var g;y.nodes=n(null===(g=y.nodes)||void 0===g?void 0:g.filter(m=>!m.isdeleted))}),(r=null===(a=r)||void 0===a?void 0:a.filter(y=>{var g,m;return y.type!=T.$.GROUP||(null!==(g=null===(m=y.nodes)||void 0===m?void 0:m.length)&&void 0!==g?g:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var o;r.svg&&(r.svg.nodes=n(null===(o=r.svg)||void 0===o||null===(o=o.nodes)||void 0===o?void 0:o.filter(a=>!a.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var o,a,y,g,m,C,w,G;n.push(null===(o=r.svg)||void 0===o||null===(o=o.background)||void 0===o?void 0:o.path),null===(a=r.svg)||void 0===a||a.nodes.forEach(N=>{var dt,ht,xt,Nt,Ft,ge,ve,ye,me,Se;n.push(null===(dt=N.source)||void 0===dt||null===(dt=dt.image)||void 0===dt?void 0:dt.path),n.push(null===(ht=N.source)||void 0===ht||null===(ht=ht.audio)||void 0===ht?void 0:ht.path),n.push(null===(xt=N.source)||void 0===xt||null===(xt=xt.video)||void 0===xt?void 0:xt.path),n.push(null===(Nt=N.source)||void 0===Nt||null===(Nt=Nt.file)||void 0===Nt?void 0:Nt.path),n.push(null===(Ft=N.source)||void 0===Ft||null===(Ft=Ft.iframe)||void 0===Ft?void 0:Ft.path),n.push(null===(ge=N.source)||void 0===ge||null===(ge=ge.track)||void 0===ge?void 0:ge.path),n.push(null===(ve=N.interactive)||void 0===ve||null===(ve=ve.show)||void 0===ve||null===(ve=ve.audio)||void 0===ve||null===(ve=ve.source)||void 0===ve?void 0:ve.path),n.push(null===(ye=N.interactive)||void 0===ye||null===(ye=ye.click)||void 0===ye||null===(ye=ye.audio)||void 0===ye||null===(ye=ye.source)||void 0===ye?void 0:ye.path),n.push(null===(me=N.interactive)||void 0===me||null===(me=me.click)||void 0===me||null===(me=me.image)||void 0===me||null===(me=me.source)||void 0===me?void 0:me.path),n.push(null===(Se=N.interactive)||void 0===Se||null===(Se=Se.click)||void 0===Se||null===(Se=Se.video)||void 0===Se||null===(Se=Se.source)||void 0===Se?void 0:Se.path)}),n.push(null===(y=r.test)||void 0===y||null===(y=y.audiotrue)||void 0===y?void 0:y.path),n.push(null===(g=r.test)||void 0===g||null===(g=g.audiofalse)||void 0===g?void 0:g.path),n.push(null===(m=r.test)||void 0===m||null===(m=m.effecttrue)||void 0===m?void 0:m.path),n.push(null===(C=r.test)||void 0===C||null===(C=C.effectfalse)||void 0===C?void 0:C.path),n.push(null===(w=r.test)||void 0===w||null===(w=w.icontrue)||void 0===w?void 0:w.path),n.push(null===(G=r.test)||void 0===G||null===(G=G.iconfalse)||void 0===G?void 0:G.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,o,a)=>a.indexOf(r)==o)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,O.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var o,a;return null===(o=r)||void 0===o||o.filter(y=>y.type==T.$.GROUP).forEach(y=>{var g;y.nodes=n(null===(g=y.nodes)||void 0===g?void 0:g.filter(m=>!m.isdeleted))}),(r=null===(a=r)||void 0===a?void 0:a.filter(y=>{var g,m;return y.type!=T.$.GROUP||(null!==(g=null===(m=y.nodes)||void 0===m?void 0:m.length)&&void 0!==g?g:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var o;r.svg&&(r.svg.nodes=n(null===(o=r.svg)||void 0===o||null===(o=o.nodes)||void 0===o?void 0:o.filter(a=>!a.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,O.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){(0,O.wM)(),(0,re.E)(this.slide)}openSlide(i,n){var r,o,a,y,g;if(i)for(let N=0,dt=null!==(m=null===(C=this._dataSource.slides)||void 0===C?void 0:C.length)&&void 0!==m?m:0;N<dt;N++){var m,C,w;if((null!==(w=this._dataSource.slides)&&void 0!==w?w:[])[N].id==i){this._slideIdx=N;break}}else if(n&&n>=0&&n<(null!==(r=null===(o=this._dataSource.slides)||void 0===o?void 0:o.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var G;this._slideIdx=0,null!==(G=this._dataSource.slides)&&void 0!==G&&G.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,O.wM)(),null!==(a=this.slide)&&void 0!==a&&null!==(a=a.svg)&&void 0!==a&&a.viewBox&&(bt.screen.frameSize=this.slide.svg.viewBox),(0,re.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==y?y:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}tryReplaceSlide(i,n,r){var o,a,y,g,m;let C=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(G=>G.id==i);if(!r||!C||null!=C&&null!==(a=C.svg)&&void 0!==a&&a.nodes.filter(G=>!G.isdeleted).length)return this.insertSlide(i,n,r);let w=null!==(y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(C))&&void 0!==y?y:0;null===(m=this._dataSource.slides)||void 0===m||m.splice(w,1,r),this._slideIdx=w,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var o,a,y,g,m;let C=null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(N=>N.id==i))&&void 0!==o?o:this._defaultSlide,w=(null!==(y=null===(g=this._dataSource.slides)||void 0===g?void 0:g.indexOf(C))&&void 0!==y?y:0)+n;var G;r?(r.id=this.newSlideId,r.code=void 0,r.name||(r.name="Trang m\u1edbi"),null!==(G=r.svg)&&void 0!==G&&G.viewBox||r.svg&&(r.svg.viewBox=bt.screen.frameSize)):r=this._defaultSlide,null===(m=this._dataSource.slides)||void 0===m||m.splice(w,0,r),this._slideIdx=w,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,o,a,y,g,m;let C=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(N=>N.id==i))&&void 0!==n?n:this._defaultSlide,w=(null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(C))&&void 0!==o?o:0)+1,G=Object.assign(JSON.parse(JSON.stringify(C)),{id:this.newSlideId,code:void 0,name:`${C.name} + (Copy)`});null===(y=this._dataSource.slides)||void 0===y||y.splice(w,0,G),this.changeSlide(this.slides,this.slideIdx,null!==(g=null===(m=this._dataSource.slides)||void 0===m?void 0:m.length)&&void 0!==g?g:0,this.slide)}moveSlide(i,n){var r,o,a,y,g,m;let C=null!==(r=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(G=>G.id==i))&&void 0!==r?r:this._defaultSlide,w=null!==(a=null===(y=this._dataSource.slides)||void 0===y?void 0:y.indexOf(C))&&void 0!==a?a:0;null===(g=this._dataSource.slides)||void 0===g||g.splice(w+n,0,null===(m=this._dataSource.slides)||void 0===m?void 0:m.splice(w,1)[0])}deleteSlide(i){var n,r,o,a,y,g;let m=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(N=>N.id==i))&&void 0!==n?n:this._defaultSlide,C=null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(m))&&void 0!==o?o:0;if(null===(y=this._dataSource.slides)||void 0===y||y.splice(C,1),null!==(g=this._dataSource.slides)&&void 0!==g&&g.length)if(C<this._slideIdx){var w,G;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(w=null===(G=this._dataSource.slides)||void 0===G?void 0:G.length)&&void 0!==w?w:0,this.slide)}else C==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,o,a,y;let g=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(C=>C.id==i))&&void 0!==n?n:this._defaultSlide,m=null!==(o=null===(a=this._dataSource.slides)||void 0===a?void 0:a.indexOf(g))&&void 0!==o?o:0;if(g.isdeleted=!0,null!==(y=this._dataSource.slides)&&void 0!==y&&null!==(y=y.filter(C=>!C.isdeleted))&&void 0!==y&&y.length){let C=!0;for(;g.isdeleted;)C?m++:m--,this._dataSource.slides[m]?g=this._dataSource.slides[m]:C=!C;this.openSlide(g.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,o){this._fnChangeSlides.forEach(a=>a(i,n,r,o))}set node(i){var n,r;let o=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((y,g)=>g==this._slideIdx),a=null==o?void 0:o.svg;null!=a&&a.nodes&&(null==a||a.nodes.push(i)),bt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,re.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((N,dt)=>dt==this._slideIdx),o=null==r?void 0:r.svg,a=(N,dt)=>{let ht=null==N?void 0:N.find(Ft=>Ft.id==i);if(ht)return ht.pid=dt,ht;let xt=0,Nt=N.length||0;for(;xt<Nt&&!ht&&(ht=a(N[xt].nodes||[],N[xt].id),!ht);)xt++;return ht},y=a((null==o?void 0:o.nodes)||[]);var g,m,C,w,G;return y?(y.style=null!==(g=y.style)&&void 0!==g?g:{},y.source=null!==(m=y.source)&&void 0!==m?m:{},y.animate=null!==(C=y.animate)&&void 0!==C?C:{},y.interactive=null!==(w=y.interactive)&&void 0!==w?w:{},y.variable=null!==(G=y.variable)&&void 0!==G?G:{},y):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((g,m)=>m==this._slideIdx),o=null==r?void 0:r.svg,y=g=>{let m=(null==g?void 0:g.find(ht=>ht.id==i))||(g=>{let m=null,C=0,w=g.length||0;for(;C<w&&!m;){if(m=y(g[C].nodes),m){m.pid=g[C].id;break}C++}var G,N,dt,ht,xt;return m&&(m.style=null!==(G=m.style)&&void 0!==G?G:{},m.source=null!==(N=m.source)&&void 0!==N?N:{},m.animate=null!==(dt=m.animate)&&void 0!==dt?dt:{},m.interactive=null!==(ht=m.interactive)&&void 0!==ht?ht:{},m.variable=null!==(xt=m.variable)&&void 0!==xt?xt:{}),m})((null==g?void 0:g.filter(ht=>ht.type==T.$.GROUP))||[]);var C,w,G,N,dt;return m&&(m.style=null!==(C=m.style)&&void 0!==C?C:{},m.source=null!==(w=m.source)&&void 0!==w?w:{},m.animate=null!==(G=m.animate)&&void 0!==G?G:{},m.interactive=null!==(N=m.interactive)&&void 0!==N?N:{},m.variable=null!==(dt=m.variable)&&void 0!==dt?dt:{}),m};return y((null==o?void 0:o.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,o,a){var y;let g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.find((w,G)=>G==this._slideIdx),m=null==g?void 0:g.svg,C=w=>{let G=[];return w.filter(N=>!N.isdeleted).forEach(N=>{N.type==T.$.GROUP?G=G.concat(C(N.nodes||[])):i>N.size.x||n>N.size.y||r<N.size.x+N.size.width||o<N.size.y+N.size.height||(a?N.type==a&&G.push(N.id):G.push(N.id))}),G};return C((null==m?void 0:m.nodes)||[])}getNodeOnArea(i,n,r,o,a){var y;let g=null===(y=this._dataSource.slides)||void 0===y?void 0:y.find((w,G)=>G==this._slideIdx),m=null==g?void 0:g.svg,C=w=>{let G=[];return w.filter(N=>!N.isdeleted).forEach(N=>{N.type==T.$.GROUP?G=G.concat(C(N.nodes||[])):N.size.x+N.size.width<i||N.size.y+N.size.height<n||N.size.x>r||N.size.y>o||(a?N.type==a&&G.push(N.id):G.push(N.id))}),G};return C((null==m?void 0:m.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,re.E)(this.slide),(0,re.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let o=this.getNode(i),a=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(o)),{id:a})),Object.assign(o,{isdeleted:!0}),(0,re.E)(this.slide),(0,re.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),a}addGroup(i,n){var r;let o=this.getNode(i),a=this.getNode(n);a.nodes=a.nodes||[];let y=Math.ceil(1e9*Math.random());return a.nodes.push(Object.assign(JSON.parse(JSON.stringify(o)),{id:y})),Object.assign(o,{isdeleted:!0}),(0,re.E)(this.slide),(0,re.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),y}setNodeP(i,n){var r;let o=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(a=>a.id==i);o&&(o.pid=n||null)}bringToFront(i){this.bringToFrontStep(i,0)}sendToBack(i){this.sendToBackStep(i,0)}bringToFrontStep(i,n){var r,o,a,y;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((w,G)=>{w.index=G+1});let g=(null!==(o=null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a?void 0:a.nodes.length)&&void 0!==o?o:0)+1;var m,C;i.map(w=>{var G,N;return{id:w,index:null!==(G=null===(N=this.slide)||void 0===N||null===(N=N.svg)||void 0===N||null===(N=N.nodes.find(dt=>dt.id==w))||void 0===N?void 0:N.index)&&void 0!==G?G:0}}).sort((w,G)=>w.index-G.index).forEach(w=>{var N,G;n?null===(N=this.slide)||void 0===N||null===(N=N.svg)||void 0===N||N.nodes.filter((dt,ht)=>dt.id==w.id).forEach(dt=>{dt.index=n+w.index+w.index/1e3}):null===(G=this.slide)||void 0===G||null===(G=G.svg)||void 0===G||G.nodes.filter(dt=>dt.id==w.id).forEach(dt=>{dt.index=g+w.index})}),null===(y=this.slide)||void 0===y||null===(y=y.svg)||void 0===y||y.nodes.sort((w,G)=>{var N,dt;return(null!==(N=w.index)&&void 0!==N?N:0)-(null!==(dt=G.index)&&void 0!==dt?dt:0)}),(0,re.T)(this.slide),i.length<=1?(null===(m=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===m||m.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(C=window.document.getElementById(st.O.SELECT_GROUP))||void 0===C||C.remove(),(0,h.Q)(bt.dataSelect.nodes))}sendToBackStep(i,n){var r,o,a,y;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((g,m)=>{g.index=m+1}),i.map(g=>{var m,C;return{id:g,index:null!==(m=null===(C=this.slide)||void 0===C||null===(C=C.svg)||void 0===C||null===(C=C.nodes.find(w=>w.id==g))||void 0===C?void 0:C.index)&&void 0!==m?m:0}}).sort((g,m)=>g.index-m.index).forEach(g=>{var C,m;n?null===(C=this.slide)||void 0===C||null===(C=C.svg)||void 0===C||C.nodes.filter(w=>w.id==g.id).forEach(w=>{w.index=n+g.index+g.index/1e3}):null===(m=this.slide)||void 0===m||null===(m=m.svg)||void 0===m||m.nodes.filter(w=>w.id==g.id).forEach(w=>{w.index=g.index/100-1})}),null===(o=this.slide)||void 0===o||null===(o=o.svg)||void 0===o||o.nodes.sort((g,m)=>{var C,w;return(null!==(C=g.index)&&void 0!==C?C:0)-(null!==(w=m.index)&&void 0!==w?w:0)}),(0,re.T)(this.slide),i.length<=1?(null===(a=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===a||a.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(y=window.document.getElementById(st.O.SELECT_GROUP))||void 0===y||y.remove(),(0,h.Q)(bt.dataSelect.nodes))}bringToFrontArea(i){var n,r;let o=i.map(ht=>bt.data.getNode(ht)).filter(ht=>!ht.isfake),{x1:a,y1:y,x2:g,y2:m}=se(o),C=this.getNodeOnArea(a,y,g,m);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ht,xt)=>{ht.index=xt+1});let w=C.map(ht=>{var xt,Nt;return null!==(xt=null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||null===(Nt=Nt.nodes.find(Ft=>Ft.id==ht))||void 0===Nt?void 0:Nt.index)&&void 0!==xt?xt:0}),G=Math.max.apply(null,w);var N,dt;i.forEach((ht,xt)=>{var Nt;null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||Nt.nodes.filter(Ft=>Ft.id==ht).forEach(Ft=>{Ft.index=G+(xt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ht,xt)=>{var Nt,Ft;return(null!==(Nt=ht.index)&&void 0!==Nt?Nt:0)-(null!==(Ft=xt.index)&&void 0!==Ft?Ft:0)}),(0,re.T)(this.slide),i.length<=1?(null===(N=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===N||N.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(dt=window.document.getElementById(st.O.SELECT_GROUP))||void 0===dt||dt.remove(),(0,h.Q)(bt.dataSelect.nodes))}sendToBackArea(i){var n,r;let o=i.map(ht=>bt.data.getNode(ht)).filter(ht=>!ht.isfake),{x1:a,y1:y,x2:g,y2:m}=se(o),C=this.getNodeOnArea(a,y,g,m);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ht,xt)=>{ht.index=xt+1});let w=C.map(ht=>{var xt,Nt;return null!==(xt=null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||null===(Nt=Nt.nodes.find(Ft=>Ft.id==ht))||void 0===Nt?void 0:Nt.index)&&void 0!==xt?xt:0}),G=Math.min.apply(null,w)-1;var N,dt;i.forEach((ht,xt)=>{var Nt;null===(Nt=this.slide)||void 0===Nt||null===(Nt=Nt.svg)||void 0===Nt||Nt.nodes.filter(Ft=>Ft.id==ht).forEach(Ft=>{Ft.index=G+(xt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ht,xt)=>{var Nt,Ft;return(null!==(Nt=ht.index)&&void 0!==Nt?Nt:0)-(null!==(Ft=xt.index)&&void 0!==Ft?Ft:0)}),(0,re.T)(this.slide),i.length<=1?(null===(N=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===N||N.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(dt=window.document.getElementById(st.O.SELECT_GROUP))||void 0===dt||dt.remove(),(0,h.Q)(bt.dataSelect.nodes))}}const se=D=>{let i=999999,n=999999,r=-999999,o=-999999;return D.forEach(a=>{i=Math.min(i,a.size.x),n=Math.min(n,a.size.y),r=Math.max(r,a.size.x+a.size.width),o=Math.max(o,a.size.y+a.size.height)}),{x1:i,y1:n,x2:r,y2:o}};class de{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":bt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:o,size:a,attribute:y}=bt.data.getNode(n.from.id);Object.assign(a,n.from.size),Object.assign(y,(0,z.sg)(o,a,y)),(0,O.__)(window.document.getElementById(r),y);break}case"attribute":{let{id:r,attribute:o}=bt.data.getNode(n.from.id);Object.assign(o,n.from.attribute),(0,O.__)(window.document.getElementById(r),o);break}case"style":{let{id:r,style:o}=bt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.style),(0,O.DB)(window.document.getElementById(r),o);break}case"source":{let{id:r,type:o,source:a}=bt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.source),(0,O.QI)(window.document.getElementById(r),o,null!=a?a:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),bt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":bt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:o,size:a,attribute:y}=bt.data.getNode(n.to.id);Object.assign(a,n.to.size),Object.assign(y,(0,z.sg)(o,a,y)),(0,O.__)(window.document.getElementById(r),y);break}case"attribute":{let{id:r,attribute:o}=bt.data.getNode(n.to.id);Object.assign(o,n.to.attribute),(0,O.__)(window.document.getElementById(r),o);break}case"style":{let{id:r,style:o}=bt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.style),(0,O.DB)(window.document.getElementById(r),o);break}case"source":{let{id:r,type:o,source:a}=bt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.source),(0,O.QI)(window.document.getElementById(r),o,null!=a?a:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),bt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class xe{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}set svgViewBox(i){this._svgViewBox=i}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var o;if(!(i<.01||i>100)){if(n=null!==(o=n)&&void 0!==o?o:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var a={x:Math.max(0,Math.min((0,u.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,u.q)(n.y/this._height,1e3),1))},y={x:(this._width/i-this._width/this._scale)*a.x,y:(this._height/i-this._height/this._scale)*a.y};this._dislocation.x+=y.x,this._dislocation.y+=y.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,O.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var Qe=p(644);class He{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,Qe.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,Qe.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Pe=p(70),Je=p(5973),Ze=p(4787),Ee=function(D){return D&&JSON.parse(JSON.stringify(D))},De=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Ue=[],Ye={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},qe={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class Ge{constructor(){this._data_variables=Ee(De).concat(Ee(Ue)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Ee(De).concat(Ee(Ue)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(o=>o.change||[]).forEach(o=>{r=r.concat(o)}),r))([]),De.forEach(r=>{var o=this._data_variables.filter(a=>a.key==r.key);o.length?o.forEach(function(a,y,g){a.type=r.type,a.readonly=r.readonly,a.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Ee(Ye)}getConditionTemp(){return Ee(qe)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Ee((D=this._data_variables,i="key",function(n){for(var r of D.map(function(o){return o[i]}).sort())D.filter(function(o){return o[i]==r}).forEach(function(o){n.push(o)}),D=D.filter(function(o){return o[i]!=r});return n}([]))):Ee(De).concat(Ee(Ue));var D,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),De.forEach(n=>{var r=this._data_variables.filter(o=>o.key==n.key);r.length?r.forEach((o,a,y)=>{o.type=n.type,o.readonly=n.readonly,o.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Ee(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(a=>a.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var o=this._data_variables.filter(a=>a.key==i);o.length?o.forEach(function(a,y,g){a.value=n,a.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(y){return y.key==i});if(r.length){var a,o=r[0]||{};switch(this.OnGetActionExecuting(o),n||(n=o.type||null),n){case"string":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":"string"==typeof o.value?o.value||"":o.value.toString().trim();break;case"number":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?0:"number"==typeof o.value?o.value||0:parseFloat(o.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(o.value)>=0?a=!1:"boolean"==typeof o.value?a=o.value:(a=(o.value+"").toLowerCase(),a="1"==o.value||"true"==o.value||"yes"==o.value||"dung"==o.value);break;case"audio-src":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${o.value}"></source></audio>`:"";break;case"video-src":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${o.value}"></source></video>`:"";break;case"img-src":a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value?`<img style="width:100%;vertical-align:middle;" src="${o.value}"/>`:"";break;default:a=[null,void 0,NaN,1/0].indexOf(o.value)>=0?"":o.value}return this.OnGetActionExecuted(o),a}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(y){return y.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var o=this._data_variables.filter(function(y){return y.key==i});if(o.length){var a=o[0];this.OnSetActionExecuting(a),a&&(a.value=n),this.OnSetActionExecuted(a)}}}getConditionAll(){return Ee(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Ee(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(o){return n==o.trim()?1:0}).reduce(function(o,a){return o+a})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(o){return n==o.trim()?1:0}).reduce(function(o,a){return o+a})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(o){return n.indexOf(o.trim())>=0?1:0}).reduce(function(o,a){return o+a})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(o){return n.indexOf(o.trim())>=0?1:0}).reduce(function(o,a){return o+a});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(o,a){return o+a});case"sub":return n.reduce(function(o,a){return o-a});case"pro":return n.reduce(function(o,a){return o*a});case"div":return n.reduce(function(o,a){return o/a});case"avg":var r=n.reduce(function(o,a){return o+a})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(o,a){return o&&a});case"or":return n.reduce(function(o,a){return o||a});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Ee(n),{variable:r}))?0:1).reduce(function(r,o){return r+o})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Ee(n),{variable:r})));break;case"slide":Pe.$.runSlide(void 0,void 0,n.slide);break;case"node":{var o;(0,Ze.L5)({id:n.node,nodeStatus:Pe.$.nodeStatus,slideStatus:Pe.$.slideStatus});let a=Pe.$.findNode(n.node);null!=a&&null!==(o=a.interactive)&&void 0!==o&&o.click&&(0,Je.F)(a,Pe.$.nodeStatus,Pe.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Ve{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case A._.PEN:this._pen_type=n;break;case A._.SHAPE:this._shape_type=n,r&&n===T.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){switch(this._pointer_type=i,i){case A._.PEN:this._pen_type||(this._pen_type=Ct.D.DRAW);break;case A._.SHAPE:this._shape_type||(this._shape_type=T.$.RECT)}this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(o=>o(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(o=>o(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(o=>o(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(o=>o(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(o=>o(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(o=>o(i,n,r))}}const bt=new class ii{constructor(){this._container="",this._svg="",this._screen=xe.prototype,this._data=pe.prototype,this._dataSelect=Wt.prototype,this._slide=ne.prototype,this._history=de.prototype,this._attribute=He.prototype,this._pointer=Ve.prototype,this._variable=Ge.prototype,this._data=new pe,this._dataSelect=new Wt,this._slide=new ne,this._history=new de,this._attribute=new He,this._pointer=new Ve,this._variable=new Ge,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,o,a;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(o=null==i?void 0:i.left)&&void 0!==o?o:0,y:null!==(a=null==i?void 0:i.top)&&void 0!==a?a:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new xe,(D=>{new O.Mh(D.container,D.target),bt.pointer.onchange=(r,o,a)=>{switch(r){case A._.POINTER:jQuery(D.target).css({cursor:"auto"});break;case A._.HAND:jQuery(D.target).css({cursor:"grab"});break;case A._.PEN:switch(o){case Ct.D.DRAW:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case Ct.D.HIGHTLIGH:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case A._.ERASER:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case A._.SHAPE:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case A._.TEXT:case A._.FOREIGNOBJECT:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(D.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{bt.pointer.pointer_type==A._.HAND&&jQuery(D.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{bt.pointer.pointer_type==A._.HAND&&jQuery(D.target).css({cursor:"grab"})}),jQuery(D.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var o;r.preventDefault();var a=bt.screen.scale,y=(null!==(o=r.originalEvent)&&void 0!==o?o:r).deltaY>0?1:-1;bt.screen.scaleTo(a-.04*a*y,(0,mt.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},bt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{bt.screen.actived=!!jQuery(r.target).parents(bt.container).length}),jQuery(D.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{bt.screen.actived=!0}),jQuery(D.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{bt.screen.actived=!1,bt.pointer.pointer_type_temp==A._.HAND&&(bt.pointer.pointer_type_temp=A._.POINTER)}),jQuery(D.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(D.container.includes("#")&&D.container.includes(r.target.getAttribute("id"))||D.container.includes(".")&&D.container.includes(r.target.getAttribute("class"))||D.container.includes(r.target.nodeName))&&(bt.pointer.pointer_type_temp||bt.pointer.pointer_type)===A._.POINTER&&(bt.dataSelect.ids=[])}),jQuery(D.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(bt.pointer.pointer_type_temp||bt.pointer.pointer_type){case A._.POINTER:f(r);break;case A._.HAND:(D=>{(0,gt.A)(D,new S,1,{x:0,y:0})})(r);break;case A._.PEN:(0,qt.i)(r);break;case A._.SHAPE:(D=>{var i=null;switch(bt.pointer.shape_type){case T.$.CIRCLE:i=new K;break;case T.$.ELLIPSE:i=new X;break;case T.$.LINE:i=new Gt;break;case T.$.RECT:i=new ot;break;case T.$.POLYGON:var n;i=new _t(null===(n=_.find(r=>r.type==bt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case T.$.FOREIGNOBJECT:i=new B;break;case T.$.IMAGE:i=new wt;break;case T.$.TEXT:case T.$.PATH:i=new St}i&&(0,gt.A)(D,i)})(r);break;case A._.FOREIGNOBJECT:(D=>{(0,gt.A)(D,new B)})(r);break;case A._.IMAGE:(D=>{(0,gt.A)(D,new wt)})(r);break;case A._.TEXT:(D=>{(0,gt.A)(D,new Q)})(r);break;case A._.ERASER:(D=>{(0,gt.A)(D,new ft)})(r);break;case A._.INDEX:(0,pt.s)(r)}};let n=!1;jQuery(D.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(D.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),D.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,rt.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,rt.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4531:(oe,Lt,p)=>{p.d(Lt,{s:()=>R,Q:()=>f});var A=p(1687),O=p(4981),st=p(4318),z=p(6816),gt=p(7492);const R=M=>{var S,T,Z,_;let I=(null===(S=M.mouseEvent)||void 0===S?void 0:S.target)||(null===(T=M.touchEvent)||void 0===T?void 0:T.target),u=(null==I?void 0:I.getAttribute("id"))||"",K=null==I?void 0:I.nodeName,L=jQuery(I).parents("g[id]").attr("id")||"";if(![A.O.INDEX_GROUP].includes(L))if(null!==(Z=M.mouseEvent)&&void 0!==Z&&Z.altKey||null!==(_=M.touchEvent)&&void 0!==_&&_.altKey||!u||u.match(/[^0-9]/)||!O.icdt.dataSelect.nodeName.includes(K)){var X;O.icdt.dataSelect.ids.length&&(O.icdt.dataSelect.ids=[]),(0==(null===(X=M.mouseEvent)||void 0===X?void 0:X.button)||M.touchEvent)&&((M,S)=>{let u=(0,gt.g1)(A.O.SCAN_GROUP,"g"),K=(0,st.bH)(0,0,1,1);(0,gt.vl)(u,K),((M,S,T,Z)=>{(0,z.A)(M,{start:u=>{},move:(u,K)=>{((u,K,L,X)=>{S=(0,st.bH)(u,K,L,X),(0,gt.vl)(T,S)})(K[0][0],K[0][1],u.x,u.y)},end:(u,K)=>{null==T||T.remove(),O.icdt.dataSelect.ids=O.icdt.data.getNodeInArea(Math.min(K[0][0],u.x),Math.min(K[0][1],u.y),Math.max(K[0][0],u.x),Math.max(K[0][1],u.y)),Z(O.icdt.dataSelect.nodes)}})})(M,K,u,S)})(M,P)}else{var et,ot;let j=parseFloat(u||"0");O.icdt.dataSelect.ids=null!==(et=M.mouseEvent)&&void 0!==et&&et.shiftKey||null!==(ot=M.touchEvent)&&void 0!==ot&&ot.shiftKey?[j].concat(O.icdt.dataSelect.ids).filter((Bt,Gt,Mt)=>Mt.indexOf(Bt)==Gt):[j],P(O.icdt.dataSelect.nodes)}},P=M=>{var S,T;let Z=1;var _,I;if(M.length&&(Z=Math.max.apply(null,null!==(_=null===(I=O.icdt.data.slide)||void 0===I||null===(I=I.svg)||void 0===I?void 0:I.nodes.map(K=>{var L;return null!==(L=K.idx)&&void 0!==L?L:0}))&&void 0!==_?_:[0])+1),1==M.length)M[0].idx||(M[0].idx=Z,M[0].time=0);else if(M.length>=0){let K=M.map(X=>{var et;return null!==(et=X.idx)&&void 0!==et?et:0}).filter(X=>X>0),L=K.length?Math.min.apply(null,K):Z;M.forEach(X=>{var et;X.idx=L,X.time=null!==(et=X.time)&&void 0!==et?et:0})}let u=(0,gt.g1)(A.O.INDEX_GROUP,"g");(0,gt.mo)(u,null!==(S=null===(T=O.icdt.data.slide)||void 0===T||null===(T=T.svg)||void 0===T?void 0:T.nodes)&&void 0!==S?S:[])},f=M=>{var S,T,Z;null!=M&&null!==(S=M.svg)&&void 0!==S&&S.nodes&&M.svg.nodes.forEach(I=>{I.idx=0,I.time=null});let _=(0,gt.g1)(A.O.INDEX_GROUP,"g");(0,gt.mo)(_,null!==(T=null===(Z=O.icdt.data.slide)||void 0===Z||null===(Z=Z.svg)||void 0===Z?void 0:Z.nodes)&&void 0!==T?T:[])}},4578:(oe,Lt,p)=>{p.d(Lt,{h:()=>S,t:()=>T});var A=p(644),O=p(9451),st=p(968),z=p(4981),gt=p(666),b=p(3171),h=p(5226),R=p(3423),P=p(5811),f=p(3385);const S=new class M{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:O.s.Escape,fn:()=>{z.icdt.dataSelect.ids.length&&(z.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:O.s.Delete,fn:()=>{z.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:O.s.Space,fn:()=>{z.icdt.pointer.pointer_type_temp=st._.HAND}},this.onchange={type:"keyup",key:O.s.Space,fn:()=>{z.icdt.pointer.pointer_type_temp=st._.POINTER}},this.onchange={type:"keydown",key:O.s.ArrowLeft,fn:()=>{z.icdt.dataSelect.ids.length||z.icdt.data.backSlide()}},this.onchange={type:"keydown",key:O.s.ArrowRight,fn:()=>{z.icdt.dataSelect.ids.length||z.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:O.s.ArrowLeft,fn:()=>{z.icdt.dataSelect.ids.length&&(z.icdt.dataSelect.nodes.forEach(_=>{(0,f.k6)(_,(0,P.q)(_.size.x-(0,R.v)(1)))}),1==z.icdt.dataSelect.ids.length?(0,gt.y)(z.icdt.dataSelect.nodes[0]):(0,b.Q)(z.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowRight,fn:()=>{z.icdt.dataSelect.ids.length&&(z.icdt.dataSelect.nodes.forEach(_=>{(0,f.k6)(_,(0,P.q)(_.size.x+(0,R.v)(1)))}),1==z.icdt.dataSelect.ids.length?(0,gt.y)(z.icdt.dataSelect.nodes[0]):(0,b.Q)(z.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowUp,fn:()=>{z.icdt.dataSelect.ids.length&&(z.icdt.dataSelect.nodes.forEach(_=>{(0,f.co)(_,(0,P.q)(_.size.y-(0,R.v)(1)))}),1==z.icdt.dataSelect.ids.length?(0,gt.y)(z.icdt.dataSelect.nodes[0]):(0,b.Q)(z.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.ArrowDown,fn:()=>{z.icdt.dataSelect.ids.length&&(z.icdt.dataSelect.nodes.forEach(_=>{(0,f.co)(_,(0,P.q)(_.size.y+(0,R.v)(1)))}),1==z.icdt.dataSelect.ids.length?(0,gt.y)(z.icdt.dataSelect.nodes[0]):(0,b.Q)(z.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:O.s.Digit1,fn:_=>{_.shiftKey&&(z.icdt.reloadView(),z.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:O.s.KeyA,fn:_=>{if(_.ctrlKey){z.icdt.dataSelect.ids=z.icdt.data.getNodeAll();let I=z.icdt.dataSelect.nodes;1==I.length?(0,gt.y)(I[0]):I.length>1&&(0,b.Q)(I)}}},this.onchange={type:"keydown",key:O.s.KeyC,fn:_=>{if(_.ctrlKey){let I=z.icdt.dataSelect.nodes;I&&(0,A.yR)({params:{type:"nodes",nodes:I}})}}},this.onchange={type:"keydown",key:O.s.KeyV,fn:_=>{_.ctrlKey&&(0,A.aY)({callback:I=>{var u,K;"nodes"==(null==I?void 0:I.type)&&null!=I&&null!==(u=I.nodes)&&void 0!==u&&u.length&&(null==I||null===(K=I.nodes)||void 0===K||K.forEach(L=>{L.id=Math.ceil(1e9*Math.random()),z.icdt.data.node=L}),(0,h.E)(z.icdt.data.slide))}})}},this.onchange={type:"keydown",key:O.s.KeyZ,fn:_=>{_.ctrlKey&&_.shiftKey?z.icdt.history.redo():_.ctrlKey&&z.icdt.history.undo()}},this.onchange={type:"keydown",key:O.s.BracketLeft,fn:_=>{_.ctrlKey&&_.shiftKey?z.icdt.data.sendToBack(z.icdt.dataSelect.ids):_.ctrlKey?z.icdt.data.sendToBackStep(z.icdt.dataSelect.ids,-2):z.icdt.data.sendToBackArea(z.icdt.dataSelect.ids)}},this.onchange={type:"keydown",key:O.s.BracketRight,fn:_=>{_.ctrlKey&&_.shiftKey?z.icdt.data.bringToFront(z.icdt.dataSelect.ids):_.ctrlKey?z.icdt.data.bringToFrontStep(z.icdt.dataSelect.ids,1):z.icdt.data.bringToFrontArea(z.icdt.dataSelect.ids)}}}set onchange(_){let I=this._fnChanges.find(u=>u.eventType==_.type&&u.eventKey==_.key);I?I.fns.push(_.fn):this._fnChanges.push({eventType:_.type,eventKey:_.key,fns:[_.fn]})}change(_,I,u){var K;null===(K=this._fnChanges.find(L=>L.eventType==_&&L.eventKey==I))||void 0===K||K.fns.forEach(L=>L(u))}},T=Z=>{S.change(Z.type,Z.keyCode||Z.which||Z.charCode||0,Z)}},410:(oe,Lt,p)=>{p.d(Lt,{a:()=>f});var A=p(4318),O=p(9322),st=p(9054),z=p(7492),gt=p(511),b=p(3423),h=p(1687),R=p(4981),P=p(8619);class f{constructor(S,T){var Z,_,I,u;let K={stroke:"#FF0000",strokeWidth:(0,b.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,b.v)(8)},{element:L,attribute:X,size:et}=(0,O.G)(Math.ceil(1e9*Math.random()),{size:T});window.document.getElementById(h.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(Mt=>null==Mt?void 0:Mt.remove()),window.document.getElementById(h.O.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(Mt=>null==Mt?void 0:Mt.remove()),null===(Z=window.document.getElementById(h.O.INTERACTIVE_GROUP))||void 0===Z||Z.appendChild(L);var ot=(Mt,It)=>{Mt&&((St=>{let{element:it}=(0,P._)(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==It?"#FF0000":"#00BA00",strokeWidth:(0,b.v)(1)},size:{x:Mt[0]-5,y:Mt[1]-5,width:10,height:10}});null===(St=window.document.getElementById(h.O.INTERACTIVE_GROUP))||void 0===St||St.prepend(it)})(),((St,it)=>{let{size:B}=null!==(St=null!=S?S:R.icdt.dataSelect.nodes[0])&&void 0!==St?St:{};if(!B)return;let yt=[[Mt[0]-B.width/2,Mt[1]-B.height/2],[Mt[0]+B.width/2,Mt[1]-B.height/2],[Mt[0]+B.width/2,Mt[1]+B.height/2],[Mt[0]-B.width/2,Mt[1]+B.height/2],[Mt[0]-B.width/2,Mt[1]-B.height/2]],{element:wt}=(0,O.G)(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:(0,b.v)(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,b.v)(8)},size:{x:0,y:0,width:10,height:10,points:yt}});null===(it=window.document.getElementById(h.O.INTERACTIVE_GROUP))||void 0===it||it.prepend(wt)})())};(0,z.__)(L,K),ot(null!=T&&null!==(_=T.points)&&void 0!==_&&_.length?T.points[0]:void 0),ot(null!=T&&null!==(I=T.points)&&void 0!==I&&I.length&&(null==T||null===(u=T.points)||void 0===u?void 0:u.length)>=2?T.points[T.points.length-1]:void 0);let _t="";return{start:Mt=>{_t=`M ${Mt.x} ${Mt.y} L ${Mt.x} ${Mt.y}`},move:(Mt,It)=>{((Mt,It)=>{_t+=` ${Mt} ${It}`,L.setAttribute("d",_t)})(Mt.x,Mt.y)},end:(Mt,It)=>{(Mt=>{let St=gt.jvg().x(it=>it[0]).y(it=>it[1]).curve(gt.$0Z)(Mt);L.setAttribute("d",St),Mt.length>=2&&(window.interactivePoints=Mt)})(It),(Mt=>{let It=9999,St=9999,it=-9999,B=-9999;Mt.forEach(yt=>{It=Math.min(It,yt[0]),St=Math.min(St,yt[1]),it=Math.max(it,yt[0]),B=Math.max(B,yt[1])}),et=(0,A.bH)(It,St,it,B,{points:Mt}),Object.assign(X,(0,A.sg)(st.$.PATH,et,X),K)})(It),ot(It.length?It[0]:void 0,"start"),ot(It.length>=2?It[It.length-1]:void 0,"end")}}}}},9623:(oe,Lt,p)=>{p.d(Lt,{U:()=>Z,i:()=>T});var A=p(1687),O=p(9125),st=p(4981),z=p(6816),gt=p(7492),b=p(511),h=p(9322),R=p(9054),P=p(7851);class f{constructor(){let I={stroke:st.icdt.attribute.stroke,strokeWidth:st.icdt.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:u,element:K,attribute:L,size:X}=(0,h.G)(Math.ceil(1e9*Math.random()),{attribute:I});(0,gt.__)(K,L);let et="",ot="";return{start:_t=>{et=`M ${_t.x} ${_t.y} L ${_t.x} ${_t.y}`},move:(_t,Bt)=>{((_t,Bt)=>{et+=` ${_t} ${Bt}`,K.setAttribute("d",et)})(_t.x,_t.y)},end:(_t,Bt)=>{var Gt;Bt.length>=3?(ot=null!==(Gt=b.jvg().x(wt=>wt[0]).y(wt=>wt[1]).curve(b.$0Z)(Bt))&&void 0!==Gt?Gt:"",K.setAttribute("d",ot)):K.setAttribute("d",et);let Mt=(0,P.n2)(ot||et),{minX:It,minY:St,maxX:it,maxY:B}=(0,P.yo)(Mt);X.x=It,X.y=St,X.width=it-It||1,X.height=B-St||1,X.ratioMaps=(0,P.IX)(X,Mt),st.icdt.data.node=Object.assign({id:u,type:R.$.PATH,name:"Path"},{size:X,attribute:L})}}}}class M{constructor(){let I={stroke:st.icdt.attribute.stroke,strokeOpacity:.4,strokeWidth:st.icdt.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:u,element:K,attribute:L,size:X}=(0,h.G)(Math.ceil(1e9*Math.random()),{attribute:I});(0,gt.__)(K,L);let et="";return{start:_t=>{et=`M ${_t.x} ${_t.y} L ${_t.x} ${_t.y}`},move:(_t,Bt)=>{((_t,Bt)=>{et+=` ${_t} ${Bt}`,K.setAttribute("d",et)})(_t.x,_t.y)},end:(_t,Bt)=>{let Gt=(0,P.n2)(et),{minX:Mt,minY:It,maxX:St,maxY:it}=(0,P.yo)(Gt);X.x=Mt,X.y=It,X.width=St-Mt||1,X.height=it-It||1,X.ratioMaps=(0,P.IX)(X,Gt),st.icdt.data.node=Object.assign({id:u,type:R.$.PATH,name:"Path"},{size:X,attribute:L})}}}}var S=p(410);const T=_=>{switch(st.icdt.pointer.pen_type){case O.D.DRAW:(0,z.A)(_,new f);break;case O.D.HIGHTLIGH:(0,z.A)(_,new M);break;case O.D.INTERACTIVE:Z(_)}},Z=_=>{var I,u;let K=(0,gt.g1)(A.O.INTERACTIVE_GROUP,"g"),L=null!==(I=null===(u=st.icdt.data.slide)||void 0===u||null===(u=u.svg)||void 0===u?void 0:u.viewBox)&&void 0!==I?I:(()=>{let{width:X,height:et}=st.icdt.screen.get;return{x:0,y:0,width:X,height:et}})();(0,gt.XH)(K,L),_&&(0,z.A)(_,new S.a)}},666:(oe,Lt,p)=>{p.d(Lt,{y:()=>h});var A=p(1687),O=p(4981),st=p(4318),z=p(6816),gt=p(7492),b=p(5811);const h=f=>{let M=(0,gt.g1)(A.O.RESIZE_GROUP,"g");(0,gt.hJ)(M,f).forEach(S=>{R(S.element,S.posType,f,M)})},R=(f,M,S,T)=>{let Z=!1;null==f||f.addEventListener("touchstart",_=>{Z=!0,P({touchEvent:_},M,S,T)}),null==f||f.addEventListener("mousedown",_=>{if(0==_.button){if(Z)return void(Z=!1);P({mouseEvent:_},M,S,T)}})},P=(f,M,S,T)=>{let j,{id:Z,type:_,size:I,attribute:u}=S,{x:K,y:L,width:X,height:et}=I,ot=(X||1)/(et||1),Bt=null,It=!1;(0,z.A)(f,{start:it=>{Bt=JSON.parse(JSON.stringify({id:Z,size:I,attribute:u}))},move:(it,B)=>{((it,B,yt,wt)=>{let Ot=yt-it,rt=wt-B;switch(M){case"rect-center":var qt,J;j=null!==(qt=f.mouseEvent)&&void 0!==qt&&qt.shiftKey||null!==(J=f.touchEvent)&&void 0!==J&&J.shiftKey?Math.abs(yt-it)>=Math.abs(wt-B)?{x:K+yt-it,y:L,width:X,height:et}:{x:K,y:L+wt-B,width:X,height:et}:{x:K+yt-it,y:L+wt-B,width:X,height:et};break;case"rect-top-left":var tt,d,nt,Et,At,Dt,Vt,Jt;j=(null!==(tt=f.mouseEvent)&&void 0!==tt&&tt.shiftKey||null!==(d=f.touchEvent)&&void 0!==d&&d.shiftKey)&&(null!==(nt=f.mouseEvent)&&void 0!==nt&&nt.altKey||null!==(Et=f.touchEvent)&&void 0!==Et&&Et.altKey)?ot>=1?{x:K+(yt-it),y:L+(yt-it)/ot,width:X-2*(yt-it),height:et-2*(yt-it)/ot}:{x:K+(wt-B)*ot,y:L+(wt-B),width:X-2*(wt-B)*ot,height:et-2*(wt-B)}:null!==(At=f.mouseEvent)&&void 0!==At&&At.shiftKey||null!==(Dt=f.touchEvent)&&void 0!==Dt&&Dt.shiftKey?ot>=1?{x:K+(yt-it),y:L+(yt-it)/ot,width:X-(yt-it),height:et-(yt-it)/ot}:{x:K+(wt-B)*ot,y:L+(wt-B),width:X-(wt-B)*ot,height:et-(wt-B)}:null!==(Vt=f.mouseEvent)&&void 0!==Vt&&Vt.altKey||null!==(Jt=f.touchEvent)&&void 0!==Jt&&Jt.altKey?{x:K+(yt-it),y:L+(wt-B),width:X-2*(yt-it),height:et-2*(wt-B)}:{x:K+(yt-it),y:L+(wt-B),width:X-(yt-it),height:et-(wt-B)};break;case"rect-top-right":var Tt,vt,te,Y,v,H,ft,ut;j=(null!==(Tt=f.mouseEvent)&&void 0!==Tt&&Tt.shiftKey||null!==(vt=f.touchEvent)&&void 0!==vt&&vt.shiftKey)&&(null!==(te=f.mouseEvent)&&void 0!==te&&te.altKey||null!==(Y=f.touchEvent)&&void 0!==Y&&Y.altKey)?ot>=1?{x:K-(yt-it),y:L-(yt-it)/ot,width:X+2*(yt-it),height:et+2*(yt-it)/ot}:{x:K+(wt-B)*ot,y:L+(wt-B),width:X-2*(wt-B)*ot,height:et-2*(wt-B)}:null!==(v=f.mouseEvent)&&void 0!==v&&v.shiftKey||null!==(H=f.touchEvent)&&void 0!==H&&H.shiftKey?ot>=1?{x:K,y:L-(yt-it)/ot,width:X+(yt-it),height:et+(yt-it)/ot}:{x:K,y:L+(wt-B),width:X-(wt-B)*ot,height:et-(wt-B)}:null!==(ft=f.mouseEvent)&&void 0!==ft&&ft.altKey||null!==(ut=f.touchEvent)&&void 0!==ut&&ut.altKey?{x:K-(yt-it),y:L+(wt-B),width:X+2*(yt-it),height:et-2*(wt-B)}:{x:K,y:L+(wt-B),width:X+(yt-it),height:et-(wt-B)};break;case"rect-bottom-left":var q,Q,V,x,U,pt,Ct,mt;j=(null!==(q=f.mouseEvent)&&void 0!==q&&q.shiftKey||null!==(Q=f.touchEvent)&&void 0!==Q&&Q.shiftKey)&&(null!==(V=f.mouseEvent)&&void 0!==V&&V.altKey||null!==(x=f.touchEvent)&&void 0!==x&&x.altKey)?ot>=1?{x:K+(yt-it),y:L+(yt-it)/ot,width:X-2*(yt-it),height:et-2*(yt-it)/ot}:{x:K-(wt-B)*ot,y:L-(wt-B),width:X+2*(wt-B)*ot,height:et+2*(wt-B)}:null!==(U=f.mouseEvent)&&void 0!==U&&U.shiftKey||null!==(pt=f.touchEvent)&&void 0!==pt&&pt.shiftKey?ot>=1?{x:K+(yt-it),y:L,width:X-(yt-it),height:et-(yt-it)/ot}:{x:K-(wt-B)*ot,y:L,width:X+(wt-B)*ot,height:et+(wt-B)}:null!==(Ct=f.mouseEvent)&&void 0!==Ct&&Ct.altKey||null!==(mt=f.touchEvent)&&void 0!==mt&&mt.altKey?{x:K+(yt-it),y:L-(wt-B),width:X-2*(yt-it),height:et+2*(wt-B)}:{x:K+(yt-it),y:L,width:X-(yt-it),height:et+(wt-B)};break;case"rect-bottom-right":var Pt,zt,Wt,Ht,ne,re,pe,se;j=(null!==(Pt=f.mouseEvent)&&void 0!==Pt&&Pt.shiftKey||null!==(zt=f.touchEvent)&&void 0!==zt&&zt.shiftKey)&&(null!==(Wt=f.mouseEvent)&&void 0!==Wt&&Wt.altKey||null!==(Ht=f.touchEvent)&&void 0!==Ht&&Ht.altKey)?ot>=1?{x:K-(yt-it),y:L-(yt-it)/ot,width:X+2*(yt-it),height:et+2*(yt-it)/ot}:{x:K-(wt-B)*ot,y:L-(wt-B),width:X+2*(wt-B)*ot,height:et+2*(wt-B)}:null!==(ne=f.mouseEvent)&&void 0!==ne&&ne.shiftKey||null!==(re=f.touchEvent)&&void 0!==re&&re.shiftKey?ot>=1?{x:K,y:L,width:X+(yt-it),height:et+(yt-it)/ot}:{x:K,y:L,width:X+(wt-B)*ot,height:et+(wt-B)}:null!==(pe=f.mouseEvent)&&void 0!==pe&&pe.altKey||null!==(se=f.touchEvent)&&void 0!==se&&se.altKey?{x:K-(yt-it),y:L-(wt-B),width:X+2*(yt-it),height:et+2*(wt-B)}:{x:K,y:L,width:X+(yt-it),height:et+(wt-B)};break;case"rect-top":var de,xe,Qe,He;j=null!==(de=f.mouseEvent)&&void 0!==de&&de.shiftKey||null!==(xe=f.touchEvent)&&void 0!==xe&&xe.shiftKey?{x:K+rt/2*ot,y:L+rt,width:X-rt*ot,height:et-rt}:null!==(Qe=f.mouseEvent)&&void 0!==Qe&&Qe.altKey||null!==(He=f.touchEvent)&&void 0!==He&&He.altKey?{x:K,y:L+rt,width:X,height:et-2*rt}:{x:K,y:L+rt,width:X,height:et-rt};break;case"rect-bottom":var Pe,Je,Ze,ei;j=null!==(Pe=f.mouseEvent)&&void 0!==Pe&&Pe.shiftKey||null!==(Je=f.touchEvent)&&void 0!==Je&&Je.shiftKey?{x:K-rt/2*ot,y:L,width:X+rt*ot,height:et+rt}:null!==(Ze=f.mouseEvent)&&void 0!==Ze&&Ze.altKey||null!==(ei=f.touchEvent)&&void 0!==ei&&ei.altKey?{x:K,y:L-rt,width:X,height:et+2*rt}:{x:K,y:L,width:X,height:et+rt};break;case"rect-left":var Ee,Xe,De,Ue;j=null!==(Ee=f.mouseEvent)&&void 0!==Ee&&Ee.shiftKey||null!==(Xe=f.touchEvent)&&void 0!==Xe&&Xe.shiftKey?{x:K+Ot,y:L+Ot/2/ot,width:X-Ot,height:et-Ot/ot}:null!==(De=f.mouseEvent)&&void 0!==De&&De.altKey||null!==(Ue=f.touchEvent)&&void 0!==Ue&&Ue.altKey?{x:K+Ot,y:L,width:X-2*Ot,height:et}:{x:K+Ot,y:L,width:X-Ot,height:et};break;case"rect-right":var Ye,qe,Ge,Ve;j=null!==(Ye=f.mouseEvent)&&void 0!==Ye&&Ye.shiftKey||null!==(qe=f.touchEvent)&&void 0!==qe&&qe.shiftKey?{x:K,y:L-Ot/2/ot,width:X+Ot,height:et+Ot/ot}:null!==(Ge=f.mouseEvent)&&void 0!==Ge&&Ge.altKey||null!==(Ve=f.touchEvent)&&void 0!==Ve&&Ve.altKey?{x:K-Ot,y:L,width:X+2*Ot,height:et}:{x:K,y:L,width:X+Ot,height:et};break;default:j={x:K+yt-it,y:L+wt-B,width:X,height:et}}j.width<0&&(j.width=0),j.height<0&&(j.height=0),j.x=(0,b.q)(j.x),j.y=(0,b.q)(j.y),j.width=(0,b.q)(j.width),j.height=(0,b.q)(j.height),Object.assign(I,j),Object.assign(u,(0,st.sg)(_,I,u)),(0,gt.__)(window.document.getElementById(Z),u),(0,gt.hJ)(T,S)})(B[0][0],B[0][1],it.x,it.y),It=!0},end:(it,B)=>{It&&Bt&&O.icdt.history.push([{type:"size",from:Bt,to:JSON.parse(JSON.stringify({id:Z,size:I,attribute:u}))}])}})}},3171:(oe,Lt,p)=>{p.d(Lt,{Q:()=>h});var A=p(1687),O=p(4981),st=p(4318),z=p(6816),gt=p(7492),b=p(5811);const h=f=>{let M=999999,S=999999,T=-999999,Z=-999999;null==f||f.forEach(u=>{M=Math.min(M,u.size.x),S=Math.min(S,u.size.y),T=Math.max(T,u.size.x+u.size.width),Z=Math.max(Z,u.size.y+u.size.height)});let _=(0,gt.g1)(A.O.SELECT_GROUP,"g"),I=(0,st.bH)(M,S,T,Z);(0,gt.yD)(_,f,I).forEach(u=>{R(u.element,u.posType,I,f,_)})},R=(f,M,S,T,Z)=>{let _=!1;null==f||f.addEventListener("touchstart",I=>{_=!0,P({touchEvent:I},M,S,T,Z)}),null==f||f.addEventListener("mousedown",I=>{if(0==I.button){if(_)return void(_=!1);P({mouseEvent:I},M,S,T,Z)}})},P=(f,M,S,T,Z)=>{let{x:_,y:I,width:u,height:K}=S,L=T.map(Bt=>Object.assign({},Bt.size)),et=[];(0,z.A)(f,{start:Bt=>{T.forEach((Bt,Gt)=>{let{id:Mt,size:St,attribute:it}=Bt;et.push(JSON.parse(JSON.stringify({id:Mt,size:St,attribute:it})))})},move:(Bt,Gt)=>{((Bt,Gt,Mt,It)=>{(()=>{let St;St="rect-center"===M?{x:_+Mt-Bt,y:I+It-Gt,width:u,height:K}:{x:_,y:I,width:u,height:K},St.width<0&&(St.width=0),St.height<0&&(St.height=0),Object.assign(S,St),(0,gt.yD)(Z,T,S)})(),T.forEach((St,it)=>{let d,{x:B,y:yt,width:wt,height:Ot}=L[it],{id:rt,type:qt,size:J,attribute:tt}=St;d="rect-center"===M?{x:B+Mt-Bt,y:yt+It-Gt,width:wt,height:Ot}:{x:B,y:yt,width:wt,height:Ot},d.width<0&&(d.width=0),d.height<0&&(d.height=0),d.x=(0,b.q)(d.x),d.y=(0,b.q)(d.y),d.width=(0,b.q)(d.width),d.height=(0,b.q)(d.height),Object.assign(J,d),Object.assign(tt,(0,st.sg)(qt,J,tt)),(0,gt.__)(window.document.getElementById(rt),tt)})})(Gt[0][0],Gt[0][1],Bt.x,Bt.y)},end:(Bt,Gt)=>{et.length&&O.icdt.history.push(T.map((Bt,Gt)=>{let{id:Mt,size:St,attribute:it}=Bt;return{type:"size",from:et[Gt],to:JSON.parse(JSON.stringify({id:Mt,size:St,attribute:it}))}}))}})}},5226:(oe,Lt,p)=>{p.d(Lt,{E:()=>_,T:()=>I});var A=p(1687),O=p(8619),st=p(8785),z=p(2282),gt=p(8054),b=p(4921),h=p(6358),R=p(9054),P=p(9322),f=p(1105),M=p(2875),S=p(7210),T=p(4981),Z=p(7492);const _=(u,K,L)=>{var X;if(K&&!(null!=L?L:window).document.getElementById(K))return;if("localhost"==location.hostname&&console.log("\xe1\xe1\xe1\xe1\xe1\xe1 s\u1ee3 qu\xe1 \u0111iiiiiiiiiiiiiiiiiiiiiiiiiii!",K),K){let ot=(null!=L?L:window).document.getElementById(K);jQuery(ot).find("#"+A.O.BACKGROUND_GROUP).empty();let j=(0,Z.g1)(A.O.BACKGROUND_GROUP,"g",void 0,ot);(0,Z.x0)(j,u)}else{jQuery(T.icdt.target).find("#"+A.O.BACKGROUND_GROUP).empty();let ot=(0,Z.g1)(A.O.BACKGROUND_GROUP,"g",void 0,T.icdt.target);(0,Z.x0)(ot,u)}let et=(ot,j)=>{j=K&&j?`${K}-${j}`:null!=K?K:j,null==ot||ot.forEach(_t=>{let Bt=K?`${K}-${_t.id}`:_t.id;var Gt;if(_t.isdeleted)null===(Gt=(null!=L?L:window).document.getElementById(Bt))||void 0===Gt||Gt.remove();else switch(_t.type){case R.$.GROUP:(0,h.m)(Bt,{},j?(null!=L?L:window).document.getElementById(j):null),et(_t.nodes,_t.id);break;case R.$.CIRCLE:(0,O._)(Bt,{size:_t.size,attribute:_t.attribute},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.ELLIPSE:(0,st.r)(Bt,{size:_t.size,attribute:_t.attribute},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.LINE:(0,b.W)(Bt,{size:_t.size,attribute:_t.attribute},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.RECT:(0,gt.f)(Bt,{size:_t.size,attribute:_t.attribute},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.POLYGON:(0,z.l)(Bt,{size:_t.size,attribute:_t.attribute},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.FOREIGNOBJECT:(0,M.e)(Bt,{size:_t.size,attribute:_t.attribute,style:_t.style,source:_t.source},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.IMAGE:(0,S.G)(Bt,{size:_t.size,attribute:_t.attribute,source:_t.source},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.TEXT:(0,f.$)(Bt,{size:_t.size,attribute:_t.attribute,source:_t.source},j?(null!=L?L:window).document.getElementById(j):null);break;case R.$.PATH:(0,P.G)(Bt,{size:_t.size,attribute:_t.attribute},j?(null!=L?L:window).document.getElementById(j):null)}})};et(null==u||null===(X=u.svg)||void 0===X?void 0:X.nodes)},I=(u,K)=>{var L;if(K&&!window.document.getElementById(K))return;let X=(et,ot)=>{ot=ot?`${K}-${ot}`:K,null==et||et.forEach(j=>{jQuery("#"+(K?`${K}-${j.id}`:j.id)).appendTo(ot?window.document.getElementById(ot):T.icdt.target),j.type==R.$.GROUP&&X(j.nodes,j.id)})};X(null==u||null===(L=u.svg)||void 0===L?void 0:L.nodes)}},8619:(oe,Lt,p)=>{p.d(Lt,{_:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(A.$.CIRCLE,P,f)),{nodeId:b,element:(0,z.it)(b,A.$.CIRCLE,"circle",{size:P,attribute:f},R),size:P,attribute:f}}},8785:(oe,Lt,p)=>{p.d(Lt,{r:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(A.$.ELLIPSE,P,f)),{nodeId:b,element:(0,z.it)(b,A.$.ELLIPSE,"ellipse",{size:P,attribute:f},R),size:P,attribute:f}}},2875:(oe,Lt,p)=>{p.d(Lt,{e:()=>z});var A=p(9054),O=p(4318),st=p(7492);const z=(gt,b,h)=>{let R=(null==b?void 0:b.size)||{x:0,y:0,width:320,height:80},P=(null==b?void 0:b.attribute)||{};Object.assign(P,(0,O.sg)(A.$.FOREIGNOBJECT,R,P));let f=(null==b?void 0:b.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},M=(null==b?void 0:b.style)||{};return{nodeId:gt,element:(0,st.it)(gt,A.$.FOREIGNOBJECT,"foreignObject",{size:R,attribute:P,style:M,source:f},h),size:R,attribute:P,style:M,source:f}}},6358:(oe,Lt,p)=>{p.d(Lt,{m:()=>z});var A=p(9054),O=p(4318),st=p(7492);const z=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{};return Object.assign(f,(0,O.sg)(A.$.GROUP,P,f)),{nodeId:b,element:(0,st.it)(b,A.$.GROUP,"g",{size:P,attribute:f},R),size:P,attribute:f}}},7210:(oe,Lt,p)=>{p.d(Lt,{G:()=>z});var A=p(9054),O=p(4318),st=p(7492);const z=(gt,b,h)=>{let R=(null==b?void 0:b.size)||{x:0,y:0,width:10,height:10},P=(null==b?void 0:b.attribute)||{preserveAspectRatio:"none"};Object.assign(P,(0,O.sg)(A.$.IMAGE,R,P));let f=(null==b?void 0:b.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:gt,element:(0,st.it)(gt,A.$.IMAGE,"image",{size:R,attribute:P,source:f},h),size:R,attribute:P,source:f}}},4921:(oe,Lt,p)=>{p.d(Lt,{W:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth,strokeLinecap:O.icdt.attribute.strokeLinecap};return Object.assign(f,(0,st.sg)(A.$.LINE,P,f)),{nodeId:b,element:(0,z.it)(b,A.$.LINE,"line",{size:P,attribute:f},R),size:P,attribute:f}}},9322:(oe,Lt,p)=>{p.d(Lt,{G:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(A.$.PATH,P,f)),{nodeId:b,element:(0,z.it)(b,A.$.PATH,"path",{size:P,attribute:f},R),size:P,attribute:f}}},2282:(oe,Lt,p)=>{p.d(Lt,{l:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(A.$.POLYGON,P,f)),{nodeId:b,element:(0,z.it)(b,A.$.POLYGON,"polygon",{size:P,attribute:f},R),size:P,attribute:f}}},8054:(oe,Lt,p)=>{p.d(Lt,{f:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:O.icdt.attribute.fill,stroke:O.icdt.attribute.stroke,strokeWidth:O.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(A.$.RECT,P,f)),{nodeId:b,element:(0,z.it)(b,A.$.RECT,"rect",{size:P,attribute:f},R),size:P,attribute:f}}},1105:(oe,Lt,p)=>{p.d(Lt,{$:()=>gt});var A=p(9054),O=p(4981),st=p(4318),z=p(7492);const gt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:320,height:80},f=(null==h?void 0:h.attribute)||{fill:O.icdt.attribute.stroke,fontFamily:O.icdt.attribute.fontFamily,fontSize:O.icdt.attribute.fontSize,textLength:O.icdt.attribute.textLength};Object.assign(f,(0,st.sg)(A.$.TEXT,P,f));let M=(null==h?void 0:h.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:b,element:(0,z.it)(b,A.$.TEXT,"text",{size:P,attribute:f,source:M},R),size:P,attribute:f,source:M}}},4318:(oe,Lt,p)=>{p.d(Lt,{bH:()=>st,sg:()=>z});var A=p(9054),O=p(7851);const st=(b,h,R,P,f)=>{let M={x:Math.min(b,R),y:Math.min(h,P),width:Math.abs(R-b)||1,height:Math.abs(P-h)||1};return null!=f&&f.ratio&&(M.width<=M.height?M.height=M.width*(null==f?void 0:f.ratio):M.width=M.height/(null==f?void 0:f.ratio)),Object.assign(M,{ratios:(null==f?void 0:f.ratios)||[[(b-M.x)/(M.width||1),(h-M.y)/(M.height||1)],[(R-M.x)/(M.width||1),(P-M.y)/(M.height||1)]]}),null!=f&&f.points&&(M.points=null==f?void 0:f.points),M},z=(b,h,R)=>{var P,f=(()=>{switch(b){case A.$.CIRCLE:return{cx:h.x+h.width/2,cy:h.y+h.height/2,r:Math.min(h.width/2,h.height/2)};case A.$.ELLIPSE:return{cx:h.x+h.width/2,cy:h.y+h.height/2,rx:h.width/2,ry:h.height/2};case A.$.LINE:{var M;let I={};return null===(M=h.ratios)||void 0===M||M.forEach((u,K)=>{I[`x${K+1}`]=h.x+h.width*u[0],I[`y${K+1}`]=h.y+h.height*u[1]}),I}case A.$.RECT:case A.$.FOREIGNOBJECT:case A.$.IMAGE:return{x:h.x,y:h.y,width:h.width,height:h.height};case A.$.TEXT:var S;return{x:h.x,y:h.y+(null!==(S=R.fontSize)&&void 0!==S?S:16)};case A.$.POLYGON:var T;if(null!==(T=h.ratios)&&void 0!==T&&T.length)return{points:(0,O.Q8)(h,h.ratios)};break;case A.$.PATH:var Z,_;if(null!==(Z=h.ratioMaps)&&void 0!==Z&&Z.length)return{d:(0,O.BG)(h,h.ratioMaps)};if(null!==(_=h.points)&&void 0!==_&&_.length)return{d:`M ${(I=h.points)[0][0]} ${I[0][1]} L ${(I.map(u=>[u[0],u[1]])||[]).map(u=>u.join(" ")).join(" ")}`}}var I;return{}})();return h.rotate?(f.transform=`rotate(${h.rotate})`,f.transformOrigin=`${h.x+h.width/2} ${h.y+h.height/2}`):null!==(P=R.transform)&&void 0!==P&&P.match(/^rotate/)&&(R.transform=null,R.transformOrigin=null),f}},3423:(oe,Lt,p)=>{p.d(Lt,{v:()=>st});var A=p(4981),O=p(5811);const st=z=>(0,O.q)(z/A.icdt.screen.scale)},3385:(oe,Lt,p)=>{p.d(Lt,{Vs:()=>R,co:()=>b,k6:()=>gt,lO:()=>h,mr:()=>P});var A=p(4981),O=p(7492),st=p(4318),z=p(5811);const gt=(f,M)=>{let{id:S,type:T,size:Z,attribute:_}=f,I=JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}));Z.x=(0,z.q)(M),Object.assign(_,(0,st.sg)(T,Z,_)),(0,O.__)(window.document.getElementById(S),_),A.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}))}])},b=(f,M)=>{let{id:S,type:T,size:Z,attribute:_}=f,I=JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}));Z.y=(0,z.q)(M),Object.assign(_,(0,st.sg)(T,Z,_)),(0,O.__)(window.document.getElementById(S),_),A.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}))}])},h=(f,M,S)=>{let{id:T,type:Z,size:_,attribute:I}=f,u=JSON.parse(JSON.stringify({id:T,size:_,attribute:I}));S&&(_.height=(0,z.q)(M*_.height/_.width)),_.width=(0,z.q)(M),Object.assign(I,(0,st.sg)(Z,_,I)),(0,O.__)(window.document.getElementById(T),I),A.icdt.history.push([{type:"size",from:u,to:JSON.parse(JSON.stringify({id:T,size:_,attribute:I}))}])},R=(f,M,S)=>{let{id:T,type:Z,size:_,attribute:I}=f,u=JSON.parse(JSON.stringify({id:T,size:_,attribute:I}));S&&(_.width=(0,z.q)(M*_.width/_.height)),_.height=(0,z.q)(M),Object.assign(I,(0,st.sg)(Z,_,I)),(0,O.__)(window.document.getElementById(T),I),A.icdt.history.push([{type:"size",from:u,to:JSON.parse(JSON.stringify({id:T,size:_,attribute:I}))}])},P=(f,M)=>{let{id:S,type:T,size:Z,attribute:_}=f,I=JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}));Z.rotate="number"==typeof M?(0,z.q)(M,100):void 0,Object.assign(_,(0,st.sg)(T,Z,_)),(0,O.__)(window.document.getElementById(S),_),A.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:S,size:Z,attribute:_}))}])}},6816:(oe,Lt,p)=>{p.d(Lt,{A:()=>b});var A=p(968),O=p(4981);class st{constructor(R){this._points=[],this._options=R}start(R){this._points.length=0,this._points.push([R.x,R.y]),this._options.start(R)}move(R){this._points.push([R.x,R.y]),this._options.move(R,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(R=this._points[0])[0],y:R[1]}:{x:0,y:0};var R}get offsetLast(){return this._points.length>=1?{x:(R=this._points[this._points.length-1])[0],y:R[1]}:{x:0,y:0};var R}}var z=p(7797);const b=(h,R,P,f,M)=>{var S,T,Z;let _=null,I=0,u=0;h.mouseEvent?(_=h.mouseEvent.target,I=h.mouseEvent.offsetX,u=h.mouseEvent.offsetY):h.touchEvent&&(_=h.touchEvent.target,h.touchEvent.touches.length&&(I=h.touchEvent.touches[0].clientX,u=h.touchEvent.touches[0].clientY));let K=null!=P?P:O.icdt.screen.scale,L=null!=f?f:O.icdt.screen.dislocation,X=null!=M?M:O.icdt.screen.offset,et=()=>{};var ot=new st({start:null!==(S=null==R?void 0:R.start)&&void 0!==S?S:et,move:null!==(T=null==R?void 0:R.move)&&void 0!==T?T:et,end:null!==(Z=null==R?void 0:R.end)&&void 0!==Z?Z:et});h.mouseEvent?ot.start((0,z.p)({x:I,y:u},K,L,{x:0,y:0})):h.touchEvent&&ot.start((0,z.p)({x:I,y:u},K,L,X));let j=it=>{ot.move((0,z.p)({x:it.clientX,y:it.clientY},K,L,X))},_t=it=>{ot.end(),[A._.SHAPE,A._.FOREIGNOBJECT,A._.IMAGE,A._.TEXT].includes(O.icdt.pointer.pointer_type)&&(it.shiftKey||(O.icdt.pointer.pointer_type=A._.POINTER))},Bt=it=>{it.touches.length&&j({clientX:it.touches[0].clientX,clientY:it.touches[0].clientY})},Gt=it=>{_t({shiftKey:it.shiftKey,ctrlKey:it.ctrlKey,altKey:it.altKey}),window.removeEventListener("touchmove",Bt,!1),window.removeEventListener("touchend",Gt,!1)},Mt=it=>{0==it.button&&j({clientX:it.clientX,clientY:it.clientY})},It=it=>{0==it.button&&(_t({shiftKey:it.shiftKey,ctrlKey:it.ctrlKey,altKey:it.altKey}),window.removeEventListener("mousemove",Mt,!1),window.removeEventListener("mouseup",It,!1))};if(h.mouseEvent)window.addEventListener("mousemove",Mt,!1),window.addEventListener("mouseup",It,!1);else if(h.touchEvent){var St;window.addEventListener("touchmove",Bt,!1),window.addEventListener("touchend",Gt,!1),null===(St=_)||void 0===St||St.addEventListener("touchmove",function(it){it.preventDefault()})}}},7797:(oe,Lt,p)=>{p.d(Lt,{p:()=>O});var A=p(5811);const O=(st,z,gt,b)=>(st.x-=b.x,st.y-=b.y,st.x/=z,st.y/=z,st.x-=gt.x,st.y-=gt.y,st.x=(0,A.q)(st.x),st.y=(0,A.q)(st.y),st)},70:(oe,Lt,p)=>{p.d(Lt,{$:()=>vt,U:()=>te});var A=p(1687),O=p(4981),st=p(9054),z=p(5973),gt=p(2336),b=p(861),h=p(157),R=p(4787),f=p(1105),M=p(6358);var I=p(7267),u=p(7210),K=p(5811);const L=(Y,v,H)=>{var ft,ut,q,Q;let V=1,x=new Image;x.onload=()=>{var U,pt,Ct,mt;V=(0,K.q)(x.naturalWidth/x.naturalHeight,100);let Pt=0,zt=0,Wt=0,Ht=0;var ne,re,pe,se;V>=1?(Wt=Math.min(x.naturalWidth,null!==(ne=null===(re=vt.slide.svg)||void 0===re||null===(re=re.viewBox)||void 0===re?void 0:re.width)&&void 0!==ne?ne:0),Ht=Wt/V):(Ht=Math.min(x.naturalHeight,null!==(pe=null===(se=vt.slide.svg)||void 0===se||null===(se=se.viewBox)||void 0===se?void 0:se.height)&&void 0!==pe?pe:0),Wt=Ht/V),Pt=((null!==(U=null===(pt=vt.slide.svg)||void 0===pt||null===(pt=pt.viewBox)||void 0===pt?void 0:pt.width)&&void 0!==U?U:0)-Wt)/2,zt=((null!==(Ct=null===(mt=vt.slide.svg)||void 0===mt||null===(mt=mt.viewBox)||void 0===mt?void 0:mt.height)&&void 0!==Ct?Ct:0)-Ht)/2,v.size={x:Pt,y:zt,width:Wt,height:Ht},X(v,H)},x.onerror=U=>{console.error(`ImgSrc load failed -> ${JSON.stringify(v.source)}`,U)},x.src=(null!==(ft=v.source)&&void 0!==ft&&ft.path?(null===(ut=O.icdt.config)||void 0===ut?void 0:ut.readfileuploadurl)+(null===(q=v.source)||void 0===q?void 0:q.path):null===(Q=v.source)||void 0===Q?void 0:Q.url)||""},X=(Y,v)=>{if(Y.slideStatus!=vt.slideStatus)return void v();let{element:H}=(0,u.G)(Math.ceil(1e9*Math.random()),{size:Y.size,source:{type:"image",image:null==Y?void 0:Y.source}});setTimeout(()=>{null==H||H.remove(),v()},3e3)};var et=p(7492);const ot=(Y,v,H)=>{var ft,ut,q,Q;let V=new Image;V.onload=()=>{j(Y,{width:V.naturalWidth,height:V.naturalHeight},v,H)},V.onerror=x=>{console.error(`ImgSrc load failed -> ${JSON.stringify(v.source)}`,x),H()},V.src=(null!==(ft=v.source)&&void 0!==ft&&ft.path?(null===(ut=O.icdt.config)||void 0===ut?void 0:ut.readfileuploadurl)+(null===(q=v.source)||void 0===q?void 0:q.path):null===(Q=v.source)||void 0===Q?void 0:Q.url)||""},j=(Y,v,H,ft)=>{if(H.slideStatus!=vt.slideStatus)return void ft();let ut=(0,K.q)(v.width/v.height,100),q=0,Q=0,V=0,x=0;ut>=1?(V=v.width,V=Math.max(V,40),V=Math.min(V,40),x=V/ut):(x=v.height,x=Math.max(x,40),x=Math.min(x,40),V=x/ut);let{size:Ct}=Y;q=Ct.x+Ct.width-V/2,Q=Ct.y-x/2;let mt=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,u.G)(`icon-${Y.id}`,{size:{x:q,y:Q,width:V,height:x},source:{type:"image",image:null==H?void 0:H.source}},mt),setTimeout(()=>{ft()},3e3)},_t=(Y,v,H)=>{var ft,ut,q,Q,V,x,U;if(v.slideStatus!=vt.slideStatus)return void H();if(!(null!==(ft=v.source)&&void 0!==ft&&ft.path||null!==(ut=v.source)&&void 0!==ut&&ut.url))return console.warn(`${Y.id} -> audio no source!`),void H();var pt=jQuery("#"+Y.id);let Ct=null!==(q=v.iteration)&&void 0!==q?q:0;if(Ct<0&&(H(),H=function(){}),!(pt.data("audio-running")&&Ct<0)){pt.data("audio-running",!0);var mt=new Audio;return mt.autoplay=!0,mt.loop=0!=Ct,mt.preload="auto",mt.controls=!0,mt.setAttributeNode(document.createAttribute("playsinline")),mt.addEventListener("canplay",function(){var Pt=mt.play();Pt&&Pt.then(function(zt){pt.data("audio-running",!0)}).catch(function(zt){pt.data("audio-running",!1),v.slideStatus===vt.slideStatus&&H()})}),mt.addEventListener("timeupdate",function(){var zt;v.slideStatus!==vt.slideStatus&&((zt=this).pause(),zt.remove(),pt.data("audio-running",!1))}),mt.addEventListener("canplaythrough",function(){this.loop&&(Ct>0?Ct--:0==Ct&&(this.loop=!1))}),mt.addEventListener("play",function(){}),mt.addEventListener("pause",function(){}),mt.addEventListener("ended",function(){this.remove(),pt.data("audio-running",!1),v.slideStatus===vt.slideStatus&&H()}),mt.onerror=function(){this.remove(),pt.data("audio-running",!1),v.slideStatus===vt.slideStatus&&H()},mt.src=(null!==(Q=v.source)&&void 0!==Q&&Q.path?(null===(V=O.icdt.config)||void 0===V?void 0:V.readfileuploadurl)+(null===(x=v.source)||void 0===x?void 0:x.path):null===(U=v.source)||void 0===U?void 0:U.url)||"",mt}};var Bt=p(9942);const yt=(Y,v)=>{var H;null===(H=v.test)||void 0===H||null===(H=H.answer)||void 0===H||null===(H=H.matching)||void 0===H||H.filter(ft=>ft.id==Y.id).forEach(ft=>ft.value=""),jQuery(`#node-${Y.id}`).remove()},Ot=(Y,v,H,ft,ut,q)=>{var Q,V,x,U,pt,Ct,mt,Pt,zt,Wt,Ht,ne;ut.iscorrect?(null!==(Q=v.test)&&void 0!==Q&&null!==(Q=Q.audiotrue)&&void 0!==Q&&Q.path&&_t(Y,{source:(0,Bt.I)(null===(U=v.test)||void 0===U?void 0:U.audiotrue),iteration:0,nodeStatus:H,slideStatus:ft},q),null!==(V=v.test)&&void 0!==V&&null!==(V=V.icontrue)&&void 0!==V&&V.path&&ot(Y,{source:(0,Bt.I)(null===(pt=v.test)||void 0===pt?void 0:pt.icontrue),iteration:0,nodeStatus:H,slideStatus:ft},q),null!==(x=v.test)&&void 0!==x&&null!==(x=x.effecttrue)&&void 0!==x&&x.path&&L(0,{source:(0,Bt.I)(null===(Ct=v.test)||void 0===Ct?void 0:Ct.effecttrue),iteration:0,nodeStatus:H,slideStatus:ft},q)):(null!==(mt=v.test)&&void 0!==mt&&null!==(mt=mt.audiofalse)&&void 0!==mt&&mt.path&&_t(Y,{source:(0,Bt.I)(null===(Wt=v.test)||void 0===Wt?void 0:Wt.audiofalse),iteration:0,nodeStatus:H,slideStatus:ft},q),null!==(Pt=v.test)&&void 0!==Pt&&null!==(Pt=Pt.iconfalse)&&void 0!==Pt&&Pt.path&&ot(Y,{source:(0,Bt.I)(null===(Ht=v.test)||void 0===Ht?void 0:Ht.iconfalse),iteration:0,nodeStatus:H,slideStatus:ft},q),null!==(zt=v.test)&&void 0!==zt&&null!==(zt=zt.effectfalse)&&void 0!==zt&&zt.path&&L(0,{source:(0,Bt.I)(null===(ne=v.test)||void 0===ne?void 0:ne.effectfalse),iteration:0,nodeStatus:H,slideStatus:ft},q))},rt=(Y,v,H,ft)=>{var ut,q,Q,V,x,U,Ct,Pt,mt;null!==(ut=v.animate)&&void 0!==ut&&ut.value&&(0,I.Z)(v,H.nodeStatus,H.slideStatus),null!==(q=v.interactive)&&void 0!==q&&q.show?(console.log(`node(${v.id}) | nodeStatus(${H.nodeStatus}) | slideStatus(${H.slideStatus}) | show`),((Y,v,H,ft)=>{var ut,q,Q;let V={total:0,counter:0},{triggershow:x,triggerrun:U,triggerhide:pt,action:Ct,audio:mt}=null!==(ut=null===(q=Y.interactive)||void 0===q?void 0:q.show)&&void 0!==ut?ut:{};if(console.log(`node(${Y.id}) | nodeStatus(${v}) | slideStatus(${H}) | show`),x){let{id:zt,ids:Wt,time:Ht,async:ne}=x;"asynctrue"==ne?setTimeout(()=>{(0,R.L5)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})}):"time"==ne&&setTimeout(()=>{(0,R.L5)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})},1e3*(null!=Ht?Ht:0))}if(U){let{id:zt,ids:Wt,time:Ht,async:ne}=U;"asynctrue"==ne?setTimeout(()=>{(0,R.Ar)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})}):"time"==ne&&setTimeout(()=>{(0,R.Ar)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})},1e3*(null!=Ht?Ht:0))}if(pt){let{id:zt,ids:Wt,time:Ht,async:ne}=pt;"asynctrue"==ne?setTimeout(()=>{(0,R.WT)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})}):"time"==ne&&setTimeout(()=>{(0,R.WT)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})},1e3*(null!=Ht?Ht:0))}let Pt=()=>{setTimeout(()=>{if(V.counter>=V.total){if(ft&&ft(),x){let{id:zt,ids:Wt,async:Ht}=x;(!Ht||"asyncfalse"==Ht)&&(0,R.L5)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})}if(U){let{id:zt,ids:Wt,async:Ht}=U;(!Ht||"asyncfalse"==Ht)&&(0,R.Ar)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})}if(pt){let{id:zt,ids:Wt,async:Ht}=pt;(!Ht||"asyncfalse"==Ht)&&(0,R.WT)({id:zt,ids:Wt,nodeStatus:v,slideStatus:H})}}})};if(null!=Ct&&Ct.value){V.total+=1;let zt=()=>{V.counter+=1,Pt()};switch(null==Ct?void 0:Ct.value){case"hide":jQuery("#"+Y.id).addClass("hide"),zt();break;case"points":{let{points:Wt,time:Ht,iteration:ne,finish:re}=Ct;(0,b.G)(Y.id,{node:Y,points:Wt,time:Ht,iteration:ne,finish:re,nodeStatus:v,slideStatus:H},zt);break}default:{let{value:Wt,time:Ht,iteration:ne,finish:re}=Ct;(0,gt.Q)(Y.id,{node:Y,value:Wt,time:Ht,iteration:ne,finish:re,nodeStatus:v,slideStatus:H},zt);break}}}if(null!=mt&&null!==(Q=mt.source)&&void 0!==Q&&Q.path){V.total+=1;let zt=()=>{V.counter+=1,Pt()},Wt=(0,h.R)(Y.id,mt,V,{nodeStatus:v,slideStatus:H},zt);-1==(null==mt?void 0:mt.iteration)&&jQuery("#"+Y.id).click(Ht=>{Ht.preventDefault(),Wt&&(Wt.volume=Wt.volume>=1?0:Wt.volume+.25),console.log(null==Wt?void 0:Wt.volume)})}V.total||Pt()})(v,H.nodeStatus,H.slideStatus,ft)):ft&&ft(),null!==(Q=v.interactive)&&void 0!==Q&&Q.click&&(Pt=null===(Ct=v.interactive)||void 0===Ct?void 0:Ct.click,Object.keys(null!=Pt?Pt:{}).map(Wt=>Pt[Wt]?1:0).includes(1)&&jQuery("#"+v.id).addClass("interactive-click"),jQuery("#"+v.id).click(Pt=>{Pt.preventDefault(),H.nodeStatus=vt.refreshNodeStatus(),console.log(`node(${v.id}) | nodeStatus(${H.nodeStatus}) | slideStatus(${H.slideStatus}) | click`),(0,z.F)(v,H.nodeStatus,H.slideStatus)})),null!==(V=v.variable)&&void 0!==V&&V.input&&jQuery("#"+v.id).on("change","input,textarea",Pt=>{Pt.preventDefault(),((Y,v,H)=>{var ft,ut;O.icdt.variable.setValue(null!==(ft=null===(ut=v.variable)||void 0===ut||null===(ut=ut.input)||void 0===ut?void 0:ut.variable)&&void 0!==ft?ft:"",Y),(Y=>{var v;let H=(ft,ut)=>{null==ft||ft.forEach(q=>{switch(q.type){case st.$.GROUP:(0,M.m)(q.id,{},ut?window.document.getElementById(ut):null),H(q.nodes,q.id);break;case st.$.POLYGON:break;case st.$.TEXT:(0,f.$)(q.id,{size:q.size,attribute:q.attribute,source:q.source},ut?window.document.getElementById(ut):null)}})};H(null===(v=Y.svg)||void 0===v?void 0:v.nodes)})(H)})(Pt.target.value,v,Y)}),null!==(x=v.variable)&&void 0!==x&&x.click&&(null!==(mt=v.variable)&&void 0!==mt&&null!==(mt=mt.click)&&void 0!==mt&&mt.variable&&jQuery("#"+v.id).addClass("variable-click"),jQuery("#"+v.id).click(Pt=>{Pt.preventDefault(),((Y,v)=>{var H;O.icdt.variable.setValueOperator(null===(H=Y.variable)||void 0===H?void 0:H.click),(Y=>{var v;let H=(ft,ut)=>{null==ft||ft.forEach(q=>{switch(q.type){case st.$.GROUP:(0,M.m)(q.id,{},ut?window.document.getElementById(ut):null),H(q.nodes,q.id);break;case st.$.POLYGON:break;case st.$.TEXT:(0,f.$)(q.id,{size:q.size,attribute:q.attribute,source:q.source},ut?window.document.getElementById(ut):null)}})};H(null===(v=Y.svg)||void 0===v?void 0:v.nodes)})(v)})(v,Y)})),"test"==(null===(U=v.source)||void 0===U?void 0:U.type)&&((Y,v)=>{var H;let ft=()=>{};switch(null===(H=Y.source)||void 0===H||null===(H=H.test)||void 0===H?void 0:H.type){case"truefalse":var ut;if(jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,H,ft,ut)=>{var q,Q;let V=null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q||null===(q=q.truefalse)||void 0===q?void 0:q.iscorrect;if(v.test?v.test.answer?v.test.answer.truefalse={value:Y.id,iscorrect:V}:v.test.answer={truefalse:{value:Y.id,iscorrect:V}}:v.test={answer:{truefalse:{value:Y.id,iscorrect:V}}},null!==(Q=v.svg)&&void 0!==Q&&Q.nodes.find(x=>{var U;return"submit"==(null===(U=x.source)||void 0===U||null===(U=U.test)||void 0===U?void 0:U.type)})){if(v.test.showselection){let x=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,et.Yw)(x,v)}}else Ot(Y,v,H,ft,{iscorrect:V},ut);console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ft)}),null!==(ut=v.test)&&void 0!==ut&&ut.showselection){let x=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,et.Yw)(x,v)}break;case"singlechoice":var q;if(jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,H,ft,ut)=>{var q,Q;let V=null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q||null===(q=q.singlechoice)||void 0===q?void 0:q.iscorrect;if(v.test?v.test.answer?v.test.answer.singlechoice={value:Y.id,iscorrect:V}:v.test.answer={singlechoice:{value:Y.id,iscorrect:V}}:v.test={answer:{singlechoice:{value:Y.id,iscorrect:V}}},null!==(Q=v.svg)&&void 0!==Q&&Q.nodes.find(x=>{var U;return"submit"==(null===(U=x.source)||void 0===U||null===(U=U.test)||void 0===U?void 0:U.type)})){if(v.test.showselection){let x=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,et.Yw)(x,v)}}else Ot(Y,v,H,ft,{iscorrect:V},ut);console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ft)}),null!==(q=v.test)&&void 0!==q&&q.showselection){let x=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,et.Yw)(x,v)}break;case"multichoice":var Q;if(jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,H,ft,ut)=>{var q,Q;let x,V=null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q||null===(q=q.multichoice)||void 0===q?void 0:q.iscorrect;if(v.test?v.test.answer?v.test.answer.multichoice?v.test.answer.multichoice.find(U=>U.value==Y.id)?(v.test.answer.multichoice=v.test.answer.multichoice.filter(U=>U.value!=Y.id),x=!0):v.test.answer.multichoice.push({value:Y.id,iscorrect:V}):v.test.answer.multichoice=[{value:Y.id,iscorrect:V}]:v.test.answer={multichoice:[{value:Y.id,iscorrect:V}]}:v.test={answer:{multichoice:[{value:Y.id,iscorrect:V}]}},null!==(Q=v.svg)&&void 0!==Q&&Q.nodes.find(U=>{var pt;return"submit"==(null===(pt=U.source)||void 0===pt||null===(pt=pt.test)||void 0===pt?void 0:pt.type)})){if(v.test.showselection){let U=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,et.Yw)(U,v)}}else Ot(Y,v,H,ft,{iscorrect:V},ut);console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ft)}),null!==(Q=v.test)&&void 0!==Q&&Q.showselection){let x=(0,et.g1)(A.O.TEST_GROUP,"g",void 0,O.icdt.target);(0,et.Yw)(x,v)}break;case"fill":var V;jQuery("#"+Y.id).on("keyup",'input[type="text"]',x=>{var U;let pt=jQuery("<div/>").css({"font-size":jQuery(x.target).css("font-size"),visibility:"hidden",float:"left"}).text(x.target.value).appendTo(window.document.body);jQuery(x.target).css({width:(null!==(U=pt.width())&&void 0!==U?U:0)+30})}).on("keypress",'input[type="text"]',x=>{13===(x.keyCode||x.charCode||x.which)&&(x.preventDefault(),x.stopPropagation(),jQuery(x.target).blur())}).on("change",'input[type="text"]',x=>{var U,pt;let Ct=vt.nodeStatus,mt=vt.slideStatus,Pt=null===(U=x.target)||void 0===U?void 0:U.getAttribute("data-key"),zt=null===(pt=x.target)||void 0===pt||null===(pt=pt.value)||void 0===pt?void 0:pt.trim();((Y,v,H,ft,ut,q)=>{var Q,V,x,U;let{value:pt}=null!==(Q=null===(V=Y.source)||void 0===V||null===(V=V.test)||void 0===V||null===(V=V.fill)||void 0===V?void 0:V.find(mt=>mt.key==`[[${ut.key}]]`))&&void 0!==Q?Q:{},Ct=pt&&pt.map(mt=>null==mt?void 0:mt.toLocaleLowerCase()).includes(null===(x=ut.value)||void 0===x?void 0:x.toLocaleLowerCase());null!==(U=v.svg)&&void 0!==U&&U.nodes.find(mt=>{var Pt;return"submit"==(null===(Pt=mt.source)||void 0===Pt||null===(Pt=Pt.test)||void 0===Pt?void 0:Pt.type)})||Ot(Y,v,H,ft,{iscorrect:Ct},q),ut.iscorrect=Ct,v.test?v.test.answer?v.test.answer.fill?v.test.answer.fill.find(mt=>mt.key==ut.key)?v.test.answer.fill.filter(mt=>mt.key==ut.key).forEach(mt=>{mt.value=ut.value,mt.iscorrect=ut.iscorrect}):v.test.answer.fill.push(ut):v.test.answer.fill=[ut]:v.test.answer={fill:[ut]}:v.test={answer:{fill:[ut]}},console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,Ct,mt,{key:Pt,value:zt},ft),jQuery("#"+Y.id).find(`input[type="text"][data-key="${Pt}"]`).val(zt)}),null!==(V=v.test)&&void 0!==V&&V.showselection||jQuery("#"+Y.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+Y.id).on("touchmove",".ondrag-item",function(x){x.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(x){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Y.size.height/Y.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${x.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(x){var U;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(U=v.test)&&void 0!==U&&U.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection"),yt(Y,v)},drag:function(x){},dragend:function(x){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Y.id} .ondrop-here`).kendoDropTarget({dragenter:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.addClass("focused")},dragleave:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.removeClass("focused")},drop:function(x){if(!x.dropTarget.hasClass("actived"))return;x.dropTarget.removeClass("focused");let U=x.dropTarget,pt=x.draggable.currentTarget;U.is(":empty")||U.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),pt.appendTo(U),((Y,v,H,ft,ut,q)=>{var Q,V,x;let{key:U}=null!==(Q=null===(V=Y.source)||void 0===V||null===(V=V.test)||void 0===V?void 0:V.matching)&&void 0!==Q?Q:{key:"KIEN"},pt=ut.key==U;null!==(x=v.svg)&&void 0!==x&&x.nodes.find(mt=>{var Pt;return"submit"==(null===(Pt=mt.source)||void 0===Pt||null===(Pt=Pt.test)||void 0===Pt?void 0:Pt.type)})||Ot(Y,v,H,ft,{iscorrect:pt},q),yt(Y,v);let Ct={id:Y.id,key:null!=U?U:"",value:ut.key};v.test?v.test.answer?v.test.answer.matching?v.test.answer.matching.find(mt=>mt.id==Ct.id)?v.test.answer.matching.filter(mt=>mt.id==Ct.id).forEach(mt=>{mt.key=Ct.key,mt.value=Ct.value}):v.test.answer.matching.push(Ct):v.test.answer.matching=[Ct]:v.test.answer={matching:[Ct]}:v.test={answer:{matching:[Ct]}},console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,{key:pt.data("key")},ft)}});break;case"matching-content":jQuery("#"+Y.id).on("touchmove",".ondrag-item",function(x){x.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(x){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Y.size.height/Y.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${x.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(x){var U;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(U=v.test)&&void 0!==U&&U.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(x){},dragend:function(x){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Y.id} .ondrop-here`).kendoDropTarget({dragenter:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.addClass("focused")},dragleave:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.removeClass("focused")},drop:function(x){x.dropTarget.hasClass("actived")&&(x.dropTarget.removeClass("focused"),x.draggable.currentTarget.appendTo(x.dropTarget))}});break;case"speech":break;case"submit":jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,H,ft,ut)=>{var q,Q,V,x,U;let pt;var Ct;if(null!=v&&null!==(q=v.test)&&void 0!==q&&null!==(q=q.answer)&&void 0!==q&&q.truefalse)pt=null==v||null===(Ct=v.test)||void 0===Ct||null===(Ct=Ct.answer)||void 0===Ct||null===(Ct=Ct.truefalse)||void 0===Ct?void 0:Ct.iscorrect;else if(null!=v&&null!==(Q=v.test)&&void 0!==Q&&null!==(Q=Q.answer)&&void 0!==Q&&Q.singlechoice){var mt;pt=null==v||null===(mt=v.test)||void 0===mt||null===(mt=mt.answer)||void 0===mt||null===(mt=mt.singlechoice)||void 0===mt?void 0:mt.iscorrect}else if(null!=v&&null!==(V=v.test)&&void 0!==V&&null!==(V=V.answer)&&void 0!==V&&V.multichoice){var Pt,zt,Wt;pt=1==[null==v||null===(Pt=v.test)||void 0===Pt||null===(Pt=Pt.answer)||void 0===Pt||null===(Pt=Pt.multichoice)||void 0===Pt?void 0:Pt.length,null==v||null===(zt=v.test)||void 0===zt||null===(zt=zt.answer)||void 0===zt||null===(zt=zt.multichoice)||void 0===zt||null===(zt=zt.map(se=>se.iscorrect?1:0))||void 0===zt?void 0:zt.reduce((se,de)=>se+de),null==v||null===(Wt=v.svg)||void 0===Wt||null===(Wt=Wt.nodes)||void 0===Wt||null===(Wt=Wt.filter(se=>{var de,xe;return"multichoice"==(null===(de=se.source)||void 0===de||null===(de=de.test)||void 0===de?void 0:de.type)&&(null===(xe=se.source)||void 0===xe||null===(xe=xe.test)||void 0===xe||null===(xe=xe.multichoice)||void 0===xe?void 0:xe.iscorrect)}))||void 0===Wt?void 0:Wt.length].filter((se,de,xe)=>xe.indexOf(se)==de).length}else if(null!=v&&null!==(x=v.test)&&void 0!==x&&null!==(x=x.answer)&&void 0!==x&&x.fill){var Ht,ne;pt=(null==v||null===(Ht=v.test)||void 0===Ht||null===(Ht=Ht.answer)||void 0===Ht||null===(Ht=Ht.fill)||void 0===Ht||null===(Ht=Ht.map(se=>se.iscorrect?1:0))||void 0===Ht?void 0:Ht.reduce((se,de)=>se+de))==(null===(ne=v.svg)||void 0===ne||null===(ne=ne.nodes)||void 0===ne||null===(ne=ne.filter(se=>{var de;return"fill"==(null===(de=se.source)||void 0===de||null===(de=de.test)||void 0===de?void 0:de.type)}))||void 0===ne?void 0:ne.length)}else if(null!=v&&null!==(U=v.test)&&void 0!==U&&null!==(U=U.answer)&&void 0!==U&&U.matching){var re,pe;pt=(null===(re=v.svg)||void 0===re||null===(re=re.nodes)||void 0===re||null===(re=re.filter(se=>{var de;return"matching-empty"==(null===(de=se.source)||void 0===de||null===(de=de.test)||void 0===de?void 0:de.type)}))||void 0===re?void 0:re.length)==((null==v||null===(pe=v.test)||void 0===pe||null===(pe=pe.answer)||void 0===pe?void 0:pe.matching)||[]).map(se=>se.key==se.value?1:0).reduce((se,de)=>se+de)}Ot(Y,v,H,ft,{iscorrect:pt},ut),console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ft)})}})(v,Y)};var qt=p(8619),J=p(8785),tt=p(4921),d=p(8054),nt=p(2282),Et=p(2875),At=p(9322);const Vt=(Y,v,H)=>{if(H.slideStatus!=vt.slideStatus||!v.length)return;let ft=v.shift(),ut=Y.filter(x=>{var U;return(null!==(U=x.idx)&&void 0!==U?U:0)==ft});if(!ut.length)return;let q=Math.max.apply(null,ut.map(x=>{var U;return null!==(U=x.time)&&void 0!==U?U:0})),Q=!1,V=q<.5?0:setTimeout(()=>{Q||(Q=!0,Vt(Y,v,H))},1e3*q);Jt(Y,v,ut,0,H,{idx:ft,total:ut.length,counter:0,isRecursive:Q,timeoutRecursive:V,maxTimeCoundown:q,uid:Math.floor(1e9*Math.random())})},Jt=(Y,v,H,ft,ut,q)=>{if(ut.slideStatus!=vt.slideStatus)return;let Q=H[ft];if(Q){switch(Q.type){case st.$.GROUP:break;case st.$.CIRCLE:(0,qt._)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.ELLIPSE:(0,J.r)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.LINE:(0,tt.W)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.RECT:(0,d.f)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.POLYGON:(0,nt.l)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.FOREIGNOBJECT:(0,Et.e)(Q.id,{size:Q.size,attribute:Q.attribute,style:Q.style,source:Q.source},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.IMAGE:(0,u.G)(Q.id,{size:Q.size,attribute:Q.attribute,source:Q.source},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.TEXT:(0,f.$)(Q.id,{size:Q.size,attribute:Q.attribute,source:Q.source},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.PATH:(0,At.G)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null)}rt(ut.slide,Q,ut,()=>{q.counter+=1,q.maxTimeCoundown<.5&&q.counter>=q.total&&(q.total=q.counter=0,q.isRecursive||(clearTimeout(q.timeoutRecursive),q.isRecursive=!0,setTimeout(()=>{Vt(Y,v,ut)},250)))}),Jt(Y,v,H,++ft,ut,q)}},vt=new class Tt{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(v){this._dataSource=v.data||{},O.icdt.variable.set=v.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var v,H;return null!==(v=null===(H=this._dataSource)||void 0===H||null===(H=H.slides)||void 0===H?void 0:H.length)&&void 0!==v?v:0}get slides(){var v;return(null===(v=this._dataSource)||void 0===v?void 0:v.slides)||[]}get slide(){var v;return((null===(v=this._dataSource)||void 0===v?void 0:v.slides)||[])[this._slideIdx]||{}}findNode(v){var H;let ft=null===(H=this._dataSource)||void 0===H||null===(H=H.slides)||void 0===H?void 0:H.find((mt,Pt)=>Pt==this._slideIdx),ut=null==ft?void 0:ft.svg,q=(mt,Pt)=>{let zt=null==mt?void 0:mt.find(ne=>ne.id==v);if(zt)return zt.pid=Pt,zt;let Wt=0,Ht=mt.length||0;for(;Wt<Ht&&!zt&&(zt=q(mt[Wt].nodes||[],mt[Wt].id),!zt);)Wt++;return zt},Q=q((null==ut?void 0:ut.nodes)||[]);var V,x,U,pt,Ct;return Q?(Q.style=null!==(V=Q.style)&&void 0!==V?V:{},Q.source=null!==(x=Q.source)&&void 0!==x?x:{},Q.animate=null!==(U=Q.animate)&&void 0!==U?U:{},Q.interactive=null!==(pt=Q.interactive)&&void 0!==pt?pt:{},Q.variable=null!==(Ct=Q.variable)&&void 0!==Ct?Ct:{},Q):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(v,H,ft){var ut;let q;var Q,V;if(this.refreshNodeStatus(),this.refreshSlideStatus(),ft)q=null===(Q=this._dataSource)||void 0===Q||null===(Q=Q.slides)||void 0===Q?void 0:Q.find(Ct=>Ct.code==ft||Ct.id==ft),q&&(this._slideIdx=(null===(V=this._dataSource)||void 0===V||null===(V=V.slides)||void 0===V?void 0:V.indexOf(q))||0);else if(H){var x,U;q=null===(x=this._dataSource)||void 0===x||null===(x=x.slides)||void 0===x?void 0:x.find(Ct=>Ct.id==H),q&&(this._slideIdx=(null===(U=this._dataSource)||void 0===U||null===(U=U.slides)||void 0===U?void 0:U.indexOf(q))||0)}else this._slideIdx=Math.min(Math.max(v||0,0),this.slideTotal-1),q=this.slide;if(q){var pt;te(O.icdt.container,O.icdt.svg,q,!0),null===(pt=jQuery(O.icdt.svg).find("#"+A.O.BACKGROUND_GROUP))||void 0===pt||pt.empty();let Ct=(0,et.g1)(A.O.BACKGROUND_GROUP,"g",void 0,O.icdt.svg);(0,et.x0)(Ct,q),(Y=>{var v,H,ft,ut;let q=vt.nodeStatus,Q=vt.slideStatus;null===(v=Y.svg)||void 0===v||v.nodes.forEach(x=>{x.pid=Math.ceil(1e9*Math.random()),(0,M.m)(x.pid)});let V=null===(H=Y.svg)||void 0===H||null===(H=H.nodes)||void 0===H?void 0:H.map(x=>{var U;return null!==(U=x.idx)&&void 0!==U?U:0}).filter((x,U,pt)=>pt.indexOf(x)==U).sort((x,U)=>(null!=x?x:0)-(null!=U?U:0));Vt(null!==(ft=null===(ut=Y.svg)||void 0===ut?void 0:ut.nodes)&&void 0!==ft?ft:[],null!=V?V:[],{slide:Y,nodeStatus:q,slideStatus:Q})})(q)}this.changeSlide(this.slides,null===(ut=this.slide)||void 0===ut?void 0:ut.id,this.slideIdx,this.slides.length,q)}set onChangeSlide(v){this._fnChangeSlides.push(v)}changeSlide(v,H,ft,ut,q){this._fnChangeSlides.forEach(Q=>Q(v,H,ft,ut,q))}},te=(Y,v,H,ft)=>{var ut,q,Q,V;let x=window.document.querySelector(v);var U;x||(x=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(U=window.document.querySelector(Y))||void 0===U||U.appendChild(x)),ft&&(x.textContent=null);let{x:pt,y:Ct,width:mt,height:Pt}=null!==(ut=null==H||null===(q=H.svg)||void 0===q?void 0:q.viewBox)&&void 0!==ut?ut:O.icdt.screen.frameSize;x.setAttributeNS(null,"viewBox",pt+" "+Ct+" "+mt+" "+Pt),x.setAttribute("id",v.replace("#",""));var re,pe,zt=null!==(Q=jQuery(Y).width())&&void 0!==Q?Q:1080,Wt=null!==(V=jQuery(Y).height())&&void 0!==V?V:1080,ne=mt/Pt;ne>=zt/Wt?pe=(re=zt)/ne:re=(pe=Wt)*ne,x.setAttributeNS(null,"width",re.toString()),x.setAttributeNS(null,"height",pe.toString())}},7267:(oe,Lt,p)=>{p.d(Lt,{E:()=>st,Z:()=>O});var A=p(70);const O=(gt,b,h)=>{var R;let{value:f}=null!==(R=gt.animate)&&void 0!==R?R:{};st(gt.id,{node:gt,value:f,nodeStatus:b,slideStatus:h},()=>{})},st=(gt,b,h)=>{var R;if(!b.value)return void h();let P=jQuery("#"+gt).parents("g");if(!P.length)return void h();let{size:f}=b.node;P.css("transform-origin",`${f.x+f.width/2}px ${f.y+f.height/2}px`);let M="",S=null!==(R=b.iteration)&&void 0!==R?R:0,T=[];(b.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?T.push(b.value):b.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(b.value)?(T.push("animation"),T.push(`animation-${b.value}`)):(T.push("animate__animated"),T.push(`animate__${b.value}`)):(T.push("animation"),T.push("animation-fadein")),S<0?(T.push("animation-iteration-infinite"),h(),h=function(){}):S>0&&T.push("animation-iteration-"+(S+1)),M=T.join(" "),function(_){let I=function(){P.data("animate-running")?P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){P.data("animate-running",!1),setTimeout(function(){_()},100)}):_()};P.hasClass("animation")?setTimeout(function(){I()}):I()}(function(){var _;z(gt),(S>0||S<0)&&P.one("animationiteration",function(){b.slideStatus===A.$.slideStatus||(P.data("animate-running",!1),z(gt),b.slideStatus===A.$.slideStatus&&h())}),P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(P.data("animate-running",!1),z(gt),b.finish){default:case 0:case 1:break;case 2:var I;st(gt,{node:b.node,value:null===(I=b.node.animate)||void 0===I?void 0:I.out,nodeStatus:b.nodeStatus,slideStatus:b.slideStatus},()=>{P.addClass("hide")})}b.slideStatus===A.$.slideStatus&&h()}),P.attr("data-class",null!==(_=P.attr("class"))&&void 0!==_?_:""),P.addClass(M),P.data("animate-running",!0)})},z=function(gt){var b,h,R=jQuery("#"+gt).parents("g"),P=null===(b=R.attr("class"))||void 0===b?void 0:b.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),f=null===(h=R.attr("class"))||void 0===h?void 0:h.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);P&&P.forEach(function(S){jQuery(R).removeClass(S)}),f&&f.forEach(function(S){jQuery(R).removeClass(S)});let M=R.attr("data-class");M&&(R.attr("class",M),R.removeAttr("data-class")),jQuery(R).data("animation-running",!1)}},2336:(oe,Lt,p)=>{p.d(Lt,{Q:()=>st});var A=p(70),O=p(7267);const st=(gt,b,h)=>{var R;if(!b.value)return void h();let P=jQuery("#"+gt).parents("g");if(!P.length)return void h();let{size:f}=b.node;P.css("transform-origin",`${f.x+f.width/2}px ${f.y+f.height/2}px`);let M="",S=null!==(R=b.iteration)&&void 0!==R?R:0,T=[];(b.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?T.push(b.value):(T.push("animation"),T.push(b.value?"animation-"+b.value:"animation-fadein")),S<0?(T.push("animation-iteration-infinite"),h(),h=function(){}):S>0&&T.push("animation-iteration-"+(S+1)),M=T.join(" "),function(_){let I=function(){P.data("animate-running")?P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){P.data("animate-running",!1),setTimeout(function(){_()},100)}):_()};P.hasClass("animation")?setTimeout(function(){I()}):I()}(function(){var _;z(gt),(S>0||S<0)&&P.one("animationiteration",function(){b.slideStatus===A.$.slideStatus||(P.data("animate-running",!1),z(gt),b.slideStatus===A.$.slideStatus&&h())}),P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(P.data("animate-running",!1),z(gt),b.finish){default:case 0:case 1:break;case 2:var I;(0,O.E)(gt,{node:b.node,value:null===(I=b.node.animate)||void 0===I?void 0:I.out,nodeStatus:b.nodeStatus,slideStatus:b.slideStatus},()=>{P.addClass("hide")})}b.slideStatus===A.$.slideStatus&&h()}),P.attr("data-class",null!==(_=P.attr("class"))&&void 0!==_?_:""),P.addClass(M),P.data("animate-running",!0)})},z=function(gt){var b,h=jQuery("#"+gt).parents("g"),R=null===(b=h.attr("class"))||void 0===b?void 0:b.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);R&&R.forEach(function(f){jQuery(h).removeClass(f)});let P=h.attr("data-class");P&&(h.attr("class",P),h.removeAttr("data-class")),jQuery(h).data("animation-running",!1)}},861:(oe,Lt,p)=>{p.d(Lt,{G:()=>gt});var A=p(4318),O=p(70),st=p(7492),z=p(7267);const gt=(h,R,P)=>{var f;if(!R.points||!R.points.length)return void P();let M=jQuery("#"+h),S=function b(h){let R=[];2===h.length&&h.splice(1,0,[(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]);let T,Z,_,P=1,f=h.length;for(;P<f;){if(T=h[P-1],Z=h[P],_=h[P+1],(Math.abs(T[0]-Z[0])>=15||Math.abs(T[1]-Z[1])>=15)&&Math.pow(T[0]-Z[0],2)+Math.pow(T[1]-Z[1],2)>=Math.pow(15,2)&&_&&(Math.abs(T[0]-_[0])<=20||Math.abs(T[1]-_[1])<=20)&&Math.pow(T[0]-_[0],2)+Math.pow(T[1]-_[1],2)<=Math.pow(20,2))R.push(Z);else{let u=Z[0]-T[0],K=Z[1]-T[1],L=Math.max(Math.abs(u),Math.abs(K));for(var I=0;I<L;I+=15)R.push([T[0]+u*I/L,T[1]+K*I/L])}P++}return f>0&&(R.splice(0,0,h[0]),R.push(h[f-1])),R}(R.points||[]),T=null!==(f=R.iteration)&&void 0!==f?f:0;if(T<0&&(P(),P=function(){}),M.data("work-running")&&T<0)return;M.data("work-running",!0);let X,Z=S.length,_=Math.max(20,1e3*(R.time||3)/Z),{id:I,type:u,size:K,attribute:L}=O.$.findNode(h),et=function(ot){if(R.slideStatus!==O.$.slideStatus)return M.data("work-running",!1),void(R.slideStatus===O.$.slideStatus&&P());if(ot<Z){let _t=S[ot];_t&&(X=Object.assign({},K,{x:_t[0]-K.width/2,y:_t[1]-K.height/2}),Object.assign(L,(0,A.sg)(u,X,L)),(0,st.__)(window.document.getElementById(I),L),setTimeout(function(){et(++ot)},_))}else if(T>0)T--,et(1);else if(T<0)et(1);else switch(M.data("work-running",!1),R.slideStatus===O.$.slideStatus&&P(),R.finish){default:case 0:break;case 1:Object.assign(L,(0,A.sg)(u,K,L)),(0,st.__)(window.document.getElementById(I),L);break;case 2:var j;(0,z.E)(R.node.id,{node:R.node,value:null===(j=R.node.animate)||void 0===j?void 0:j.out,nodeStatus:R.nodeStatus,slideStatus:R.slideStatus},()=>{M.addClass("hide")})}};et(1)}},157:(oe,Lt,p)=>{p.d(Lt,{R:()=>st});var A=p(4981),O=p(70);const st=(gt,b,h,R,P)=>{var f,M,S,T,Z,_,I;if(R.slideStatus!=O.$.slideStatus)return b.async&&"change-slide"!=b.async?void 0:void P();if(R.nodeStatus!=O.$.nodeStatus&&(!b.async||"change-node"==b.async))return void P();if(!(null!==(f=b.source)&&void 0!==f&&f.path||null!==(M=b.source)&&void 0!==M&&M.url))return console.warn(`${gt} -> audio no source!`),P(),void(P=()=>{});var u=jQuery("#"+gt);let K=null!==(S=b.iteration)&&void 0!==S?S:0;if(K<0&&(P(),P=function(){}),!(u.data("audio-running")&&K<0)){u.data("audio-running",!0);var L=function(et){et.pause(),et.remove(),u.data("audio-running",!1)},X=new Audio;return X.autoplay=!0,X.loop=0!=K,X.preload="auto",X.controls=!0,X.setAttributeNode(document.createAttribute("playsinline")),X.addEventListener("canplay",function(){var et=X.play();et&&et.then(function(ot){var j;u.data("audio-running",!0),"time"==b.async?setTimeout(()=>{L(X),P(),P=()=>{}},1e3*(null!==(j=b.time)&&void 0!==j?j:1)):"non-stop"==b.async&&(P(),P=()=>{})}).catch(function(ot){u.data("audio-running",!1),R.slideStatus===O.$.slideStatus&&(P(),P=()=>{})})}),X.addEventListener("timeupdate",function(){switch(b.async){case"time":case"non-stop":break;case"finish-action":h.total>=2&&h.total-h.counter==1&&(L(this),P(),P=()=>{});break;default:case"change-node":R.nodeStatus!==O.$.nodeStatus&&(L(this),P(),P=()=>{});break;case"change-slide":R.slideStatus!==O.$.slideStatus&&(L(this),P(),P=()=>{})}}),X.addEventListener("canplaythrough",function(){this.loop&&(K>0?K--:0==K&&(this.loop=!1))}),X.addEventListener("play",function(){}),X.addEventListener("pause",function(){}),X.addEventListener("ended",function(){this.remove(),u.data("audio-running",!1),R.slideStatus===O.$.slideStatus&&(P(),P=()=>{})}),X.onerror=function(){this.remove(),u.data("audio-running",!1),R.slideStatus===O.$.slideStatus&&(P(),P=()=>{})},X.src=(null!==(T=b.source)&&void 0!==T&&T.path?(null===(Z=A.icdt.config)||void 0===Z?void 0:Z.readfileuploadurl)+(null===(_=b.source)||void 0===_?void 0:_.path):null===(I=b.source)||void 0===I?void 0:I.url)||"",X}}},5973:(oe,Lt,p)=>{p.d(Lt,{F:()=>P});var A=p(4981),O=p(70),st=p(2336),z=p(861),gt=p(157),b=p(4787),h=p(370),R=p(7267);const P=(f,M,S,T)=>{var Z,_,I;let u={total:0,counter:0},{triggershow:K,triggerrun:L,triggerhide:X,action:et,audio:ot,slide:j,media:_t}=null!==(Z=null===(_=f.interactive)||void 0===_?void 0:_.click)&&void 0!==Z?Z:{};if(console.log(`node(${f.id}) | nodeStatus(${M}) | slideStatus(${S}) | click`),K){let{id:St,ids:it,time:B,async:yt}=K;"asynctrue"==yt?(0,b.L5)({id:St,ids:it,nodeStatus:M,slideStatus:S}):"time"==yt&&setTimeout(()=>{(0,b.L5)({id:St,ids:it,nodeStatus:M,slideStatus:S})},1e3*(null!=B?B:0))}if(L){let{id:St,ids:it,time:B,async:yt}=L;"asynctrue"==yt?(0,b.Ar)({id:St,ids:it,nodeStatus:M,slideStatus:S}):"time"==yt&&setTimeout(()=>{(0,b.Ar)({id:St,ids:it,nodeStatus:M,slideStatus:S})},1e3*(null!=B?B:0))}if(X){let{id:St,ids:it,time:B,async:yt}=X;"asynctrue"==yt?(0,b.WT)({id:St,ids:it,nodeStatus:M,slideStatus:S}):"time"==yt&&setTimeout(()=>{(0,b.WT)({id:St,ids:it,nodeStatus:M,slideStatus:S})},1e3*(null!=B?B:0))}let Bt=()=>{setTimeout(()=>{if(u.counter>=u.total){if(T&&T(),K){let{id:St,ids:it,async:B}=K;(!B||"asyncfalse"==B)&&(0,b.L5)({id:St,ids:it,nodeStatus:M,slideStatus:S})}if(L){let{id:St,ids:it,async:B}=L;(!B||"asyncfalse"==B)&&(0,b.Ar)({id:St,ids:it,nodeStatus:M,slideStatus:S})}if(X){let{id:St,ids:it,async:B}=X;(!B||"asyncfalse"==B)&&(0,b.WT)({id:St,ids:it,nodeStatus:M,slideStatus:S})}}})};if(null!=et&&et.value){u.total+=1;let St=()=>{u.counter+=1,Bt()};switch(null==et?void 0:et.value){case"hide":var Gt;(0,R.E)(f.id,{node:f,value:null===(Gt=f.animate)||void 0===Gt?void 0:Gt.out,nodeStatus:M,slideStatus:S},()=>{jQuery("#"+f.id).addClass("hide"),St()});break;case"points":{let{points:it,time:B,iteration:yt,finish:wt}=et;it&&(0,z.G)(f.id,{node:f,points:it,time:B,iteration:yt,finish:wt,nodeStatus:M,slideStatus:S},St);break}default:{let{value:it,time:B,iteration:yt,finish:wt}=et;(0,st.Q)(f.id,{node:f,value:it,time:B,iteration:yt,finish:wt,nodeStatus:M,slideStatus:S},St);break}}}if(null!=ot&&null!==(I=ot.source)&&void 0!==I&&I.path){u.total+=1;let St=()=>{u.counter+=1,Bt()};(0,gt.R)(f.id,ot,u,{nodeStatus:M,slideStatus:S},St)}if(u.total||Bt(),null!=j&&j.id)switch(j.id){case-1:O.$.runSlide(O.$.slideIdx-1);break;case-2:O.$.runSlide(O.$.slideIdx+1);break;default:var Mt;O.$.runSlide(void 0,j.id,null===(Mt=j.code)||void 0===Mt?void 0:Mt.toString())}if(null!=_t&&_t.type){var It;let it=`<div class="popup-media-viewer"><iframe src="${(0,h.e)({readfileuploadurl:null===(It=A.icdt.config)||void 0===It?void 0:It.readfileuploadurl,type:null==_t?void 0:_t.type,oss:null==_t?void 0:_t.oss,path:null==_t?void 0:_t.path,url:null==_t?void 0:_t.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,B=jQuery(it).appendTo(window.document.body);B.find(".btn-close").click(function(yt){yt.preventDefault(),B.remove()})}}},4787:(oe,Lt,p)=>{p.d(Lt,{Ar:()=>gt,L5:()=>z,WT:()=>b});var A=p(70),O=p(5973),st=p(7267);const z=h=>{h.id?jQuery("#"+h.id).removeClass("hide"):h.ids&&h.ids.forEach(R=>{jQuery("#"+R).removeClass("hide")})},gt=h=>{h.id?(jQuery("#"+h.id).removeClass("hide"),(0,O.F)(A.$.findNode(h.id),h.nodeStatus,h.slideStatus)):h.ids&&h.ids.forEach(R=>{jQuery("#"+R).removeClass("hide"),(0,O.F)(A.$.findNode(R),h.nodeStatus,h.slideStatus)})},b=h=>{if(h.id){var R;let P=A.$.findNode(h.id);(0,st.E)(h.id,{node:P,value:null===(R=P.animate)||void 0===R?void 0:R.out,nodeStatus:h.nodeStatus,slideStatus:h.slideStatus},()=>{jQuery("#"+h.id).addClass("hide")})}else h.ids&&h.ids.forEach(P=>{var f;let M=A.$.findNode(P);(0,st.E)(P,{node:M,value:null===(f=M.animate)||void 0===f?void 0:f.out,nodeStatus:h.nodeStatus,slideStatus:h.slideStatus},()=>{jQuery("#"+P).addClass("hide")})})}},7492:(oe,Lt,p)=>{p.d(Lt,{Mh:()=>L,wM:()=>ot,xo:()=>X,it:()=>j,g1:()=>It,__:()=>_t,QI:()=>Gt,DB:()=>Bt,eb:()=>et,x0:()=>rt,g$:()=>St,mo:()=>Ot,XH:()=>wt,hJ:()=>it,vl:()=>yt,yD:()=>B,Yw:()=>qt});var A=p(9054),O=p(1687),st=p(9359),gt=/^#?[a-fA-F0-9]+$/;const R=(J,tt)=>{var d;if("none"==(J=null!==(d=J)&&void 0!==d?d:""))return"none";if("transparent"==J)return"rgba(0,0,0,0)";if(J.includes("rgba("))return J;if(J.includes("rgb(")&&(J=(0,st.E)(J)),!(J=J.replace(/[^0-9a-fA-F]/g,"")))return"";if(!gt.test(J))return console.error(`hex2rgba -> ${J}: first argument has invalid hexadecimal characters`),"";if("#"===J[0]&&(J=J.slice(1)),3===J.length){let Et=J.split("");Et.splice(2,0,J[2]),Et.splice(1,0,J[1]),Et.splice(0,0,J[0]),J=Et.join("")}if(6!==J.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var nt=[parseInt(J.slice(0,2),16),parseInt(J.slice(2,4),16),parseInt(J.slice(4,6),16)];return tt="number"==typeof tt?tt:parseFloat(tt),nt.push(tt>=0&&tt<=1?tt:1),"rgba("+nt.join(",")+")"};var P=p(370),f=p(1814),M=p(4981),S=p(3423),T=p(8054),Z=p(7210),_=p(8619),I=p(70),u=p(2875),K=p(1105);class L{constructor(tt,d){let nt=window.document.querySelector(d);var Et;nt||(nt=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(Et=window.document.querySelector(tt))||void 0===Et||Et.appendChild(nt));let{svgViewBox:At,svgSize:Dt}=M.icdt.screen.init();nt.setAttributeNS(null,"viewBox",`${At.x} ${At.y} ${At.width} ${At.height}`),nt.setAttribute("id",d.replace("#","")),nt.style.display="block",nt.style.width=`${Dt.width}px`,nt.style.height=`${Dt.height}px`,nt.style.backgroundColor="#fafafa",nt.style.cursor="default"}}const X=J=>{jQuery(M.icdt.target).find("#"+O.O.BACKGROUND_GROUP).empty();let tt=It(O.O.BACKGROUND_GROUP,"g",void 0,M.icdt.target);rt(tt,J),(()=>{let d=window.document.getElementById(null==J?void 0:J.id);jQuery(d).find("#"+O.O.BACKGROUND_GROUP).empty();let nt=It(O.O.BACKGROUND_GROUP,"g",void 0,d);rt(nt,J)})()},et=()=>{let J=M.icdt.screen.svgViewBox,tt=M.icdt.screen.svgSize;M.icdt.target&&(M.icdt.target.setAttributeNS(null,"viewBox",`${J.x} ${J.y} ${J.width} ${J.height}`),M.icdt.target.style.left=`${tt.x}px`,M.icdt.target.style.top=`${tt.y}px`,M.icdt.target.style.width=`${tt.width}px`,M.icdt.target.style.height=`${tt.height}px`)},ot=()=>{jQuery(M.icdt.target).find(">*:not(defs)").remove()},j=(J,tt,d,nt,Et)=>{let At;return J?(At=jQuery(Et||M.icdt.target).find("#"+J).get(0),At||(At=window.document.createElementNS("http://www.w3.org/2000/svg",d),At.setAttribute("id",J),tt==A.$.FOREIGNOBJECT&&At.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(At).appendTo(Et||M.icdt.target))):(At=window.document.createElementNS("http://www.w3.org/2000/svg",d),jQuery(At).appendTo(Et||M.icdt.target)),null!=nt&&nt.attribute&&_t(At,null==nt?void 0:nt.attribute),null!=nt&&nt.style&&Bt(At,null==nt?void 0:nt.style),null!=nt&&nt.source&&Gt(At,tt,null==nt?void 0:nt.source),At},_t=(J,tt)=>{return jQuery(J).attr((d=Object.assign({},tt||{}),null===(nt=Object.keys(d))||void 0===nt||nt.forEach(Dt=>{switch(Dt){case"fill":break;case"fillRule":var Vt;Object.assign(d,{"fill-rule":null!==(Vt=d.fillRule)&&void 0!==Vt?Vt:null,fillRule:null});break;case"stroke":var Jt;Object.assign(d,{"stroke-width":null!==(Jt=d.strokeWidth)&&void 0!==Jt?Jt:null,strokeWidth:null});break;case"strokeLinecap":var Tt;Object.assign(d,{"stroke-linecap":null!==(Tt=d.strokeLinecap)&&void 0!==Tt?Tt:null,strokeLinecap:null});break;case"strokeLinejoin":var vt;Object.assign(d,{"stroke-linejoin":null!==(vt=d.strokeLinejoin)&&void 0!==vt?vt:null,strokeLinejoin:null});break;case"strokeMiterlimit":var te;Object.assign(d,{"stroke-miterlimit":null!==(te=d.strokeMiterlimit)&&void 0!==te?te:null,strokeMiterlimit:null});break;case"strokeDasharray":var Y;Object.assign(d,{"stroke-dasharray":null!==(Y=d.strokeDasharray)&&void 0!==Y?Y:null,strokeDasharray:null});break;case"strokeDasharrays":var v,H;Object.assign(d,{"stroke-dasharray":null!==(v=null===(H=d.strokeDasharrays)||void 0===H?void 0:H.join(" "))&&void 0!==v?v:null,strokeDasharrays:null});break;case"fontFamily":var ft;Object.assign(d,{"font-family":null!==(ft=d.fontFamily)&&void 0!==ft?ft:null,fontFamily:null});break;case"fontWeight":var ut;Object.assign(d,{"font-weight":null!==(ut=d.fontWeight)&&void 0!==ut?ut:null,fontWeight:null});break;case"fontSize":var q;Object.assign(d,{"font-size":null!==(q=d.fontSize)&&void 0!==q?q:null,fontSize:null});break;case"textLength":Object.assign(d,{textLength:d.textLength?`${d.textLength}px`:null});break;case"transformOrigin":var Q;Object.assign(d,{"transform-origin":null!==(Q=d.transformOrigin)&&void 0!==Q?Q:null,transformOrigin:null})}}),Object.assign({},null!=d?d:{},{fill:null!=d&&d.fill?R(d.fill,null!==(Et=null==d?void 0:d.fillOpacity)&&void 0!==Et?Et:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=d&&d.stroke?R(d.stroke,null!==(At=null==d?void 0:d.strokeOpacity)&&void 0!==At?At:1):"rgba(0,0,0,0)",strokeOpacity:null}))),J;var d,nt,Et,At},Bt=(J,tt)=>{return jQuery(J).css((d=Object.assign({},tt||{}),null===(nt=Object.keys(d))||void 0===nt||nt.forEach(Et=>{switch(Et){case"padding":Object.assign(d,{padding:d.padding?`${d.padding}px`:null});break;case"borderWidth":var At;Object.assign(d,d.borderWidth&&d.borderColor?{"border-width":`${d.borderWidth}px`,"border-style":d.borderStyle||"solid","border-color":R(d.borderColor,null!==(At=d.borderOpacity)&&void 0!==At?At:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(d,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(d,{"border-radius":d.borderRadius?`${d.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var Dt;Object.assign(d,d.backgroundColor?{"background-color":R(d.backgroundColor,null!==(Dt=d.backgroundOpacity)&&void 0!==Dt?Dt:1)}:{"background-color":""}),Object.assign(d,{backgroundColor:null,backgroundOpacity:null})}}),d)),J;var d,nt},Gt=(J,tt,d)=>{switch(tt){case A.$.TEXT:var nt,Et;jQuery(J).text(null!==(nt=null==d||null===(Et=d.text)||void 0===Et?void 0:Et.textContent)&&void 0!==nt?nt:"");break;case A.$.IMAGE:var At,Dt,Vt,Jt,Tt;jQuery(J).attr("href",(null==d||null===(At=d.image)||void 0===At?void 0:At.base64)||(null!=d&&null!==(Dt=d.image)&&void 0!==Dt&&Dt.path?(null===(Vt=M.icdt.config)||void 0===Vt?void 0:Vt.readfileuploadurl)+(null==d||null===(Jt=d.image)||void 0===Jt?void 0:Jt.path):null==d||null===(Tt=d.image)||void 0===Tt?void 0:Tt.url)||"");break;case A.$.FOREIGNOBJECT:switch(null==d?void 0:d.type){case"text":var vt,te;if(null!==(vt=d.text)&&void 0!==vt&&vt.variableKeywords&&null!==(te=d.text)&&void 0!==te&&te.variableKeywords.length){var Y;let a=M.icdt.variable.getKeys(),y=(null===(Y=d.text)||void 0===Y?void 0:Y.textContent)||"";d.text.variableKeywords.forEach(g=>{var m=g.replace(/[^a-zA-Z0-9_]/gm,"");if(a.indexOf(m)>=0){var C=M.icdt.variable.getValue(m);y=y.replace(g,C)}}),jQuery(J).text(y)}else{var v;jQuery(J).text((null===(v=d.text)||void 0===v?void 0:v.textContent)||"")}break;case"html":{var H,ft,ut;let a=(null==d||null===(H=d.html)||void 0===H?void 0:H.htmlContent)||"";if(null!==(ft=d.html)&&void 0!==ft&&ft.variableKeywords&&null!==(ut=d.html)&&void 0!==ut&&ut.variableKeywords.length){let y=M.icdt.variable.getKeys();d.html.variableKeywords.forEach(g=>{var m=g.replace(/[^a-zA-Z0-9_]/gm,"");if(y.indexOf(m)>=0){var C=M.icdt.variable.getValue(m);a=a.replace(g,C)}})}jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${a}</div>`).find("img[path],video[path],iframe[path]").each((y,g)=>{var m,C;g.setAttribute("src",(null!==(m=null===(C=M.icdt.config)||void 0===C?void 0:C.readfileuploadurl)&&void 0!==m?m:"")+g.getAttribute("path")),g.removeAttribute("path")});break}case"input":var q,Q,V,x;if(null!==(q=d.input)&&void 0!==q&&q.input)jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(V=null===(x=d.input)||void 0===x?void 0:x.placeholder)&&void 0!==V?V:""}" maxlength="100" /></div>`);else if(null!==(Q=d.input)&&void 0!==Q&&Q.textarea){var U,pt;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(U=null===(pt=d.input)||void 0===pt?void 0:pt.placeholder)&&void 0!==U?U:""}" maxlength="1000"></textarea></div>`)}break;case"image":var Ct,mt,Pt,zt,Wt;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(Ct=d.image)||void 0===Ct?void 0:Ct.base64)||(null!==(mt=d.image)&&void 0!==mt&&mt.path?(null===(Pt=M.icdt.config)||void 0===Pt?void 0:Pt.readfileuploadurl)+(null===(zt=d.image)||void 0===zt?void 0:zt.path):null===(Wt=d.image)||void 0===Wt?void 0:Wt.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var Ht,ne,re,pe;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(Ht=d.iframe)&&void 0!==Ht&&Ht.path?(null===(ne=M.icdt.config)||void 0===ne?void 0:ne.readfileuploadurl)+(null===(re=d.iframe)||void 0===re?void 0:re.path):null===(pe=d.iframe)||void 0===pe?void 0:pe.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var se,de,xe,Qe,He;let a=(0,P.e)({readfileuploadurl:null===(se=M.icdt.config)||void 0===se?void 0:se.readfileuploadurl,type:null===(de=d.embed)||void 0===de?void 0:de.type,oss:null===(xe=d.embed)||void 0===xe?void 0:xe.oss,path:null===(Qe=d.embed)||void 0===Qe?void 0:Qe.path,url:null===(He=d.embed)||void 0===He?void 0:He.url});jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${a}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var Pe,Je;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(Pe=null===(Je=d.svg)||void 0===Je?void 0:Je.svgContent)&&void 0!==Pe?Pe:""}</div>`);break;case"test":{var Ze,ei,Ee,Xe;let a=(null==d||null===(Ze=d.html)||void 0===Ze?void 0:Ze.htmlContent)||"";if(null!==(ei=d.html)&&void 0!==ei&&ei.variableKeywords&&null!==(Ee=d.html)&&void 0!==Ee&&Ee.variableKeywords.length){let y=M.icdt.variable.getKeys();d.html.variableKeywords.forEach(g=>{var m=g.replace(/[^a-zA-Z0-9_]/gm,"");if(y.indexOf(m)>=0){var C=M.icdt.variable.getValue(m);a=a.replace(g,C)}})}switch(null==d||null===(Xe=d.test)||void 0===Xe?void 0:Xe.type){case"truefalse":var De;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(De=d.test.truefalse)&&void 0!==De&&De.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${a}</div></div></div>`);break;case"singlechoice":var Ue;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ue=d.test.singlechoice)&&void 0!==Ue&&Ue.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${a}</div></div></div>`);break;case"multichoice":var Ye;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ye=d.test.multichoice)&&void 0!==Ye&&Ye.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${a}</div></div></div>`);break;case"matching-empty":var qe;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==d||null===(qe=d.test.matching)||void 0===qe?void 0:qe.key}"></div>`);break;case"matching-content":var Ge,Ve,ii;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==d||null===(Ge=d.test.matching)||void 0===Ge?void 0:Ge.key}"><div class="ondrag-item" data-key="${null!==(Ve=null==d||null===(ii=d.test)||void 0===ii||null===(ii=ii.matching)||void 0===ii?void 0:ii.key)&&void 0!==Ve?Ve:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${a}</div></div></div></div>`);break;case"fill":var bt;((null===(bt=d.html)||void 0===bt?void 0:bt.fillKeywords)||[]).forEach(y=>{var g=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${y.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;a=a.replace(new RegExp(y.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),g)}),jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${a}</div></div></div>`);break;case"speech":jQuery(J).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var D,i,n,r,o;jQuery(J).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(D=null!==(i=d.image)&&void 0!==i&&i.path?(null===(n=M.icdt.config)||void 0===n?void 0:n.readfileuploadurl)+(null===(r=d.image)||void 0===r?void 0:r.path):null===(o=d.image)||void 0===o?void 0:o.url)&&void 0!==D?D:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(J).find("img[path],video[path],iframe[path]").each((y,g)=>{var m,C;g.setAttribute("src",(null!==(m=null===(C=M.icdt.config)||void 0===C?void 0:C.readfileuploadurl)&&void 0!==m?m:"")+g.getAttribute("path")),g.removeAttribute("path")})}}}},It=(J,tt,d,nt)=>{let Et=jQuery(nt||M.icdt.target).find("#"+J).get(0);return Et||(Et=window.document.createElementNS("http://www.w3.org/2000/svg",tt),Et.setAttribute("id",J),jQuery(Et).appendTo(nt||M.icdt.target)),jQuery(Et).attr((null==d?void 0:d.attribute)||{}),jQuery(Et).css((null==d?void 0:d.style)||{}),Et},St=(J,tt)=>{let d=(0,S.v)(2),nt={fill:f.S3.fill,stroke:f.S3.stroke,"stroke-width":(0,S.v)(f.S3.strokeWidth)};return[{element:It("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:tt.x-d,y:tt.y-d,width:tt.width+2*d,height:tt.height+2*d},nt)},J),posType:"rect-center"}]},it=(J,tt)=>{let{size:d}=tt,nt=(0,S.v)(1),Et=(0,S.v)(2),At=(0,S.v)(5),Dt={stroke:f.NV.stroke,"stroke-width":(0,S.v)(f.NV.strokeWidth),"stroke-linecap":f.NV.strokeLinecap},Vt={fill:f.Mo.fill,stroke:f.Mo.stroke,"stroke-width":(0,S.v)(f.Mo.strokeWidth)},Jt={fill:f.In.fill,stroke:f.In.stroke,"stroke-width":(0,S.v)(f.In.strokeWidth),width:(0,S.v)(f.In.width),height:(0,S.v)(f.In.height)};return It("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:d.x-nt,y1:d.y,x2:d.x-nt,y2:d.y+d.height},Dt)},J),It("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-nt,x2:d.x+d.width,y2:d.y-nt},Dt)},J),It("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:d.x+d.width+nt,y1:d.y,x2:d.x+d.width+nt,y2:d.y+d.height},Dt)},J),It("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+nt,x2:d.x+d.width,y2:d.y+d.height+nt},Dt)},J),[{element:It("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Vt),style:{cursor:"move"}},J),posType:"rect-center"},{element:It("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:d.x-At,y:d.y-At},Jt),style:{cursor:"nw-resize"}},J),posType:"rect-top-left"},{element:It("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:d.x+d.width-Et,y:d.y-At},Jt),style:{cursor:"ne-resize"}},J),posType:"rect-top-right"},{element:It("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:d.x-At,y:d.y+d.height-Et},Jt),style:{cursor:"sw-resize"}},J),posType:"rect-bottom-left"},{element:It("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:d.x+d.width-Et,y:d.y+d.height-Et},Jt),style:{cursor:"se-resize"}},J),posType:"rect-bottom-right"},{element:It("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:d.x+d.width/2-Et-nt,y:d.y-At},Jt),style:{cursor:"n-resize"}},J),posType:"rect-top"},{element:It("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:d.x+d.width-Et,y:d.y+d.height/2-Et-nt},Jt),style:{cursor:"e-resize"}},J),posType:"rect-right"},{element:It("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:d.x+d.width/2-Et-nt,y:d.y+d.height-Et},Jt),style:{cursor:"s-resize"}},J),posType:"rect-bottom"},{element:It("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:d.x-At,y:d.y+d.height/2-Et-nt},Jt),style:{cursor:"w-resize"}},J),posType:"rect-left"}]},B=(J,tt,d)=>{let nt=(0,S.v)(1),Et={stroke:f.NV.stroke,"stroke-width":(0,S.v)(f.NV.strokeWidth),"stroke-linecap":f.NV.strokeLinecap},At={fill:f.Mo.fill,stroke:f.Mo.stroke,"stroke-width":(0,S.v)(f.Mo.strokeWidth)},Dt={fill:f.dt.fill,stroke:f.dt.stroke,"stroke-width":(0,S.v)(f.dt.strokeWidth)},te=(It("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:d.x-nt,y1:d.y,x2:d.x-nt,y2:d.y+d.height},Et)},J),It("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-nt,x2:d.x+d.width,y2:d.y-nt},Et)},J),It("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:d.x+d.width+nt,y1:d.y,x2:d.x+d.width+nt,y2:d.y+d.height},Et)},J),It("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+nt,x2:d.x+d.width,y2:d.y+d.height+nt},Et)},J),It("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},At)},J));return tt.forEach(Y=>{let{size:v}=Y;It("icdt-temp-select-rect-node-"+Y.id,"rect",{attribute:Object.assign({x:v.x,y:v.y,width:v.width,height:v.height},Dt)},J)}),[{element:te,posType:"rect-center"}]},yt=(J,tt)=>{let d=(0,S.v)(1),nt={stroke:f.NV.stroke,"stroke-width":(0,S.v)(f.NV.strokeWidth),"stroke-linecap":f.NV.strokeLinecap},Et={fill:f.Mo.fill,stroke:f.Mo.stroke,"stroke-width":(0,S.v)(f.Mo.strokeWidth)};return It("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:tt.x-d,y1:tt.y,x2:tt.x-d,y2:tt.y+tt.height},nt)},J),It("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:tt.x,y1:tt.y-d,x2:tt.x+tt.width,y2:tt.y-d},nt)},J),It("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:tt.x+tt.width+d,y1:tt.y,x2:tt.x+tt.width+d,y2:tt.y+tt.height},nt)},J),It("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:tt.x,y1:tt.y+tt.height+d,x2:tt.x+tt.width,y2:tt.y+tt.height+d},nt)},J),[{element:It("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:tt.x,y:tt.y,width:tt.width,height:tt.height},Et)},J),posType:"rect-center"}]},wt=(J,tt)=>((0,S.v)(-1),(0,S.v)(f.h8.strokeWidth),(0,S.v)(f.h8.strokeDasharray),It("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:tt.x,y:tt.y,width:tt.width,height:tt.height,class:"cursor-draw"},{fill:f.MA.fill})},J),[]),Ot=(J,tt)=>{let d={fill:f.k0.fill,stroke:f.k0.stroke,"stroke-width":(0,S.v)(f.k0.strokeWidth),"stroke-dasharray":(0,S.v)(f.k0.strokeDasharray)};jQuery(J).empty(),tt.forEach(nt=>{var Et,At;let{size:Dt}=nt;if(!nt.idx)return;It("icdt-temp-index-rect-node-"+nt.id,"rect",{attribute:Object.assign({x:Dt.x-5,y:Dt.y-5,width:Dt.width+10,height:Dt.height+10},d)},J);let{element:Vt}=(0,u.e)(Math.ceil(1e9*Math.random()),{size:{x:Dt.x-76,y:Dt.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(Et=nt.idx)&&void 0!==Et?Et:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(At=nt.time)&&void 0!==At?At:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},J);Vt.classList.add("node-input"),jQuery(Vt).on("change",'input[name="idx"]',Jt=>{var Tt;nt.idx=parseInt(null!==(Tt=Jt.target.value)&&void 0!==Tt?Tt:"0")}).on("change",'input[name="time"]',Jt=>{var Tt;nt.time=parseFloat(null!==(Tt=Jt.target.value)&&void 0!==Tt?Tt:"0")}).on("click",'button[name="remove"]',Jt=>{nt.idx=0,nt.time=null,Ot(J,tt)})})},rt=(J,tt)=>{var d,nt,Et,At,Dt,Vt;let{color:Jt,opacity:Tt,path:vt,url:te,base64:Y}=null!==(d=null==tt||null===(nt=tt.svg)||void 0===nt?void 0:nt.background)&&void 0!==d?d:{},{x:v,y:H,width:ft,height:ut}=null!==(Et=null==tt||null===(At=tt.svg)||void 0===At?void 0:At.viewBox)&&void 0!==Et?Et:{x:0,y:0,width:0,height:0};(0,K.$)(void 0,{size:{x:0,y:(0,S.v)(-21),width:ft,height:ut},attribute:{fill:"#999",fontSize:(0,S.v)(14),class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(Dt=null!==(Vt=null==tt?void 0:tt.name)&&void 0!==Vt?Vt:null==tt?void 0:tt.code)&&void 0!==Dt?Dt:void 0}}},J),(0,T.f)(void 0,{size:{x:v,y:H,width:ft,height:ut},attribute:{fill:"#fff",stroke:"#999",strokeWidth:(0,S.v)(1),strokeDasharray:(0,S.v)(10),class:"hide-on-viewer"}},J),Jt&&(0,T.f)(void 0,{size:{x:v,y:H,width:ft,height:ut},attribute:{fill:Jt,fillOpacity:Tt}},J),vt&&(0,Z.G)(void 0,{size:{x:v,y:H,width:ft,height:ut},source:{type:"image",image:{path:vt,url:te,base64:Y}}},J)},qt=(J,tt)=>{var d;switch(jQuery(J).empty(),null===(d=tt.test)||void 0===d?void 0:d.type){case"truefalse":{var nt,Et,At,Dt;let q=null==tt||null===(nt=tt.test)||void 0===nt||null===(nt=nt.answer)||void 0===nt||null===(nt=nt.truefalse)||void 0===nt?void 0:nt.value,Q=null===(Et=tt.svg)||void 0===Et?void 0:Et.nodes.find(V=>{var x;return"submit"==(null===(x=V.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)});null===(At=tt.svg)||void 0===At||At.nodes.filter(V=>{var x;return"truefalse"==(null===(x=V.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)&&(V.id!=q||!Q)}).forEach(V=>{var x;let{x:pt,y:Ct,width:mt,height:Pt}=null!==(x=null==V?void 0:V.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:pt-.5,y:Ct-.5,width:mt+1,height:Pt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},J)}),null!=tt&&null!==(Dt=tt.test)&&void 0!==Dt&&null!==(Dt=Dt.answer)&&void 0!==Dt&&Dt.truefalse&&q&&Q&&(V=>{let x=I.$.findNode(q),{x:pt,y:Ct,width:mt,height:Pt}=null!==(V=null==x?void 0:x.size)&&void 0!==V?V:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:pt-2,y:Ct-2,width:mt+4,height:Pt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},J)})();break}case"singlechoice":{var Vt,Jt,Tt,vt;let q=null==tt||null===(Vt=tt.test)||void 0===Vt||null===(Vt=Vt.answer)||void 0===Vt||null===(Vt=Vt.singlechoice)||void 0===Vt?void 0:Vt.value,Q=null===(Jt=tt.svg)||void 0===Jt?void 0:Jt.nodes.find(V=>{var x;return"submit"==(null===(x=V.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)});null===(Tt=tt.svg)||void 0===Tt||Tt.nodes.filter(V=>{var x;return"singlechoice"==(null===(x=V.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)&&(V.id!=q||!Q)}).forEach(V=>{var x;let{x:pt,y:Ct,width:mt,height:Pt}=null!==(x=null==V?void 0:V.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:pt-.5,y:Ct-.5,width:mt+1,height:Pt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},J)}),null!=tt&&null!==(vt=tt.test)&&void 0!==vt&&null!==(vt=vt.answer)&&void 0!==vt&&vt.singlechoice&&q&&Q&&(V=>{let x=I.$.findNode(q),{x:pt,y:Ct,width:mt,height:Pt}=null!==(V=null==x?void 0:x.size)&&void 0!==V?V:{x:0,y:0,width:0,height:0};(0,_._)(Math.ceil(1e9*Math.random()),{size:{x:pt-2,y:Ct-2,width:mt+4,height:Pt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},J)})();break}case"multichoice":{var te,Y,v,H,ft;let q=null!==(te=null==tt||null===(Y=tt.test)||void 0===Y||null===(Y=Y.answer)||void 0===Y||null===(Y=Y.multichoice)||void 0===Y?void 0:Y.map(V=>V.value))&&void 0!==te?te:[],Q=null===(v=tt.svg)||void 0===v?void 0:v.nodes.find(V=>{var x;return"submit"==(null===(x=V.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)});var ut;null===(H=tt.svg)||void 0===H||H.nodes.filter(V=>{var x;return!("multichoice"!=(null===(x=V.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)||q.includes(V.id)&&Q)}).forEach(V=>{var x;let{x:pt,y:Ct,width:mt,height:Pt}=null!==(x=null==V?void 0:V.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,T.f)(Math.ceil(1e9*Math.random()),{size:{x:pt-.5,y:Ct-.5,width:mt+1,height:Pt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},J)}),null!=tt&&null!==(ft=tt.test)&&void 0!==ft&&null!==(ft=ft.answer)&&void 0!==ft&&ft.multichoice&&q.length&&Q&&(null==tt||null===(ut=tt.test)||void 0===ut||null===(ut=ut.answer)||void 0===ut||ut.multichoice.forEach(V=>{var x;let U=I.$.findNode(V.value),{x:Ct,y:mt,width:Pt,height:zt}=null!==(x=null==U?void 0:U.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,T.f)(Math.ceil(1e9*Math.random()),{size:{x:Ct-2,y:mt-2,width:Pt+4,height:zt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},J)}));break}}}},370:(oe,Lt,p)=>{p.d(Lt,{e:()=>st});const st=b=>{switch(null==b?void 0:b.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+b.readfileuploadurl+b.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+b.readfileuploadurl+b.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+b.readfileuploadurl+b.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+b.readfileuploadurl+b.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+b.readfileuploadurl+b.path;case 906:case 911:case 910:return""+b.readfileuploadurl+b.path;case 905:case 912:var h;return"imsmanifest.xml"==(null===(h=b.path)||void 0===h||null===(h=h.split("/"))||void 0===h?void 0:h.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+b.readfileuploadurl+b.path:""+b.readfileuploadurl+b.path;case 907:case 900:return""+b.readfileuploadurl+b.path;case 904:switch(b.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+b.url;case 1002:var R;return null!==(R=z(b.url))&&void 0!==R?R:"";case 1005:var P;return null!==(P=b.url)&&void 0!==P?P:"";default:var f;return null!==(f=b.url)&&void 0!==f?f:""}default:return""+b.readfileuploadurl+b.path}},z=b=>{let h=gt(b);return h?"https://www.youtube.com/embed/"+h+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},gt=b=>{let h=null==b?void 0:b.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return h&&h.length>=2?h[1]:null}},511:(oe,Lt,p)=>{function A(){}function O(t){return null==t?A:function(){return this.querySelector(t)}}function gt(){return[]}function b(t){return null==t?gt:function(){return this.querySelectorAll(t)}}function P(t){return function(){return this.matches(t)}}function f(t){return function(e){return e.matches(t)}}p.d(Lt,{$0Z:()=>aa,jvg:()=>la});var M=Array.prototype.find;function T(){return this.firstElementChild}var _=Array.prototype.filter;function I(){return Array.from(this.children)}function X(t){return new Array(t.length)}function ot(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function _t(t,e,l,s,c,E){for(var W,k=0,F=e.length,at=E.length;k<at;++k)(W=e[k])?(W.__data__=E[k],s[k]=W):l[k]=new ot(t,E[k]);for(;k<F;++k)(W=e[k])&&(c[k]=W)}function Bt(t,e,l,s,c,E,k){var W,F,Xt,at=new Map,ct=e.length,Kt=E.length,Ut=new Array(ct);for(W=0;W<ct;++W)(F=e[W])&&(Ut[W]=Xt=k.call(F,F.__data__,W,e)+"",at.has(Xt)?c[W]=F:at.set(Xt,F));for(W=0;W<Kt;++W)Xt=k.call(t,E[W],W,E)+"",(F=at.get(Xt))?(s[W]=F,F.__data__=E[W],at.delete(Xt)):l[W]=new ot(t,E[W]);for(W=0;W<ct;++W)(F=e[W])&&at.get(Ut[W])===F&&(c[W]=F)}function Gt(t){return t.__data__}function It(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Ot(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}ot.prototype={constructor:ot,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Et="http://www.w3.org/1999/xhtml";const At={svg:"http://www.w3.org/2000/svg",xhtml:Et,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Dt(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),At.hasOwnProperty(e)?{space:At[e],local:t}:t}function Vt(t){return function(){this.removeAttribute(t)}}function Jt(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Tt(t,e){return function(){this.setAttribute(t,e)}}function vt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function te(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function Y(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function H(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ft(t){return function(){this.style.removeProperty(t)}}function ut(t,e,l){return function(){this.style.setProperty(t,e,l)}}function q(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function V(t,e){return t.style.getPropertyValue(e)||H(t).getComputedStyle(t,null).getPropertyValue(e)}function x(t){return function(){delete this[t]}}function U(t,e){return function(){this[t]=e}}function pt(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function mt(t){return t.trim().split(/^|\s+/)}function Pt(t){return t.classList||new zt(t)}function zt(t){this._node=t,this._names=mt(t.getAttribute("class")||"")}function Wt(t,e){for(var l=Pt(t),s=-1,c=e.length;++s<c;)l.add(e[s])}function Ht(t,e){for(var l=Pt(t),s=-1,c=e.length;++s<c;)l.remove(e[s])}function ne(t){return function(){Wt(this,t)}}function re(t){return function(){Ht(this,t)}}function pe(t,e){return function(){(e.apply(this,arguments)?Wt:Ht)(this,t)}}function de(){this.textContent=""}function xe(t){return function(){this.textContent=t}}function Qe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Pe(){this.innerHTML=""}function Je(t){return function(){this.innerHTML=t}}function Ze(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ee(){this.nextSibling&&this.parentNode.appendChild(this)}function De(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ye(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===Et&&e.documentElement.namespaceURI===Et?e.createElement(t):e.createElementNS(l,t)}}function qe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ge(t){var e=Dt(t);return(e.local?qe:Ye)(e)}function ii(){return null}function D(){var t=this.parentNode;t&&t.removeChild(this)}function n(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function r(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function m(t){return function(){var e=this.__on;if(e){for(var E,l=0,s=-1,c=e.length;l<c;++l)E=e[l],t.type&&E.type!==t.type||E.name!==t.name?e[++s]=E:this.removeEventListener(E.type,E.listener,E.options);++s?e.length=s:delete this.__on}}}function C(t,e,l){return function(){var c,s=this.__on,E=function y(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var k=0,W=s.length;k<W;++k)if((c=s[k]).type===t.type&&c.name===t.name)return this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=E,c.options=l),void(c.value=e);this.addEventListener(t.type,E,l),c={type:t.type,name:t.name,value:e,listener:E,options:l},s?s.push(c):this.__on=[c]}}function G(t,e,l){var s=H(t),c=s.CustomEvent;"function"==typeof c?c=new c(e,l):(c=s.document.createEvent("Event"),l?(c.initEvent(e,l.bubbles,l.cancelable),c.detail=l.detail):c.initEvent(e,!1,!1)),t.dispatchEvent(c)}function N(t,e){return function(){return G(this,t,e)}}function dt(t,e){return function(){return G(this,t,e.apply(this,arguments))}}zt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Nt=[null];function Ft(t,e){this._groups=t,this._parents=e}function ge(){return new Ft([[document.documentElement]],Nt)}Ft.prototype=ge.prototype={constructor:Ft,select:function st(t){"function"!=typeof t&&(t=O(t));for(var e=this._groups,l=e.length,s=new Array(l),c=0;c<l;++c)for(var F,at,E=e[c],k=E.length,W=s[c]=new Array(k),ct=0;ct<k;++ct)(F=E[ct])&&(at=t.call(F,F.__data__,ct,E))&&("__data__"in F&&(at.__data__=F.__data__),W[ct]=at);return new Ft(s,this._parents)},selectAll:function R(t){t="function"==typeof t?function h(t){return function(){return function z(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):b(t);for(var e=this._groups,l=e.length,s=[],c=[],E=0;E<l;++E)for(var F,k=e[E],W=k.length,at=0;at<W;++at)(F=k[at])&&(s.push(t.call(F,F.__data__,at,k)),c.push(F));return new Ft(s,c)},selectChild:function Z(t){return this.select(null==t?T:function S(t){return function(){return M.call(this.children,t)}}("function"==typeof t?t:f(t)))},selectChildren:function K(t){return this.selectAll(null==t?I:function u(t){return function(){return _.call(this.children,t)}}("function"==typeof t?t:f(t)))},filter:function L(t){"function"!=typeof t&&(t=P(t));for(var e=this._groups,l=e.length,s=new Array(l),c=0;c<l;++c)for(var F,E=e[c],k=E.length,W=s[c]=[],at=0;at<k;++at)(F=E[at])&&t.call(F,F.__data__,at,E)&&W.push(F);return new Ft(s,this._parents)},data:function Mt(t,e){if(!arguments.length)return Array.from(this,Gt);var l=e?Bt:_t,s=this._parents,c=this._groups;"function"!=typeof t&&(t=function j(t){return function(){return t}}(t));for(var E=c.length,k=new Array(E),W=new Array(E),F=new Array(E),at=0;at<E;++at){var ct=s[at],Kt=c[at],Ut=Kt.length,Xt=It(t.call(ct,ct&&ct.__data__,at,s)),_e=Xt.length,Oe=W[at]=new Array(_e),jt=k[at]=new Array(_e);l(ct,Kt,Oe,jt,F[at]=new Array(Ut),Xt,e);for(var ue,fe,ie=0,Yt=0;ie<_e;++ie)if(ue=Oe[ie]){for(ie>=Yt&&(Yt=ie+1);!(fe=jt[Yt])&&++Yt<_e;);ue._next=fe||null}}return(k=new Ft(k,s))._enter=W,k._exit=F,k},enter:function et(){return new Ft(this._enter||this._groups.map(X),this._parents)},exit:function St(){return new Ft(this._exit||this._groups.map(X),this._parents)},join:function it(t,e,l){var s=this.enter(),c=this,E=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(c=e(c))&&(c=c.selection()),null==l?E.remove():l(E),s&&c?s.merge(c).order():c},merge:function B(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,c=l.length,k=Math.min(c,s.length),W=new Array(c),F=0;F<k;++F)for(var Xt,at=l[F],ct=s[F],Kt=at.length,Ut=W[F]=new Array(Kt),_e=0;_e<Kt;++_e)(Xt=at[_e]||ct[_e])&&(Ut[_e]=Xt);for(;F<c;++F)W[F]=l[F];return new Ft(W,this._parents)},selection:function ve(){return this},order:function yt(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var k,s=t[e],c=s.length-1,E=s[c];--c>=0;)(k=s[c])&&(E&&4^k.compareDocumentPosition(E)&&E.parentNode.insertBefore(k,E),E=k);return this},sort:function wt(t){function e(Kt,Ut){return Kt&&Ut?t(Kt.__data__,Ut.__data__):!Kt-!Ut}t||(t=Ot);for(var l=this._groups,s=l.length,c=new Array(s),E=0;E<s;++E){for(var at,k=l[E],W=k.length,F=c[E]=new Array(W),ct=0;ct<W;++ct)(at=k[ct])&&(F[ct]=at);F.sort(e)}return new Ft(c,this._parents).order()},call:function rt(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function qt(){return Array.from(this)},node:function J(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],c=0,E=s.length;c<E;++c){var k=s[c];if(k)return k}return null},size:function tt(){let t=0;for(const e of this)++t;return t},empty:function d(){return!this.node()},each:function nt(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var W,c=e[l],E=0,k=c.length;E<k;++E)(W=c[E])&&t.call(W,W.__data__,E,c);return this},attr:function v(t,e){var l=Dt(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?Jt:Vt:"function"==typeof e?l.local?Y:te:l.local?vt:Tt)(l,e))},style:function Q(t,e,l){return arguments.length>1?this.each((null==e?ft:"function"==typeof e?q:ut)(t,e,null==l?"":l)):V(this.node(),t)},property:function Ct(t,e){return arguments.length>1?this.each((null==e?x:"function"==typeof e?pt:U)(t,e)):this.node()[t]},classed:function se(t,e){var l=mt(t+"");if(arguments.length<2){for(var s=Pt(this.node()),c=-1,E=l.length;++c<E;)if(!s.contains(l[c]))return!1;return!0}return this.each(("function"==typeof e?pe:e?ne:re)(l,e))},text:function He(t){return arguments.length?this.each(null==t?de:("function"==typeof t?Qe:xe)(t)):this.node().textContent},html:function ei(t){return arguments.length?this.each(null==t?Pe:("function"==typeof t?Ze:Je)(t)):this.node().innerHTML},raise:function Xe(){return this.each(Ee)},lower:function Ue(){return this.each(De)},append:function Ve(t){var e="function"==typeof t?t:Ge(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function bt(t,e){var l="function"==typeof t?t:Ge(t),s=null==e?ii:"function"==typeof e?e:O(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function i(){return this.each(D)},clone:function o(t){return this.select(t?r:n)},datum:function a(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function w(t,e,l){var c,k,s=function g(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),E=s.length;if(!(arguments.length<2)){for(W=e?C:m,c=0;c<E;++c)this.each(W(s[c],e,l));return this}var W=this.node().__on;if(W)for(var ct,F=0,at=W.length;F<at;++F)for(c=0,ct=W[F];c<E;++c)if((k=s[c]).type===ct.type&&k.name===ct.name)return ct.value},dispatch:function ht(t,e){return this.each(("function"==typeof e?dt:N)(t,e))},[Symbol.iterator]:function*xt(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var k,s=t[e],c=0,E=s.length;c<E;++c)(k=s[c])&&(yield k)}};const ye=ge;var me={value:()=>{}};function Se(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new Ni(l)}function Ni(t){this._=t}function ar(t,e){for(var c,l=0,s=t.length;l<s;++l)if((c=t[l]).name===e)return c.value}function gn(t,e,l){for(var s=0,c=t.length;s<c;++s)if(t[s].name===e){t[s]=me,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}Ni.prototype=Se.prototype={constructor:Ni,on:function(t,e){var c,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",c=l.indexOf(".");if(c>=0&&(s=l.slice(c+1),l=l.slice(0,c)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),E=-1,k=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++E<k;)if(c=(t=s[E]).type)l[c]=gn(l[c],t.name,e);else if(null==e)for(c in l)l[c]=gn(l[c],t.name,null);return this}for(;++E<k;)if((c=(t=s[E]).type)&&(c=ar(l[c],t.name)))return c},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Ni(t)},call:function(t,e){if((c=arguments.length-2)>0)for(var c,E,l=new Array(c),s=0;s<c;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,c=(E=this._[t]).length;s<c;++s)E[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],c=0,E=s.length;c<E;++c)s[c].value.apply(e,l)}};const or=Se;var Li,Si,yi=0,Ei=0,Oi=0,yn=1e3,Di=0,hi=0,ji=0,ki="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Yi(){return hi||(pn(sr),hi=ki.now()+ji)}function sr(){hi=0}function Bi(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new Bi;return s.restart(t,e,l),s}function _n(){hi=(Di=ki.now())+ji,yi=Ei=0;try{!function dr(){Yi(),++yi;for(var e,t=Li;t;)(e=hi-t._time)>=0&&t._call.call(void 0,e),t=t._next;--yi}()}finally{yi=0,function hr(){for(var t,l,e=Li,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Li=l);Si=t,qi(s)}(),hi=0}}function ur(){var t=ki.now(),e=t-Di;e>yn&&(ji-=e,Di=t)}function qi(t){yi||(Ei&&(Ei=clearTimeout(Ei)),t-hi>24?(t<1/0&&(Ei=setTimeout(_n,t-ki.now()-ji)),Oi&&(Oi=clearInterval(Oi))):(Oi||(Di=ki.now(),Oi=setInterval(ur,yn)),yi=1,pn(_n)))}function wn(t,e,l){var s=new Bi;return s.restart(c=>{s.stop(),t(c+e)},e=null==e?0:+e,l),s}Bi.prototype=mn.prototype={constructor:Bi,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Yi():+l)+(null==e?0:+e),!this._next&&Si!==this&&(Si?Si._next=this:Li=this,Si=this),this._call=t,this._time=l,qi()},stop:function(){this._call&&(this._call=null,this._time=1/0,qi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,Ki=3;function Ui(t,e,l,s,c,E){var k=t.__transition;if(k){if(l in k)return}else t.__transition={};!function vr(t,e,l){var c,s=t.__transition;function k(at){var ct,Kt,Ut,Xt;if(1!==l.state)return F();for(ct in s)if((Xt=s[ct]).name===l.name){if(Xt.state===Ki)return wn(k);4===Xt.state?(Xt.state=6,Xt.timer.stop(),Xt.on.call("interrupt",t,t.__data__,Xt.index,Xt.group),delete s[ct]):+ct<e&&(Xt.state=6,Xt.timer.stop(),Xt.on.call("cancel",t,t.__data__,Xt.index,Xt.group),delete s[ct])}if(wn(function(){l.state===Ki&&(l.state=4,l.timer.restart(W,l.delay,l.time),W(at))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=Ki,c=new Array(Ut=l.tween.length),ct=0,Kt=-1;ct<Ut;++ct)(Xt=l.tween[ct].value.call(t,t.__data__,l.index,l.group))&&(c[++Kt]=Xt);c.length=Kt+1}}function W(at){for(var ct=at<l.duration?l.ease.call(null,at/l.duration):(l.timer.restart(F),l.state=5,1),Kt=-1,Ut=c.length;++Kt<Ut;)c[Kt].call(t,ct);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),F())}function F(){for(var at in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function E(at){l.state=1,l.timer.restart(k,l.delay,l.time),l.delay<=at&&k(at-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:c,on:cr,tween:fr,time:E.time,delay:E.delay,duration:E.duration,ease:E.ease,timer:null,state:bn})}function en(t,e){var l=$e(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function ni(t,e){var l=$e(t,e);if(l.state>Ki)throw new Error("too late; already running");return l}function $e(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function di(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Gi,On=180/Math.PI,nn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,c,E){var k,W,F;return(k=Math.sqrt(t*t+e*e))&&(t/=k,e/=k),(F=t*l+e*s)&&(l-=t*F,s-=e*F),(W=Math.sqrt(l*l+s*s))&&(l/=W,s/=W,F/=W),t*s<e*l&&(t=-t,e=-e,F=-F,k=-k),{translateX:c,translateY:E,rotate:Math.atan2(e,t)*On,skewX:Math.atan(F)*On,scaleX:k,scaleY:W}}function kn(t,e,l,s){function c(at){return at.length?at.pop()+" ":""}return function(at,ct){var Kt=[],Ut=[];return at=t(at),ct=t(ct),function E(at,ct,Kt,Ut,Xt,_e){if(at!==Kt||ct!==Ut){var Oe=Xt.push("translate(",null,e,null,l);_e.push({i:Oe-4,x:di(at,Kt)},{i:Oe-2,x:di(ct,Ut)})}else(Kt||Ut)&&Xt.push("translate("+Kt+e+Ut+l)}(at.translateX,at.translateY,ct.translateX,ct.translateY,Kt,Ut),function k(at,ct,Kt,Ut){at!==ct?(at-ct>180?ct+=360:ct-at>180&&(at+=360),Ut.push({i:Kt.push(c(Kt)+"rotate(",null,s)-2,x:di(at,ct)})):ct&&Kt.push(c(Kt)+"rotate("+ct+s)}(at.rotate,ct.rotate,Kt,Ut),function W(at,ct,Kt,Ut){at!==ct?Ut.push({i:Kt.push(c(Kt)+"skewX(",null,s)-2,x:di(at,ct)}):ct&&Kt.push(c(Kt)+"skewX("+ct+s)}(at.skewX,ct.skewX,Kt,Ut),function F(at,ct,Kt,Ut,Xt,_e){if(at!==Kt||ct!==Ut){var Oe=Xt.push(c(Xt)+"scale(",null,",",null,")");_e.push({i:Oe-4,x:di(at,Kt)},{i:Oe-2,x:di(ct,Ut)})}else(1!==Kt||1!==Ut)&&Xt.push(c(Xt)+"scale("+Kt+","+Ut+")")}(at.scaleX,at.scaleY,ct.scaleX,ct.scaleY,Kt,Ut),at=ct=null,function(Xt){for(var jt,_e=-1,Oe=Ut.length;++_e<Oe;)Kt[(jt=Ut[_e]).i]=jt.x(Xt);return Kt.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?nn:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Gi||(Gi=document.createElementNS("http://www.w3.org/2000/svg","g")),Gi.setAttribute("transform",t),t=Gi.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):nn},", ",")",")");function br(t,e){var l,s;return function(){var c=ni(this,t),E=c.tween;if(E!==l)for(var k=0,W=(s=l=E).length;k<W;++k)if(s[k].name===e){(s=s.slice()).splice(k,1);break}c.tween=s}}function xr(t,e,l){var s,c;if("function"!=typeof l)throw new Error;return function(){var E=ni(this,t),k=E.tween;if(k!==s){c=(s=k).slice();for(var W={name:e,value:l},F=0,at=c.length;F<at;++F)if(c[F].name===e){c[F]=W;break}F===at&&c.push(W)}E.tween=c}}function rn(t,e,l){var s=t._id;return t.each(function(){var c=ni(this,s);(c.value||(c.value={}))[e]=l.apply(this,arguments)}),function(c){return $e(c,s).value[e]}}function ln(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Tn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function Ti(){}var Wi=1/.7,pi="\\s*([+-]?\\d+)\\s*",Ai="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ri="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),kr=new RegExp(`^rgb\\(${ri},${ri},${ri}\\)$`),Tr=new RegExp(`^rgba\\(${pi},${pi},${pi},${Ai}\\)$`),Cr=new RegExp(`^rgba\\(${ri},${ri},${ri},${Ai}\\)$`),Ar=new RegExp(`^hsl\\(${Ai},${ri},${ri}\\)$`),Mr=new RegExp(`^hsla\\(${Ai},${ri},${ri},${Ai}\\)$`),Cn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function An(){return this.rgb().formatHex()}function Mn(){return this.rgb().formatRgb()}function Mi(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new Be(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Fi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Fi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new Be(e[1],e[2],e[3],1):(e=kr.exec(t))?new Be(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Tr.exec(t))?Fi(e[1],e[2],e[3],e[4]):(e=Cr.exec(t))?Fi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ar.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=Mr.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):Cn.hasOwnProperty(t)?In(Cn[t]):"transparent"===t?new Be(NaN,NaN,NaN,0):null}function In(t){return new Be(t>>16&255,t>>8&255,255&t,1)}function Fi(t,e,l,s){return s<=0&&(t=e=l=NaN),new Be(t,e,l,s)}function Qi(t,e,l,s){return 1===arguments.length?function Rr(t){return t instanceof Ti||(t=Mi(t)),t?new Be((t=t.rgb()).r,t.g,t.b,t.opacity):new Be}(t):new Be(t,e,l,null==s?1:s)}function Be(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Pn(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}`}function Rn(){const t=Hi(this.opacity);return`${1===t?"rgb(":"rgba("}${ci(this.r)}, ${ci(this.g)}, ${ci(this.b)}${1===t?")":`, ${t})`}`}function Hi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ci(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fi(t){return((t=ci(t))<16?"0":"")+t.toString(16)}function Nn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new ti(t,e,l,s)}function Ln(t){if(t instanceof ti)return new ti(t.h,t.s,t.l,t.opacity);if(t instanceof Ti||(t=Mi(t)),!t)return new ti;if(t instanceof ti)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,c=Math.min(e,l,s),E=Math.max(e,l,s),k=NaN,W=E-c,F=(E+c)/2;return W?(k=e===E?(l-s)/W+6*(l<s):l===E?(s-e)/W+2:(e-l)/W+4,W/=F<.5?E+c:2-E-c,k*=60):W=F>0&&F<1?0:k,new ti(k,W,F,t.opacity)}function ti(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Vi(t){return Math.max(0,Math.min(1,t||0))}function an(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,c){var E=t*t,k=E*t;return((1-3*t+3*E-k)*e+(4-6*E+3*k)*l+(1+3*t+3*E-3*k)*s+k*c)/6}ln(Ti,Mi,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:An,formatHex:An,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Pr(){return Ln(this).formatHsl()},formatRgb:Mn,toString:Mn}),ln(Be,Qi,Tn(Ti,{brighter(t){return t=null==t?Wi:Math.pow(Wi,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Be(ci(this.r),ci(this.g),ci(this.b),Hi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function Nr(){return`#${fi(this.r)}${fi(this.g)}${fi(this.b)}${fi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rn,toString:Rn})),ln(ti,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new ti(t,e,l,null==s?1:s)},Tn(Ti,{brighter(t){return t=null==t?Wi:Math.pow(Wi,t),new ti(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ti(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,c=2*l-s;return new Be(an(t>=240?t-240:t+120,c,s),an(t,c,s),an(t<120?t+240:t-120,c,s),this.opacity)},clamp(){return new ti(Dn(this.h),Vi(this.s),Vi(this.l),Hi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Hi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Vi(this.s)}%, ${100*Vi(this.l)}%${1===t?")":`, ${t})`}`}}));const Bn=t=>()=>t;function zn(t,e){var l=e-t;return l?function Kn(t,e){return function(l){return t+l*e}}(t,l):Bn(isNaN(t)?e:t)}const Un=function t(e){var l=function Kr(t){return 1==(t=+t)?zn:function(e,l){return l-e?function Br(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):Bn(isNaN(e)?l:e)}}(e);function s(c,E){var k=l((c=Qi(c)).r,(E=Qi(E)).r),W=l(c.g,E.g),F=l(c.b,E.b),at=zn(c.opacity,E.opacity);return function(ct){return c.r=k(ct),c.g=W(ct),c.b=F(ct),c.opacity=at(ct),c+""}}return s.gamma=t,s}(1);function Gn(t){return function(e){var k,W,l=e.length,s=new Array(l),c=new Array(l),E=new Array(l);for(k=0;k<l;++k)W=Qi(e[k]),s[k]=W.r||0,c[k]=W.g||0,E[k]=W.b||0;return s=t(s),c=t(c),E=t(E),W.opacity=1,function(F){return W.r=s(F),W.g=c(F),W.b=E(F),W+""}}}Gn(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),c=t[s],E=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*c-E,c,E,s<e-1?t[s+2]:2*E-c)}}),Gn(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var on=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sn=new RegExp(on.source,"g");function Gr(t,e){var s,c,E,l=on.lastIndex=sn.lastIndex=0,k=-1,W=[],F=[];for(t+="",e+="";(s=on.exec(t))&&(c=sn.exec(e));)(E=c.index)>l&&(E=e.slice(l,E),W[k]?W[k]+=E:W[++k]=E),(s=s[0])===(c=c[0])?W[k]?W[k]+=c:W[++k]=c:(W[++k]=null,F.push({i:k,x:di(s,c)})),l=sn.lastIndex;return l<e.length&&(E=e.slice(l),W[k]?W[k]+=E:W[++k]=E),W.length<2?F[0]?function Ur(t){return function(e){return t(e)+""}}(F[0].x):function zr(t){return function(){return t}}(e):(e=F.length,function(at){for(var Kt,ct=0;ct<e;++ct)W[(Kt=F[ct]).i]=Kt.x(at);return W.join("")})}function Wn(t,e){var l;return("number"==typeof e?di:e instanceof Mi?Un:(l=Mi(e))?(e=l,Un):Gr)(t,e)}function Wr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,E,c=l+"";return function(){var k=this.getAttribute(t);return k===c?null:k===s?E:E=e(s=k,l)}}function Hr(t,e,l){var s,E,c=l+"";return function(){var k=this.getAttributeNS(t.space,t.local);return k===c?null:k===s?E:E=e(s=k,l)}}function Vr(t,e,l){var s,c,E;return function(){var k,F,W=l(this);return null==W?void this.removeAttribute(t):(k=this.getAttribute(t))===(F=W+"")?null:k===s&&F===c?E:(c=F,E=e(s=k,W))}}function Jr(t,e,l){var s,c,E;return function(){var k,F,W=l(this);return null==W?void this.removeAttributeNS(t.space,t.local):(k=this.getAttributeNS(t.space,t.local))===(F=W+"")?null:k===s&&F===c?E:(c=F,E=e(s=k,W))}}function qr(t,e){var l,s;function c(){var E=e.apply(this,arguments);return E!==s&&(l=(s=E)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,E)),l}return c._value=e,c}function $r(t,e){var l,s;function c(){var E=e.apply(this,arguments);return E!==s&&(l=(s=E)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,E)),l}return c._value=e,c}function el(t,e){return function(){en(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){en(this,t).delay=e}}function rl(t,e){return function(){ni(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){ni(this,t).duration=e}}var wl=ye.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var Bl=0;function ai(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++Bl}var oi=ye.prototype;ai.prototype=function Kl(t){return ye().transition(t)}.prototype={constructor:ai,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=O(t));for(var s=this._groups,c=s.length,E=new Array(c),k=0;k<c;++k)for(var ct,Kt,W=s[k],F=W.length,at=E[k]=new Array(F),Ut=0;Ut<F;++Ut)(ct=W[Ut])&&(Kt=t.call(ct,ct.__data__,Ut,W))&&("__data__"in ct&&(Kt.__data__=ct.__data__),at[Ut]=Kt,Ui(at[Ut],e,l,Ut,at,$e(ct,l)));return new ai(E,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=b(t));for(var s=this._groups,c=s.length,E=[],k=[],W=0;W<c;++W)for(var ct,F=s[W],at=F.length,Kt=0;Kt<at;++Kt)if(ct=F[Kt]){for(var Xt,Ut=t.call(ct,ct.__data__,Kt,F),_e=$e(ct,l),Oe=0,jt=Ut.length;Oe<jt;++Oe)(Xt=Ut[Oe])&&Ui(Xt,e,l,Oe,Ut,_e);E.push(Ut),k.push(ct)}return new ai(E,k,e,l)},selectChild:oi.selectChild,selectChildren:oi.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=P(t));for(var e=this._groups,l=e.length,s=new Array(l),c=0;c<l;++c)for(var F,E=e[c],k=E.length,W=s[c]=[],at=0;at<k;++at)(F=E[at])&&t.call(F,F.__data__,at,E)&&W.push(F);return new ai(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,E=Math.min(s,l.length),k=new Array(s),W=0;W<E;++W)for(var Ut,F=e[W],at=l[W],ct=F.length,Kt=k[W]=new Array(ct),Xt=0;Xt<ct;++Xt)(Ut=F[Xt]||at[Xt])&&(Kt[Xt]=Ut);for(;W<s;++W)k[W]=e[W];return new ai(k,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,c=s.length,E=0;E<c;++E)for(var F,k=s[E],W=k.length,at=0;at<W;++at)if(F=k[at]){var ct=$e(F,e);Ui(F,t,l,at,k,{time:ct.time+ct.delay+ct.duration,delay:0,duration:ct.duration,ease:ct.ease})}return new ai(s,this._parents,t,l)},call:oi.call,nodes:oi.nodes,node:oi.node,size:oi.size,empty:oi.empty,each:oi.each,on:function gl(t,e){var l=this._id;return arguments.length<2?$e(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,c,E=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?en:ni;return function(){var k=E(this,t),W=k.on;W!==s&&(c=(s=W).copy()).on(e,l),k.on=c}}(l,t,e))},attr:function Zr(t,e){var l=Dt(t),s="transform"===l?wr:Wn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,rn(this,"attr."+t,e)):null==e?(l.local?Fr:Wr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=Dt(t);return this.tween(l,(s.local?qr:$r)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Wn;return null==e?this.styleTween(t,function xl(t,e){var l,s,c;return function(){var E=V(this,t),k=(this.style.removeProperty(t),V(this,t));return E===k?null:E===l&&k===s?c:c=e(l=E,s=k)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,c,E;return function(){var k=V(this,t),W=l(this),F=W+"";return null==W&&(this.style.removeProperty(t),F=W=V(this,t)),k===F?null:k===s&&F===c?E:(c=F,E=e(s=k,W))}}(t,s,rn(this,"style."+t,e))).each(function Sl(t,e){var l,s,c,W,E="style."+e,k="end."+E;return function(){var F=ni(this,t),at=F.on,ct=null==F.value[E]?W||(W=Fn(e)):void 0;(at!==l||c!==ct)&&(s=(l=at).copy()).on(k,c=ct),F.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,E,c=l+"";return function(){var k=V(this,t);return k===c?null:k===s?E:E=e(s=k,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Al(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Cl(t,e,l){var s,c;function E(){var k=e.apply(this,arguments);return k!==c&&(s=(c=k)&&function Tl(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,k,l)),s}return E._value=e,E}(t,e,null==l?"":l))},text:function Pl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(rn(this,"text",t)):function Ml(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Nl(t){var e,l;function s(){var c=t.apply(this,arguments);return c!==l&&(e=(l=c)&&function Rl(t){return function(e){this.textContent=t.call(this,e)}}(c)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var k,s=$e(this.node(),l).tween,c=0,E=s.length;c<E;++c)if((k=s[c]).name===t)return k.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):$e(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):$e(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){ni(this,t).ease=e}}(e,t)):$e(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;ni(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,c=l.size();return new Promise(function(E,k){var W={value:k},F={value:function(){0==--c&&E()}};l.each(function(){var at=ni(this,s),ct=at.on;ct!==t&&((e=(t=ct).copy())._.cancel.push(W),e._.interrupt.push(W),e._.end.push(F)),at.on=e}),0===c&&E()})},[Symbol.iterator]:oi[Symbol.iterator]};var Ul={time:null,delay:0,duration:250,ease:function zl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Gl(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}ye.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,c,k,l=t.__transition,E=!0;if(l){for(k in e=null==e?null:e+"",l)(s=l[k]).name===e?(c=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(c?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[k]):E=!1;E&&delete t.__transition}}(this,t)})},ye.prototype.transition=function Wl(t){var e,l;t instanceof ai?(e=t._id,t=t._name):(e=Qn(),(l=Ul).time=Yi(),t=null==t?null:t+"");for(var s=this._groups,c=s.length,E=0;E<c;++E)for(var F,k=s[E],W=k.length,at=0;at<W;++at)(F=k[at])&&Ui(F,t,e,at,k,l||Gl(F,e));return new ai(s,this._parents,t,e)};Math;function Ii(t){return{type:t}}function wi(t){return function(){return t}}function Yn(t){this._context=t}function ql(t){return new Yn(t)}["w","e"].map(Ii),["n","s"].map(Ii),["n","w","e","s","nw","ne","sw","se"].map(Ii),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const fn=Math.PI,vn=2*fn,vi=1e-6,$l=vn-vi;function qn(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Xi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?qn:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return qn;const l=10**e;return function(s){this._+=s[0];for(let c=1,E=s.length;c<E;++c)this._+=Math.round(arguments[c]*l)/l+s[c]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,c){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+c}`}bezierCurveTo(e,l,s,c,E,k){this._append`C${+e},${+l},${+s},${+c},${this._x1=+E},${this._y1=+k}`}arcTo(e,l,s,c,E){if(e=+e,l=+l,s=+s,c=+c,(E=+E)<0)throw new Error(`negative radius: ${E}`);let k=this._x1,W=this._y1,F=s-e,at=c-l,ct=k-e,Kt=W-l,Ut=ct*ct+Kt*Kt;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Ut>vi)if(Math.abs(Kt*F-at*ct)>vi&&E){let Xt=s-k,_e=c-W,Oe=F*F+at*at,jt=Xt*Xt+_e*_e,Rt=Math.sqrt(Oe),ie=Math.sqrt(Ut),Yt=E*Math.tan((fn-Math.acos((Oe+Ut-jt)/(2*Rt*ie)))/2),ue=Yt/ie,fe=Yt/Rt;Math.abs(ue-1)>vi&&this._append`L${e+ue*ct},${l+ue*Kt}`,this._append`A${E},${E},0,0,${+(Kt*Xt>ct*_e)},${this._x1=e+fe*F},${this._y1=l+fe*at}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,c,E,k){if(e=+e,l=+l,k=!!k,(s=+s)<0)throw new Error(`negative radius: ${s}`);let W=s*Math.cos(c),F=s*Math.sin(c),at=e+W,ct=l+F,Kt=1^k,Ut=k?c-E:E-c;null===this._x1?this._append`M${at},${ct}`:(Math.abs(this._x1-at)>vi||Math.abs(this._y1-ct)>vi)&&this._append`L${at},${ct}`,s&&(Ut<0&&(Ut=Ut%vn+vn),Ut>$l?this._append`A${s},${s},0,1,${Kt},${e-W},${l-F}A${s},${s},0,1,${Kt},${this._x1=at},${this._y1=ct}`:Ut>vi&&this._append`A${s},${s},0,${+(Ut>=fn)},${Kt},${this._x1=e+s*Math.cos(E)},${this._y1=l+s*Math.sin(E)}`)}rect(e,l,s,c){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+c}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=wi(!0),s=null,c=ql,E=null,k=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Xi(e)}(W);function W(F){var at,Kt,Xt,ct=(F=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(F)).length,Ut=!1;for(null==s&&(E=c(Xt=k())),at=0;at<=ct;++at)!(at<ct&&l(Kt=F[at],at,F))===Ut&&((Ut=!Ut)?E.lineStart():E.lineEnd()),Ut&&E.point(+t(Kt,at,F),+e(Kt,at,F));if(Xt)return E=null,Xt+""||null}return t="function"==typeof t?t:void 0===t?na:wi(t),e="function"==typeof e?e:void 0===e?ra:wi(e),W.x=function(F){return arguments.length?(t="function"==typeof F?F:wi(+F),W):t},W.y=function(F){return arguments.length?(e="function"==typeof F?F:wi(+F),W):e},W.defined=function(F){return arguments.length?(l="function"==typeof F?F:wi(!!F),W):l},W.curve=function(F){return arguments.length?(c=F,null!=s&&(E=c(s)),W):c},W.context=function(F){return arguments.length?(null==F?s=E=null:E=c(s=F),W):s},W}function $n(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function bi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$n(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$n(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},bi.prototype={constructor:bi,scale:function(t){return 1===t?this:new bi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new bi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new bi(1,0,0)}}]);