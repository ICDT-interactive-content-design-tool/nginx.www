"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4981],{1814:(ae,Dt,y)=>{y.d(Dt,{In:()=>st,MA:()=>h,Mo:()=>U,NV:()=>k,S3:()=>C,dt:()=>yt,h8:()=>b,k0:()=>R});const C={fill:"transparent",stroke:"#129bff",strokeWidth:1},k={stroke:"#5F6CE1",strokeWidth:1,strokeLinecap:"round",strokeDasharrays:[4,2,1,2]},st={fill:"#FFFFFF",stroke:"#5F6CE1",strokeWidth:1,width:7,height:7},U={fill:"transparent",stroke:"transparent",strokeWidth:1},yt={fill:"none",stroke:"#5F6CE1",strokeWidth:1},b={stroke:"#129bff",strokeWidth:1,strokeLinecap:"round",strokeDasharray:8},h={fill:"transparent"},R={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2}},7851:(ae,Dt,y)=>{y.d(Dt,{BG:()=>b,IX:()=>yt,Q8:()=>f,RZ:()=>R,SS:()=>h,T1:()=>T,Ug:()=>P,n2:()=>k,yo:()=>U});var C=y(5811);const k=w=>{var I;return null===(I=w.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===I?void 0:I.map(u=>{let K={type:u.substring(0,1)},N=(tt=u.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?tt.split(/\s/).map(et=>(0,C.q)(parseFloat(et),1e6)):[];var tt;return N.length&&(K.points=N),K})},U=w=>{let I=[],u=[],K=[],N=[];return w.forEach(tt=>{switch(["M","L","C","S","Q","T"].includes(tt.type)&&tt.points&&tt.points.forEach((_t,it)=>{it%2==0?I.push(_t):u.push(_t)}),tt.type){case"A":var et;7==(null===(et=tt.points)||void 0===et?void 0:et.length)&&(K.push(tt.points[5]),N.push(tt.points[6]));break;case"H":var at;null!==(at=tt.points)&&void 0!==at&&at.length&&(I.push(tt.points[0]),K.push(tt.points[0]));break;case"V":var L;null!==(L=tt.points)&&void 0!==L&&L.length&&(u.push(tt.points[0]),N.push(tt.points[0]));break;case"a":var Ot;if(7==(null===(Ot=tt.points)||void 0===Ot?void 0:Ot.length)){let _t=I[I.length-1];I.push(_t+tt.points[5]),K.push(_t+tt.points[5]);let it=u[u.length-1];u.push(it+tt.points[6]),N.push(it+tt.points[6])}break;case"h":var At;if(null!==(At=tt.points)&&void 0!==At&&At.length){let _t=I[I.length-1];I.push(_t+tt.points[0]),K.push(_t+tt.points[0])}break;case"v":var Kt;if(null!==(Kt=tt.points)&&void 0!==Kt&&Kt.length){let _t=u[u.length-1];u.push(_t+tt.points[0]),N.push(_t+tt.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":var Ct;null===(Ct=tt.points)||void 0===Ct||Ct.forEach((_t,it)=>{it%2==0?K.push(_t):N.push(_t)});break;case"m":case"l":case"c":case"s":case"q":case"t":var Mt;null===(Mt=tt.points)||void 0===Mt||Mt.forEach((_t,it)=>{if(it%2==0){let B=I[I.length-1];I.push(B+_t),K.push(B+_t)}else{let B=u[u.length-1];u.push(B+_t),N.push(B+_t)}})}}),{minX:Math.min.apply(null,K),minY:Math.min.apply(null,N),maxX:Math.max.apply(null,K),maxY:Math.max.apply(null,N)}},yt=(w,I)=>I.map(u=>{let K=[];switch(u.type){case"a":var N;7==(null===(N=u.points)||void 0===N?void 0:N.length)&&K.push([(0,C.q)(u.points[0]/w.width,1e6),(0,C.q)(u.points[1]/w.height,1e6),u.points[2],u.points[3],u.points[4],(0,C.q)(u.points[5]/w.width,1e6),(0,C.q)(u.points[6]/w.height,1e6)]);break;case"A":var tt;7==(null===(tt=u.points)||void 0===tt?void 0:tt.length)&&K.push([(0,C.q)(u.points[0]/w.width,1e6),(0,C.q)(u.points[1]/w.height,1e6),u.points[2],u.points[3],u.points[4],(0,C.q)((u.points[5]-w.x)/w.width,1e6),(0,C.q)((u.points[6]-w.y)/w.height,1e6)]);break;case"h":var et;null!==(et=u.points)&&void 0!==et&&et.length&&K.push([(0,C.q)(u.points[0]/w.width,1e6)]);break;case"H":var at;null!==(at=u.points)&&void 0!==at&&at.length&&K.push([(0,C.q)((u.points[0]-w.x)/w.width,1e6)]);break;case"v":var L;null!==(L=u.points)&&void 0!==L&&L.length&&K.push([(0,C.q)(u.points[0]/w.height,1e6)]);break;case"V":var Ot;null!==(Ot=u.points)&&void 0!==Ot&&Ot.length&&K.push([(0,C.q)((u.points[0]-w.y)/w.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":var At;if(null!==(At=u.points)&&void 0!==At&&At.length)for(let Ct=0,Mt=u.points.length-1;Ct<Mt;Ct+=2)K.push([(0,C.q)((u.points[Ct]-w.x)/w.width,1e6),(0,C.q)((u.points[Ct+1]-w.y)/w.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":var Kt;if(null!==(Kt=u.points)&&void 0!==Kt&&Kt.length)for(let Ct=0,Mt=u.points.length-1;Ct<Mt;Ct+=2)K.push([(0,C.q)(u.points[Ct]/w.width,1e6),(0,C.q)(u.points[Ct+1]/w.height,1e6)])}return K.length?{type:u.type,ratios:K}:{type:u.type}}),b=(w,I)=>I.map(u=>{switch(u.type){case"a":var K,N;return`${u.type}${null!==(K=null===(N=u.ratios)||void 0===N||null===(N=N.map(Et=>{var rt,$t,V,Z,d,lt,wt;return[(0,C.q)(w.width*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6),(0,C.q)(w.height*(null!==($t=Et[1])&&void 0!==$t?$t:0),1e6),null!==(V=Et[2])&&void 0!==V?V:0,null!==(Z=Et[3])&&void 0!==Z?Z:0,null!==(d=Et[4])&&void 0!==d?d:0,(0,C.q)(w.width*(null!==(lt=Et[5])&&void 0!==lt?lt:0),1e6),(0,C.q)(w.height*(null!==(wt=Et[6])&&void 0!==wt?wt:0),1e6)]}))||void 0===N||null===(N=N.map(Et=>Et.join(" ")))||void 0===N?void 0:N.join(" "))&&void 0!==K?K:""}`;case"A":var tt,et;return`${u.type}${null!==(tt=null===(et=u.ratios)||void 0===et||null===(et=et.map(Et=>{var rt,$t,V,Z,d,lt,wt;return[(0,C.q)(w.width*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6),(0,C.q)(w.height*(null!==($t=Et[1])&&void 0!==$t?$t:0),1e6),null!==(V=Et[2])&&void 0!==V?V:0,null!==(Z=Et[3])&&void 0!==Z?Z:0,null!==(d=Et[4])&&void 0!==d?d:0,(0,C.q)(w.x+w.width*(null!==(lt=Et[5])&&void 0!==lt?lt:0),1e6),(0,C.q)(w.y+w.height*(null!==(wt=Et[6])&&void 0!==wt?wt:0),1e6)]}))||void 0===et||null===(et=et.map(Et=>Et.join(" ")))||void 0===et?void 0:et.join(" "))&&void 0!==tt?tt:""}`;case"h":var at,L;return`${u.type}${null!==(at=null===(L=u.ratios)||void 0===L||null===(L=L.map(Et=>{var rt;return(0,C.q)(w.width*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6)}))||void 0===L?void 0:L.join(" "))&&void 0!==at?at:""}`;case"H":var Ot,At;return`${u.type}${null!==(Ot=null===(At=u.ratios)||void 0===At||null===(At=At.map(Et=>{var rt;return(0,C.q)(w.x+w.width*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6)}))||void 0===At?void 0:At.join(" "))&&void 0!==Ot?Ot:""}`;case"v":var Kt,Ct;return`${u.type}${null!==(Kt=null===(Ct=u.ratios)||void 0===Ct||null===(Ct=Ct.map(Et=>{var rt;return(0,C.q)(w.height*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6)}))||void 0===Ct?void 0:Ct.join(" "))&&void 0!==Kt?Kt:""}`;case"V":var Mt,_t;return`${u.type}${null!==(Mt=null===(_t=u.ratios)||void 0===_t||null===(_t=_t.map(Et=>{var rt;return(0,C.q)(w.y+w.height*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6)}))||void 0===_t?void 0:_t.join(" "))&&void 0!==Mt?Mt:""}`;case"z":case"Z":return u.type;case"M":case"L":case"C":case"S":case"Q":case"T":var it,B;return`${u.type}${null!==(it=null===(B=u.ratios)||void 0===B||null===(B=B.map(Et=>{var rt,$t;return[(0,C.q)(w.x+w.width*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6),(0,C.q)(w.y+w.height*(null!==($t=Et[1])&&void 0!==$t?$t:0),1e6)]}))||void 0===B||null===(B=B.map(Et=>Et.join(" ")))||void 0===B?void 0:B.join(" "))&&void 0!==it?it:""}`;case"m":case"l":case"c":case"s":case"q":case"t":var pt,St;return`${u.type}${null!==(pt=null===(St=u.ratios)||void 0===St||null===(St=St.map(Et=>{var rt,$t;return[(0,C.q)(w.width*(null!==(rt=Et[0])&&void 0!==rt?rt:0),1e6),(0,C.q)(w.height*(null!==($t=Et[1])&&void 0!==$t?$t:0),1e6)]}))||void 0===St||null===(St=St.map(Et=>Et.join(" ")))||void 0===St?void 0:St.join(" "))&&void 0!==pt?pt:""}`;default:return""}}).join(""),h=w=>{return(I=w.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?I.split(/\s/).map(u=>parseFloat(u)):[];var I},R=w=>{let I=[],u=[];return w.forEach((K,N)=>{N%2==0?I.push(K):u.push(K)}),{minX:Math.min.apply(null,I),minY:Math.min.apply(null,u),maxX:Math.max.apply(null,I),maxY:Math.max.apply(null,u)}},P=(w,I)=>{let u=[];for(let K=0,N=I.length-1;K<N;K+=2)u.push([(I[K]-w.x)/w.width,(I[K+1]-w.y)/w.height]);return u},f=(w,I)=>I.map(u=>[(0,C.q)(w.x+w.width*u[0],1e6),(0,C.q)(w.y+w.height*u[1],1e6)]).map(u=>u.join(" ")).join(" "),T=(w,I)=>{let u=(w=>{let I=w.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map(u=>(0,C.q)(parseFloat(u),1e6));if(6==I.length)return{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}})(I);return u?window.Snap.path.map(w,new window.Snap.Matrix(u.a,u.b,u.c,u.d,u.e,u.f)).toString():w}},9942:(ae,Dt,y)=>{y.d(Dt,{w:()=>A,I:()=>M});var C=y(4981),k=y(9054),st=y(5811),U=/^#[a-fA-F0-9]+$/i,yt=/^rgba\((\d+),(\d+),(\d+),(\d+)\)$/i,b=/^rgb\((\d+),(\d+),(\d+)\)$/i;const h=J=>{let w=null,I=null;if(J)if("transparent"==J)w="#000000",I=0;else if(J.match(U))w=J;else{let u=(J=J.replace(/\s+/g,"")).match(yt);if(u)w="#"+(256|u[1]).toString(16).slice(1)+(256|u[2]).toString(16).slice(1)+(256|u[3]).toString(16).slice(1),I=(0,st.q)(parseFloat(u[4]),100);else{let K=J.match(b);K&&(w="#"+(256|K[1]).toString(16).slice(1)+(256|K[2]).toString(16).slice(1)+(256|K[3]).toString(16).slice(1))}}return{hex:w,alpha:I}},M=J=>T(null==J?void 0:J.url,null==J?void 0:J.path,null==J?void 0:J.src);var T=(J,w,I)=>{var u,K;let N,tt,et,at;var L,Ot;return J&&(N=J.replace(/\\/g,"/")),w&&(tt=w.replace(/\\/g,"/")),I&&(et=I.replace(/\\/g,"/")),tt&&!N&&(N=(null===(L=C.icdt.config)||void 0===L?void 0:L.readfileuploadurl)+tt),!et||tt||N||(tt=et.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),N=(null===(Ot=C.icdt.config)||void 0===Ot?void 0:Ot.readfileuploadurl)+tt),at=(null!==(u=N)&&void 0!==u?u:"").split("/").pop()||(null!==(K=tt)&&void 0!==K?K:"").split("/").pop()||"",{url:N,path:tt,name:at}};const A=J=>{let w={x:0,y:0,width:J.screen.w,height:J.screen.h},I=[];return J.data.forEach((u,K)=>{var N,tt;let et={id:"number"==typeof u.id?u.id:C.icdt.data.newSlideId,code:null===(N=u.id)||void 0===N?void 0:N.toString(),name:"string"==typeof u.id?u.id:`Trang ${K+1}`,svg:{viewBox:w,nodes:[]},test:(at=u.test2,at?(at.audiotrue&&(at.audiotrue=M({path:at.audiotrue.path})),at.audiofalse&&(at.audiofalse=M({path:at.audiofalse.path})),at.effecttrue&&(at.effecttrue=M({path:at.effecttrue.path})),at.effectfalse&&(at.effectfalse=M({path:at.effectfalse.path})),at.icontrue&&(at.icontrue=M({path:at.icontrue.path})),at.iconfalse&&(at.iconfalse=M({path:at.iconfalse.path})),at):{})};var at;u.background&&et.svg&&(et.svg.background=function(J){return J&&(null!==J.match(/#([a-zA-Z0-9]+)/)||null!==J.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)||null!==J.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9]+\)/))}(u.background)?{color:u.background}:function(J){return J&&null!==J.match(/data:[^;]+;base64,/)}(u.background)?{base64:u.background}:function(J){return J&&null!==J.match(/http(s)?:\/\//)}(u.background)?T(u.background):T(void 0,u.background)),jQuery(null!==(tt=u.svg)&&void 0!==tt?tt:"").find(".svg-node").each((at,L)=>{var Ot,At;let Kt=jQuery(L).parents(".indexs"),Ct=Kt.attr("data-index"),Mt=Kt.attr("data-time"),_t=null!==(Ot=L.getAttribute("id"))&&void 0!==Ot?Ot:"0",it={id:parseInt(_t),code:`${L.nodeName}-${L.getAttribute("id")}`,name:L.nodeName,idx:Ct?parseInt(Ct):0,time:Mt?parseFloat(Mt):0,type:(()=>{switch(L.nodeName){case"polygon":return k.$.POLYGON;case"circle":return k.$.CIRCLE;case"ellipse":return k.$.ELLIPSE;case"line":return k.$.LINE;case"rect":return k.$.RECT;case"foreignObject":return k.$.FOREIGNOBJECT}return 0})(),size:(B=>{let pt=0,St=0,Et=0,rt=0,$t=null,V=null,Z=parseFloat((null===(B=L.getAttribute("transform"))||void 0===B?void 0:B.replace("rotate(","").replace(")",""))||"0")||null;switch(L.nodeName){case"polygon":{var d,lt;let wt=[],Tt=[],Lt=999999999,Qt=999999999,Ht=0,Pt=0;$t=JSON.parse(L.getAttribute("ratios")||"[]"),V=null!==(d=null===(lt=L.getAttribute("points"))||void 0===lt?void 0:lt.split(",").map(function(vt){return vt.split(" ").map(function(te){return parseFloat(te)})}))&&void 0!==d?d:[],V.forEach(function(vt){wt.push(vt[0]),Tt.push(vt[1])}),Lt=Math.min.apply(null,wt),Qt=Math.min.apply(null,Tt),Ht=Math.max.apply(null,wt),Pt=Math.max.apply(null,Tt),pt=Lt,St=Qt,Et=Ht-pt,rt=Pt-St;break}case"circle":{let wt=parseFloat(L.getAttribute("cx")||"0"),Tt=parseFloat(L.getAttribute("cy")||"0"),Lt=parseFloat(L.getAttribute("r")||"0");pt=wt-Lt,St=Tt-Lt,Et=2*Lt,rt=2*Lt;break}case"ellipse":{let wt=parseFloat(L.getAttribute("cx")||"0"),Tt=parseFloat(L.getAttribute("cy")||"0"),Lt=parseFloat(L.getAttribute("rx")||"0"),Qt=parseFloat(L.getAttribute("ry")||"0");pt=wt-Lt,St=Tt-Qt,Et=2*Lt,rt=2*Qt;break}case"line":{let wt=parseFloat(L.getAttribute("x1")||"0"),Tt=parseFloat(L.getAttribute("y1")||"0"),Lt=parseFloat(L.getAttribute("x2")||"0"),Qt=parseFloat(L.getAttribute("y2")||"0"),Ht=999999999,Pt=999999999,vt=0,te=0;Ht=Math.min(wt,Lt),Pt=Math.min(Tt,Qt),vt=Math.max(wt,Lt),te=Math.max(Tt,Qt),pt=Ht,St=Pt,Et=vt-pt,rt=te-St,$t=[[(wt-pt)/(Et||1),(Tt-St)/(rt||1)],[(Lt-pt)/(Et||1),(Qt-St)/(rt||1)]];break}case"rect":case"foreignObject":pt=parseFloat(L.getAttribute("x")||"0"),St=parseFloat(L.getAttribute("y")||"0"),Et=parseFloat(L.getAttribute("width")||"0"),rt=parseFloat(L.getAttribute("height")||"0")}return Object.assign({},{x:pt,y:St,width:Et,height:rt,ratios:$t,points:V,rotate:Z})})(),attribute:(()=>{let B={};switch(L.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{var pt,St,Et,rt,$t,V;let Z=null!==(pt=L.getAttribute("fill"))&&void 0!==pt?pt:null,d=null!==(St=L.getAttribute("stroke"))&&void 0!==St?St:null,lt=null!==(Et=parseFloat(L.getAttribute("stroke-width")||"0"))&&void 0!==Et?Et:null,wt=null!==(rt=L.getAttribute("stroke-linecap"))&&void 0!==rt?rt:null,Tt=null!==($t=L.getAttribute("stroke-linejoin"))&&void 0!==$t?$t:null,Lt=null!==(V=parseFloat(L.getAttribute("stroke-dasharray")||"0"))&&void 0!==V?V:null;Object.assign(B,{fill:Z,stroke:d,strokeWidth:lt,strokeLinecap:wt,strokeLinejoin:Tt,strokeDasharray:Lt});break}}return B})(),style:(()=>{let B={};switch(L.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let Et=jQuery(L).find(".svg-container");if(Et.length){let $t=parseFloat(Et.css("border-width")||"0")||null,V=Et.css("border-style")||null,Z=Et.css("border-color")||null,d=null,lt=Et.css("background-color")||null,wt=null;(()=>{let{hex:Tt,alpha:Lt}=h(Z);Z=Tt,d=Lt})(),(()=>{let{hex:Tt,alpha:Lt}=h(lt);lt=Tt,wt=Lt})(),Object.assign(B,{borderWidth:$t,borderStyle:V,borderColor:Z,borderOpacity:d,backgroundColor:lt,backgroundOpacity:wt})}let rt=jQuery(L).find(".svg-editor-content");if(rt.length){var pt,St;let $t=JSON.parse((rt.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:V,alpha:Z}=h($t.TextColor);Object.assign(B,{fontFamily:null!==(pt=$t.FontFamily)&&void 0!==pt?pt:null,fontSize:null!==(St=$t.FontSize)&&void 0!==St?St:null,color:V,opacity:Z})}break}}return B})(),source:(()=>{let B={};switch(L.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(Kt.hasClass("editors")){let Pt=jQuery(L).find(".svg-editor-content");if(Pt.length){var pt;let vt=Pt.html(),te=null!==(pt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==pt?pt:[];Object.assign(B,{type:"html",html:{htmlContent:vt,variableKeywords:te}})}}else if(Kt.hasClass("inputs")||Kt.hasClass("textareas"))Object.assign(B,{type:"input",input:{input:!!jQuery(L).find("input").length,textarea:!!jQuery(L).find("textarea").length}});else if(Kt.hasClass("tests")){let Pt=jQuery(L).find(".svg-test");if(Kt.hasClass("tests-truefalse")){var St,Et;let vt=Pt.find(".svg-editor-content").html(),te=null!==(St=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==St?St:[];Object.assign(B,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(Et=u.test2.truefalse)||void 0===Et?void 0:Et.includes(_t)}},html:{htmlContent:vt,variableKeywords:te}})}else if(Kt.hasClass("tests-singlechoice")){var rt,$t;let vt=Pt.find(".svg-editor-content").html(),te=null!==(rt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==rt?rt:[];Object.assign(B,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===($t=u.test2.singlechoice)||void 0===$t?void 0:$t.includes(_t)}},html:{htmlContent:vt,variableKeywords:te}})}else if(Kt.hasClass("tests-multichoice")){var V,Z;let vt=Pt.find(".svg-editor-content").html(),te=null!==(V=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==V?V:[];Object.assign(B,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(Z=u.test2.multichoice)||void 0===Z?void 0:Z.includes(_t)}},html:{htmlContent:vt,variableKeywords:te}})}else if(Kt.hasClass("tests-fill")){var d,lt;let vt=Pt.find(".svg-editor-content").html(),te=null!==(d=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[],Y=null!==(lt=(null!=vt?vt:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==lt?lt:[];Y=Y.filter((v,q,ut)=>ut.indexOf(v)==q),Object.assign(B,{type:"test",test:{type:"fill",fill:Y.map(v=>{var q;return{key:v,value:null===(q=u.test2.fill)||void 0===q||null===(q=q.find(ut=>ut.id==_t))||void 0===q||null===(q=q.vals)||void 0===q?void 0:q.map(ut=>ut.text).filter(ut=>!["",null,void 0,NaN].includes(ut))}})},html:{htmlContent:vt,variableKeywords:te,fillKeywords:Y}})}else if(Kt.hasClass("tests-matching")){if(Pt.hasClass("svg-test-empty"))Object.assign(B,{type:"test",test:{type:"matching-empty",matching:{key:Pt.attr("data-name")||null}}});else if(Pt.hasClass("svg-test-content")){var wt;let vt=Pt.find(".svg-editor-content").html(),te=null!==(wt=(null!=vt?vt:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==wt?wt:[];Object.assign(B,{type:"test",test:{type:"matching-content",matching:{key:Pt.attr("data-name")||null}},html:{htmlContent:vt,variableKeywords:te}})}}else if(Kt.hasClass("tests-speech")){var Tt;Object.assign(B,{type:"speech",speech:{value:null===(Tt=u.test2.speech)||void 0===Tt||null===(Tt=Tt.find(vt=>vt.id==_t))||void 0===Tt||null===(Tt=Tt.vals)||void 0===Tt?void 0:Tt.map(vt=>vt.text).filter(vt=>!["",null,void 0,NaN].includes(vt))}})}else if(Kt.hasClass("tests-submit")){let vt=jQuery(L).find(".svg-container img");Object.assign(B,{type:"test",test:{type:"submit"},image:T(vt.attr("url"),vt.attr("path"),vt.attr("src"))})}}else if(Kt.hasClass("images")){let Pt=jQuery(L).find(".svg-editor-content img");if(Pt.length)Object.assign(B,{type:"image",image:T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src"))});else{let vt=jQuery(L).find("iframe");Object.assign(B,{type:"iframe",iframe:T(vt.attr("url"),vt.attr("path"),vt.attr("src"))})}}else if(Kt.hasClass("sounds")){let Pt=jQuery(L).find(".svg-editor-content img");Pt.length&&Object.assign(B,{type:"image",image:T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src"))})}else if(Kt.hasClass("htmls")){let Pt=jQuery(L).find("iframe");Pt.length&&Object.assign(B,{type:"iframe",iframe:T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src"))})}else if(Kt.hasClass("svgs")){let Pt=jQuery(L).find("svg");var Lt,Qt;Pt.length&&Object.assign(B,{type:"svg",svg:Object.assign(T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src")),{svgContent:null!==(Lt=null===(Qt=Pt.get(0))||void 0===Qt?void 0:Qt.outerHTML)&&void 0!==Lt?Lt:null})})}else if(Kt.hasClass("medias")){let Pt=jQuery(L).find(".media-item");if(Pt.length)switch(Pt.attr("type")){case"audio":Object.assign(B,{type:"audio",audio:T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src"))});break;case"video":Object.assign(B,{type:"video",video:T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src"))});break;case"file":Object.assign(B,{type:"file",file:T(Pt.attr("url"),Pt.attr("path"),Pt.attr("src"))});break;default:var Ht;Object.assign(B,{type:"link",link:{url:null!==(Ht=Pt.attr("url"))&&void 0!==Ht?Ht:null}})}let vt=jQuery(L).find("img");vt.length&&(Object.assign(B,{image:T(vt.attr("url"),vt.attr("path"),vt.attr("src"))}),B.type||Object.assign(B,{type:"image"}))}}return B})(),animate:(B=>{let pt={},St=null===(B=u.animates)||void 0===B?void 0:B.find(Et=>Et.elementId==_t);return St&&Object.assign(pt,{value:St.value}),pt})(),interactive:(()=>{let B={},pt=u.actions.show.filter(Et=>Et.elementId==_t&&Et.active);pt.length&&(B.show={},pt.forEach(Et=>{let{source:rt}=Et;switch(null==rt?void 0:rt.type){case"work":var $t,V,Z,d,lt;B.show.action={},Object.assign(B.show.action,{value:null!==($t=rt.value)&&void 0!==$t?$t:null,iteration:null!==(V=rt.iteration)&&void 0!==V?V:null,finish:null!==(Z=rt.end)&&void 0!==Z?Z:null,time:null!==(d=rt.time)&&void 0!==d?d:null,points:null!==(lt=rt.points)&&void 0!==lt?lt:null});break;case"audio":var wt,Tt,Lt;B.show.audio={},Object.assign(B.show.audio,{source:T(null,null,rt.url),iteration:null!==(wt=rt.iteration)&&void 0!==wt?wt:null,finish:null!==(Tt=rt.end)&&void 0!==Tt?Tt:null,time:null!==(Lt=rt.time)&&void 0!==Lt?Lt:null,async:-1==rt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Qt,Ht,Pt,vt,te,Y,v,q,ut,dt,X,Q,H,x,z;rt.options.includes("show")&&(B.show.triggershow={},Object.assign(B.show.triggershow,{id:null!==(Qt=parseInt(null!==(Ht=rt.id)&&void 0!==Ht?Ht:"0"))&&void 0!==Qt?Qt:null,ids:null===(Pt=rt.ids)||void 0===Pt?void 0:Pt.map(gt=>parseInt(gt)),async:null!==(vt=rt.async)&&void 0!==vt?vt:null,time:null!==(te=rt.time)&&void 0!==te?te:null})),rt.options.includes("run")&&(B.show.triggerrun={},Object.assign(B.show.triggerrun,{id:null!==(Y=parseInt(null!==(v=rt.id)&&void 0!==v?v:"0"))&&void 0!==Y?Y:null,ids:null===(q=rt.ids)||void 0===q?void 0:q.map(gt=>parseInt(gt)),async:null!==(ut=rt.async)&&void 0!==ut?ut:null,time:null!==(dt=rt.time)&&void 0!==dt?dt:null})),rt.options.includes("hide")&&(B.show.triggerhide={},Object.assign(B.show.triggerhide,{id:null!==(X=parseInt(null!==(Q=rt.id)&&void 0!==Q?Q:"0"))&&void 0!==X?X:null,ids:null===(H=rt.ids)||void 0===H?void 0:H.map(gt=>parseInt(gt)),async:null!==(x=rt.async)&&void 0!==x?x:null,time:null!==(z=rt.time)&&void 0!==z?z:null}))}}));let St=u.actions.click.filter(Et=>Et.elementId==_t&&Et.active);return St&&(B.click={},St.forEach(Et=>{let{source:rt}=Et;switch(null==rt?void 0:rt.type){case"work":var $t,V,Z,d,lt;B.click.action={},Object.assign(B.click.action,{value:null!==($t=rt.value)&&void 0!==$t?$t:null,iteration:null!==(V=rt.iteration)&&void 0!==V?V:null,finish:null!==(Z=rt.end)&&void 0!==Z?Z:null,time:null!==(d=rt.time)&&void 0!==d?d:null,points:null!==(lt=rt.points)&&void 0!==lt?lt:null});break;case"audio":var wt,Tt,Lt;B.click.audio={},Object.assign(B.click.audio,{source:T(null,null,rt.url),iteration:null!==(wt=rt.iteration)&&void 0!==wt?wt:null,finish:null!==(Tt=rt.end)&&void 0!==Tt?Tt:null,time:null!==(Lt=rt.time)&&void 0!==Lt?Lt:null,async:-1==rt.iteration?"change-slide":"change-node"});break;case"node":case"node2":var Qt,Ht,Pt,vt,te,Y,v,q,ut,dt,X,Q,H,x,z;rt.options.includes("show")&&(B.click.triggershow={},Object.assign(B.click.triggershow,{id:null!==(Qt=parseInt(null!==(Ht=rt.id)&&void 0!==Ht?Ht:"0"))&&void 0!==Qt?Qt:null,ids:null===(Pt=rt.ids)||void 0===Pt?void 0:Pt.map(It=>parseInt(It)),async:null!==(vt=rt.async)&&void 0!==vt?vt:null,time:null!==(te=rt.time)&&void 0!==te?te:null})),rt.options.includes("run")&&(B.click.triggerrun={},Object.assign(B.click.triggerrun,{id:null!==(Y=parseInt(null!==(v=rt.id)&&void 0!==v?v:"0"))&&void 0!==Y?Y:null,ids:null===(q=rt.ids)||void 0===q?void 0:q.map(It=>parseInt(It)),async:null!==(ut=rt.async)&&void 0!==ut?ut:null,time:null!==(dt=rt.time)&&void 0!==dt?dt:null})),rt.options.includes("hide")&&(B.click.triggerhide={},Object.assign(B.click.triggerhide,{id:null!==(X=parseInt(null!==(Q=rt.id)&&void 0!==Q?Q:"0"))&&void 0!==X?X:null,ids:null===(H=rt.ids)||void 0===H?void 0:H.map(It=>parseInt(It)),async:null!==(x=rt.async)&&void 0!==x?x:null,time:null!==(z=rt.time)&&void 0!==z?z:null}));break;case"slide":var gt;B.click.slide={},Object.assign(B.click.slide,{id:parseInt(null!==(gt=rt.id)&&void 0!==gt?gt:"0")||rt.num||null,code:rt.id})}})),B})(),variable:(B=>{let pt={};var St;L.getAttribute("data-variable")&&(pt.input={},Object.assign(pt.input,{variable:null!==(St=L.getAttribute("data-variable"))&&void 0!==St?St:null}));let Et=null===(B=u.nodes)||void 0===B||null===(B=B.find(d=>d.id==_t))||void 0===B?void 0:B.variable;var rt,$t,V,Z;return Et&&(pt.click={},Object.assign(pt.click,{variable:null!==(rt=Et.variable)&&void 0!==rt?rt:null,operator:null!==($t=Et.operator)&&void 0!==$t?$t:null,valuetype:null!==(V=Et.valuetype)&&void 0!==V?V:null,value:null!==(Z=Et.value)&&void 0!==Z?Z:null})),pt})()};null===(At=et.svg)||void 0===At||At.nodes.push(it)}),I.push(et)}),{screen:{width:J.screen.w,height:J.screen.h},data:{slides:I},variable:J.variable}}},644:(ae,Dt,y)=>{y.d(Dt,{Dx:()=>b,aY:()=>P,qp:()=>R,qz:()=>yt,sV:()=>h,yR:()=>f});var C=y(5861),k=y(9422);k.config({driver:[k.INDEXEDDB,k.LOCALSTORAGE,k.WEBSQL],name:"_localDataDB",version:1});const U={create:(M=(0,C.Z)(function*(){return k}),function(){return M.apply(this,arguments)}),get:function(){var M=(0,C.Z)(function*(T){return k.getItem(T)});return function(A){return M.apply(this,arguments)}}(),set:function(){var M=(0,C.Z)(function*(T,A){return k.setItem(T,A)});return function(A,J){return M.apply(this,arguments)}}()},yt=function(){var M=(0,C.Z)(function*(T){yield U.create();var A=(yield U.get("icdt-data"))||[];"function"==typeof T.callback&&T.callback(A)});return function(A){return M.apply(this,arguments)}}(),b=function(){var M=(0,C.Z)(function*(T){yield U.create(),T.params=T.params||{};try{yield U.set("icdt-data",T.params),"function"==typeof T.callback&&T.callback(T.params)}catch(A){"function"==typeof T.callback&&T.callback(null),console.error(A)}});return function(A){return M.apply(this,arguments)}}(),h=function(){var M=(0,C.Z)(function*(T){yield U.create();try{var A=(yield U.get("icdt-config"))||{};"function"==typeof T.callback&&T.callback(A)}catch(J){"function"==typeof T.callback&&T.callback(null),console.error(J)}});return function(A){return M.apply(this,arguments)}}(),R=function(){var M=(0,C.Z)(function*(T){yield U.create(),T.params=T.params||{};try{yield U.set("icdt-config",T.params),"function"==typeof T.callback&&T.callback(T.params)}catch(A){"function"==typeof T.callback&&T.callback(null),console.error(A)}});return function(A){return M.apply(this,arguments)}}(),P=function(){var M=(0,C.Z)(function*(T){yield U.create();try{var A=(yield U.get("icdt-clipboard"))||{};"function"==typeof T.callback&&T.callback(A)}catch(J){"function"==typeof T.callback&&T.callback(null),console.error(J)}});return function(A){return M.apply(this,arguments)}}(),f=function(){var M=(0,C.Z)(function*(T){yield U.create(),T.params=T.params||{};try{yield U.set("icdt-clipboard",T.params),"function"==typeof T.callback&&T.callback(T.params)}catch(A){"function"==typeof T.callback&&T.callback(null),console.error(A)}});return function(A){return M.apply(this,arguments)}}();var M},9359:(ae,Dt,y)=>{y.d(Dt,{E:()=>C});const C=(k,st)=>{if(!k)return"";let U=k.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),yt=(U&&U[4]||"").trim(),b=U?(256|U[1]).toString(16).slice(1)+(256|U[2]).toString(16).slice(1)+(256|U[3]).toString(16).slice(1):k;if("0"==yt)return"transparent";if(st){let h;h=""!==yt?yt:"01",h=(255*h|256).toString(16).slice(1),b+=h}return console.log(`lib_rgba2hex: ${k} -> ${b}`),`#${b}`}},1687:(ae,Dt,y)=>{y.d(Dt,{O:()=>C});const C={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"}},9125:(ae,Dt,y)=>{y.d(Dt,{D:()=>C});const C={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3}},968:(ae,Dt,y)=>{y.d(Dt,{_:()=>C});const C={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8}},4714:(ae,Dt,y)=>{y.d(Dt,{D:()=>C});const C={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306}},9054:(ae,Dt,y)=>{y.d(Dt,{$:()=>C});const C={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,PATH:8}},4981:(ae,Dt,y)=>{y.d(Dt,{icdt:()=>bt});var C=y(968),k=y(7492),st=y(1687),U=y(4318),yt=y(6816),b=y(666),h=y(3171);const f=D=>{var i,n,r,a,o;let p=(null===(i=D.mouseEvent)||void 0===i?void 0:i.target)||(null===(n=D.touchEvent)||void 0===n?void 0:n.target),m=(null==p?void 0:p.getAttribute("id"))||"",g=null==p?void 0:p.nodeName,O=(null==p||null===(r=p.parentNode)||void 0===r?void 0:r.getAttribute("id"))||"";var _,G;if([st.O.RESIZE_GROUP,st.O.SELECT_GROUP].includes(O))return null===(_=D.mouseEvent)||void 0===_||_.stopPropagation(),void(null===(G=D.mouseEvent)||void 0===G||G.preventDefault());if(null!==(a=D.mouseEvent)&&void 0!==a&&a.altKey||null!==(o=D.touchEvent)&&void 0!==o&&o.altKey||!m||m.match(/[^0-9]/)||!bt.dataSelect.nodeName.includes(g)){var j;bt.dataSelect.ids.length&&(bt.dataSelect.ids=[]),(0==(null===(j=D.mouseEvent)||void 0===j?void 0:j.button)||D.touchEvent)&&(D=>{let o=(0,k.g1)(st.O.SCAN_GROUP,"g"),p=(0,U.bH)(0,0,1,1);(0,k.vl)(o,p),((D,i,n)=>{(0,yt.A)(D,{start:o=>{},move:(o,p)=>{((o,p,m,g)=>{i=(0,U.bH)(o,p,m,g),(0,k.vl)(n,i)})(p[0][0],p[0][1],o.x,o.y)},end:(o,p)=>{null==n||n.remove(),bt.dataSelect.ids=bt.data.getNodeInArea(Math.min(p[0][0],o.x),Math.min(p[0][1],o.y),Math.max(p[0][0],o.x),Math.max(p[0][1],o.y));let m=bt.dataSelect.nodes;1==m.length?(0,b.y)(m[0]):m.length>1&&(0,h.Q)(m)}})})(D,p,o)})(D)}else{var ht,ct;let xt=parseFloat(m||"0");bt.dataSelect.ids=null!==(ht=D.mouseEvent)&&void 0!==ht&&ht.shiftKey||null!==(ct=D.touchEvent)&&void 0!==ct&&ct.shiftKey?[xt].concat(bt.dataSelect.ids).filter((Zt,fe,ge)=>ge.indexOf(Zt)==fe):[xt];let jt=bt.dataSelect.nodes;jt.length>1?(0,h.Q)(jt):1==jt.length&&(0,b.y)(jt[0])}};class T{constructor(){let{x:i,y:n}=bt.screen.dislocation;var r=(a,o,p,m)=>{bt.screen.move({x:i,y:n},{x:p-a,y:m-o})};return{start:a=>{},move:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)},end:(a,o)=>{r(o[0][0],o[0][1],a.x,a.y)}}}}var A=y(9054),J=y(4714);const w=[{name:"tam gi\xe1c vu\xf4ng",type:J.D.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam gi\xe1c c\xe2n",type:J.D.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"h\xecnh ch\u1eef nh\u1eadt",type:J.D.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"h\xecnh ng\u0169 gi\xe1c \u0111\u1ec1u",type:J.D.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"h\xecnh l\u1ee5c gi\xe1c \u0111\u1ec1u",type:J.D.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung \u0111\xe1nh d\u1ea5u v\u1ecb tr\xed",type:J.D.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung \u0111\xe1nh tr\xf2 chuy\u1ec7n",type:J.D.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"h\xecnh ch\u1eef th\u1eadp",type:J.D.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"h\xecnh m\u0169i t\xean 1 chi\u1ec1u",type:J.D.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"h\xecnh m\u0169i t\xean 2 chi\u1ec1u",type:J.D.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"h\xecnh ng\xf4i sao 4 c\xe1nh",type:J.D.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"h\xecnh ng\xf4i sao 5 c\xe1nh",type:J.D.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"h\xecnh ng\xf4i sao 6 c\xe1nh",type:J.D.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}];var I=y(8619),u=y(5811);class K{constructor(){let i=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,I._)(Math.ceil(1e9*Math.random())),p=(m,g,O,_)=>{o=(0,U.bH)(m,g,O,_,{ratio:1}),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,U.sg)(A.$.CIRCLE,o,a)),(0,k.__)(r,a),(0,k.g$)(i,o)};return{start:m=>{r.setAttribute("cx",m.x.toString()),r.setAttribute("cy",m.y.toString()),r.setAttribute("r","1")},move:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y)},end:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y),bt.data.node=Object.assign({id:n,type:A.$.CIRCLE,name:"Circle"},{size:o,attribute:a}),null==i||i.remove()}}}}var N=y(8785);class tt{constructor(){let i=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,N.r)(Math.ceil(1e9*Math.random()));var p=(m,g,O,_)=>{o=(0,U.bH)(m,g,O,_),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,U.sg)(A.$.ELLIPSE,o,a)),(0,k.__)(r,a),(0,k.g$)(i,o)};return{start:m=>{r.setAttribute("cx",m.x.toString()),r.setAttribute("cy",m.y.toString()),r.setAttribute("rx","1"),r.setAttribute("ry","1")},move:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y)},end:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y),bt.data.node=Object.assign({id:n,type:A.$.ELLIPSE,name:"Ellipse"},{size:o,attribute:a}),null==i||i.remove()}}}}var et=y(8054);class at{constructor(){let i=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,et.f)(Math.ceil(1e9*Math.random()));var p=(m,g,O,_)=>{o=(0,U.bH)(m,g,O,_),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,U.sg)(A.$.RECT,o,a)),(0,k.__)(r,a),(0,k.g$)(i,o)};return{start:m=>{p(m.x,m.y,m.x+o.width,m.y+o.height)},move:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y)},end:(m,g)=>{o.width>=10&&o.height>=10?bt.data.node=Object.assign({id:n,type:A.$.RECT,name:"Rect"},{size:o,attribute:a}):null==r||r.remove(),null==i||i.remove()}}}}var L=y(2282);class Ot{constructor(i){let n=(0,k.g1)(st.O.CREATE_GROUP,"g"),r=i||[[0,0],[1,1],[0,1]],{nodeId:a,element:o,attribute:p,size:m}=(0,L.l)(Math.ceil(1e9*Math.random()));m.ratios=r;var g=(O,_,G,j)=>{m=(0,U.bH)(O,_,G,j,{ratios:r}),m.x=(0,u.q)(m.x),m.y=(0,u.q)(m.y),m.width=(0,u.q)(m.width),m.height=(0,u.q)(m.height),Object.assign(p,(0,U.sg)(A.$.POLYGON,m,p)),(0,k.__)(o,p),(0,k.g$)(n,m)};return{start:O=>{},move:(O,_)=>{g(_[0][0],_[0][1],O.x,O.y)},end:(O,_)=>{g(_[0][0],_[0][1],O.x,O.y),bt.data.node=Object.assign({id:a,type:A.$.POLYGON,name:"Polygon"},{size:m,attribute:p}),null==n||n.remove()}}}}var At=y(4921);class Kt{constructor(){let i=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o}=(0,At.W)(Math.ceil(1e9*Math.random()));var p=(m,g,O,_)=>{o=(0,U.bH)(m,g,O,_),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,U.sg)(A.$.LINE,o,a)),(0,k.__)(r,a),(0,k.g$)(i,o)};return{start:m=>{},move:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y)},end:(m,g)=>{p(g[0][0],g[0][1],m.x,m.y),bt.data.node=Object.assign({id:n,type:A.$.LINE,name:"Line"},{size:o,attribute:a}),null==i||i.remove()}}}}var Ct=y(8419);class Mt{constructor(){let{nodeId:i,element:n,attribute:r,size:a}=(0,Ct.G)(Math.ceil(1e9*Math.random())),p="";var m=(g,O)=>{p+=` ${g} ${O}`,n.setAttribute("d",p)};return{start:g=>{p=`M ${g.x} ${g.y} L ${g.x} ${g.y}`},move:(g,O)=>{m(g.x,g.y)},end:(g,O)=>{m(g.x,g.y),(g=>{let O=9999,_=9999,G=-9999,j=-9999;g.forEach(ht=>{O=Math.min(O,ht[0]),_=Math.min(_,ht[1]),G=Math.max(G,ht[0]),j=Math.max(j,ht[1])}),a=(0,U.bH)(O,_,G,j,{points:g}),Object.assign(r,(0,U.sg)(A.$.PATH,a,r)),(0,k.__)(n,r)})(O),bt.data.node=Object.assign({id:i,type:A.$.PATH,name:"Path"},{size:a,attribute:r})}}}}var _t=y(2875);class it{constructor(){let i=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,size:a,attribute:o,style:p,source:m}=(0,_t.e)(Math.ceil(1e9*Math.random()));var g=(O,_,G,j)=>{a=(0,U.bH)(O,_,G,j),a.x=(0,u.q)(a.x),a.y=(0,u.q)(a.y),a.width=(0,u.q)(a.width),a.height=(0,u.q)(a.height),Object.assign(o,(0,U.sg)(A.$.FOREIGNOBJECT,a,o)),(0,k.__)(r,o),(0,k.g$)(i,a)};return{start:O=>{g(O.x,O.y,O.x+a.width,O.y+a.height)},move:(O,_)=>{g(_[0][0],_[0][1],O.x,O.y)},end:(O,_)=>{a.width>=10&&a.height>=10?bt.data.node=Object.assign({id:n,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:p,source:m}):null==r||r.remove(),null==i||i.remove()}}}}var B=y(7210);class pt{constructor(){var i,n;let r=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:a,element:o,size:p,attribute:m,source:g}=(0,B.G)(Math.ceil(1e9*Math.random())),O=1;(G=>{if(!G)return;let j=new Image;j.onload=()=>{O=(0,u.q)(j.naturalWidth/j.naturalHeight,100)},j.onerror=ht=>{console.error(`ImgSrc load failed -> ${G}`,ht)},j.src=G})(null!==(i=null===(n=g.image)||void 0===n?void 0:n.url)&&void 0!==i?i:"");var _=(G,j,ht,ct)=>{p=(0,U.bH)(G,j,ht,ct,{ratio:O}),p.x=(0,u.q)(p.x),p.y=(0,u.q)(p.y),p.width=(0,u.q)(p.width),p.height=(0,u.q)(p.height),Object.assign(m,(0,U.sg)(A.$.IMAGE,p,m)),(0,k.__)(o,m),(0,k.g$)(r,p)};return{start:G=>{_(G.x,G.y,G.x+p.width,G.y+p.height)},move:(G,j)=>{_(j[0][0],j[0][1],G.x,G.y)},end:(G,j)=>{p.width>=10&&p.height>=10?bt.data.node=Object.assign({id:a,type:A.$.IMAGE,name:"Image"},{size:p,attribute:m,source:g}):null==o||o.remove(),null==r||r.remove()}}}}var Et=y(4578),rt=y(9623);function Z(D,i,n,r){return Math.sqrt(Math.pow(n-D,2)+Math.pow(r-i,2))}function d(D,i,n,r,a){return Z(D,i,n,r)<a?1:0}function wt(D,i,n,r,a,o,p){var m=[];return m.push(d(D,i,n,r,p)),m.push(d(D,i,a,o,p)),m.push(function lt(D,i,n,r,a,o,p){var m=[a-n,o-r],g=[D-n,i-r],O=[-m[1],m[0]],_=Math.sqrt(Math.pow(O[0],2)+Math.pow(O[1],2)),G=[O[0]/_,O[1]/_],j=Math.sqrt(Math.pow(m[0],2)+Math.pow(m[1],2)),ht=[m[0]/j,m[1]/j],ct=g[0]*ht[0]+g[1]*ht[1];if(ct<=0||ct>=j)return 0;var xt=g[0]*G[0]+g[1]*G[1];return xt>=p||xt<=-p?0:1}(D,i,n,r,a,o,p)),m}function Tt(D,i,n,r,a){var o=[n-D,r-i],p=[-o[1],o[0]],m=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)),g=[p[0]/m,p[1]/m];return[[D+a*g[0],i+a*g[1]],[D-a*g[0],i-a*g[1]],[n-a*g[0],r-a*g[1]],[n+a*g[0],r+a*g[1]]]}function Lt(D,i,n,r,a,o,p){var ct,m=[a-D,o-i],g=[n-D,r-i],O=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),_=[g[0]/O,g[1]/O],G=m[0]*_[0]+m[1]*_[1],j=[D+G*_[0],i+G*_[1]],ht=Math.sqrt(Math.pow(a-j[0],2)+Math.pow(o-j[1],2));ct=0===ht?p:Math.sqrt(Math.pow(p,2)-Math.pow(ht,2));var xt=[D+G*_[0]+ct*_[0],i+G*_[1]+ct*_[1]];return xt[0]===D&&xt[1]===i?null:xt}function Qt(D,i,n,r,a,o,p){var m=[a-D,o-i],g=[n-D,r-i],O=[-g[1],g[0]],_=Math.sqrt(Math.pow(O[0],2)+Math.pow(O[1],2)),G=[O[0]/_,O[1]/_],j=m[0]*G[0]+m[1]*G[1],ht=v([D,i],[n,r],[a,o]);if(te([ht[0]-a,ht[1]-o])>=p)return null;var xt=Math.sqrt(Math.pow(p,2)-Math.pow(j,2)),jt=[a-j*G[0],o-j*G[1]],Zt=Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)),fe=[g[0]/Zt,g[1]/Zt],ge=[[jt[0]-fe[0]*xt,jt[1]-fe[1]*xt],[jt[0]+fe[0]*xt,jt[1]+fe[1]*xt]];return ge[0][0]===D&&ge[0][1]===i?null:ge}function Ht(D,i,n,r,a,o,p,m){var g,O,_,G,j,ht;return-(_=p-a)*(O=r-i)+(g=n-D)*(G=m-o)==0?null:(ht=(_*(i-o)-G*(D-a))/(-_*O+g*G),(j=(-O*(D-a)+g*(i-o))/(-_*O+g*G))>=0&&j<=1&&ht>=0&&ht<=1?[D+ht*g,i+ht*O]:null)}function Pt(D,i,n,r,a,o,p,m,g,O){var _=Tt(o,p,m,g,O),G=[];if(n[0]&&!n[1])G.push(Lt(D,i,r,a,o,p,O)),G.push(Ht(D,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),G.push(Ht(D,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1])),(j=Qt(D,i,r,a,m,g,O))&&G.push(j[0],j[1]);else if(!n[0]&&n[1])G.push(Lt(D,i,r,a,m,g,O)),G.push(Ht(D,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),G.push(Ht(D,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1])),(j=Qt(D,i,r,a,o,p,O))&&G.push(j[0],j[1]);else if(n[0]&&n[1])G.push(Lt(D,i,r,a,o,p,O)),G.push(Ht(D,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),G.push(Ht(D,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1])),G.push(Lt(D,i,r,a,m,g,O));else{var j=Qt(D,i,r,a,m,g,O),ht=Qt(D,i,r,a,o,p,O);j&&G.push(j[0],j[1]),ht&&G.push(ht[0],ht[1]),G.push(Ht(D,i,r,a,_[0][0],_[0][1],_[3][0],_[3][1])),G.push(Ht(D,i,r,a,_[1][0],_[1][1],_[2][0],_[2][1]))}for(var ct=[D,i],xt=0;xt<G.length;xt++)G[xt]&&Z(G[xt][0],G[xt][1],r,a)<Z(ct[0],ct[1],r,a)&&(ct=G[xt]);return ct[0]===D&&ct[1]===i?null:ct}function vt(D,i,n,r,a,o,p,m,g){var O=Tt(a,o,p,m,g),_=[],G=Qt(D,i,n,r,a,o,g);G&&_.push(G[0],G[1]),(G=Qt(D,i,n,r,p,m,g))&&_.push(G[0],G[1]),_.push(Ht(D,i,n,r,O[0][0],O[0][1],O[3][0],O[3][1])),_.push(Ht(D,i,n,r,O[1][0],O[1][1],O[2][0],O[2][1]));for(var j=[n,r],ht=[D,i],ct=0;ct<_.length;ct++)_[ct]&&Z(_[ct][0],_[ct][1],D,i)<Z(j[0],j[1],D,i)&&(j=_[ct]);for(var xt=0;xt<_.length;xt++)_[xt]&&Z(_[xt][0],_[xt][1],n,r)<Z(ht[0],ht[1],n,r)&&(ht=_[xt]);return j[0]===n&&j[1]===r||ht[0]===D&&ht[1]===i?null:[j,ht]}var te=function(D){return Math.sqrt(D[0]*D[0]+D[1]*D[1])},v=function(D,i,n){var r=[i[0]-D[0],i[1]-D[1]],a=te(r);if(a<1e-6)return D;var o=[n[0]-D[0],n[1]-D[1]],p=(r[0]*o[0]+r[1]*o[1])/a;return p<0?D:p>a?i:[D[0]+r[0]*p/a,D[1]+r[1]*p/a]};class q{constructor(){let{element:r,size:o}=(0,Ct.G)(Math.ceil(1e9*Math.random()));(0,k.__)(r,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let p="";return{start:O=>{p=`M ${O.x} ${O.y} L ${O.x} ${O.y}`},move:(O,_)=>{((O,_)=>{p+=` ${O} ${_}`,r.setAttribute("d",p)})(O.x,O.y)},end:(O,_)=>{r.remove(),(O=>{let _=9999,G=9999,j=-9999,ht=-9999;O.forEach(xt=>{_=Math.min(_,xt[0]),G=Math.min(G,xt[1]),j=Math.max(j,xt[0]),ht=Math.max(ht,xt[1])}),o=(0,U.bH)(_,G,j,ht,{points:O}),bt.data.getNodeInArea(0,0,1920,1920,A.$.PATH).forEach(xt=>{let Zt=((D,i,n)=>{n=n||20;var r=[],a=function(_){var G=i[0][0],j=i[0][1],ht=0,ct=0;if(1!==_.length||d(_[0][0],_[0][1],G,j,n)){for(var xt;ht<_.length-1;){var jt=_[ht],Zt=_[ht+1],fe=d(jt[0],jt[1],G,j,n),ge=d(Zt[0],Zt[1],G,j,n);if(fe&&ge)ct=++ht;else if(fe&&!ge)(we=Lt(jt[0],jt[1],Zt[0],Zt[1],G,j,n))?(_[ht]=we,ct=ht):ht++;else if(!fe&&ge){var we;(we=Lt(Zt[0],Zt[1],jt[0],jt[1],G,j,n))&&((xt=_.slice(ct,ht+1)).push(we),r.push(xt)),ct=++ht}else{var ye=Qt(jt[0],jt[1],Zt[0],Zt[1],G,j,n);ye?(((xt=_.slice(ct,ht+1))[xt.length-1][0]!==ye[0][0]||xt[xt.length-1][1]!==ye[0][1])&&xt.push(ye[0]),xt.length>1&&r.push(xt),_[ht]=ye[1],_[ht+1]&&_[ht+1][0]==ye[1][0]&&_[ht+1][1]==ye[1][1]&&ht++,ct=ht):ht++}}ct!==ht&&(xt=_.slice(ct,_.length))&&r.push(xt)}else r.push(_)},o=function(_,G){var Zt,j=i[G],ht=i[G+1],ct=0,xt=0;if(1!==_.length||-1!==(jt=wt(_[0][0],_[0][1],j[0],j[1],ht[0],ht[1],n)).indexOf(1)){for(;ct<_.length-1;){var fe=_[ct],ge=_[ct+1],jt=wt(fe[0],fe[1],j[0],j[1],ht[0],ht[1],n),we=wt(ge[0],ge[1],j[0],j[1],ht[0],ht[1],n);if(-1!==jt.indexOf(1)&&-1!==we.indexOf(1))xt=++ct;else if(-1!==jt.indexOf(1)&&-1===we.indexOf(1))(ye=Pt(fe[0],fe[1],jt,ge[0],ge[1],j[0],j[1],ht[0],ht[1],n))?(_[ct]=ye,xt=ct):ct++;else if(-1===jt.indexOf(1)&&-1!==we.indexOf(1)){var ye;(ye=Pt(ge[0],ge[1],we,fe[0],fe[1],j[0],j[1],ht[0],ht[1],n))?((Zt=_.slice(xt,ct+1)).push(ye),r.push(Zt),xt=++ct):ct++}else{var Se=vt(fe[0],fe[1],ge[0],ge[1],j[0],j[1],ht[0],ht[1],n);Se?(((Zt=_.slice(xt,ct+1))[Zt.length-1][0]!==Se[0][0]||Zt[Zt.length-1][1]!==Se[0][1])&&Zt.push(Se[0]),Zt.length>1&&r.push(Zt),_[ct]=Se[1],_[ct+1]&&_[ct+1][0]==Se[1][0]&&_[ct+1][1]==Se[1][1]&&ct++,xt=ct):ct++}}xt!==ct&&(Zt=_.slice(xt,_.length))&&r.push(Zt)}else r.push(_)};if(i=function V(D){var i=[];if(1===D.length)i=D;else{for(var n=0;n<D.length-1;)(D[n][0]!==D[n+1][0]||D[n][1]!==D[n+1][1])&&i.push(D[n]),n++;0!==D.length&&0===i.length&&i.push(D[0]),(D[D.length-1][0]!==D[i.length-1][0]||D[D.length-1][1]!==D[i.length-1][1])&&i.push(D[n])}return i}(i),1===i.length){for(var p=0;p<D.length;p++)a(D[p]);D=r}else for(var m=0;m<i.length-1;m++){for(p=0;p<D.length;p++)o(D[p],m);D=r,r=[]}for(var g=0;g<D.length;g++)for(var O=0;O<D[g].length;O++)D[g][O][0]=Math.round(D[g][O][0]),D[g][O][1]=Math.round(D[g][O][1]);return D})(bt.data.getNode(xt).size.points,O,2);console.log(Zt)})})(_)}}}}var dt=y(1105);class X{constructor(){let i=(0,k.g1)(st.O.CREATE_GROUP,"g"),{nodeId:n,element:r,attribute:a,size:o,source:p}=(0,dt.$)(Math.ceil(1e9*Math.random())),m=(g,O,_,G)=>{o=(0,U.bH)(g,O,_,G),o.x=(0,u.q)(o.x),o.y=(0,u.q)(o.y),o.width=(0,u.q)(o.width),o.height=(0,u.q)(o.height),Object.assign(a,(0,U.sg)(A.$.TEXT,o,a)),(0,k.__)(r,a),(0,k.g$)(i,o)};return{start:g=>{m(g.x,g.y,g.x+o.width,g.y+o.height)},move:(g,O)=>{m(O[0][0],O[0][1],g.x,g.y)},end:(g,O)=>{o.width>=10&&o.height>=10?bt.data.node=Object.assign({id:n,type:A.$.TEXT,name:"Text"},{size:o,attribute:a,source:p}):null==r||r.remove(),null==i||i.remove()}}}}var z=y(4113),gt=y(9125),It=y(7797);var Rt=y(6358);class Ut{constructor(){this._nodeName=["circle","ellipse","line","polygon","rect","text","path","foreignObject","image"],this._selected_Ids=[],this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(i){this._selected_Ids=i,this.change(this.ids)}get nodes(){return this._selected_Ids.map(i=>bt.data.getNode(i)).filter(i=>!i.isfake)}set onchange(i){this._fnChanges.push(i)}change(i){var n,r,a,o,p;null===(n=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===n||n.remove(),null===(r=window.document.getElementById(st.O.SELECT_GROUP))||void 0===r||r.remove(),null===(a=window.document.getElementById(st.O.SCAN_GROUP))||void 0===a||a.remove(),null===(o=window.document.getElementById(st.O.CREATE_GROUP))||void 0===o||o.remove(),null===(p=window.document.getElementById(st.O.INTERACTIVE_GROUP))||void 0===p||p.remove(),jQuery('[id^="icdt-temp-"]').remove(),this._fnChanges.forEach(m=>m(i))}deleteNode(){for(let i of this._selected_Ids){let n=bt.data.deleteNode(i);bt.history.push([{type:"delete",from:{id:n},to:{id:n}}])}bt.dataSelect.ids=[]}groupNode(){let i=[];if(bt.dataSelect.ids.length>=2){let n=bt.data.getNode(bt.dataSelect.ids[0]),{nodeId:r,attribute:a,size:o}=(0,Rt.m)(Math.ceil(1e9*Math.random()),void 0,n.pid?window.document.getElementById(n.pid):null);bt.data.node=Object.assign({id:r,type:A.$.GROUP,name:"G"},{size:o,attribute:a});for(let p of bt.dataSelect.ids)i.push(bt.data.addGroup(p,r))}if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,b.y)(n[0]):n.length>1&&(0,h.Q)(n)}}ungroupNode(){let i=[];for(let n of bt.dataSelect.ids)i.push(bt.data.unGroup(n));if(i.length){bt.dataSelect.ids=i;let n=bt.dataSelect.nodes;1==n.length?(0,b.y)(n[0]):n.length>1&&(0,h.Q)(n)}}}var Wt=y(9942);class Vt{createNodeImage(i,n){var r,a,o,p;let{nodeId:g,element:O,size:_,attribute:G,source:j}=(0,B.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Wt.I)(i)}});(ht=>{if(!ht)return;let ct=new Image;ct.onload=()=>{let xt=(0,u.q)(ct.naturalWidth/ct.naturalHeight,100);xt>=1?(_.width=Math.min(ct.naturalWidth,512),_.height=(0,u.q)(_.width/xt,100)):(_.height=Math.min(ct.naturalHeight,512),_.width=(0,u.q)(_.height*xt,100)),_.x=(0,u.q)(_.x+50-_.width/2,100),_.y=(0,u.q)(_.y+50-_.height/2,100),Object.assign(G,(0,U.sg)(A.$.IMAGE,_,G)),(0,k.__)(O,G),bt.data.node=Object.assign({id:g,type:A.$.IMAGE,name:"Image"},{size:_,attribute:G,source:j})},ct.onerror=xt=>{console.error(`ImgSrc load failed -> ${ht}`,xt),null==O||O.remove()},ct.src=ht})(null!==(o=null===(p=j.image)||void 0===p?void 0:p.url)&&void 0!==o?o:"")}createNodeIframe(i,n){var r,a;let{nodeId:p,element:m,size:g,attribute:O,style:_,source:G}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:(0,Wt.I)(i)}});(j=>{let ht=(null===(j=bt.data.slide)||void 0===j||null===(j=j.svg)||void 0===j?void 0:j.viewBox)||{x:0,y:0,width:100,height:100},ct=(0,u.q)(ht.width/ht.height,100);ct>=1?(g.width=Math.min(ht.width,512),g.height=(0,u.q)(g.width/ct,100)):(g.height=Math.min(ht.height,512),g.width=(0,u.q)(g.height*ct,100)),g.x=(0,u.q)(g.x+50-g.width/2,100),g.y=(0,u.q)(g.y+50-g.height/2,100),Object.assign(O,(0,U.sg)(A.$.IMAGE,g,O)),(0,k.__)(m,O),bt.data.node=Object.assign({id:p,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:g,attribute:O,style:_,source:G})})()}createNodeEmbed(i,n){var r,a;let{nodeId:p,element:m,size:g,attribute:O,style:_,source:G}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},style:{},source:{type:"embed",embed:Object.assign(i,(0,Wt.I)(i))}});(j=>{let ht=(null===(j=bt.data.slide)||void 0===j||null===(j=j.svg)||void 0===j?void 0:j.viewBox)||{x:0,y:0,width:100,height:100},ct=(0,u.q)(ht.width/ht.height,100);ct>=1?(g.width=Math.min(ht.width,512),g.height=(0,u.q)(g.width/ct,100)):(g.height=Math.min(ht.height,512),g.width=(0,u.q)(g.height*ct,100)),g.x=(0,u.q)(g.x+50-g.width/2,100),g.y=(0,u.q)(g.y+50-g.height/2,100),Object.assign(O,(0,U.sg)(A.$.IMAGE,g,O)),(0,k.__)(m,O),bt.data.node=Object.assign({id:p,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:g,attribute:O,style:_,source:G})})()}createNodeMedia(i,n){var r,a,o,p;let{nodeId:g,element:O,size:_,attribute:G,source:j}=(0,B.G)(Math.ceil(1e9*Math.random()),{size:{x:(null!==(r=null==n?void 0:n.x)&&void 0!==r?r:50)-50,y:(null!==(a=null==n?void 0:n.y)&&void 0!==a?a:50)-50,width:100,height:100},source:{type:"image",image:(0,Wt.I)(i.cover)}}),ht={click:{media:i.media}};(ct=>{if(!ct)return;let xt=new Image;xt.onload=()=>{let jt=(0,u.q)(xt.naturalWidth/xt.naturalHeight,100);jt>=1?(_.width=Math.min(xt.naturalWidth,512),_.height=(0,u.q)(_.width/jt,100)):(_.height=Math.min(xt.naturalHeight,512),_.width=(0,u.q)(_.height*jt,100)),_.x=(0,u.q)(_.x+50-_.width/2,100),_.y=(0,u.q)(_.y+50-_.height/2,100),Object.assign(G,(0,U.sg)(A.$.IMAGE,_,G)),(0,k.__)(O,G),bt.data.node=Object.assign({id:g,type:A.$.IMAGE,name:"Image"},{size:_,attribute:G,source:j,interactive:ht})},xt.onerror=jt=>{console.error(`ImgSrc load failed -> ${ct}`,jt),null==O||O.remove()},xt.src=ct})(null!==(o=null===(p=j.image)||void 0===p?void 0:p.url)&&void 0!==o?o:"")}insert(i){var n;if(bt.data.insertSlide(bt.data.slideId,1),i.title){let{nodeId:r,size:a,attribute:o,style:p,source:m}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${i.title}</span>`}}});bt.data.node=Object.assign({id:r,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:p,source:m})}if(i.description){let{nodeId:r,size:a,attribute:o,style:p,source:m}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${i.description.replace(/\n/g,"<br/>")}</span>`}}});bt.data.node=Object.assign({id:r,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:a,attribute:o,style:p,source:m})}null!==(n=i.media)&&void 0!==n&&n.prompt&&((()=>{let{nodeId:r,size:a,attribute:o}=(0,et.f)(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});bt.data.node=Object.assign({id:r,type:A.$.RECT,name:"Rect"},{size:a,attribute:o})})(),(r=>{let{nodeId:a,size:o,attribute:p,style:m,source:g}=(0,_t.e)(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(r=i.media)||void 0===r?void 0:r.prompt}</i></span>`}}});bt.data.node=Object.assign({id:a,type:A.$.FOREIGNOBJECT,name:"ForeignObject"},{size:o,attribute:p,style:m,source:g})})())}}var qt=y(5226);class ce{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang m\u1edbi",svg:{viewBox:bt.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var i;let n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((o,p)=>p==this._slideIdx),r=null==n?void 0:n.svg,a=o=>{let p=[];return o.filter(m=>!m.isdeleted).forEach(m=>{m.type==A.$.GROUP?p=p.concat(a(m.nodes||[])):p.push(m.id)}),p};return a((null==r?void 0:r.nodes)||[])}}get get(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(p=>p.type==A.$.GROUP).forEach(p=>{var m;p.nodes=n(null===(m=p.nodes)||void 0===m?void 0:m.filter(g=>!g.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(p=>{var m,g;return p.type!=A.$.GROUP||(null!==(m=null===(g=p.nodes)||void 0===g?void 0:g.length)&&void 0!==m?m:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource}get getResource(){var i;let n=[];return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a,o,p,m,g,O,_,G;n.push(null===(a=r.svg)||void 0===a||null===(a=a.background)||void 0===a?void 0:a.path),null===(o=r.svg)||void 0===o||o.nodes.forEach(j=>{var ht,ct,xt,jt,Zt,fe,ge,we,ye,Se;n.push(null===(ht=j.source)||void 0===ht||null===(ht=ht.image)||void 0===ht?void 0:ht.path),n.push(null===(ct=j.source)||void 0===ct||null===(ct=ct.audio)||void 0===ct?void 0:ct.path),n.push(null===(xt=j.source)||void 0===xt||null===(xt=xt.video)||void 0===xt?void 0:xt.path),n.push(null===(jt=j.source)||void 0===jt||null===(jt=jt.file)||void 0===jt?void 0:jt.path),n.push(null===(Zt=j.source)||void 0===Zt||null===(Zt=Zt.iframe)||void 0===Zt?void 0:Zt.path),n.push(null===(fe=j.source)||void 0===fe||null===(fe=fe.track)||void 0===fe?void 0:fe.path),n.push(null===(ge=j.interactive)||void 0===ge||null===(ge=ge.show)||void 0===ge||null===(ge=ge.audio)||void 0===ge||null===(ge=ge.source)||void 0===ge?void 0:ge.path),n.push(null===(we=j.interactive)||void 0===we||null===(we=we.click)||void 0===we||null===(we=we.audio)||void 0===we||null===(we=we.source)||void 0===we?void 0:we.path),n.push(null===(ye=j.interactive)||void 0===ye||null===(ye=ye.click)||void 0===ye||null===(ye=ye.image)||void 0===ye||null===(ye=ye.source)||void 0===ye?void 0:ye.path),n.push(null===(Se=j.interactive)||void 0===Se||null===(Se=Se.click)||void 0===Se||null===(Se=Se.video)||void 0===Se||null===(Se=Se.source)||void 0===Se?void 0:Se.path)}),n.push(null===(p=r.test)||void 0===p||null===(p=p.audiotrue)||void 0===p?void 0:p.path),n.push(null===(m=r.test)||void 0===m||null===(m=m.audiofalse)||void 0===m?void 0:m.path),n.push(null===(g=r.test)||void 0===g||null===(g=g.effecttrue)||void 0===g?void 0:g.path),n.push(null===(O=r.test)||void 0===O||null===(O=O.effectfalse)||void 0===O?void 0:O.path),n.push(null===(_=r.test)||void 0===_||null===(_=_.icontrue)||void 0===_?void 0:_.path),n.push(null===(G=r.test)||void 0===G||null===(G=G.iconfalse)||void 0===G?void 0:G.path)}),n.filter(r=>r).map(r=>r.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase()).filter((r,a,o)=>o.indexOf(r)==a)}set set(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,k.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var i;let n=r=>{var a,o;return null===(a=r)||void 0===a||a.filter(p=>p.type==A.$.GROUP).forEach(p=>{var m;p.nodes=n(null===(m=p.nodes)||void 0===m?void 0:m.filter(g=>!g.isdeleted))}),(r=null===(o=r)||void 0===o?void 0:o.filter(p=>{var m,g;return p.type!=A.$.GROUP||(null!==(m=null===(g=p.nodes)||void 0===g?void 0:g.length)&&void 0!==m?m:0)>0}))||[]};return null===(i=this._dataSource.slides)||void 0===i||i.forEach(r=>{var a;r.svg&&(r.svg.nodes=n(null===(a=r.svg)||void 0===a||null===(a=a.nodes)||void 0===a?void 0:a.filter(o=>!o.isdeleted)))}),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(i){this._dataSource=i,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),(0,k.wM)(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var i,n;return null!==(i=null===(n=this.slide)||void 0===n?void 0:n.id)&&void 0!==i?i:0}get slideIdx(){return this._slideIdx}get slide(){var i;return null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((n,r)=>r==this._slideIdx)}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var i,n;this._slideIdx<(null!==(i=null===(n=this._dataSource.slides)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){(0,k.wM)(),(0,qt.E)(this.slide)}openSlide(i,n){var r,a,o,p;if(i)for(let G=0,j=null!==(m=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==m?m:0;G<j;G++){var m,g,O;if((null!==(O=this._dataSource.slides)&&void 0!==O?O:[])[G].id==i){this._slideIdx=G;break}}else if(n&&n>=0&&n<(null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==r?r:0))this._slideIdx=null!=n?n:0;else{var _;this._slideIdx=0,null!==(_=this._dataSource.slides)&&void 0!==_&&_.length||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))])}(0,k.wM)(),(0,qt.E)(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(o=null===(p=this._dataSource.slides)||void 0===p?void 0:p.length)&&void 0!==o?o:0,this.slide)}addSlide(){var i,n,r;null===(i=this._dataSource.slides)||void 0===i||i.push(this._defaultSlide),this._slideIdx=(null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-1,this.openSlide(void 0,this._slideIdx)}tryReplaceSlide(i,n,r){var a,o,p,m,g;let O=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(G=>G.id==i);if(!r||!O||null!=O&&null!==(o=O.svg)&&void 0!==o&&o.nodes.filter(G=>!G.isdeleted).length)return this.insertSlide(i,n,r);let _=null!==(p=null===(m=this._dataSource.slides)||void 0===m?void 0:m.indexOf(O))&&void 0!==p?p:0;null===(g=this._dataSource.slides)||void 0===g||g.splice(_,1,r),this._slideIdx=_,this.openSlide(void 0,this._slideIdx)}insertSlide(i,n,r){var a,o,p,m,g;let O=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(j=>j.id==i))&&void 0!==a?a:this._defaultSlide,_=(null!==(p=null===(m=this._dataSource.slides)||void 0===m?void 0:m.indexOf(O))&&void 0!==p?p:0)+n;var G;r?(r.id=this.newSlideId,r.code=void 0,r.name||(r.name="Trang m\u1edbi"),null!==(G=r.svg)&&void 0!==G&&G.viewBox||r.svg&&(r.svg.viewBox=bt.screen.frameSize)):r=this._defaultSlide,null===(g=this._dataSource.slides)||void 0===g||g.splice(_,0,r),this._slideIdx=_,this.openSlide(void 0,this._slideIdx)}copySlide(i){var n,r,a,o,p,m,g;let O=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(j=>j.id==i))&&void 0!==n?n:this._defaultSlide,_=(null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(O))&&void 0!==a?a:0)+1,G=Object.assign(JSON.parse(JSON.stringify(O)),{id:this.newSlideId,code:void 0,name:`${O.name} + (Copy)`});null===(p=this._dataSource.slides)||void 0===p||p.splice(_,0,G),this.changeSlide(this.slides,this.slideIdx,null!==(m=null===(g=this._dataSource.slides)||void 0===g?void 0:g.length)&&void 0!==m?m:0,this.slide)}moveSlide(i,n){var r,a,o,p,m,g;let O=null!==(r=null===(a=this._dataSource.slides)||void 0===a?void 0:a.find(G=>G.id==i))&&void 0!==r?r:this._defaultSlide,_=null!==(o=null===(p=this._dataSource.slides)||void 0===p?void 0:p.indexOf(O))&&void 0!==o?o:0;null===(m=this._dataSource.slides)||void 0===m||m.splice(_+n,0,null===(g=this._dataSource.slides)||void 0===g?void 0:g.splice(_,1)[0])}deleteSlide(i){var n,r,a,o,p,m;let g=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(j=>j.id==i))&&void 0!==n?n:this._defaultSlide,O=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(g))&&void 0!==a?a:0;if(null===(p=this._dataSource.slides)||void 0===p||p.splice(O,1),null!==(m=this._dataSource.slides)&&void 0!==m&&m.length)if(O<this._slideIdx){var _,G;--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(_=null===(G=this._dataSource.slides)||void 0===G?void 0:G.length)&&void 0!==_?_:0,this.slide)}else O==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx));else this.addSlide()}deleteSlide1(i){var n,r,a,o,p;let m=null!==(n=null===(r=this._dataSource.slides)||void 0===r?void 0:r.find(O=>O.id==i))&&void 0!==n?n:this._defaultSlide,g=null!==(a=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(m))&&void 0!==a?a:0;if(m.isdeleted=!0,null!==(p=this._dataSource.slides)&&void 0!==p&&null!==(p=p.filter(O=>!O.isdeleted))&&void 0!==p&&p.length){let O=!0;for(;m.isdeleted;)O?g++:g--,this._dataSource.slides[g]?m=this._dataSource.slides[g]:O=!O;this.openSlide(m.id)}else this.addSlide()}set onChangeSlide(i){this._fnChangeSlides.push(i)}changeSlide(i,n,r,a){this._fnChangeSlides.forEach(o=>o(i,n,r,a))}set node(i){var n,r;let a=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((p,m)=>m==this._slideIdx),o=null==a?void 0:a.svg;null!=o&&o.nodes&&(null==o||o.nodes.push(i)),bt.history.push([{type:"add",from:{id:i.id},to:{id:i.id}}]),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id)}findNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((j,ht)=>ht==this._slideIdx),a=null==r?void 0:r.svg,o=(j,ht)=>{let ct=null==j?void 0:j.find(Zt=>Zt.id==i);if(ct)return ct.pid=ht,ct;let xt=0,jt=j.length||0;for(;xt<jt&&!ct&&(ct=o(j[xt].nodes||[],j[xt].id),!ct);)xt++;return ct},p=o((null==a?void 0:a.nodes)||[]);var m,g,O,_,G;return p?(p.style=null!==(m=p.style)&&void 0!==m?m:{},p.source=null!==(g=p.source)&&void 0!==g?g:{},p.animate=null!==(O=p.animate)&&void 0!==O?O:{},p.interactive=null!==(_=p.interactive)&&void 0!==_?_:{},p.variable=null!==(G=p.variable)&&void 0!==G?G:{},p):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(i){var n;let r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((m,g)=>g==this._slideIdx),a=null==r?void 0:r.svg,p=m=>{let g=(null==m?void 0:m.find(ct=>ct.id==i))||(m=>{let g=null,O=0,_=m.length||0;for(;O<_&&!g;){if(g=p(m[O].nodes),g){g.pid=m[O].id;break}O++}var G,j,ht,ct,xt;return g&&(g.style=null!==(G=g.style)&&void 0!==G?G:{},g.source=null!==(j=g.source)&&void 0!==j?j:{},g.animate=null!==(ht=g.animate)&&void 0!==ht?ht:{},g.interactive=null!==(ct=g.interactive)&&void 0!==ct?ct:{},g.variable=null!==(xt=g.variable)&&void 0!==xt?xt:{}),g})((null==m?void 0:m.filter(ct=>ct.type==A.$.GROUP))||[]);var O,_,G,j,ht;return g&&(g.style=null!==(O=g.style)&&void 0!==O?O:{},g.source=null!==(_=g.source)&&void 0!==_?_:{},g.animate=null!==(G=g.animate)&&void 0!==G?G:{},g.interactive=null!==(j=g.interactive)&&void 0!==j?j:{},g.variable=null!==(ht=g.variable)&&void 0!==ht?ht:{}),g};return p((null==a?void 0:a.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(i,n,r,a,o){var p;let m=null===(p=this._dataSource.slides)||void 0===p?void 0:p.find((_,G)=>G==this._slideIdx),g=null==m?void 0:m.svg,O=_=>{let G=[];return _.filter(j=>!j.isdeleted).forEach(j=>{j.type==A.$.GROUP?G=G.concat(O(j.nodes||[])):i>j.size.x||n>j.size.y||r<j.size.x+j.size.width||a<j.size.y+j.size.height||(o?j.type==o&&G.push(j.id):G.push(j.id))}),G};return O((null==g?void 0:g.nodes)||[])}getNodeOnArea(i,n,r,a,o){var p;let m=null===(p=this._dataSource.slides)||void 0===p?void 0:p.find((_,G)=>G==this._slideIdx),g=null==m?void 0:m.svg,O=_=>{let G=[];return _.filter(j=>!j.isdeleted).forEach(j=>{j.type==A.$.GROUP?G=G.concat(O(j.nodes||[])):j.size.x+j.size.width<i||j.size.y+j.size.height<n||j.size.x>r||j.size.y>a||(o?j.type==o&&G.push(j.id):G.push(j.id))}),G};return O((null==g?void 0:g.nodes)||[])}deleteNode(i,n){var r;return this.getNode(i).isdeleted=null==n||n,(0,qt.E)(this.slide),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),i}unGroup(i){var n,r;let a=this.getNode(i),o=Math.ceil(1e9*Math.random());return null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:o})),Object.assign(a,{isdeleted:!0}),(0,qt.E)(this.slide),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),o}addGroup(i,n){var r;let a=this.getNode(i),o=this.getNode(n);o.nodes=o.nodes||[];let p=Math.ceil(1e9*Math.random());return o.nodes.push(Object.assign(JSON.parse(JSON.stringify(a)),{id:p})),Object.assign(a,{isdeleted:!0}),(0,qt.E)(this.slide),(0,qt.E)(this.slide,null===(r=this.slide)||void 0===r?void 0:r.id),p}setNodeP(i,n){var r;let a=null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r?void 0:r.nodes.find(o=>o.id==i);a&&(a.pid=n||null)}bringToFront(i){this.bringToFrontStep(i,0)}sendToBack(i){this.sendToBackStep(i,0)}bringToFrontStep(i,n){var r,a,o,p;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((_,G)=>{_.index=G+1});let m=(null!==(a=null===(o=this.slide)||void 0===o||null===(o=o.svg)||void 0===o?void 0:o.nodes.length)&&void 0!==a?a:0)+1;var g,O;i.map(_=>{var G,j;return{id:_,index:null!==(G=null===(j=this.slide)||void 0===j||null===(j=j.svg)||void 0===j||null===(j=j.nodes.find(ht=>ht.id==_))||void 0===j?void 0:j.index)&&void 0!==G?G:0}}).sort((_,G)=>_.index-G.index).forEach(_=>{var j,G;n?null===(j=this.slide)||void 0===j||null===(j=j.svg)||void 0===j||j.nodes.filter((ht,ct)=>ht.id==_.id).forEach(ht=>{ht.index=n+_.index+_.index/1e3}):null===(G=this.slide)||void 0===G||null===(G=G.svg)||void 0===G||G.nodes.filter(ht=>ht.id==_.id).forEach(ht=>{ht.index=m+_.index})}),null===(p=this.slide)||void 0===p||null===(p=p.svg)||void 0===p||p.nodes.sort((_,G)=>{var j,ht;return(null!==(j=_.index)&&void 0!==j?j:0)-(null!==(ht=G.index)&&void 0!==ht?ht:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(g=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===g||g.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(O=window.document.getElementById(st.O.SELECT_GROUP))||void 0===O||O.remove(),(0,h.Q)(bt.dataSelect.nodes))}sendToBackStep(i,n){var r,a,o,p;null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.forEach((m,g)=>{m.index=g+1}),i.map(m=>{var g,O;return{id:m,index:null!==(g=null===(O=this.slide)||void 0===O||null===(O=O.svg)||void 0===O||null===(O=O.nodes.find(_=>_.id==m))||void 0===O?void 0:O.index)&&void 0!==g?g:0}}).sort((m,g)=>m.index-g.index).forEach(m=>{var O,g;n?null===(O=this.slide)||void 0===O||null===(O=O.svg)||void 0===O||O.nodes.filter(_=>_.id==m.id).forEach(_=>{_.index=n+m.index+m.index/1e3}):null===(g=this.slide)||void 0===g||null===(g=g.svg)||void 0===g||g.nodes.filter(_=>_.id==m.id).forEach(_=>{_.index=m.index/100-1})}),null===(a=this.slide)||void 0===a||null===(a=a.svg)||void 0===a||a.nodes.sort((m,g)=>{var O,_;return(null!==(O=m.index)&&void 0!==O?O:0)-(null!==(_=g.index)&&void 0!==_?_:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(o=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===o||o.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(p=window.document.getElementById(st.O.SELECT_GROUP))||void 0===p||p.remove(),(0,h.Q)(bt.dataSelect.nodes))}bringToFrontArea(i){var n,r;let a=i.map(ct=>bt.data.getNode(ct)).filter(ct=>!ct.isfake),{x1:o,y1:p,x2:m,y2:g}=pe(a),O=this.getNodeOnArea(o,p,m,g);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ct,xt)=>{ct.index=xt+1});let _=O.map(ct=>{var xt,jt;return null!==(xt=null===(jt=this.slide)||void 0===jt||null===(jt=jt.svg)||void 0===jt||null===(jt=jt.nodes.find(Zt=>Zt.id==ct))||void 0===jt?void 0:jt.index)&&void 0!==xt?xt:0}),G=Math.max.apply(null,_);var j,ht;i.forEach((ct,xt)=>{var jt;null===(jt=this.slide)||void 0===jt||null===(jt=jt.svg)||void 0===jt||jt.nodes.filter(Zt=>Zt.id==ct).forEach(Zt=>{Zt.index=G+(xt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ct,xt)=>{var jt,Zt;return(null!==(jt=ct.index)&&void 0!==jt?jt:0)-(null!==(Zt=xt.index)&&void 0!==Zt?Zt:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(j=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===j||j.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(ht=window.document.getElementById(st.O.SELECT_GROUP))||void 0===ht||ht.remove(),(0,h.Q)(bt.dataSelect.nodes))}sendToBackArea(i){var n,r;let a=i.map(ct=>bt.data.getNode(ct)).filter(ct=>!ct.isfake),{x1:o,y1:p,x2:m,y2:g}=pe(a),O=this.getNodeOnArea(o,p,m,g);null===(n=this.slide)||void 0===n||null===(n=n.svg)||void 0===n||n.nodes.forEach((ct,xt)=>{ct.index=xt+1});let _=O.map(ct=>{var xt,jt;return null!==(xt=null===(jt=this.slide)||void 0===jt||null===(jt=jt.svg)||void 0===jt||null===(jt=jt.nodes.find(Zt=>Zt.id==ct))||void 0===jt?void 0:jt.index)&&void 0!==xt?xt:0}),G=Math.min.apply(null,_)-1;var j,ht;i.forEach((ct,xt)=>{var jt;null===(jt=this.slide)||void 0===jt||null===(jt=jt.svg)||void 0===jt||jt.nodes.filter(Zt=>Zt.id==ct).forEach(Zt=>{Zt.index=G+(xt+1)/100})}),null===(r=this.slide)||void 0===r||null===(r=r.svg)||void 0===r||r.nodes.sort((ct,xt)=>{var jt,Zt;return(null!==(jt=ct.index)&&void 0!==jt?jt:0)-(null!==(Zt=xt.index)&&void 0!==Zt?Zt:0)}),(0,qt.T)(this.slide),i.length<=1?(null===(j=window.document.getElementById(st.O.RESIZE_GROUP))||void 0===j||j.remove(),(0,b.y)(bt.dataSelect.nodes[0])):(null===(ht=window.document.getElementById(st.O.SELECT_GROUP))||void 0===ht||ht.remove(),(0,h.Q)(bt.dataSelect.nodes))}}const pe=D=>{let i=999999,n=999999,r=-999999,a=-999999;return D.forEach(o=>{i=Math.min(i,o.size.x),n=Math.min(n,o.size.y),r=Math.max(r,o.size.x+o.size.width),a=Math.max(a,o.size.y+o.size.height)}),{x1:i,y1:n,x2:r,y2:a}};class oe{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.from.id);break;case"edit":break;case"delete":bt.data.deleteNode(n.from.id,!1);break;case"size":{let{id:r,type:a,size:o,attribute:p}=bt.data.getNode(n.from.id);Object.assign(o,n.from.size),Object.assign(p,(0,U.sg)(a,o,p)),(0,k.__)(window.document.getElementById(r),p);break}case"attribute":{let{id:r,attribute:a}=bt.data.getNode(n.from.id);Object.assign(a,n.from.attribute),(0,k.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=bt.data.getNode(n.from.id);Object.assign(null!=a?a:{},n.from.style),(0,k.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=bt.data.getNode(n.from.id);Object.assign(null!=o?o:{},n.from.source),(0,k.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.from.id);Object.assign(null!=r?r:{},n.from.variable);break}}}),bt.dataSelect.ids=[]},this.redoExecute=i=>{i.forEach(function(n){switch(n.type){case"add":bt.data.deleteNode(n.to.id,!1);break;case"edit":break;case"delete":bt.data.deleteNode(n.to.id,!0);break;case"size":{let{id:r,type:a,size:o,attribute:p}=bt.data.getNode(n.to.id);Object.assign(o,n.to.size),Object.assign(p,(0,U.sg)(a,o,p)),(0,k.__)(window.document.getElementById(r),p);break}case"attribute":{let{id:r,attribute:a}=bt.data.getNode(n.to.id);Object.assign(a,n.to.attribute),(0,k.__)(window.document.getElementById(r),a);break}case"style":{let{id:r,style:a}=bt.data.getNode(n.to.id);Object.assign(null!=a?a:{},n.to.style),(0,k.DB)(window.document.getElementById(r),a);break}case"source":{let{id:r,type:a,source:o}=bt.data.getNode(n.to.id);Object.assign(null!=o?o:{},n.to.source),(0,k.QI)(window.document.getElementById(r),a,null!=o?o:{});break}case"animate":{let{animate:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.animate);break}case"interactive":{let{interactive:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.interactive);break}case"variable":{let{variable:r}=bt.data.getNode(n.to.id);Object.assign(null!=r?r:{},n.to.variable);break}}}),bt.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(i){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:i}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:i})),this.change()}undo(){this._index<0||(this.undoExecute(this._dataSource[this._index].data),this._index--,this.change())}redo(){this._index>=this._dataSource.length-1||(this._index++,this.redoExecute(this._dataSource[this._index].data),this.change())}set onchange(i){this._fnChanges.push(i)}change(){this._fnChanges.forEach(i=>i(this.index,this.total))}}class se{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(i){this._actived=i}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(i){var n,r;this._frameSize.width=null!==(n=null==i?void 0:i.width)&&void 0!==n?n:1080,this._frameSize.height=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}get frameSize(){return this._frameSize}set frameSize(i){this._frameSize.x=i.x,this._frameSize.y=i.y,this._frameSize.width=i.width,this._frameSize.height=i.height,this.reset()}set screen(i){this._offset=i.offset,this._width=i.width,this._height=i.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(i,n,r){var a;if(!(i<.1||i>10)){if(n=null!==(a=n)&&void 0!==a?a:{x:this._width/2,y:this._height/2},r)this._dislocation.x=this._width/i/2-n.x,this._dislocation.y=this._height/i/2-n.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var o={x:Math.max(0,Math.min((0,u.q)(n.x/this._width,1e3),1)),y:Math.max(0,Math.min((0,u.q)(n.y/this._height,1e3),1))},p={x:(this._width/i-this._width/this._scale)*o.x,y:(this._height/i-this._height/this._scale)*o.y};this._dislocation.x+=p.x,this._dislocation.y+=p.y}this._scale=i,this.change(),this.zoomChange(this.scale)}}set zoomTo(i){"fit"==i?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof i&&this.scaleTo(i/100,void 0,!0)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(i,n){this._dislocation.x=i.x+n.x/this._scale,this._dislocation.y=i.y+n.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){(0,k.eb)()}set onZoomChange(i){this._fnZoomChanges.push(i)}zoomChange(i){this._fnZoomChanges.forEach(n=>n(i))}}var xe=y(644);class Qe{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){(0,xe.sV)({callback:i=>{this._fill=(null==i?void 0:i.fill)||this._fill,this._stroke=(null==i?void 0:i.stroke)||this._stroke,this._strokeWidth=(null==i?void 0:i.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==i?void 0:i.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==i?void 0:i.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){(0,xe.qp)({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(i){this._fill=i,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(i){this._stroke=i,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(i){this._strokeWidth=i,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(i){this._strokeLinecap=i}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(i){this._strokeLinejoin=i}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(i){this._fnChangeFills.push(i)}changeFill(i){this._fnChangeFills.forEach(n=>n(i)),this.saveConfig()}set onchangestroke(i){this._fnChangeStrokes.push(i)}changeStroke(i){this._fnChangeStrokes.forEach(n=>n(i)),this.saveConfig()}set onchangestrokewidth(i){this._fnChangeStrokeWidths.push(i)}changeStrokeWidth(i){this._fnChangeStrokeWidths.forEach(n=>n(i)),this.saveConfig()}}var Pe=y(70),Ve=y(5973),Je=y(4787),Ee=function(D){return D&&JSON.parse(JSON.stringify(D))},De=[{key:"FinishedTest",type:"boolean",value:!1,note:"Ho\xe0n th\xe0nh BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"T\u1ed5ng s\u1ed1 BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"S\u1ed1 BKT kh\xf4ng v\u01b0\u1ee3t qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"S\u1ed1 BKT \u0111\xe3 v\u01b0\u1ee3t qua",system:!0,readonly:!1}],Ue=[],Xe={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},Ye={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class He{constructor(){this._data_variables=Ee(De).concat(Ee(Ue)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=i=>{"function"==typeof i&&this.GetActionExecuteds.push(i)},this.OnGetActionExecuted=i=>{this.GetActionExecuteds.forEach(n=>{n(i)})},this.SetActionExecutings=[],this.FuncSetExecutings=i=>{"function"==typeof i&&this.SetActionExecutings.push(i)},this.OnSetActionExecuting=i=>{this.SetActionExecutings.forEach(n=>{n(i)})},this.SetActionExecuteds=[],this.FuncSetExecuteds=i=>{"function"==typeof i&&this.SetActionExecuteds.push(i)},this.OnSetActionExecuted=i=>{for(var n of(this.SetActionExecuteds.forEach(r=>{r(i)}),this.getCondition(i.key)||[]))n.if&&n.if.length>0&&(this.checkValueConditions(n.if)?this.setValueOperators(n.then||[]):this.setValueOperators(n.else||[]))}}renew(){this._data_variables=Ee(De).concat(Ee(Ue)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(i){if(!i)return;let n={};"string"==typeof i?n=JSON.parse(i):"object"==typeof i&&(n=i),this._data_variables=n.variables||[],this._data_conditions=n.conditions||(r=>(this._data_variables.map(a=>a.change||[]).forEach(a=>{r=r.concat(a)}),r))([]),De.forEach(r=>{var a=this._data_variables.filter(o=>o.key==r.key);a.length?a.forEach(function(o,p,m){o.type=r.type,o.readonly=r.readonly,o.system=r.system}):this._data_variables.push(r)})}getVariableTemp(){return Ee(Xe)}getConditionTemp(){return Ee(Ye)}getKeys(){return this._data_variables.map(function(i){return i.key}).sort(function(i,n){return i.localeCompare(n)})}getVariableAll(){return this._data_variables.length?Ee((D=this._data_variables,i="key",function(n){for(var r of D.map(function(a){return a[i]}).sort())D.filter(function(a){return a[i]==r}).forEach(function(a){n.push(a)}),D=D.filter(function(a){return a[i]!=r});return n}([]))):Ee(De).concat(Ee(Ue));var D,i}setVariableAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_variables=i),De.forEach(n=>{var r=this._data_variables.filter(a=>a.key==n.key);r.length?r.forEach((a,o,p)=>{a.type=n.type,a.readonly=n.readonly,a.system=n.system}):this._data_variables.push(n)}))}getVariable(i){return i?Ee(this._data_variables.filter(n=>n.key==i)[0]||{}):{}}setVariable(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(o=>o.key==i)[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(o=>o.key==i);a.length?a.forEach(function(o,p,m){o.value=n,o.type=r}):this._data_variables.push({key:i,value:n,type:r})}}getValue(i,n){if(!i)return"";var r=this._data_variables.filter(function(p){return p.key==i});if(r.length){var o,a=r[0]||{};switch(this.OnGetActionExecuting(a),n||(n=a.type||null),n){case"string":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":"string"==typeof a.value?a.value||"":a.value.toString().trim();break;case"number":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?0:"number"==typeof a.value?a.value||0:parseFloat(a.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(a.value)>=0?o=!1:"boolean"==typeof a.value?o=a.value:(o=(a.value+"").toLowerCase(),o="1"==a.value||"true"==a.value||"yes"==a.value||"dung"==a.value);break;case"audio-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></audio>`:"";break;case"video-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${a.value}"></source></video>`:"";break;case"img-src":o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value?`<img style="width:100%;vertical-align:middle;" src="${a.value}"/>`:"";break;default:o=[null,void 0,NaN,1/0].indexOf(a.value)>=0?"":a.value}return this.OnGetActionExecuted(a),o}return null}setValue(i,n,r){if(i){switch([null,void 0,NaN,1/0].indexOf(n)>=0&&(n=""),r||(r=(this._data_variables.filter(function(p){return p.key==i})[0]||{}).type||null),r){case"string":"string"!=typeof n&&(n=n.toString().trim());break;case"number":"number"!=typeof n&&(n=parseFloat(n)||0);break;case"boolean":"string"==typeof n&&(n=n.toLowerCase()),"boolean"!=typeof n&&(n="1"==n||"true"==n||"yes"==n||"dung"==n)}var a=this._data_variables.filter(function(p){return p.key==i});if(a.length){var o=a[0];this.OnSetActionExecuting(o),o&&(o.value=n),this.OnSetActionExecuted(o)}}}getConditionAll(){return Ee(this._data_conditions.sort(function(i,n){return i.idx-n.idx}))}setConditionAll(i){i&&("string"==typeof i&&(i=JSON.parse(i)),"object"==typeof i&&(this._data_conditions=i))}getCondition(i){return i?Ee(this._data_conditions.filter(n=>n.variable==i||(n.variables||[]).indexOf(i)>=0).sort(function(n,r){return n.idx-r.idx})):{}}switchCondition(i,n,r){switch(i){case"==":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})>0):n==r;case"!=":return"string"==typeof r?(r=r.toLowerCase().trim(),"string"==typeof n&&(n=n.toLowerCase().trim()),0==r.split(";").map(function(a){return n==a.trim()?1:0}).reduce(function(a,o){return a+o})):n!=r;case">=":return n>=r;case"<=":return n<=r;case">":return n>r;case"<":return n<r;case"\u2208":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o})>0;case"\u2209":return r=(r+"").toLowerCase().trim(),n=(n+"").toLowerCase().trim(),0==r.split(";").map(function(a){return n.indexOf(a.trim())>=0?1:0}).reduce(function(a,o){return a+o});default:return!1}}switchOperator(i,n,r){switch(i){case"+":return n+r;case"-":return n-r;case"*":return n*r;case"/":return n/r;case"=":return r;case"=!":return!r;case"==":return n==r;case"!=":return n!=r}}switchFormula(i,n){switch(i){case"sum":return n.reduce(function(a,o){return a+o});case"sub":return n.reduce(function(a,o){return a-o});case"pro":return n.reduce(function(a,o){return a*o});case"div":return n.reduce(function(a,o){return a/o});case"avg":var r=n.reduce(function(a,o){return a+o})/(n.length||1);return Math.round(1e4*(r+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,n);case"max":return Math.max.apply(null,n);case"and":return n.reduce(function(a,o){return a&&o});case"or":return n.reduce(function(a,o){return a||o});default:return 0}}switchValueType_Condition(i){switch(i.valuetype){case"value":return this.switchCondition(i.condition,this.getValue(i.variable),i.value);case"variable":return this.switchCondition(i.condition,this.getValue(i.variable),this.getValue(i.value));default:return 0}}switchValueType_Operator(i){switch(i.valuetype){case"value":return this.switchOperator(i.operator,this.getValue(i.variable),i.value);case"variable":return this.switchOperator(i.operator,this.getValue(i.variable),this.getValue(i.value));case"variables":var n=this.switchFormula(i.valueformula,i.value.map(r=>this.getValue(r)));return this.switchOperator(i.operator,this.getValue(i.variable),n)}}checkValueCondition(i){return this.switchValueType_Condition(i)}getValueOperator(i){return this.switchValueType_Operator(i)}setValueOperator(i){null!=i&&i.variable&&this.setValue(i.variable,this.getValueOperator(i))}checkValueConditions(i){return 0==i.map(n=>{switch(n.type){case"variable":return this.switchValueType_Condition(n)?0:1;case"variables":return 0==n.variables.map(r=>this.switchValueType_Condition(Object.assign(Ee(n),{variable:r}))?0:1).reduce(function(r,a){return r+a})?0:1;default:return 0}}).reduce((n,r)=>(null!=n?n:0)+(null!=r?r:0))}setValueOperators(i){for(var n of i)switch(n.type){case"variable":this.setValue(n.variable,this.getValueOperator(n));break;case"variables":for(var r of n.variables)this.setValue(r,this.getValueOperator(Object.assign(Ee(n),{variable:r})));break;case"slide":Pe.$.runSlide(void 0,void 0,n.slide);break;case"node":{var a;(0,Je.L5)({id:n.node,nodeStatus:Pe.$.nodeStatus,slideStatus:Pe.$.slideStatus});let o=Pe.$.findNode(n.node);null!=o&&null!==(a=o.interactive)&&void 0!==a&&a.click&&(0,Ve.F)(o,Pe.$.nodeStatus,Pe.$.slideStatus);break}}}FuncGetExecutings(i){"function"==typeof i&&this.GetActionExecutings.push(i)}OnGetActionExecuting(i){this.GetActionExecutings.forEach(n=>{n(i)})}}class Ge{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(i,n,r){if(this._pointer_type=i,n)switch(i){case C._.PEN:this._pen_type=n;break;case C._.SHAPE:this._shape_type=n,r&&n===A.$.POLYGON&&(this._polygon_type=r)}}get pointer_type(){return this._pointer_type}set pointer_type(i){this._pointer_type=i,this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(i){this._pointer_type_temp=i,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(i){this._pen_type=i,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(i){this._shape_type=i,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(i){this._polygon_type=i,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(i){this._fnChangePointerTypes.push(i)}changePointerType(i,n,r){this._fnChangePointerTypes.forEach(a=>a(i,n,r))}set onchangePointerTypeTemp(i){this._fnChangePointerTypeTemps.push(i)}changePointerTypeTemp(i,n,r){this._fnChangePointerTypeTemps.forEach(a=>a(i,n,r))}set onchangePenType(i){this._fnChangePenTypes.push(i)}changePenType(i,n,r){this._fnChangePenTypes.forEach(a=>a(i,n,r))}set onchangeShapeType(i){this._fnChangeShapeTypes.push(i)}changeShapeType(i,n,r){this._fnChangeShapeTypes.forEach(a=>a(i,n,r))}set onchangePolygonType(i){this._fnChangePolygonTypes.push(i)}changePolygonType(i,n,r){this._fnChangePolygonTypes.forEach(a=>a(i,n,r))}set onchange(i){this._fnChanges.push(i)}change(i,n,r){this._fnChanges.forEach(a=>a(i,n,r))}}const bt=new class qe{constructor(){this._container="",this._svg="",this._screen=se.prototype,this._data=ce.prototype,this._dataSelect=Ut.prototype,this._slide=Vt.prototype,this._history=oe.prototype,this._attribute=Qe.prototype,this._pointer=Ge.prototype,this._variable=He.prototype,this._data=new ce,this._dataSelect=new Ut,this._slide=new Vt,this._history=new oe,this._attribute=new Qe,this._pointer=new Ge,this._variable=new He,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._pointer.onchangePointerTypeTemp=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(i){this._config=i}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,resources:this._data.getResource,variable:this._variable.get,info:{}}}set dataSource(i){this._screen.set=i.screen||{width:1080,height:1080},this._data.set=i.data||{},this._variable.set=i.variable||{}}get container(){return this._container}set container(i){this._container=i}get svg(){return this._svg}set svg(i){this._svg=i}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var i,n,r,a,o;this._screen.screen=(i=jQuery(this._container).offset(),n=jQuery(this._container).width(),r=jQuery(this._container).height(),console.log("reloadView",JSON.stringify({offset:i,width:n,height:r})),{offset:{x:null!==(a=null==i?void 0:i.left)&&void 0!==a?a:0,y:null!==(o=null==i?void 0:i.top)&&void 0!==o?o:0},width:null!=n?n:0,height:null!=r?r:0})}init(i){this._container=i.container,this._svg=i.target,this._screen=new se,(D=>{new k.Mh(D.container,D.target),bt.pointer.onchange=(r,a,o)=>{switch(r){case C._.POINTER:jQuery(D.target).css({cursor:"auto"});break;case C._.HAND:jQuery(D.target).css({cursor:"grab"});break;case C._.PEN:switch(a){case gt.D.DRAW:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case gt.D.HIGHTLIGH:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case C._.ERASER:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case C._.SHAPE:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case C._.TEXT:case C._.FOREIGNOBJECT:jQuery(D.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}},jQuery(D.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",r=>{bt.pointer.pointer_type==C._.HAND&&jQuery(D.target).css({cursor:"grabbing"})}).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",r=>{bt.pointer.pointer_type==C._.HAND&&jQuery(D.target).css({cursor:"grab"})}),jQuery(D.container).off("mousewheel.icdt-init").on("mousewheel.icdt-init",r=>{var a;r.preventDefault();var o=bt.screen.scale,p=(null!==(a=r.originalEvent)&&void 0!==a?a:r).deltaY>0?1:-1;bt.screen.scaleTo(o-.04*o*p,(0,It.p)({x:r.clientX,y:r.clientY},1,{x:0,y:0},bt.screen.offset))}),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{bt.screen.actived=!!jQuery(r.target).parents("app-main").length}),jQuery(D.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",r=>{bt.screen.actived=!0}),jQuery(D.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",r=>{bt.screen.actived=!1,bt.pointer.pointer_type_temp==C._.HAND&&(bt.pointer.pointer_type_temp=C._.POINTER)}),jQuery(D.container).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{0==r.button&&(D.container.includes("#")&&D.container.includes(r.target.getAttribute("id"))||D.container.includes(".")&&D.container.includes(r.target.getAttribute("class"))||D.container.includes(r.target.nodeName))&&(bt.pointer.pointer_type_temp||bt.pointer.pointer_type)===C._.POINTER&&(bt.dataSelect.ids=[])}),jQuery(D.container).off("touchmove.icdt-init").on("touchmove.icdt-init",r=>{r.preventDefault()});const i=r=>{switch(bt.pointer.pointer_type_temp||bt.pointer.pointer_type){case C._.POINTER:f(r);break;case C._.HAND:(D=>{(0,yt.A)(D,new T,1,{x:0,y:0})})(r);break;case C._.PEN:(0,rt.i)(r);break;case C._.SHAPE:(D=>{var i=null;switch(bt.pointer.shape_type){case A.$.CIRCLE:i=new K;break;case A.$.ELLIPSE:i=new tt;break;case A.$.LINE:i=new Kt;break;case A.$.RECT:i=new at;break;case A.$.POLYGON:var n;i=new Ot(null===(n=w.find(r=>r.type==bt.pointer.polygon_type))||void 0===n?void 0:n.ratios);break;case A.$.FOREIGNOBJECT:i=new it;break;case A.$.IMAGE:i=new pt;break;case A.$.TEXT:case A.$.PATH:i=new Mt}i&&(0,yt.A)(D,i)})(r);break;case C._.FOREIGNOBJECT:(D=>{(0,yt.A)(D,new it)})(r);break;case C._.IMAGE:(D=>{(0,yt.A)(D,new pt)})(r);break;case C._.TEXT:(D=>{(0,yt.A)(D,new X)})(r);break;case C._.ERASER:(D=>{(0,yt.A)(D,new q)})(r);break;case C._.INDEX:(0,z.s)(r)}};let n=!1;jQuery(D.target).off("touchstart.icdt-init").on("touchstart.icdt-init",r=>{n=!0,i({touchEvent:r})}),jQuery(D.target).off("mousedown.icdt-init").on("mousedown.icdt-init",r=>{if(1!=r.button){if(n)return void(n=!1);i({mouseEvent:r})}}),D.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Et.t)(r))}),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",r=>{bt.screen.actived&&((r.ctrlKey||r.altKey)&&(r.stopPropagation(),r.preventDefault()),(0,Et.t)(r))}))})({container:i.container,target:i.target,iskeyboard:i.iskeyboard})}}},4113:(ae,Dt,y)=>{y.d(Dt,{s:()=>R,Q:()=>f});var C=y(1687),k=y(4981),st=y(4318),U=y(6816),yt=y(7492);const R=M=>{var T,A,J,w;let I=(null===(T=M.mouseEvent)||void 0===T?void 0:T.target)||(null===(A=M.touchEvent)||void 0===A?void 0:A.target),u=(null==I?void 0:I.getAttribute("id"))||"",K=null==I?void 0:I.nodeName,N=jQuery(I).parents("g[id]").attr("id")||"";if(![C.O.INDEX_GROUP].includes(N))if(null!==(J=M.mouseEvent)&&void 0!==J&&J.altKey||null!==(w=M.touchEvent)&&void 0!==w&&w.altKey||!u||u.match(/[^0-9]/)||!k.icdt.dataSelect.nodeName.includes(K)){var tt;k.icdt.dataSelect.ids.length&&(k.icdt.dataSelect.ids=[]),(0==(null===(tt=M.mouseEvent)||void 0===tt?void 0:tt.button)||M.touchEvent)&&((M,T)=>{let u=(0,yt.g1)(C.O.SCAN_GROUP,"g"),K=(0,st.bH)(0,0,1,1);(0,yt.vl)(u,K),((M,T,A,J)=>{(0,U.A)(M,{start:u=>{},move:(u,K)=>{((u,K,N,tt)=>{T=(0,st.bH)(u,K,N,tt),(0,yt.vl)(A,T)})(K[0][0],K[0][1],u.x,u.y)},end:(u,K)=>{null==A||A.remove(),k.icdt.dataSelect.ids=k.icdt.data.getNodeInArea(Math.min(K[0][0],u.x),Math.min(K[0][1],u.y),Math.max(K[0][0],u.x),Math.max(K[0][1],u.y)),J(k.icdt.dataSelect.nodes)}})})(M,K,u,T)})(M,P)}else{var et,at;let L=parseFloat(u||"0");k.icdt.dataSelect.ids=null!==(et=M.mouseEvent)&&void 0!==et&&et.shiftKey||null!==(at=M.touchEvent)&&void 0!==at&&at.shiftKey?[L].concat(k.icdt.dataSelect.ids).filter((At,Kt,Ct)=>Ct.indexOf(At)==Kt):[L],P(k.icdt.dataSelect.nodes)}},P=M=>{var T,A;let J=1;var w,I;if(M.length&&(J=Math.max.apply(null,null!==(w=null===(I=k.icdt.data.slide)||void 0===I||null===(I=I.svg)||void 0===I?void 0:I.nodes.map(K=>{var N;return null!==(N=K.idx)&&void 0!==N?N:0}))&&void 0!==w?w:[0])+1),1==M.length)M[0].idx||(M[0].idx=J,M[0].time=0);else if(M.length>=0){let K=M.map(tt=>{var et;return null!==(et=tt.idx)&&void 0!==et?et:0}).filter(tt=>tt>0),N=K.length?Math.min.apply(null,K):J;M.forEach(tt=>{var et;tt.idx=N,tt.time=null!==(et=tt.time)&&void 0!==et?et:0})}let u=(0,yt.g1)(C.O.INDEX_GROUP,"g");(0,yt.mo)(u,null!==(T=null===(A=k.icdt.data.slide)||void 0===A||null===(A=A.svg)||void 0===A?void 0:A.nodes)&&void 0!==T?T:[])},f=M=>{var T,A,J;null!=M&&null!==(T=M.svg)&&void 0!==T&&T.nodes&&M.svg.nodes.forEach(I=>{I.idx=0,I.time=null});let w=(0,yt.g1)(C.O.INDEX_GROUP,"g");(0,yt.mo)(w,null!==(A=null===(J=k.icdt.data.slide)||void 0===J||null===(J=J.svg)||void 0===J?void 0:J.nodes)&&void 0!==A?A:[])}},4578:(ae,Dt,y)=>{y.d(Dt,{h:()=>T,t:()=>A});var C=y(644),k=y(7308),st=y(968),U=y(4981),yt=y(666),b=y(3171),h=y(5226),R=y(3423),P=y(5811),f=y(3385);const T=new class M{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:k.s.Escape,fn:()=>{U.icdt.dataSelect.ids.length&&(U.icdt.dataSelect.ids=[])}},this.onchange={type:"keydown",key:k.s.Delete,fn:()=>{U.icdt.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:k.s.Space,fn:()=>{U.icdt.pointer.pointer_type_temp=st._.HAND}},this.onchange={type:"keyup",key:k.s.Space,fn:()=>{U.icdt.pointer.pointer_type_temp=st._.POINTER}},this.onchange={type:"keydown",key:k.s.ArrowLeft,fn:()=>{U.icdt.dataSelect.ids.length||U.icdt.data.backSlide()}},this.onchange={type:"keydown",key:k.s.ArrowRight,fn:()=>{U.icdt.dataSelect.ids.length||U.icdt.data.nextSlide()}},this.onchange={type:"keydown",key:k.s.ArrowLeft,fn:()=>{U.icdt.dataSelect.ids.length&&(U.icdt.dataSelect.nodes.forEach(w=>{(0,f.k6)(w,(0,P.q)(w.size.x-(0,R.v)(1)))}),1==U.icdt.dataSelect.ids.length?(0,yt.y)(U.icdt.dataSelect.nodes[0]):(0,b.Q)(U.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:k.s.ArrowRight,fn:()=>{U.icdt.dataSelect.ids.length&&(U.icdt.dataSelect.nodes.forEach(w=>{(0,f.k6)(w,(0,P.q)(w.size.x+(0,R.v)(1)))}),1==U.icdt.dataSelect.ids.length?(0,yt.y)(U.icdt.dataSelect.nodes[0]):(0,b.Q)(U.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:k.s.ArrowUp,fn:()=>{U.icdt.dataSelect.ids.length&&(U.icdt.dataSelect.nodes.forEach(w=>{(0,f.co)(w,(0,P.q)(w.size.y-(0,R.v)(1)))}),1==U.icdt.dataSelect.ids.length?(0,yt.y)(U.icdt.dataSelect.nodes[0]):(0,b.Q)(U.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:k.s.ArrowDown,fn:()=>{U.icdt.dataSelect.ids.length&&(U.icdt.dataSelect.nodes.forEach(w=>{(0,f.co)(w,(0,P.q)(w.size.y+(0,R.v)(1)))}),1==U.icdt.dataSelect.ids.length?(0,yt.y)(U.icdt.dataSelect.nodes[0]):(0,b.Q)(U.icdt.dataSelect.nodes))}},this.onchange={type:"keydown",key:k.s.Digit1,fn:w=>{w.shiftKey&&(U.icdt.reloadView(),U.icdt.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:k.s.KeyA,fn:w=>{if(w.ctrlKey){U.icdt.dataSelect.ids=U.icdt.data.getNodeAll();let I=U.icdt.dataSelect.nodes;1==I.length?(0,yt.y)(I[0]):I.length>1&&(0,b.Q)(I)}}},this.onchange={type:"keydown",key:k.s.KeyC,fn:w=>{if(w.ctrlKey){let I=U.icdt.dataSelect.nodes;I&&(0,C.yR)({params:{type:"nodes",nodes:I}})}}},this.onchange={type:"keydown",key:k.s.KeyV,fn:w=>{w.ctrlKey&&(0,C.aY)({callback:I=>{var u,K;"nodes"==(null==I?void 0:I.type)&&null!=I&&null!==(u=I.nodes)&&void 0!==u&&u.length&&(null==I||null===(K=I.nodes)||void 0===K||K.forEach(N=>{N.id=Math.ceil(1e9*Math.random()),U.icdt.data.node=N}),(0,h.E)(U.icdt.data.slide))}})}},this.onchange={type:"keydown",key:k.s.KeyZ,fn:w=>{w.ctrlKey&&w.shiftKey?U.icdt.history.redo():w.ctrlKey&&U.icdt.history.undo()}},this.onchange={type:"keydown",key:k.s.BracketLeft,fn:w=>{w.ctrlKey&&w.shiftKey?U.icdt.data.sendToBack(U.icdt.dataSelect.ids):w.ctrlKey?U.icdt.data.sendToBackStep(U.icdt.dataSelect.ids,-2):U.icdt.data.sendToBackArea(U.icdt.dataSelect.ids)}},this.onchange={type:"keydown",key:k.s.BracketRight,fn:w=>{w.ctrlKey&&w.shiftKey?U.icdt.data.bringToFront(U.icdt.dataSelect.ids):w.ctrlKey?U.icdt.data.bringToFrontStep(U.icdt.dataSelect.ids,1):U.icdt.data.bringToFrontArea(U.icdt.dataSelect.ids)}}}set onchange(w){let I=this._fnChanges.find(u=>u.eventType==w.type&&u.eventKey==w.key);I?I.fns.push(w.fn):this._fnChanges.push({eventType:w.type,eventKey:w.key,fns:[w.fn]})}change(w,I,u){var K;null===(K=this._fnChanges.find(N=>N.eventType==w&&N.eventKey==I))||void 0===K||K.fns.forEach(N=>N(u))}},A=J=>{T.change(J.type,J.keyCode||J.which||J.charCode||0,J)}},410:(ae,Dt,y)=>{y.d(Dt,{a:()=>f});var C=y(4318),k=y(8419),st=y(9054),U=y(7492),yt=y(511),b=y(3423),h=y(1687),R=y(4981),P=y(8619);class f{constructor(T,A){var J,w,I,u;let K={stroke:"#FF0000",strokeWidth:(0,b.v)(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,b.v)(8)},{element:N,attribute:tt,size:et}=(0,k.G)(Math.ceil(1e9*Math.random()),{size:A});window.document.getElementById(h.O.INTERACTIVE_GROUP).querySelectorAll("path").forEach(Ct=>null==Ct?void 0:Ct.remove()),window.document.getElementById(h.O.INTERACTIVE_GROUP).querySelectorAll("circle").forEach(Ct=>null==Ct?void 0:Ct.remove()),null===(J=window.document.getElementById(h.O.INTERACTIVE_GROUP))||void 0===J||J.appendChild(N);var at=(Ct,Mt)=>{Ct&&((_t=>{let{element:it}=(0,P._)(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==Mt?"#FF0000":"#00BA00",strokeWidth:(0,b.v)(1)},size:{x:Ct[0]-5,y:Ct[1]-5,width:10,height:10}});null===(_t=window.document.getElementById(h.O.INTERACTIVE_GROUP))||void 0===_t||_t.prepend(it)})(),((_t,it)=>{let{size:B}=null!==(_t=null!=T?T:R.icdt.dataSelect.nodes[0])&&void 0!==_t?_t:{};if(!B)return;let pt=[[Ct[0]-B.width/2,Ct[1]-B.height/2],[Ct[0]+B.width/2,Ct[1]-B.height/2],[Ct[0]+B.width/2,Ct[1]+B.height/2],[Ct[0]-B.width/2,Ct[1]+B.height/2],[Ct[0]-B.width/2,Ct[1]-B.height/2]],{element:St}=(0,k.G)(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:(0,b.v)(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:(0,b.v)(8)},size:{x:0,y:0,width:10,height:10,points:pt}});null===(it=window.document.getElementById(h.O.INTERACTIVE_GROUP))||void 0===it||it.prepend(St)})())};(0,U.__)(N,K),at(null!=A&&null!==(w=A.points)&&void 0!==w&&w.length?A.points[0]:void 0),at(null!=A&&null!==(I=A.points)&&void 0!==I&&I.length&&(null==A||null===(u=A.points)||void 0===u?void 0:u.length)>=2?A.points[A.points.length-1]:void 0);let Ot="";return{start:Ct=>{Ot=`M ${Ct.x} ${Ct.y} L ${Ct.x} ${Ct.y}`},move:(Ct,Mt)=>{((Ct,Mt)=>{Ot+=` ${Ct} ${Mt}`,N.setAttribute("d",Ot)})(Ct.x,Ct.y)},end:(Ct,Mt)=>{(Ct=>{let _t=yt.jvg().x(it=>it[0]).y(it=>it[1]).curve(yt.$0Z)(Ct);N.setAttribute("d",_t),Ct.length>=2&&(window.interactivePoints=Ct)})(Mt),(Ct=>{let Mt=9999,_t=9999,it=-9999,B=-9999;Ct.forEach(pt=>{Mt=Math.min(Mt,pt[0]),_t=Math.min(_t,pt[1]),it=Math.max(it,pt[0]),B=Math.max(B,pt[1])}),et=(0,C.bH)(Mt,_t,it,B,{points:Ct}),Object.assign(tt,(0,C.sg)(st.$.PATH,et,tt),K)})(Mt),at(Mt.length?Mt[0]:void 0,"start"),at(Mt.length>=2?Mt[Mt.length-1]:void 0,"end")}}}}},9623:(ae,Dt,y)=>{y.d(Dt,{U:()=>J,i:()=>A});var C=y(1687),k=y(9125),st=y(4981),U=y(6816),yt=y(7492),b=y(4318),h=y(8419),R=y(9054),P=y(511);class f{constructor(){let I={strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:u,element:K,attribute:N,size:tt}=(0,h.G)(Math.ceil(1e9*Math.random()));(0,yt.__)(K,N);let at="";return{start:At=>{at=`M ${At.x} ${At.y} L ${At.x} ${At.y}`},move:(At,Kt)=>{((At,Kt)=>{at+=` ${At} ${Kt}`,K.setAttribute("d",at)})(At.x,At.y)},end:(At,Kt)=>{(At=>{let Ct=P.jvg().x(Mt=>Mt[0]).y(Mt=>Mt[1]).curve(P.$0Z)(At);K.setAttribute("d",Ct)})(Kt),(At=>{let Kt=9999,Ct=9999,Mt=-9999,_t=-9999;At.forEach(it=>{Kt=Math.min(Kt,it[0]),Ct=Math.min(Ct,it[1]),Mt=Math.max(Mt,it[0]),_t=Math.max(_t,it[1])}),tt=(0,b.bH)(Kt,Ct,Mt,_t,{points:At}),Object.assign(N,(0,b.sg)(R.$.PATH,tt,N),I)})(Kt),st.icdt.data.node=Object.assign({id:u,type:R.$.PATH,name:"Path"},{size:tt,attribute:N})}}}}class M{constructor(){let I={strokeOpacity:.4,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:u,element:K,attribute:N,size:tt}=(0,h.G)(Math.ceil(1e9*Math.random()));(0,yt.__)(K,N);let at="";var L=(Ot,At)=>{at+=` ${Ot} ${At}`,K.setAttribute("d",at)};return{start:Ot=>{at=`M ${Ot.x} ${Ot.y} L ${Ot.x} ${Ot.y}`},move:(Ot,At)=>{L(Ot.x,Ot.y)},end:(Ot,At)=>{L(Ot.x,Ot.y),(Ot=>{let At=9999,Kt=9999,Ct=-9999,Mt=-9999;Ot.forEach(_t=>{At=Math.min(At,_t[0]),Kt=Math.min(Kt,_t[1]),Ct=Math.max(Ct,_t[0]),Mt=Math.max(Mt,_t[1])}),tt=(0,b.bH)(At,Kt,Ct,Mt,{points:Ot}),Object.assign(N,(0,b.sg)(R.$.PATH,tt,N),I)})(At),st.icdt.data.node=Object.assign({id:u,type:R.$.PATH,name:"Path"},{size:tt,attribute:N})}}}}var T=y(410);const A=w=>{switch(st.icdt.pointer.pen_type){case k.D.DRAW:(0,U.A)(w,new f);break;case k.D.HIGHTLIGH:(0,U.A)(w,new M);break;case k.D.INTERACTIVE:J(w)}},J=w=>{var I,u;let K=(0,yt.g1)(C.O.INTERACTIVE_GROUP,"g"),N=null!==(I=null===(u=st.icdt.data.slide)||void 0===u||null===(u=u.svg)||void 0===u?void 0:u.viewBox)&&void 0!==I?I:(()=>{let{width:tt,height:et}=st.icdt.screen.get;return{x:0,y:0,width:tt,height:et}})();(0,yt.XH)(K,N),w&&(0,U.A)(w,new T.a)}},666:(ae,Dt,y)=>{y.d(Dt,{y:()=>h});var C=y(1687),k=y(4981),st=y(4318),U=y(6816),yt=y(7492),b=y(5811);const h=f=>{let M=(0,yt.g1)(C.O.RESIZE_GROUP,"g");(0,yt.hJ)(M,f).forEach(T=>{R(T.element,T.posType,f,M)})},R=(f,M,T,A)=>{let J=!1;null==f||f.addEventListener("touchstart",w=>{J=!0,P({touchEvent:w},M,T,A)}),null==f||f.addEventListener("mousedown",w=>{if(0==w.button){if(J)return void(J=!1);P({mouseEvent:w},M,T,A)}})},P=(f,M,T,A)=>{let L,{id:J,type:w,size:I,attribute:u}=T,{x:K,y:N,width:tt,height:et}=I,at=(tt||1)/(et||1),At=null,Mt=!1;(0,U.A)(f,{start:it=>{At=JSON.parse(JSON.stringify({id:J,size:I,attribute:u}))},move:(it,B)=>{((it,B,pt,St)=>{let Et=pt-it,rt=St-B;switch(M){case"rect-center":var $t,V;L=null!==($t=f.mouseEvent)&&void 0!==$t&&$t.shiftKey||null!==(V=f.touchEvent)&&void 0!==V&&V.shiftKey?Math.abs(pt-it)>=Math.abs(St-B)?{x:K+pt-it,y:N,width:tt,height:et}:{x:K,y:N+St-B,width:tt,height:et}:{x:K+pt-it,y:N+St-B,width:tt,height:et};break;case"rect-top-left":var Z,d,lt,wt,Tt,Lt,Qt,Ht;L=(null!==(Z=f.mouseEvent)&&void 0!==Z&&Z.shiftKey||null!==(d=f.touchEvent)&&void 0!==d&&d.shiftKey)&&(null!==(lt=f.mouseEvent)&&void 0!==lt&&lt.altKey||null!==(wt=f.touchEvent)&&void 0!==wt&&wt.altKey)?at>=1?{x:K+(pt-it),y:N+(pt-it)/at,width:tt-2*(pt-it),height:et-2*(pt-it)/at}:{x:K+(St-B)*at,y:N+(St-B),width:tt-2*(St-B)*at,height:et-2*(St-B)}:null!==(Tt=f.mouseEvent)&&void 0!==Tt&&Tt.shiftKey||null!==(Lt=f.touchEvent)&&void 0!==Lt&&Lt.shiftKey?at>=1?{x:K+(pt-it),y:N+(pt-it)/at,width:tt-(pt-it),height:et-(pt-it)/at}:{x:K+(St-B)*at,y:N+(St-B),width:tt-(St-B)*at,height:et-(St-B)}:null!==(Qt=f.mouseEvent)&&void 0!==Qt&&Qt.altKey||null!==(Ht=f.touchEvent)&&void 0!==Ht&&Ht.altKey?{x:K+(pt-it),y:N+(St-B),width:tt-2*(pt-it),height:et-2*(St-B)}:{x:K+(pt-it),y:N+(St-B),width:tt-(pt-it),height:et-(St-B)};break;case"rect-top-right":var Pt,vt,te,Y,v,q,ut,dt;L=(null!==(Pt=f.mouseEvent)&&void 0!==Pt&&Pt.shiftKey||null!==(vt=f.touchEvent)&&void 0!==vt&&vt.shiftKey)&&(null!==(te=f.mouseEvent)&&void 0!==te&&te.altKey||null!==(Y=f.touchEvent)&&void 0!==Y&&Y.altKey)?at>=1?{x:K-(pt-it),y:N-(pt-it)/at,width:tt+2*(pt-it),height:et+2*(pt-it)/at}:{x:K+(St-B)*at,y:N+(St-B),width:tt-2*(St-B)*at,height:et-2*(St-B)}:null!==(v=f.mouseEvent)&&void 0!==v&&v.shiftKey||null!==(q=f.touchEvent)&&void 0!==q&&q.shiftKey?at>=1?{x:K,y:N-(pt-it)/at,width:tt+(pt-it),height:et+(pt-it)/at}:{x:K,y:N+(St-B),width:tt-(St-B)*at,height:et-(St-B)}:null!==(ut=f.mouseEvent)&&void 0!==ut&&ut.altKey||null!==(dt=f.touchEvent)&&void 0!==dt&&dt.altKey?{x:K-(pt-it),y:N+(St-B),width:tt+2*(pt-it),height:et-2*(St-B)}:{x:K,y:N+(St-B),width:tt+(pt-it),height:et-(St-B)};break;case"rect-bottom-left":var X,Q,H,x,z,gt,It,mt;L=(null!==(X=f.mouseEvent)&&void 0!==X&&X.shiftKey||null!==(Q=f.touchEvent)&&void 0!==Q&&Q.shiftKey)&&(null!==(H=f.mouseEvent)&&void 0!==H&&H.altKey||null!==(x=f.touchEvent)&&void 0!==x&&x.altKey)?at>=1?{x:K+(pt-it),y:N+(pt-it)/at,width:tt-2*(pt-it),height:et-2*(pt-it)/at}:{x:K-(St-B)*at,y:N-(St-B),width:tt+2*(St-B)*at,height:et+2*(St-B)}:null!==(z=f.mouseEvent)&&void 0!==z&&z.shiftKey||null!==(gt=f.touchEvent)&&void 0!==gt&&gt.shiftKey?at>=1?{x:K+(pt-it),y:N,width:tt-(pt-it),height:et-(pt-it)/at}:{x:K-(St-B)*at,y:N,width:tt+(St-B)*at,height:et+(St-B)}:null!==(It=f.mouseEvent)&&void 0!==It&&It.altKey||null!==(mt=f.touchEvent)&&void 0!==mt&&mt.altKey?{x:K+(pt-it),y:N-(St-B),width:tt-2*(pt-it),height:et+2*(St-B)}:{x:K+(pt-it),y:N,width:tt-(pt-it),height:et+(St-B)};break;case"rect-bottom-right":var Rt,Ut,Wt,Vt,qt,ce,pe,oe;L=(null!==(Rt=f.mouseEvent)&&void 0!==Rt&&Rt.shiftKey||null!==(Ut=f.touchEvent)&&void 0!==Ut&&Ut.shiftKey)&&(null!==(Wt=f.mouseEvent)&&void 0!==Wt&&Wt.altKey||null!==(Vt=f.touchEvent)&&void 0!==Vt&&Vt.altKey)?at>=1?{x:K-(pt-it),y:N-(pt-it)/at,width:tt+2*(pt-it),height:et+2*(pt-it)/at}:{x:K-(St-B)*at,y:N-(St-B),width:tt+2*(St-B)*at,height:et+2*(St-B)}:null!==(qt=f.mouseEvent)&&void 0!==qt&&qt.shiftKey||null!==(ce=f.touchEvent)&&void 0!==ce&&ce.shiftKey?at>=1?{x:K,y:N,width:tt+(pt-it),height:et+(pt-it)/at}:{x:K,y:N,width:tt+(St-B)*at,height:et+(St-B)}:null!==(pe=f.mouseEvent)&&void 0!==pe&&pe.altKey||null!==(oe=f.touchEvent)&&void 0!==oe&&oe.altKey?{x:K-(pt-it),y:N-(St-B),width:tt+2*(pt-it),height:et+2*(St-B)}:{x:K,y:N,width:tt+(pt-it),height:et+(St-B)};break;case"rect-top":var se,xe,Qe,Pe;L=null!==(se=f.mouseEvent)&&void 0!==se&&se.shiftKey||null!==(xe=f.touchEvent)&&void 0!==xe&&xe.shiftKey?{x:K+rt/2*at,y:N+rt,width:tt-rt*at,height:et-rt}:null!==(Qe=f.mouseEvent)&&void 0!==Qe&&Qe.altKey||null!==(Pe=f.touchEvent)&&void 0!==Pe&&Pe.altKey?{x:K,y:N+rt,width:tt,height:et-2*rt}:{x:K,y:N+rt,width:tt,height:et-rt};break;case"rect-bottom":var Ve,Je,ei,Ee;L=null!==(Ve=f.mouseEvent)&&void 0!==Ve&&Ve.shiftKey||null!==(Je=f.touchEvent)&&void 0!==Je&&Je.shiftKey?{x:K-rt/2*at,y:N,width:tt+rt*at,height:et+rt}:null!==(ei=f.mouseEvent)&&void 0!==ei&&ei.altKey||null!==(Ee=f.touchEvent)&&void 0!==Ee&&Ee.altKey?{x:K,y:N-rt,width:tt,height:et+2*rt}:{x:K,y:N,width:tt,height:et+rt};break;case"rect-left":var Ze,De,Ue,Xe;L=null!==(Ze=f.mouseEvent)&&void 0!==Ze&&Ze.shiftKey||null!==(De=f.touchEvent)&&void 0!==De&&De.shiftKey?{x:K+Et,y:N+Et/2/at,width:tt-Et,height:et-Et/at}:null!==(Ue=f.mouseEvent)&&void 0!==Ue&&Ue.altKey||null!==(Xe=f.touchEvent)&&void 0!==Xe&&Xe.altKey?{x:K+Et,y:N,width:tt-2*Et,height:et}:{x:K+Et,y:N,width:tt-Et,height:et};break;case"rect-right":var Ye,He,Ge,qe;L=null!==(Ye=f.mouseEvent)&&void 0!==Ye&&Ye.shiftKey||null!==(He=f.touchEvent)&&void 0!==He&&He.shiftKey?{x:K,y:N-Et/2/at,width:tt+Et,height:et+Et/at}:null!==(Ge=f.mouseEvent)&&void 0!==Ge&&Ge.altKey||null!==(qe=f.touchEvent)&&void 0!==qe&&qe.altKey?{x:K-Et,y:N,width:tt+2*Et,height:et}:{x:K,y:N,width:tt+Et,height:et};break;default:L={x:K+pt-it,y:N+St-B,width:tt,height:et}}L.width<0&&(L.width=0),L.height<0&&(L.height=0),L.x=(0,b.q)(L.x),L.y=(0,b.q)(L.y),L.width=(0,b.q)(L.width),L.height=(0,b.q)(L.height),Object.assign(I,L),Object.assign(u,(0,st.sg)(w,I,u)),(0,yt.__)(window.document.getElementById(J),u),(0,yt.hJ)(A,T)})(B[0][0],B[0][1],it.x,it.y),Mt=!0},end:(it,B)=>{Mt&&At&&k.icdt.history.push([{type:"size",from:At,to:JSON.parse(JSON.stringify({id:J,size:I,attribute:u}))}])}})}},3171:(ae,Dt,y)=>{y.d(Dt,{Q:()=>h});var C=y(1687),k=y(4981),st=y(4318),U=y(6816),yt=y(7492),b=y(5811);const h=f=>{let M=999999,T=999999,A=-999999,J=-999999;null==f||f.forEach(u=>{M=Math.min(M,u.size.x),T=Math.min(T,u.size.y),A=Math.max(A,u.size.x+u.size.width),J=Math.max(J,u.size.y+u.size.height)});let w=(0,yt.g1)(C.O.SELECT_GROUP,"g"),I=(0,st.bH)(M,T,A,J);(0,yt.yD)(w,f,I).forEach(u=>{R(u.element,u.posType,I,f,w)})},R=(f,M,T,A,J)=>{let w=!1;null==f||f.addEventListener("touchstart",I=>{w=!0,P({touchEvent:I},M,T,A,J)}),null==f||f.addEventListener("mousedown",I=>{if(0==I.button){if(w)return void(w=!1);P({mouseEvent:I},M,T,A,J)}})},P=(f,M,T,A,J)=>{let{x:w,y:I,width:u,height:K}=T,N=A.map(At=>Object.assign({},At.size)),et=[];(0,U.A)(f,{start:At=>{A.forEach((At,Kt)=>{let{id:Ct,size:_t,attribute:it}=At;et.push(JSON.parse(JSON.stringify({id:Ct,size:_t,attribute:it})))})},move:(At,Kt)=>{((At,Kt,Ct,Mt)=>{(()=>{let _t;_t="rect-center"===M?{x:w+Ct-At,y:I+Mt-Kt,width:u,height:K}:{x:w,y:I,width:u,height:K},_t.width<0&&(_t.width=0),_t.height<0&&(_t.height=0),Object.assign(T,_t),(0,yt.yD)(J,A,T)})(),A.forEach((_t,it)=>{let d,{x:B,y:pt,width:St,height:Et}=N[it],{id:rt,type:$t,size:V,attribute:Z}=_t;d="rect-center"===M?{x:B+Ct-At,y:pt+Mt-Kt,width:St,height:Et}:{x:B,y:pt,width:St,height:Et},d.width<0&&(d.width=0),d.height<0&&(d.height=0),d.x=(0,b.q)(d.x),d.y=(0,b.q)(d.y),d.width=(0,b.q)(d.width),d.height=(0,b.q)(d.height),Object.assign(V,d),Object.assign(Z,(0,st.sg)($t,V,Z)),(0,yt.__)(window.document.getElementById(rt),Z)})})(Kt[0][0],Kt[0][1],At.x,At.y)},end:(At,Kt)=>{et.length&&k.icdt.history.push(A.map((At,Kt)=>{let{id:Ct,size:_t,attribute:it}=At;return{type:"size",from:et[Kt],to:JSON.parse(JSON.stringify({id:Ct,size:_t,attribute:it}))}}))}})}},5226:(ae,Dt,y)=>{y.d(Dt,{E:()=>w,T:()=>I});var C=y(1687),k=y(8619),st=y(8785),U=y(2282),yt=y(8054),b=y(4921),h=y(6358),R=y(9054),P=y(8419),f=y(1105),M=y(2875),T=y(7210),A=y(4981),J=y(7492);const w=(u,K,N)=>{var tt;if(K&&!(null!=N?N:window).document.getElementById(K))return;if("localhost"==location.hostname&&console.log("\xe1\xe1\xe1\xe1\xe1\xe1 s\u1ee3 qu\xe1 \u0111iiiiiiiiiiiiiiiiiiiiiiiiiii!",K),K){let at=(null!=N?N:window).document.getElementById(K);jQuery(at).find("#"+C.O.BACKGROUND_GROUP).empty();let L=(0,J.g1)(C.O.BACKGROUND_GROUP,"g",void 0,at);(0,J.x0)(L,u)}else{jQuery(A.icdt.target).find("#"+C.O.BACKGROUND_GROUP).empty();let at=(0,J.g1)(C.O.BACKGROUND_GROUP,"g",void 0,A.icdt.target);(0,J.x0)(at,u)}let et=(at,L)=>{L=K&&L?`${K}-${L}`:null!=K?K:L,null==at||at.forEach(Ot=>{let At=K?`${K}-${Ot.id}`:Ot.id;var Kt;if(Ot.isdeleted)null===(Kt=(null!=N?N:window).document.getElementById(At))||void 0===Kt||Kt.remove();else switch(Ot.type){case R.$.GROUP:(0,h.m)(At,{},L?(null!=N?N:window).document.getElementById(L):null),et(Ot.nodes,Ot.id);break;case R.$.CIRCLE:(0,k._)(At,{size:Ot.size,attribute:Ot.attribute},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.ELLIPSE:(0,st.r)(At,{size:Ot.size,attribute:Ot.attribute},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.LINE:(0,b.W)(At,{size:Ot.size,attribute:Ot.attribute},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.RECT:(0,yt.f)(At,{size:Ot.size,attribute:Ot.attribute},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.POLYGON:(0,U.l)(At,{size:Ot.size,attribute:Ot.attribute},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.FOREIGNOBJECT:(0,M.e)(At,{size:Ot.size,attribute:Ot.attribute,style:Ot.style,source:Ot.source},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.IMAGE:(0,T.G)(At,{size:Ot.size,attribute:Ot.attribute,source:Ot.source},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.TEXT:(0,f.$)(At,{size:Ot.size,attribute:Ot.attribute,source:Ot.source},L?(null!=N?N:window).document.getElementById(L):null);break;case R.$.PATH:(0,P.G)(At,{size:Ot.size,attribute:Ot.attribute},L?(null!=N?N:window).document.getElementById(L):null)}})};et(null==u||null===(tt=u.svg)||void 0===tt?void 0:tt.nodes)},I=(u,K)=>{var N;if(K&&!window.document.getElementById(K))return;let tt=(et,at)=>{at=at?`${K}-${at}`:K,null==et||et.forEach(L=>{jQuery("#"+(K?`${K}-${L.id}`:L.id)).appendTo(at?window.document.getElementById(at):A.icdt.target),L.type==R.$.GROUP&&tt(L.nodes,L.id)})};tt(null==u||null===(N=u.svg)||void 0===N?void 0:N.nodes)}},8619:(ae,Dt,y)=>{y.d(Dt,{_:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:k.icdt.attribute.fill,stroke:k.icdt.attribute.stroke,strokeWidth:k.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(C.$.CIRCLE,P,f)),{nodeId:b,element:(0,U.it)(b,C.$.CIRCLE,"circle",{size:P,attribute:f},R),size:P,attribute:f}}},8785:(ae,Dt,y)=>{y.d(Dt,{r:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:k.icdt.attribute.fill,stroke:k.icdt.attribute.stroke,strokeWidth:k.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(C.$.ELLIPSE,P,f)),{nodeId:b,element:(0,U.it)(b,C.$.ELLIPSE,"ellipse",{size:P,attribute:f},R),size:P,attribute:f}}},2875:(ae,Dt,y)=>{y.d(Dt,{e:()=>U});var C=y(9054),k=y(4318),st=y(7492);const U=(yt,b,h)=>{let R=(null==b?void 0:b.size)||{x:0,y:0,width:180,height:180},P=(null==b?void 0:b.attribute)||{};Object.assign(P,(0,k.sg)(C.$.FOREIGNOBJECT,R,P));let f=(null==b?void 0:b.source)||{type:"html",html:{htmlContent:'<span style="font-family: Roboto; font-size: 24px;">H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!</span>'}},M=(null==b?void 0:b.style)||{};return{nodeId:yt,element:(0,st.it)(yt,C.$.FOREIGNOBJECT,"foreignObject",{size:R,attribute:P,style:M,source:f},h),size:R,attribute:P,style:M,source:f}}},6358:(ae,Dt,y)=>{y.d(Dt,{m:()=>U});var C=y(9054),k=y(4318),st=y(7492);const U=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{};return Object.assign(f,(0,k.sg)(C.$.GROUP,P,f)),{nodeId:b,element:(0,st.it)(b,C.$.GROUP,"g",{size:P,attribute:f},R),size:P,attribute:f}}},7210:(ae,Dt,y)=>{y.d(Dt,{G:()=>U});var C=y(9054),k=y(4318),st=y(7492);const U=(yt,b,h)=>{let R=(null==b?void 0:b.size)||{x:0,y:0,width:100,height:100},P=(null==b?void 0:b.attribute)||{preserveAspectRatio:"none"};Object.assign(P,(0,k.sg)(C.$.IMAGE,R,P));let f=(null==b?void 0:b.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:yt,element:(0,st.it)(yt,C.$.IMAGE,"image",{size:R,attribute:P,source:f},h),size:R,attribute:P,source:f}}},4921:(ae,Dt,y)=>{y.d(Dt,{W:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{stroke:k.icdt.attribute.stroke,strokeWidth:k.icdt.attribute.strokeWidth,strokeLinecap:k.icdt.attribute.strokeLinecap};return Object.assign(f,(0,st.sg)(C.$.LINE,P,f)),{nodeId:b,element:(0,U.it)(b,C.$.LINE,"line",{size:P,attribute:f},R),size:P,attribute:f}}},8419:(ae,Dt,y)=>{y.d(Dt,{G:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{stroke:k.icdt.attribute.stroke,strokeWidth:k.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(C.$.PATH,P,f)),{nodeId:b,element:(0,U.it)(b,C.$.PATH,"path",{size:P,attribute:f},R),size:P,attribute:f}}},2282:(ae,Dt,y)=>{y.d(Dt,{l:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:k.icdt.attribute.fill,stroke:k.icdt.attribute.stroke,strokeWidth:k.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(C.$.POLYGON,P,f)),{nodeId:b,element:(0,U.it)(b,C.$.POLYGON,"polygon",{size:P,attribute:f},R),size:P,attribute:f}}},8054:(ae,Dt,y)=>{y.d(Dt,{f:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:10,height:10},f=(null==h?void 0:h.attribute)||{fill:k.icdt.attribute.fill,stroke:k.icdt.attribute.stroke,strokeWidth:k.icdt.attribute.strokeWidth};return Object.assign(f,(0,st.sg)(C.$.RECT,P,f)),{nodeId:b,element:(0,U.it)(b,C.$.RECT,"rect",{size:P,attribute:f},R),size:P,attribute:f}}},1105:(ae,Dt,y)=>{y.d(Dt,{$:()=>yt});var C=y(9054),k=y(4981),st=y(4318),U=y(7492);const yt=(b,h,R)=>{let P=(null==h?void 0:h.size)||{x:0,y:0,width:100,height:50},f=(null==h?void 0:h.attribute)||{fill:k.icdt.attribute.stroke,fontFamily:k.icdt.attribute.fontFamily,fontSize:k.icdt.attribute.fontSize,textLength:k.icdt.attribute.textLength};Object.assign(f,(0,st.sg)(C.$.TEXT,P,f));let M=(null==h?void 0:h.source)||{type:"text",text:{textContent:"H\xe3y nh\u1eadp n\u1ed9i dung c\u1ee7a b\u1ea1n!"}};return{nodeId:b,element:(0,U.it)(b,C.$.TEXT,"text",{size:P,attribute:f,source:M},R),size:P,attribute:f,source:M}}},4318:(ae,Dt,y)=>{y.d(Dt,{bH:()=>st,sg:()=>U});var C=y(9054),k=y(7851);const st=(b,h,R,P,f)=>{let M={x:Math.min(b,R),y:Math.min(h,P),width:Math.abs(R-b)||1,height:Math.abs(P-h)||1};return null!=f&&f.ratio&&(M.width<=M.height?M.height=M.width*(null==f?void 0:f.ratio):M.width=M.height/(null==f?void 0:f.ratio)),Object.assign(M,{ratios:(null==f?void 0:f.ratios)||[[(b-M.x)/(M.width||1),(h-M.y)/(M.height||1)],[(R-M.x)/(M.width||1),(P-M.y)/(M.height||1)]]}),null!=f&&f.points&&(M.points=null==f?void 0:f.points),M},U=(b,h,R)=>{var P=(()=>{switch(b){case C.$.CIRCLE:return{cx:h.x+h.width/2,cy:h.y+h.height/2,r:Math.min(h.width/2,h.height/2)};case C.$.ELLIPSE:return{cx:h.x+h.width/2,cy:h.y+h.height/2,rx:h.width/2,ry:h.height/2};case C.$.LINE:{var f;let w={};return null===(f=h.ratios)||void 0===f||f.forEach((I,u)=>{w[`x${u+1}`]=h.x+h.width*I[0],w[`y${u+1}`]=h.y+h.height*I[1]}),w}case C.$.RECT:case C.$.FOREIGNOBJECT:case C.$.IMAGE:return{x:h.x,y:h.y,width:h.width,height:h.height};case C.$.TEXT:var M;return{x:h.x,y:h.y+(null!==(M=R.fontSize)&&void 0!==M?M:16)};case C.$.POLYGON:var T;if(null!==(T=h.ratios)&&void 0!==T&&T.length)return{points:(0,k.Q8)(h,h.ratios)};break;case C.$.PATH:var A,J;if(null!==(A=h.ratioMaps)&&void 0!==A&&A.length)return{d:(0,k.BG)(h,h.ratioMaps)};if(null!==(J=h.points)&&void 0!==J&&J.length)return{d:`M ${(w=h.points)[0][0]} ${w[0][1]} L ${(w.map(I=>[I[0],I[1]])||[]).map(I=>I.join(" ")).join(" ")}`}}var w;return{}})();return h.rotate&&(P.transform=`rotate(${h.rotate})`,P.transformOrigin=`${h.x+h.width/2} ${h.y+h.height/2}`),P}},5811:(ae,Dt,y)=>{y.d(Dt,{q:()=>C});const C=(k,st)=>{var U;return st=null!==(U=st)&&void 0!==U?U:100,Math.round((k+Number.EPSILON)*st)/st}},3423:(ae,Dt,y)=>{y.d(Dt,{v:()=>st});var C=y(4981),k=y(5811);const st=U=>(0,k.q)(U/C.icdt.screen.scale)},3385:(ae,Dt,y)=>{y.d(Dt,{Vs:()=>R,co:()=>b,k6:()=>yt,lO:()=>h,mr:()=>P});var C=y(4981),k=y(7492),st=y(4318),U=y(5811);const yt=(f,M)=>{let{id:T,type:A,size:J,attribute:w}=f,I=JSON.parse(JSON.stringify({id:T,size:J,attribute:w}));J.x=(0,U.q)(M),Object.assign(w,(0,st.sg)(A,J,w)),(0,k.__)(window.document.getElementById(T),w),C.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:T,size:J,attribute:w}))}])},b=(f,M)=>{let{id:T,type:A,size:J,attribute:w}=f,I=JSON.parse(JSON.stringify({id:T,size:J,attribute:w}));J.y=(0,U.q)(M),Object.assign(w,(0,st.sg)(A,J,w)),(0,k.__)(window.document.getElementById(T),w),C.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:T,size:J,attribute:w}))}])},h=(f,M,T)=>{let{id:A,type:J,size:w,attribute:I}=f,u=JSON.parse(JSON.stringify({id:A,size:w,attribute:I}));T&&(w.height=(0,U.q)(M*w.height/w.width)),w.width=(0,U.q)(M),Object.assign(I,(0,st.sg)(J,w,I)),(0,k.__)(window.document.getElementById(A),I),C.icdt.history.push([{type:"size",from:u,to:JSON.parse(JSON.stringify({id:A,size:w,attribute:I}))}])},R=(f,M,T)=>{let{id:A,type:J,size:w,attribute:I}=f,u=JSON.parse(JSON.stringify({id:A,size:w,attribute:I}));T&&(w.width=(0,U.q)(M*w.width/w.height)),w.height=(0,U.q)(M),Object.assign(I,(0,st.sg)(J,w,I)),(0,k.__)(window.document.getElementById(A),I),C.icdt.history.push([{type:"size",from:u,to:JSON.parse(JSON.stringify({id:A,size:w,attribute:I}))}])},P=(f,M)=>{let{id:T,type:A,size:J,attribute:w}=f,I=JSON.parse(JSON.stringify({id:T,size:J,attribute:w}));J.rotate=(0,U.q)(M),Object.assign(w,(0,st.sg)(A,J,w)),(0,k.__)(window.document.getElementById(T),w),C.icdt.history.push([{type:"size",from:I,to:JSON.parse(JSON.stringify({id:T,size:J,attribute:w}))}])}},6816:(ae,Dt,y)=>{y.d(Dt,{A:()=>b});var C=y(968),k=y(4981);class st{constructor(R){this._points=[],this._options=R}start(R){this._points.length=0,this._points.push([R.x,R.y]),this._options.start(R)}move(R){this._points.push([R.x,R.y]),this._options.move(R,this._points)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(R=this._points[0])[0],y:R[1]}:{x:0,y:0};var R}get offsetLast(){return this._points.length>=1?{x:(R=this._points[this._points.length-1])[0],y:R[1]}:{x:0,y:0};var R}}var U=y(7797);const b=(h,R,P,f,M)=>{var T,A,J;let w=null,I=0,u=0;h.mouseEvent?(w=h.mouseEvent.target,I=h.mouseEvent.offsetX,u=h.mouseEvent.offsetY):h.touchEvent&&(w=h.touchEvent.target,h.touchEvent.touches.length&&(I=h.touchEvent.touches[0].clientX,u=h.touchEvent.touches[0].clientY));let K=null!=P?P:k.icdt.screen.scale,N=null!=f?f:k.icdt.screen.dislocation,tt=null!=M?M:k.icdt.screen.offset,et=()=>{};var at=new st({start:null!==(T=null==R?void 0:R.start)&&void 0!==T?T:et,move:null!==(A=null==R?void 0:R.move)&&void 0!==A?A:et,end:null!==(J=null==R?void 0:R.end)&&void 0!==J?J:et});h.mouseEvent?at.start((0,U.p)({x:I,y:u},K,N,{x:0,y:0})):h.touchEvent&&at.start((0,U.p)({x:I,y:u},K,N,tt));let L=it=>{at.move((0,U.p)({x:it.clientX,y:it.clientY},K,N,tt))},Ot=it=>{at.end(),[C._.SHAPE,C._.FOREIGNOBJECT,C._.IMAGE,C._.TEXT].includes(k.icdt.pointer.pointer_type)&&(it.shiftKey||(k.icdt.pointer.pointer_type=C._.POINTER))},At=it=>{it.touches.length&&L({clientX:it.touches[0].clientX,clientY:it.touches[0].clientY})},Kt=it=>{Ot({shiftKey:it.shiftKey,ctrlKey:it.ctrlKey,altKey:it.altKey}),window.removeEventListener("touchmove",At,!1),window.removeEventListener("touchend",Kt,!1)},Ct=it=>{0==it.button&&L({clientX:it.clientX,clientY:it.clientY})},Mt=it=>{0==it.button&&(Ot({shiftKey:it.shiftKey,ctrlKey:it.ctrlKey,altKey:it.altKey}),window.removeEventListener("mousemove",Ct,!1),window.removeEventListener("mouseup",Mt,!1))};if(h.mouseEvent)window.addEventListener("mousemove",Ct,!1),window.addEventListener("mouseup",Mt,!1);else if(h.touchEvent){var _t;window.addEventListener("touchmove",At,!1),window.addEventListener("touchend",Kt,!1),null===(_t=w)||void 0===_t||_t.addEventListener("touchmove",function(it){it.preventDefault()})}}},7797:(ae,Dt,y)=>{y.d(Dt,{p:()=>k});var C=y(5811);const k=(st,U,yt,b)=>(st.x-=b.x,st.y-=b.y,st.x/=U,st.y/=U,st.x-=yt.x,st.y-=yt.y,st.x=(0,C.q)(st.x),st.y=(0,C.q)(st.y),st)},70:(ae,Dt,y)=>{y.d(Dt,{$:()=>vt,U:()=>te});var C=y(1687),k=y(4981),st=y(9054),U=y(5973),yt=y(2336),b=y(861),h=y(157),R=y(4787),f=y(1105),M=y(6358);var I=y(7267),u=y(7210),K=y(5811);const N=(Y,v,q)=>{var ut,dt,X,Q;let H=1,x=new Image;x.onload=()=>{var z,gt,It,mt;H=(0,K.q)(x.naturalWidth/x.naturalHeight,100);let Rt=0,Ut=0,Wt=0,Vt=0;var qt,ce,pe,oe;H>=1?(Wt=Math.min(x.naturalWidth,null!==(qt=null===(ce=vt.slide.svg)||void 0===ce||null===(ce=ce.viewBox)||void 0===ce?void 0:ce.width)&&void 0!==qt?qt:0),Vt=Wt/H):(Vt=Math.min(x.naturalHeight,null!==(pe=null===(oe=vt.slide.svg)||void 0===oe||null===(oe=oe.viewBox)||void 0===oe?void 0:oe.height)&&void 0!==pe?pe:0),Wt=Vt/H),Rt=((null!==(z=null===(gt=vt.slide.svg)||void 0===gt||null===(gt=gt.viewBox)||void 0===gt?void 0:gt.width)&&void 0!==z?z:0)-Wt)/2,Ut=((null!==(It=null===(mt=vt.slide.svg)||void 0===mt||null===(mt=mt.viewBox)||void 0===mt?void 0:mt.height)&&void 0!==It?It:0)-Vt)/2,v.size={x:Rt,y:Ut,width:Wt,height:Vt},tt(v,q)},x.onerror=z=>{console.error(`ImgSrc load failed -> ${JSON.stringify(v.source)}`,z)},x.src=(null!==(ut=v.source)&&void 0!==ut&&ut.path?(null===(dt=k.icdt.config)||void 0===dt?void 0:dt.readfileuploadurl)+(null===(X=v.source)||void 0===X?void 0:X.path):null===(Q=v.source)||void 0===Q?void 0:Q.url)||""},tt=(Y,v)=>{if(Y.slideStatus!=vt.slideStatus)return void v();let{element:q}=(0,u.G)(Math.ceil(1e9*Math.random()),{size:Y.size,source:{type:"image",image:null==Y?void 0:Y.source}});setTimeout(()=>{null==q||q.remove(),v()},3e3)};var et=y(7492);const at=(Y,v,q)=>{var ut,dt,X,Q;let H=new Image;H.onload=()=>{L(Y,{width:H.naturalWidth,height:H.naturalHeight},v,q)},H.onerror=x=>{console.error(`ImgSrc load failed -> ${JSON.stringify(v.source)}`,x),q()},H.src=(null!==(ut=v.source)&&void 0!==ut&&ut.path?(null===(dt=k.icdt.config)||void 0===dt?void 0:dt.readfileuploadurl)+(null===(X=v.source)||void 0===X?void 0:X.path):null===(Q=v.source)||void 0===Q?void 0:Q.url)||""},L=(Y,v,q,ut)=>{if(q.slideStatus!=vt.slideStatus)return void ut();let dt=(0,K.q)(v.width/v.height,100),X=0,Q=0,H=0,x=0;dt>=1?(H=v.width,H=Math.max(H,40),H=Math.min(H,40),x=H/dt):(x=v.height,x=Math.max(x,40),x=Math.min(x,40),H=x/dt);let{size:It}=Y;X=It.x+It.width-H/2,Q=It.y-x/2;let mt=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,u.G)(`icon-${Y.id}`,{size:{x:X,y:Q,width:H,height:x},source:{type:"image",image:null==q?void 0:q.source}},mt),setTimeout(()=>{ut()},3e3)},Ot=(Y,v,q)=>{var ut,dt,X,Q,H,x,z;if(v.slideStatus!=vt.slideStatus)return void q();if(!(null!==(ut=v.source)&&void 0!==ut&&ut.path||null!==(dt=v.source)&&void 0!==dt&&dt.url))return console.warn(`${Y.id} -> audio no source!`),void q();var gt=jQuery("#"+Y.id);let It=null!==(X=v.iteration)&&void 0!==X?X:0;if(It<0&&(q(),q=function(){}),!(gt.data("audio-running")&&It<0)){gt.data("audio-running",!0);var mt=new Audio;return mt.autoplay=!0,mt.loop=0!=It,mt.preload="auto",mt.controls=!0,mt.setAttributeNode(document.createAttribute("playsinline")),mt.addEventListener("canplay",function(){var Rt=mt.play();Rt&&Rt.then(function(Ut){gt.data("audio-running",!0)}).catch(function(Ut){gt.data("audio-running",!1),v.slideStatus===vt.slideStatus&&q()})}),mt.addEventListener("timeupdate",function(){var Ut;v.slideStatus!==vt.slideStatus&&((Ut=this).pause(),Ut.remove(),gt.data("audio-running",!1))}),mt.addEventListener("canplaythrough",function(){this.loop&&(It>0?It--:0==It&&(this.loop=!1))}),mt.addEventListener("play",function(){}),mt.addEventListener("pause",function(){}),mt.addEventListener("ended",function(){this.remove(),gt.data("audio-running",!1),v.slideStatus===vt.slideStatus&&q()}),mt.onerror=function(){this.remove(),gt.data("audio-running",!1),v.slideStatus===vt.slideStatus&&q()},mt.src=(null!==(Q=v.source)&&void 0!==Q&&Q.path?(null===(H=k.icdt.config)||void 0===H?void 0:H.readfileuploadurl)+(null===(x=v.source)||void 0===x?void 0:x.path):null===(z=v.source)||void 0===z?void 0:z.url)||"",mt}};var At=y(9942);const pt=(Y,v,q)=>{var ut;null===(ut=v.test)||void 0===ut||null===(ut=ut.answer)||void 0===ut||null===(ut=ut.matching)||void 0===ut||ut.filter(dt=>dt.value==q.key).forEach(dt=>dt.value=""),jQuery(`#node-${Y.id}`).remove()},Et=(Y,v,q,ut,dt,X)=>{var Q,H,x,z,gt,It,mt,Rt,Ut,Wt,Vt,qt;dt.iscorrect?(null!==(Q=v.test)&&void 0!==Q&&null!==(Q=Q.audiotrue)&&void 0!==Q&&Q.path&&Ot(Y,{source:(0,At.I)(null===(z=v.test)||void 0===z?void 0:z.audiotrue),iteration:0,nodeStatus:q,slideStatus:ut},X),null!==(H=v.test)&&void 0!==H&&null!==(H=H.icontrue)&&void 0!==H&&H.path&&at(Y,{source:(0,At.I)(null===(gt=v.test)||void 0===gt?void 0:gt.icontrue),iteration:0,nodeStatus:q,slideStatus:ut},X),null!==(x=v.test)&&void 0!==x&&null!==(x=x.effecttrue)&&void 0!==x&&x.path&&N(0,{source:(0,At.I)(null===(It=v.test)||void 0===It?void 0:It.effecttrue),iteration:0,nodeStatus:q,slideStatus:ut},X)):(null!==(mt=v.test)&&void 0!==mt&&null!==(mt=mt.audiofalse)&&void 0!==mt&&mt.path&&Ot(Y,{source:(0,At.I)(null===(Wt=v.test)||void 0===Wt?void 0:Wt.audiofalse),iteration:0,nodeStatus:q,slideStatus:ut},X),null!==(Rt=v.test)&&void 0!==Rt&&null!==(Rt=Rt.iconfalse)&&void 0!==Rt&&Rt.path&&at(Y,{source:(0,At.I)(null===(Vt=v.test)||void 0===Vt?void 0:Vt.iconfalse),iteration:0,nodeStatus:q,slideStatus:ut},X),null!==(Ut=v.test)&&void 0!==Ut&&null!==(Ut=Ut.effectfalse)&&void 0!==Ut&&Ut.path&&N(0,{source:(0,At.I)(null===(qt=v.test)||void 0===qt?void 0:qt.effectfalse),iteration:0,nodeStatus:q,slideStatus:ut},X))},rt=(Y,v,q,ut)=>{var dt,X,Q,H,x,z,It,Rt,mt;null!==(dt=v.animate)&&void 0!==dt&&dt.value&&(0,I.Z)(v,q.nodeStatus,q.slideStatus),null!==(X=v.interactive)&&void 0!==X&&X.show?((Y,v,q,ut)=>{var dt,X,Q;console.log("icdt_Run_Interactive_NodeShow",Y,v,q);let H={total:0,counter:0},{triggershow:x,triggerrun:z,triggerhide:gt,action:It,audio:mt}=null!==(dt=null===(X=Y.interactive)||void 0===X?void 0:X.show)&&void 0!==dt?dt:{};if(x){let{id:Ut,ids:Wt,time:Vt,async:qt}=x;"asynctrue"==qt?setTimeout(()=>{(0,R.L5)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})}):"time"==qt&&setTimeout(()=>{(0,R.L5)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})},1e3*(null!=Vt?Vt:0))}if(z){let{id:Ut,ids:Wt,time:Vt,async:qt}=z;"asynctrue"==qt?setTimeout(()=>{(0,R.Ar)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})}):"time"==qt&&setTimeout(()=>{(0,R.Ar)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})},1e3*(null!=Vt?Vt:0))}if(gt){let{id:Ut,ids:Wt,time:Vt,async:qt}=gt;"asynctrue"==qt?setTimeout(()=>{(0,R.WT)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})}):"time"==qt&&setTimeout(()=>{(0,R.WT)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})},1e3*(null!=Vt?Vt:0))}let Rt=()=>{setTimeout(()=>{if(H.counter>=H.total){if(ut&&ut(),x){let{id:Ut,ids:Wt,async:Vt}=x;(!Vt||"asyncfalse"==Vt)&&(0,R.L5)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})}if(z){let{id:Ut,ids:Wt,async:Vt}=z;(!Vt||"asyncfalse"==Vt)&&(0,R.Ar)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})}if(gt){let{id:Ut,ids:Wt,async:Vt}=gt;(!Vt||"asyncfalse"==Vt)&&(0,R.WT)({id:Ut,ids:Wt,nodeStatus:v,slideStatus:q})}}})};if(null!=It&&It.value){H.total+=1;let Ut=()=>{H.counter+=1,Rt()};switch(null==It?void 0:It.value){case"hide":jQuery("#"+Y.id).addClass("hide"),Ut();break;case"points":{let{points:Wt,time:Vt,iteration:qt,finish:ce}=It;(0,b.G)(Y.id,{node:Y,points:Wt,time:Vt,iteration:qt,finish:ce,nodeStatus:v,slideStatus:q},Ut);break}default:{let{value:Wt,time:Vt,iteration:qt,finish:ce}=It;(0,yt.Q)(Y.id,{node:Y,value:Wt,time:Vt,iteration:qt,finish:ce,nodeStatus:v,slideStatus:q},Ut);break}}}if(null!=mt&&null!==(Q=mt.source)&&void 0!==Q&&Q.path){H.total+=1;let Ut=()=>{H.counter+=1,Rt()},Wt=(0,h.R)(Y.id,mt,H,{nodeStatus:v,slideStatus:q},Ut);-1==(null==mt?void 0:mt.iteration)&&jQuery("#"+Y.id).click(Vt=>{Vt.preventDefault(),Wt&&(Wt.volume=Wt.volume>=1?0:Wt.volume+.25),console.log(null==Wt?void 0:Wt.volume)})}H.total||Rt()})(v,q.nodeStatus,q.slideStatus,ut):ut&&ut(),null!==(Q=v.interactive)&&void 0!==Q&&Q.click&&(Rt=null===(It=v.interactive)||void 0===It?void 0:It.click,Object.keys(null!=Rt?Rt:{}).map(Wt=>Rt[Wt]?1:0).includes(1)&&jQuery("#"+v.id).addClass("interactive-click"),jQuery("#"+v.id).click(Rt=>{Rt.preventDefault(),q.nodeStatus=vt.refreshNodeStatus(),(0,U.F)(v,q.nodeStatus,q.slideStatus)})),null!==(H=v.variable)&&void 0!==H&&H.input&&jQuery("#"+v.id).on("change","input,textarea",Rt=>{Rt.preventDefault(),((Y,v,q)=>{var ut,dt;k.icdt.variable.setValue(null!==(ut=null===(dt=v.variable)||void 0===dt||null===(dt=dt.input)||void 0===dt?void 0:dt.variable)&&void 0!==ut?ut:"",Y),(Y=>{var v;let q=(ut,dt)=>{null==ut||ut.forEach(X=>{switch(X.type){case st.$.GROUP:(0,M.m)(X.id,{},dt?window.document.getElementById(dt):null),q(X.nodes,X.id);break;case st.$.POLYGON:break;case st.$.TEXT:(0,f.$)(X.id,{size:X.size,attribute:X.attribute,source:X.source},dt?window.document.getElementById(dt):null)}})};q(null===(v=Y.svg)||void 0===v?void 0:v.nodes)})(q)})(Rt.target.value,v,Y)}),null!==(x=v.variable)&&void 0!==x&&x.click&&(null!==(mt=v.variable)&&void 0!==mt&&null!==(mt=mt.click)&&void 0!==mt&&mt.variable&&jQuery("#"+v.id).addClass("variable-click"),jQuery("#"+v.id).click(Rt=>{Rt.preventDefault(),((Y,v)=>{var q;k.icdt.variable.setValueOperator(null===(q=Y.variable)||void 0===q?void 0:q.click),(Y=>{var v;let q=(ut,dt)=>{null==ut||ut.forEach(X=>{switch(X.type){case st.$.GROUP:(0,M.m)(X.id,{},dt?window.document.getElementById(dt):null),q(X.nodes,X.id);break;case st.$.POLYGON:break;case st.$.TEXT:(0,f.$)(X.id,{size:X.size,attribute:X.attribute,source:X.source},dt?window.document.getElementById(dt):null)}})};q(null===(v=Y.svg)||void 0===v?void 0:v.nodes)})(v)})(v,Y)})),"test"==(null===(z=v.source)||void 0===z?void 0:z.type)&&((Y,v)=>{var q;let ut=()=>{};switch(null===(q=Y.source)||void 0===q||null===(q=q.test)||void 0===q?void 0:q.type){case"truefalse":var dt;if(jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,q,ut,dt)=>{var X,Q;let H=null===(X=Y.source)||void 0===X||null===(X=X.test)||void 0===X||null===(X=X.truefalse)||void 0===X?void 0:X.iscorrect;if(v.test?v.test.answer?v.test.answer.truefalse={value:Y.id,iscorrect:H}:v.test.answer={truefalse:{value:Y.id,iscorrect:H}}:v.test={answer:{truefalse:{value:Y.id,iscorrect:H}}},null!==(Q=v.svg)&&void 0!==Q&&Q.nodes.find(x=>{var z;return"submit"==(null===(z=x.source)||void 0===z||null===(z=z.test)||void 0===z?void 0:z.type)})){if(v.test.showselection){let x=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,et.Yw)(x,v)}}else Et(Y,v,q,ut,{iscorrect:H},dt);console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ut)}),null!==(dt=v.test)&&void 0!==dt&&dt.showselection){let x=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,et.Yw)(x,v)}break;case"singlechoice":var X;if(jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,q,ut,dt)=>{var X,Q;let H=null===(X=Y.source)||void 0===X||null===(X=X.test)||void 0===X||null===(X=X.singlechoice)||void 0===X?void 0:X.iscorrect;if(v.test?v.test.answer?v.test.answer.singlechoice={value:Y.id,iscorrect:H}:v.test.answer={singlechoice:{value:Y.id,iscorrect:H}}:v.test={answer:{singlechoice:{value:Y.id,iscorrect:H}}},null!==(Q=v.svg)&&void 0!==Q&&Q.nodes.find(x=>{var z;return"submit"==(null===(z=x.source)||void 0===z||null===(z=z.test)||void 0===z?void 0:z.type)})){if(v.test.showselection){let x=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,et.Yw)(x,v)}}else Et(Y,v,q,ut,{iscorrect:H},dt);console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ut)}),null!==(X=v.test)&&void 0!==X&&X.showselection){let x=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,et.Yw)(x,v)}break;case"multichoice":var Q;if(jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,q,ut,dt)=>{var X,Q;let x,H=null===(X=Y.source)||void 0===X||null===(X=X.test)||void 0===X||null===(X=X.multichoice)||void 0===X?void 0:X.iscorrect;if(v.test?v.test.answer?v.test.answer.multichoice?v.test.answer.multichoice.find(z=>z.value==Y.id)?(v.test.answer.multichoice=v.test.answer.multichoice.filter(z=>z.value!=Y.id),x=!0):v.test.answer.multichoice.push({value:Y.id,iscorrect:H}):v.test.answer.multichoice=[{value:Y.id,iscorrect:H}]:v.test.answer={multichoice:[{value:Y.id,iscorrect:H}]}:v.test={answer:{multichoice:[{value:Y.id,iscorrect:H}]}},null!==(Q=v.svg)&&void 0!==Q&&Q.nodes.find(z=>{var gt;return"submit"==(null===(gt=z.source)||void 0===gt||null===(gt=gt.test)||void 0===gt?void 0:gt.type)})){if(v.test.showselection){let z=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,et.Yw)(z,v)}}else Et(Y,v,q,ut,{iscorrect:H},dt);console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ut)}),null!==(Q=v.test)&&void 0!==Q&&Q.showselection){let x=(0,et.g1)(C.O.TEST_GROUP,"g",void 0,k.icdt.target);(0,et.Yw)(x,v)}break;case"fill":var H;jQuery("#"+Y.id).on("keyup",'input[type="text"]',x=>{var z;let gt=jQuery("<div/>").css({"font-size":jQuery(x.target).css("font-size"),visibility:"hidden",float:"left"}).text(x.target.value).appendTo(window.document.body);jQuery(x.target).css({width:(null!==(z=gt.width())&&void 0!==z?z:0)+30})}).on("keypress",'input[type="text"]',x=>{13===(x.keyCode||x.charCode||x.which)&&(x.preventDefault(),x.stopPropagation(),jQuery(x.target).blur())}).on("change",'input[type="text"]',x=>{var z,gt;let It=vt.nodeStatus,mt=vt.slideStatus,Rt=null===(z=x.target)||void 0===z?void 0:z.getAttribute("data-key"),Ut=null===(gt=x.target)||void 0===gt||null===(gt=gt.value)||void 0===gt?void 0:gt.trim();((Y,v,q,ut,dt,X)=>{var Q,H,x,z;let{value:gt}=null!==(Q=null===(H=Y.source)||void 0===H||null===(H=H.test)||void 0===H||null===(H=H.fill)||void 0===H?void 0:H.find(mt=>mt.key==`[[${dt.key}]]`))&&void 0!==Q?Q:{},It=gt&&gt.map(mt=>null==mt?void 0:mt.toLocaleLowerCase()).includes(null===(x=dt.value)||void 0===x?void 0:x.toLocaleLowerCase());null!==(z=v.svg)&&void 0!==z&&z.nodes.find(mt=>{var Rt;return"submit"==(null===(Rt=mt.source)||void 0===Rt||null===(Rt=Rt.test)||void 0===Rt?void 0:Rt.type)})||Et(Y,v,q,ut,{iscorrect:It},X),dt.iscorrect=It,v.test?v.test.answer?v.test.answer.fill?v.test.answer.fill.find(mt=>mt.key==dt.key)?v.test.answer.fill.filter(mt=>mt.key==dt.key).forEach(mt=>{mt.value=dt.value,mt.iscorrect=dt.iscorrect}):v.test.answer.fill.push(dt):v.test.answer.fill=[dt]:v.test.answer={fill:[dt]}:v.test={answer:{fill:[dt]}},console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,It,mt,{key:Rt,value:Ut},ut),jQuery("#"+Y.id).find(`input[type="text"][data-key="${Rt}"]`).val(Ut)}),null!==(H=v.test)&&void 0!==H&&H.showselection||jQuery("#"+Y.id).addClass("hide-selection");break;case"matching-empty":jQuery("#"+Y.id).on("touchmove",".ondrag-item",function(x){x.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(x){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Y.size.height/Y.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${x.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(x){var z;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(z=v.test)&&void 0!==z&&z.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(x){},dragend:function(x){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Y.id} .ondrop-here`).kendoDropTarget({dragenter:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.addClass("focused")},dragleave:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.removeClass("focused")},drop:function(x){if(!x.dropTarget.hasClass("actived"))return;x.dropTarget.removeClass("focused");let z=x.dropTarget,gt=x.draggable.currentTarget;z.is(":empty")||z.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),gt.appendTo(z),((Y,v,q,ut,dt,X)=>{var Q,H,x;let{key:z}=null!==(Q=null===(H=Y.source)||void 0===H||null===(H=H.test)||void 0===H?void 0:H.matching)&&void 0!==Q?Q:{key:"KIEN"},gt=dt.key==z;null!==(x=v.svg)&&void 0!==x&&x.nodes.find(mt=>{var Rt;return"submit"==(null===(Rt=mt.source)||void 0===Rt||null===(Rt=Rt.test)||void 0===Rt?void 0:Rt.type)})||Et(Y,v,q,ut,{iscorrect:gt},X),pt(Y,v,dt);let It={key:null!=z?z:"",value:dt.key};v.test?v.test.answer?v.test.answer.matching?v.test.answer.matching.find(mt=>mt.key==z)?v.test.answer.matching.filter(mt=>mt.key==z).forEach(mt=>mt.value=It.value):v.test.answer.matching.push(It):v.test.answer.matching=[It]:v.test.answer={matching:[It]}:v.test={answer:{matching:[It]}},console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,{key:gt.data("key")},ut)}});break;case"matching-content":jQuery("#"+Y.id).on("touchmove",".ondrag-item",function(x){x.preventDefault()}).kendoDraggable({filter:".ondrag-item",hint:function(x){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${Y.size.height/Y.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${x.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(x){var z;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),null!==(z=v.test)&&void 0!==z&&z.showselection||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(x){},dragend:function(x){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${Y.id} .ondrop-here`).kendoDropTarget({dragenter:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.addClass("focused")},dragleave:function(x){x.dropTarget.hasClass("actived")&&x.dropTarget.removeClass("focused")},drop:function(x){if(!x.dropTarget.hasClass("actived"))return;x.dropTarget.removeClass("focused");let gt=x.draggable.currentTarget;gt.appendTo(x.dropTarget),pt(Y,v,{key:gt.data("key")})}});break;case"speech":break;case"submit":jQuery("#"+Y.id).click(x=>{x.preventDefault(),((Y,v,q,ut,dt)=>{var X,Q,H,x,z;let gt;var It;if(null!=v&&null!==(X=v.test)&&void 0!==X&&null!==(X=X.answer)&&void 0!==X&&X.truefalse)gt=null==v||null===(It=v.test)||void 0===It||null===(It=It.answer)||void 0===It||null===(It=It.truefalse)||void 0===It?void 0:It.iscorrect;else if(null!=v&&null!==(Q=v.test)&&void 0!==Q&&null!==(Q=Q.answer)&&void 0!==Q&&Q.singlechoice){var mt;gt=null==v||null===(mt=v.test)||void 0===mt||null===(mt=mt.answer)||void 0===mt||null===(mt=mt.singlechoice)||void 0===mt?void 0:mt.iscorrect}else if(null!=v&&null!==(H=v.test)&&void 0!==H&&null!==(H=H.answer)&&void 0!==H&&H.multichoice){var Rt,Ut,Wt;gt=1==[null==v||null===(Rt=v.test)||void 0===Rt||null===(Rt=Rt.answer)||void 0===Rt||null===(Rt=Rt.multichoice)||void 0===Rt?void 0:Rt.length,null==v||null===(Ut=v.test)||void 0===Ut||null===(Ut=Ut.answer)||void 0===Ut||null===(Ut=Ut.multichoice)||void 0===Ut||null===(Ut=Ut.map(oe=>oe.iscorrect?1:0))||void 0===Ut?void 0:Ut.reduce((oe,se)=>oe+se),null==v||null===(Wt=v.svg)||void 0===Wt||null===(Wt=Wt.nodes)||void 0===Wt||null===(Wt=Wt.filter(oe=>{var se,xe;return"multichoice"==(null===(se=oe.source)||void 0===se||null===(se=se.test)||void 0===se?void 0:se.type)&&(null===(xe=oe.source)||void 0===xe||null===(xe=xe.test)||void 0===xe||null===(xe=xe.multichoice)||void 0===xe?void 0:xe.iscorrect)}))||void 0===Wt?void 0:Wt.length].filter((oe,se,xe)=>xe.indexOf(oe)==se).length}else if(null!=v&&null!==(x=v.test)&&void 0!==x&&null!==(x=x.answer)&&void 0!==x&&x.fill){var Vt,qt;gt=(null==v||null===(Vt=v.test)||void 0===Vt||null===(Vt=Vt.answer)||void 0===Vt||null===(Vt=Vt.fill)||void 0===Vt||null===(Vt=Vt.map(oe=>oe.iscorrect?1:0))||void 0===Vt?void 0:Vt.reduce((oe,se)=>oe+se))==(null===(qt=v.svg)||void 0===qt||null===(qt=qt.nodes)||void 0===qt||null===(qt=qt.filter(oe=>{var se;return"fill"==(null===(se=oe.source)||void 0===se||null===(se=se.test)||void 0===se?void 0:se.type)}))||void 0===qt?void 0:qt.length)}else if(null!=v&&null!==(z=v.test)&&void 0!==z&&null!==(z=z.answer)&&void 0!==z&&z.matching){var ce,pe;gt=(null===(ce=v.svg)||void 0===ce||null===(ce=ce.nodes)||void 0===ce||null===(ce=ce.filter(oe=>{var se;return"matching-empty"==(null===(se=oe.source)||void 0===se||null===(se=se.test)||void 0===se?void 0:se.type)}))||void 0===ce?void 0:ce.length)==((null==v||null===(pe=v.test)||void 0===pe||null===(pe=pe.answer)||void 0===pe?void 0:pe.matching)||[]).map(oe=>oe.key==oe.value?1:0).reduce((oe,se)=>oe+se)}Et(Y,v,q,ut,{iscorrect:gt},dt),console.log("node source ->",Y.source),console.log("slide test ->",v.test)})(Y,v,vt.nodeStatus,vt.slideStatus,ut)})}})(v,Y)};var $t=y(8619),V=y(8785),Z=y(4921),d=y(8054),lt=y(2282),wt=y(2875),Tt=y(8419);const Qt=(Y,v,q)=>{if(q.slideStatus!=vt.slideStatus||!v.length)return;let ut=v.shift(),dt=Y.filter(x=>{var z;return(null!==(z=x.idx)&&void 0!==z?z:0)==ut});if(!dt.length)return;let X=Math.max.apply(null,dt.map(x=>{var z;return null!==(z=x.time)&&void 0!==z?z:0})),Q=!1,H=X<.5?0:setTimeout(()=>{Q||(Q=!0,Qt(Y,v,q))},1e3*X);Ht(Y,v,dt,0,q,{idx:ut,total:dt.length,counter:0,isRecursive:Q,timeoutRecursive:H,maxTimeCoundown:X,uid:Math.floor(1e9*Math.random())})},Ht=(Y,v,q,ut,dt,X)=>{if(dt.slideStatus!=vt.slideStatus)return;let Q=q[ut];if(Q){switch(Q.type){case st.$.GROUP:break;case st.$.CIRCLE:(0,$t._)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.ELLIPSE:(0,V.r)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.LINE:(0,Z.W)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.RECT:(0,d.f)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.POLYGON:(0,lt.l)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.FOREIGNOBJECT:(0,wt.e)(Q.id,{size:Q.size,attribute:Q.attribute,style:Q.style,source:Q.source},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.IMAGE:(0,u.G)(Q.id,{size:Q.size,attribute:Q.attribute,source:Q.source},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.TEXT:(0,f.$)(Q.id,{size:Q.size,attribute:Q.attribute,source:Q.source},Q.pid?window.document.getElementById(Q.pid):null);break;case st.$.PATH:(0,Tt.G)(Q.id,{size:Q.size,attribute:Q.attribute},Q.pid?window.document.getElementById(Q.pid):null)}rt(dt.slide,Q,dt,()=>{X.counter+=1,X.maxTimeCoundown<.5&&X.counter>=X.total&&(X.total=X.counter=0,X.isRecursive||(clearTimeout(X.timeoutRecursive),X.isRecursive=!0,setTimeout(()=>{Qt(Y,v,dt)},250)))}),Ht(Y,v,q,++ut,dt,X)}},vt=new class Pt{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(v){this._dataSource=v.data||{},k.icdt.variable.set=v.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var v,q;return null!==(v=null===(q=this._dataSource)||void 0===q||null===(q=q.slides)||void 0===q?void 0:q.length)&&void 0!==v?v:0}get slides(){var v;return(null===(v=this._dataSource)||void 0===v?void 0:v.slides)||[]}get slide(){var v;return((null===(v=this._dataSource)||void 0===v?void 0:v.slides)||[])[this._slideIdx]||{}}findNode(v){var q;let ut=null===(q=this._dataSource)||void 0===q||null===(q=q.slides)||void 0===q?void 0:q.find((mt,Rt)=>Rt==this._slideIdx),dt=null==ut?void 0:ut.svg,X=(mt,Rt)=>{let Ut=null==mt?void 0:mt.find(qt=>qt.id==v);if(Ut)return Ut.pid=Rt,Ut;let Wt=0,Vt=mt.length||0;for(;Wt<Vt&&!Ut&&(Ut=X(mt[Wt].nodes||[],mt[Wt].id),!Ut);)Wt++;return Ut},Q=X((null==dt?void 0:dt.nodes)||[]);var H,x,z,gt,It;return Q?(Q.style=null!==(H=Q.style)&&void 0!==H?H:{},Q.source=null!==(x=Q.source)&&void 0!==x?x:{},Q.animate=null!==(z=Q.animate)&&void 0!==z?z:{},Q.interactive=null!==(gt=Q.interactive)&&void 0!==gt?gt:{},Q.variable=null!==(It=Q.variable)&&void 0!==It?It:{},Q):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(v,q,ut){var dt;let X;var Q,H;if(this.refreshNodeStatus(),this.refreshSlideStatus(),ut)X=null===(Q=this._dataSource)||void 0===Q||null===(Q=Q.slides)||void 0===Q?void 0:Q.find(It=>It.code==ut||It.id==ut),X&&(this._slideIdx=(null===(H=this._dataSource)||void 0===H||null===(H=H.slides)||void 0===H?void 0:H.indexOf(X))||0);else if(q){var x,z;X=null===(x=this._dataSource)||void 0===x||null===(x=x.slides)||void 0===x?void 0:x.find(It=>It.id==q),X&&(this._slideIdx=(null===(z=this._dataSource)||void 0===z||null===(z=z.slides)||void 0===z?void 0:z.indexOf(X))||0)}else this._slideIdx=Math.min(Math.max(v||0,0),this.slideTotal-1),X=this.slide;if(X){var gt;te(k.icdt.container,k.icdt.svg,X,!0),null===(gt=jQuery(k.icdt.svg).find("#"+C.O.BACKGROUND_GROUP))||void 0===gt||gt.empty();let It=(0,et.g1)(C.O.BACKGROUND_GROUP,"g",void 0,k.icdt.svg);(0,et.x0)(It,X),(Y=>{var v,q,ut,dt;let X=vt.nodeStatus,Q=vt.slideStatus;null===(v=Y.svg)||void 0===v||v.nodes.forEach(x=>{x.pid=Math.ceil(1e9*Math.random()),(0,M.m)(x.pid)});let H=null===(q=Y.svg)||void 0===q||null===(q=q.nodes)||void 0===q?void 0:q.map(x=>{var z;return null!==(z=x.idx)&&void 0!==z?z:0}).filter((x,z,gt)=>gt.indexOf(x)==z).sort((x,z)=>(null!=x?x:0)-(null!=z?z:0));Qt(null!==(ut=null===(dt=Y.svg)||void 0===dt?void 0:dt.nodes)&&void 0!==ut?ut:[],null!=H?H:[],{slide:Y,nodeStatus:X,slideStatus:Q})})(X)}this.changeSlide(this.slides,null===(dt=this.slide)||void 0===dt?void 0:dt.id,this.slideIdx,this.slides.length,X)}set onChangeSlide(v){this._fnChangeSlides.push(v)}changeSlide(v,q,ut,dt,X){this._fnChangeSlides.forEach(Q=>Q(v,q,ut,dt,X))}},te=(Y,v,q,ut)=>{var dt,X,Q,H;let x=window.document.querySelector(v);var z;x||(x=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(z=window.document.querySelector(Y))||void 0===z||z.appendChild(x)),ut&&(x.textContent=null);let{x:gt,y:It,width:mt,height:Rt}=null!==(dt=null==q||null===(X=q.svg)||void 0===X?void 0:X.viewBox)&&void 0!==dt?dt:k.icdt.screen.frameSize;x.setAttributeNS(null,"viewBox",gt+" "+It+" "+mt+" "+Rt),x.setAttribute("id",v.replace("#",""));var ce,pe,Ut=null!==(Q=jQuery(Y).width())&&void 0!==Q?Q:1080,Wt=null!==(H=jQuery(Y).height())&&void 0!==H?H:1080,qt=mt/Rt;qt>=Ut/Wt?pe=(ce=Ut)/qt:ce=(pe=Wt)*qt,x.setAttributeNS(null,"width",ce.toString()),x.setAttributeNS(null,"height",pe.toString())}},7267:(ae,Dt,y)=>{y.d(Dt,{E:()=>st,Z:()=>k});var C=y(70);const k=(yt,b,h)=>{var R;let{value:f}=null!==(R=yt.animate)&&void 0!==R?R:{};st(yt.id,{node:yt,value:f,nodeStatus:b,slideStatus:h},()=>{})},st=(yt,b,h)=>{var R;if(!b.value)return void h();let P=jQuery("#"+yt).parents("g");if(!P.length)return void h();let{size:f}=b.node;P.css("transform-origin",`${f.x+f.width/2}px ${f.y+f.height/2}px`);let M="",T=null!==(R=b.iteration)&&void 0!==R?R:0,A=[];(b.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?A.push(b.value):b.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(b.value)?(A.push("animation"),A.push(`animation-${b.value}`)):(A.push("animate__animated"),A.push(`animate__${b.value}`)):(A.push("animation"),A.push("animation-fadein")),T<0?(A.push("animation-iteration-infinite"),h(),h=function(){}):T>0&&A.push("animation-iteration-"+(T+1)),M=A.join(" "),function(w){let I=function(){P.data("animate-running")?P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){P.data("animate-running",!1),setTimeout(function(){w()},100)}):w()};P.hasClass("animation")?setTimeout(function(){I()}):I()}(function(){var w;U(yt),(T>0||T<0)&&P.one("animationiteration",function(){b.slideStatus===C.$.slideStatus||(P.data("animate-running",!1),U(yt),b.slideStatus===C.$.slideStatus&&h())}),P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(P.data("animate-running",!1),U(yt),b.finish){default:case 0:case 1:break;case 2:var I;st(yt,{node:b.node,value:null===(I=b.node.animate)||void 0===I?void 0:I.out,nodeStatus:b.nodeStatus,slideStatus:b.slideStatus},()=>{P.addClass("hide")})}b.slideStatus===C.$.slideStatus&&h()}),P.attr("data-class",null!==(w=P.attr("class"))&&void 0!==w?w:""),P.addClass(M),P.data("animate-running",!0)})},U=function(yt){var b,h,R=jQuery("#"+yt).parents("g"),P=null===(b=R.attr("class"))||void 0===b?void 0:b.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),f=null===(h=R.attr("class"))||void 0===h?void 0:h.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);P&&P.forEach(function(T){jQuery(R).removeClass(T)}),f&&f.forEach(function(T){jQuery(R).removeClass(T)});let M=R.attr("data-class");M&&(R.attr("class",M),R.removeAttr("data-class")),jQuery(R).data("animation-running",!1)}},2336:(ae,Dt,y)=>{y.d(Dt,{Q:()=>st});var C=y(70),k=y(7267);const st=(yt,b,h)=>{var R;if(!b.value)return void h();let P=jQuery("#"+yt).parents("g");if(!P.length)return void h();let{size:f}=b.node;P.css("transform-origin",`${f.x+f.width/2}px ${f.y+f.height/2}px`);let M="",T=null!==(R=b.iteration)&&void 0!==R?R:0,A=[];(b.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?A.push(b.value):(A.push("animation"),A.push(b.value?"animation-"+b.value:"animation-fadein")),T<0?(A.push("animation-iteration-infinite"),h(),h=function(){}):T>0&&A.push("animation-iteration-"+(T+1)),M=A.join(" "),function(w){let I=function(){P.data("animate-running")?P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){P.data("animate-running",!1),setTimeout(function(){w()},100)}):w()};P.hasClass("animation")?setTimeout(function(){I()}):I()}(function(){var w;U(yt),(T>0||T<0)&&P.one("animationiteration",function(){b.slideStatus===C.$.slideStatus||(P.data("animate-running",!1),U(yt),b.slideStatus===C.$.slideStatus&&h())}),P.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){switch(P.data("animate-running",!1),U(yt),b.finish){default:case 0:case 1:break;case 2:var I;(0,k.E)(yt,{node:b.node,value:null===(I=b.node.animate)||void 0===I?void 0:I.out,nodeStatus:b.nodeStatus,slideStatus:b.slideStatus},()=>{P.addClass("hide")})}b.slideStatus===C.$.slideStatus&&h()}),P.attr("data-class",null!==(w=P.attr("class"))&&void 0!==w?w:""),P.addClass(M),P.data("animate-running",!0)})},U=function(yt){var b,h=jQuery("#"+yt).parents("g"),R=null===(b=h.attr("class"))||void 0===b?void 0:b.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);R&&R.forEach(function(f){jQuery(h).removeClass(f)});let P=h.attr("data-class");P&&(h.attr("class",P),h.removeAttr("data-class")),jQuery(h).data("animation-running",!1)}},861:(ae,Dt,y)=>{y.d(Dt,{G:()=>yt});var C=y(4318),k=y(70),st=y(7492),U=y(7267);const yt=(h,R,P)=>{var f;if(!R.points||!R.points.length)return void P();let M=jQuery("#"+h),T=function b(h){let R=[];2===h.length&&h.splice(1,0,[(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]);let A,J,w,P=1,f=h.length;for(;P<f;){if(A=h[P-1],J=h[P],w=h[P+1],(Math.abs(A[0]-J[0])>=15||Math.abs(A[1]-J[1])>=15)&&Math.pow(A[0]-J[0],2)+Math.pow(A[1]-J[1],2)>=Math.pow(15,2)&&w&&(Math.abs(A[0]-w[0])<=20||Math.abs(A[1]-w[1])<=20)&&Math.pow(A[0]-w[0],2)+Math.pow(A[1]-w[1],2)<=Math.pow(20,2))R.push(J);else{let u=J[0]-A[0],K=J[1]-A[1],N=Math.max(Math.abs(u),Math.abs(K));for(var I=0;I<N;I+=15)R.push([A[0]+u*I/N,A[1]+K*I/N])}P++}return f>0&&(R.splice(0,0,h[0]),R.push(h[f-1])),R}(R.points||[]),A=null!==(f=R.iteration)&&void 0!==f?f:0;if(A<0&&(P(),P=function(){}),M.data("work-running")&&A<0)return;M.data("work-running",!0);let tt,J=T.length,w=Math.max(20,1e3*(R.time||3)/J),{id:I,type:u,size:K,attribute:N}=k.$.findNode(h),et=function(at){if(R.slideStatus!==k.$.slideStatus)return M.data("work-running",!1),void(R.slideStatus===k.$.slideStatus&&P());if(at<J){let Ot=T[at];Ot&&(tt=Object.assign({},K,{x:Ot[0]-K.width/2,y:Ot[1]-K.height/2}),Object.assign(N,(0,C.sg)(u,tt,N)),(0,st.__)(window.document.getElementById(I),N),setTimeout(function(){et(++at)},w))}else if(A>0)A--,et(1);else if(A<0)et(1);else switch(M.data("work-running",!1),R.slideStatus===k.$.slideStatus&&P(),R.finish){default:case 0:break;case 1:Object.assign(N,(0,C.sg)(u,K,N)),(0,st.__)(window.document.getElementById(I),N);break;case 2:var L;(0,U.E)(R.node.id,{node:R.node,value:null===(L=R.node.animate)||void 0===L?void 0:L.out,nodeStatus:R.nodeStatus,slideStatus:R.slideStatus},()=>{M.addClass("hide")})}};et(1)}},157:(ae,Dt,y)=>{y.d(Dt,{R:()=>st});var C=y(4981),k=y(70);const st=(yt,b,h,R,P)=>{var f,M,T,A,J,w,I;if(R.slideStatus!=k.$.slideStatus)return b.async&&"change-slide"!=b.async?void 0:void P();if(R.nodeStatus!=k.$.nodeStatus&&(!b.async||"change-node"==b.async))return void P();if(!(null!==(f=b.source)&&void 0!==f&&f.path||null!==(M=b.source)&&void 0!==M&&M.url))return console.warn(`${yt} -> audio no source!`),P(),void(P=()=>{});var u=jQuery("#"+yt);let K=null!==(T=b.iteration)&&void 0!==T?T:0;if(K<0&&(P(),P=function(){}),!(u.data("audio-running")&&K<0)){u.data("audio-running",!0);var N=function(et){et.pause(),et.remove(),u.data("audio-running",!1)},tt=new Audio;return tt.autoplay=!0,tt.loop=0!=K,tt.preload="auto",tt.controls=!0,tt.setAttributeNode(document.createAttribute("playsinline")),tt.addEventListener("canplay",function(){var et=tt.play();et&&et.then(function(at){var L;u.data("audio-running",!0),"time"==b.async?setTimeout(()=>{N(tt),P(),P=()=>{}},1e3*(null!==(L=b.time)&&void 0!==L?L:1)):"non-stop"==b.async&&(P(),P=()=>{})}).catch(function(at){u.data("audio-running",!1),R.slideStatus===k.$.slideStatus&&(P(),P=()=>{})})}),tt.addEventListener("timeupdate",function(){switch(b.async){case"time":case"non-stop":break;case"finish-action":h.total>=2&&h.total-h.counter==1&&(N(this),P(),P=()=>{});break;default:case"change-node":R.nodeStatus!==k.$.nodeStatus&&(N(this),P(),P=()=>{});break;case"change-slide":R.slideStatus!==k.$.slideStatus&&(N(this),P(),P=()=>{})}}),tt.addEventListener("canplaythrough",function(){this.loop&&(K>0?K--:0==K&&(this.loop=!1))}),tt.addEventListener("play",function(){}),tt.addEventListener("pause",function(){}),tt.addEventListener("ended",function(){this.remove(),u.data("audio-running",!1),R.slideStatus===k.$.slideStatus&&(P(),P=()=>{})}),tt.onerror=function(){this.remove(),u.data("audio-running",!1),R.slideStatus===k.$.slideStatus&&(P(),P=()=>{})},tt.src=(null!==(A=b.source)&&void 0!==A&&A.path?(null===(J=C.icdt.config)||void 0===J?void 0:J.readfileuploadurl)+(null===(w=b.source)||void 0===w?void 0:w.path):null===(I=b.source)||void 0===I?void 0:I.url)||"",tt}}},5973:(ae,Dt,y)=>{y.d(Dt,{F:()=>P});var C=y(4981),k=y(70),st=y(2336),U=y(861),yt=y(157),b=y(4787),h=y(370),R=y(7267);const P=(f,M,T,A)=>{var J,w,I;let u={total:0,counter:0},{triggershow:K,triggerrun:N,triggerhide:tt,action:et,audio:at,slide:L,media:Ot}=null!==(J=null===(w=f.interactive)||void 0===w?void 0:w.click)&&void 0!==J?J:{};if(K){let{id:_t,ids:it,time:B,async:pt}=K;"asynctrue"==pt?(0,b.L5)({id:_t,ids:it,nodeStatus:M,slideStatus:T}):"time"==pt&&setTimeout(()=>{(0,b.L5)({id:_t,ids:it,nodeStatus:M,slideStatus:T})},1e3*(null!=B?B:0))}if(N){let{id:_t,ids:it,time:B,async:pt}=N;"asynctrue"==pt?(0,b.Ar)({id:_t,ids:it,nodeStatus:M,slideStatus:T}):"time"==pt&&setTimeout(()=>{(0,b.Ar)({id:_t,ids:it,nodeStatus:M,slideStatus:T})},1e3*(null!=B?B:0))}if(tt){let{id:_t,ids:it,time:B,async:pt}=tt;"asynctrue"==pt?(0,b.WT)({id:_t,ids:it,nodeStatus:M,slideStatus:T}):"time"==pt&&setTimeout(()=>{(0,b.WT)({id:_t,ids:it,nodeStatus:M,slideStatus:T})},1e3*(null!=B?B:0))}let At=()=>{setTimeout(()=>{if(u.counter>=u.total){if(A&&A(),K){let{id:_t,ids:it,async:B}=K;(!B||"asyncfalse"==B)&&(0,b.L5)({id:_t,ids:it,nodeStatus:M,slideStatus:T})}if(N){let{id:_t,ids:it,async:B}=N;(!B||"asyncfalse"==B)&&(0,b.Ar)({id:_t,ids:it,nodeStatus:M,slideStatus:T})}if(tt){let{id:_t,ids:it,async:B}=tt;(!B||"asyncfalse"==B)&&(0,b.WT)({id:_t,ids:it,nodeStatus:M,slideStatus:T})}}})};if(null!=et&&et.value){u.total+=1;let _t=()=>{u.counter+=1,At()};switch(null==et?void 0:et.value){case"hide":var Kt;(0,R.E)(f.id,{node:f,value:null===(Kt=f.animate)||void 0===Kt?void 0:Kt.out,nodeStatus:M,slideStatus:T},()=>{jQuery("#"+f.id).addClass("hide"),_t()});break;case"points":{let{points:it,time:B,iteration:pt,finish:St}=et;it&&(0,U.G)(f.id,{node:f,points:it,time:B,iteration:pt,finish:St,nodeStatus:M,slideStatus:T},_t);break}default:{let{value:it,time:B,iteration:pt,finish:St}=et;(0,st.Q)(f.id,{node:f,value:it,time:B,iteration:pt,finish:St,nodeStatus:M,slideStatus:T},_t);break}}}if(null!=at&&null!==(I=at.source)&&void 0!==I&&I.path){u.total+=1;let _t=()=>{u.counter+=1,At()};(0,yt.R)(f.id,at,u,{nodeStatus:M,slideStatus:T},_t)}if(u.total||At(),null!=L&&L.id)switch(console.log(`InteractiveNode #${f.id} slide(undefined,${L.id},${L.code}) success!`),L.id){case-1:k.$.runSlide(k.$.slideIdx-1);break;case-2:k.$.runSlide(k.$.slideIdx+1);break;default:var Ct;k.$.runSlide(void 0,L.id,null===(Ct=L.code)||void 0===Ct?void 0:Ct.toString())}if(null!=Ot&&Ot.type){var Mt;let it=`<div class="popup-media-viewer"><iframe src="${(0,h.e)({readfileuploadurl:null===(Mt=C.icdt.config)||void 0===Mt?void 0:Mt.readfileuploadurl,type:null==Ot?void 0:Ot.type,oss:null==Ot?void 0:Ot.oss,path:null==Ot?void 0:Ot.path,url:null==Ot?void 0:Ot.url})}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`,B=jQuery(it).appendTo(window.document.body);B.find(".btn-close").click(function(pt){pt.preventDefault(),B.remove()})}}},4787:(ae,Dt,y)=>{y.d(Dt,{Ar:()=>yt,L5:()=>U,WT:()=>b});var C=y(70),k=y(5973),st=y(7267);const U=h=>{console.log("icdt_Run_Interactive_TriggerShow",h),h.id?jQuery("#"+h.id).removeClass("hide"):h.ids&&h.ids.forEach(R=>{jQuery("#"+R).removeClass("hide")})},yt=h=>{console.log("icdt_Run_Interactive_TriggerRun",h),h.id?(jQuery("#"+h.id).removeClass("hide"),(0,k.F)(C.$.findNode(h.id),h.nodeStatus,h.slideStatus)):h.ids&&h.ids.forEach(R=>{jQuery("#"+R).removeClass("hide"),(0,k.F)(C.$.findNode(R),h.nodeStatus,h.slideStatus)})},b=h=>{if(console.log("icdt_Run_Interactive_TriggerHide",h),h.id){var R;let P=C.$.findNode(h.id);(0,st.E)(h.id,{node:P,value:null===(R=P.animate)||void 0===R?void 0:R.out,nodeStatus:h.nodeStatus,slideStatus:h.slideStatus},()=>{jQuery("#"+h.id).addClass("hide")})}else h.ids&&h.ids.forEach(P=>{var f;let M=C.$.findNode(P);(0,st.E)(P,{node:M,value:null===(f=M.animate)||void 0===f?void 0:f.out,nodeStatus:h.nodeStatus,slideStatus:h.slideStatus},()=>{jQuery("#"+P).addClass("hide")})})}},7492:(ae,Dt,y)=>{y.d(Dt,{Mh:()=>N,wM:()=>at,xo:()=>tt,it:()=>L,g1:()=>Mt,__:()=>Ot,QI:()=>Kt,DB:()=>At,eb:()=>et,x0:()=>rt,g$:()=>_t,mo:()=>Et,XH:()=>St,hJ:()=>it,vl:()=>pt,yD:()=>B,Yw:()=>$t});var C=y(9054),k=y(1687),st=y(9359),yt=/^#?[a-fA-F0-9]+$/;const R=(V,Z)=>{var d;if("none"==(V=null!==(d=V)&&void 0!==d?d:""))return"none";if("transparent"==V)return"rgba(0,0,0,0)";if(V.includes("rgba("))return V;if(V.includes("rgb(")&&(V=(0,st.E)(V)),!(V=V.replace(/[^0-9a-fA-F]/g,"")))return"";if(!yt.test(V))return console.error(`hex2rgba -> ${V}: first argument has invalid hexadecimal characters`),"";if("#"===V[0]&&(V=V.slice(1)),3===V.length){let wt=V.split("");wt.splice(2,0,V[2]),wt.splice(1,0,V[1]),wt.splice(0,0,V[0]),V=wt.join("")}if(6!==V.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var lt=[parseInt(V.slice(0,2),16),parseInt(V.slice(2,4),16),parseInt(V.slice(4,6),16)];return Z="number"==typeof Z?Z:parseFloat(Z),lt.push(Z>=0&&Z<=1?Z:1),"rgba("+lt.join(",")+")"};var P=y(370),f=y(1814),M=y(4981),T=y(3423),A=y(8054),J=y(7210),w=y(8619),I=y(70),u=y(2875),K=y(1105);class N{constructor(Z,d){let lt=window.document.querySelector(d);var wt;lt||(lt=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(wt=window.document.querySelector(Z))||void 0===wt||wt.appendChild(lt));let{svgViewBox:Tt,svgSize:Lt}=M.icdt.screen.init();lt.setAttributeNS(null,"viewBox",`${Tt.x} ${Tt.y} ${Tt.width} ${Tt.height}`),lt.setAttribute("id",d.replace("#","")),lt.style.display="block",lt.style.width=`${Lt.width}px`,lt.style.height=`${Lt.height}px`,lt.style.backgroundColor="#fafafa",lt.style.cursor="default"}}const tt=V=>{jQuery(M.icdt.target).find("#"+k.O.BACKGROUND_GROUP).empty();let Z=Mt(k.O.BACKGROUND_GROUP,"g",void 0,M.icdt.target);rt(Z,V),(()=>{let d=window.document.getElementById(null==V?void 0:V.id);jQuery(d).find("#"+k.O.BACKGROUND_GROUP).empty();let lt=Mt(k.O.BACKGROUND_GROUP,"g",void 0,d);rt(lt,V)})()},et=()=>{let V=M.icdt.screen.svgViewBox,Z=M.icdt.screen.svgSize;M.icdt.target&&(M.icdt.target.setAttributeNS(null,"viewBox",`${V.x} ${V.y} ${V.width} ${V.height}`),M.icdt.target.style.left=`${Z.x}px`,M.icdt.target.style.top=`${Z.y}px`,M.icdt.target.style.width=`${Z.width}px`,M.icdt.target.style.height=`${Z.height}px`)},at=()=>{jQuery(M.icdt.target).find(">*:not(defs)").remove()},L=(V,Z,d,lt,wt)=>{let Tt;return V?(Tt=jQuery(wt||M.icdt.target).find("#"+V).get(0),Tt||(Tt=window.document.createElementNS("http://www.w3.org/2000/svg",d),Tt.setAttribute("id",V),Z==C.$.FOREIGNOBJECT&&Tt.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(Tt).appendTo(wt||M.icdt.target))):(Tt=window.document.createElementNS("http://www.w3.org/2000/svg",d),jQuery(Tt).appendTo(wt||M.icdt.target)),null!=lt&&lt.attribute&&Ot(Tt,null==lt?void 0:lt.attribute),null!=lt&&lt.style&&At(Tt,null==lt?void 0:lt.style),null!=lt&&lt.source&&Kt(Tt,Z,null==lt?void 0:lt.source),Tt},Ot=(V,Z)=>{return jQuery(V).attr((d=Object.assign({},Z||{}),null===(lt=Object.keys(d))||void 0===lt||lt.forEach(Lt=>{switch(Lt){case"fill":break;case"fillRule":var Qt;Object.assign(d,{"fill-rule":null!==(Qt=d.fillRule)&&void 0!==Qt?Qt:null,fillRule:null});break;case"stroke":var Ht;Object.assign(d,{"stroke-width":null!==(Ht=d.strokeWidth)&&void 0!==Ht?Ht:null,strokeWidth:null});break;case"strokeLinecap":var Pt;Object.assign(d,{"stroke-linecap":null!==(Pt=d.strokeLinecap)&&void 0!==Pt?Pt:null,strokeLinecap:null});break;case"strokeLinejoin":var vt;Object.assign(d,{"stroke-linejoin":null!==(vt=d.strokeLinejoin)&&void 0!==vt?vt:null,strokeLinejoin:null});break;case"strokeMiterlimit":var te;Object.assign(d,{"stroke-miterlimit":null!==(te=d.strokeMiterlimit)&&void 0!==te?te:null,strokeMiterlimit:null});break;case"strokeDasharray":var Y;Object.assign(d,{"stroke-dasharray":null!==(Y=d.strokeDasharray)&&void 0!==Y?Y:null,strokeDasharray:null});break;case"strokeDasharrays":var v,q;Object.assign(d,{"stroke-dasharray":null!==(v=null===(q=d.strokeDasharrays)||void 0===q?void 0:q.join(" "))&&void 0!==v?v:null,strokeDasharrays:null});break;case"fontFamily":var ut;Object.assign(d,{"font-family":null!==(ut=d.fontFamily)&&void 0!==ut?ut:null,fontFamily:null});break;case"fontWeight":var dt;Object.assign(d,{"font-weight":null!==(dt=d.fontWeight)&&void 0!==dt?dt:null,fontWeight:null});break;case"fontSize":var X;Object.assign(d,{"font-size":null!==(X=d.fontSize)&&void 0!==X?X:null,fontSize:null});break;case"textLength":Object.assign(d,{textLength:d.textLength?`${d.textLength}px`:null});break;case"transformOrigin":var Q;Object.assign(d,{"transform-origin":null!==(Q=d.transformOrigin)&&void 0!==Q?Q:null,transformOrigin:null})}}),Object.assign({},null!=d?d:{},{fill:null!=d&&d.fill?R(d.fill,null!==(wt=null==d?void 0:d.fillOpacity)&&void 0!==wt?wt:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:null!=d&&d.stroke?R(d.stroke,null!==(Tt=null==d?void 0:d.strokeOpacity)&&void 0!==Tt?Tt:1):"rgba(0,0,0,0)",strokeOpacity:null}))),V;var d,lt,wt,Tt},At=(V,Z)=>{return jQuery(V).css((d=Object.assign({},Z||{}),null===(lt=Object.keys(d))||void 0===lt||lt.forEach(wt=>{switch(wt){case"padding":Object.assign(d,{padding:d.padding?`${d.padding}px`:null});break;case"borderWidth":var Tt;Object.assign(d,d.borderWidth&&d.borderColor?{"border-width":`${d.borderWidth}px`,"border-style":d.borderStyle||"solid","border-color":R(d.borderColor,null!==(Tt=d.borderOpacity)&&void 0!==Tt?Tt:1)}:{"border-width":"","border-style":"","border-color":""}),Object.assign(d,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(d,{"border-radius":d.borderRadius?`${d.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":var Lt;Object.assign(d,d.backgroundColor?{"background-color":R(d.backgroundColor,null!==(Lt=d.backgroundOpacity)&&void 0!==Lt?Lt:1)}:{"background-color":""}),Object.assign(d,{backgroundColor:null,backgroundOpacity:null})}}),d)),V;var d,lt},Kt=(V,Z,d)=>{switch(Z){case C.$.TEXT:var lt,wt;jQuery(V).text(null!==(lt=null==d||null===(wt=d.text)||void 0===wt?void 0:wt.textContent)&&void 0!==lt?lt:"");break;case C.$.IMAGE:var Tt,Lt,Qt,Ht,Pt;jQuery(V).attr("href",(null==d||null===(Tt=d.image)||void 0===Tt?void 0:Tt.base64)||(null!=d&&null!==(Lt=d.image)&&void 0!==Lt&&Lt.path?(null===(Qt=M.icdt.config)||void 0===Qt?void 0:Qt.readfileuploadurl)+(null==d||null===(Ht=d.image)||void 0===Ht?void 0:Ht.path):null==d||null===(Pt=d.image)||void 0===Pt?void 0:Pt.url)||"");break;case C.$.FOREIGNOBJECT:switch(null==d?void 0:d.type){case"text":var vt,te;if(null!==(vt=d.text)&&void 0!==vt&&vt.variableKeywords&&null!==(te=d.text)&&void 0!==te&&te.variableKeywords.length){var Y;let p=M.icdt.variable.getKeys(),m=(null===(Y=d.text)||void 0===Y?void 0:Y.textContent)||"";d.text.variableKeywords.forEach(g=>{var O=g.replace(/[^a-zA-Z0-9_]/gm,"");if(p.indexOf(O)>=0){var _=M.icdt.variable.getValue(O);m=m.replace(g,_)}}),jQuery(V).text(m)}else{var v;jQuery(V).text((null===(v=d.text)||void 0===v?void 0:v.textContent)||"")}break;case"html":{var q,ut,dt;let p=(null==d||null===(q=d.html)||void 0===q?void 0:q.htmlContent)||"";if(null!==(ut=d.html)&&void 0!==ut&&ut.variableKeywords&&null!==(dt=d.html)&&void 0!==dt&&dt.variableKeywords.length){let m=M.icdt.variable.getKeys();d.html.variableKeywords.forEach(g=>{var O=g.replace(/[^a-zA-Z0-9_]/gm,"");if(m.indexOf(O)>=0){var _=M.icdt.variable.getValue(O);p=p.replace(g,_)}})}jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${p}</div>`).find("img[path],video[path],iframe[path]").each((m,g)=>{var O,_;g.setAttribute("src",(null!==(O=null===(_=M.icdt.config)||void 0===_?void 0:_.readfileuploadurl)&&void 0!==O?O:"")+g.getAttribute("path")),g.removeAttribute("path")});break}case"input":var X,Q,H,x;if(null!==(X=d.input)&&void 0!==X&&X.input)jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(H=null===(x=d.input)||void 0===x?void 0:x.placeholder)&&void 0!==H?H:""}" maxlength="100" /></div>`);else if(null!==(Q=d.input)&&void 0!==Q&&Q.textarea){var z,gt;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(z=null===(gt=d.input)||void 0===gt?void 0:gt.placeholder)&&void 0!==z?z:""}" maxlength="1000"></textarea></div>`)}break;case"image":var It,mt,Rt,Ut,Wt;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(It=d.image)||void 0===It?void 0:It.base64)||(null!==(mt=d.image)&&void 0!==mt&&mt.path?(null===(Rt=M.icdt.config)||void 0===Rt?void 0:Rt.readfileuploadurl)+(null===(Ut=d.image)||void 0===Ut?void 0:Ut.path):null===(Wt=d.image)||void 0===Wt?void 0:Wt.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":var Vt,qt,ce,pe;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${(null!==(Vt=d.iframe)&&void 0!==Vt&&Vt.path?(null===(qt=M.icdt.config)||void 0===qt?void 0:qt.readfileuploadurl)+(null===(ce=d.iframe)||void 0===ce?void 0:ce.path):null===(pe=d.iframe)||void 0===pe?void 0:pe.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{var oe,se,xe,Qe,Pe;let p=(0,P.e)({readfileuploadurl:null===(oe=M.icdt.config)||void 0===oe?void 0:oe.readfileuploadurl,type:null===(se=d.embed)||void 0===se?void 0:se.type,oss:null===(xe=d.embed)||void 0===xe?void 0:xe.oss,path:null===(Qe=d.embed)||void 0===Qe?void 0:Qe.path,url:null===(Pe=d.embed)||void 0===Pe?void 0:Pe.url});jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${p}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":var Ve,Je;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(Ve=null===(Je=d.svg)||void 0===Je?void 0:Je.svgContent)&&void 0!==Ve?Ve:""}</div>`);break;case"test":{var ei,Ee,Ze,De;let p=(null==d||null===(ei=d.html)||void 0===ei?void 0:ei.htmlContent)||"";if(null!==(Ee=d.html)&&void 0!==Ee&&Ee.variableKeywords&&null!==(Ze=d.html)&&void 0!==Ze&&Ze.variableKeywords.length){let m=M.icdt.variable.getKeys();d.html.variableKeywords.forEach(g=>{var O=g.replace(/[^a-zA-Z0-9_]/gm,"");if(m.indexOf(O)>=0){var _=M.icdt.variable.getValue(O);p=p.replace(g,_)}})}switch(null==d||null===(De=d.test)||void 0===De?void 0:De.type){case"truefalse":var Ue;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ue=d.test.truefalse)&&void 0!==Ue&&Ue.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${p}</div></div></div>`);break;case"singlechoice":var Xe;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Xe=d.test.singlechoice)&&void 0!==Xe&&Xe.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${p}</div></div></div>`);break;case"multichoice":var Ye;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==d?void 0:d.test.type}" data-correct="${null!=d&&null!==(Ye=d.test.multichoice)&&void 0!==Ye&&Ye.iscorrect?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${p}</div></div></div>`);break;case"matching-empty":var He;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null==d||null===(He=d.test.matching)||void 0===He?void 0:He.key}"></div>`);break;case"matching-content":var Ge,qe,bt;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null==d||null===(Ge=d.test.matching)||void 0===Ge?void 0:Ge.key}"><div class="ondrag-item" data-key="${null!==(qe=null==d||null===(bt=d.test)||void 0===bt||null===(bt=bt.matching)||void 0===bt?void 0:bt.key)&&void 0!==qe?qe:"KIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${p}</div></div></div></div>`);break;case"fill":var D;((null===(D=d.html)||void 0===D?void 0:D.fillKeywords)||[]).forEach(m=>{var g=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${m.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;p=p.replace(new RegExp(m.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),g)}),jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${p}</div></div></div>`);break;case"speech":jQuery(V).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":var i,n,r,a,o;jQuery(V).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(i=null!==(n=d.image)&&void 0!==n&&n.path?(null===(r=M.icdt.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(a=d.image)||void 0===a?void 0:a.path):null===(o=d.image)||void 0===o?void 0:o.url)&&void 0!==i?i:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(V).find("img[path],video[path],iframe[path]").each((m,g)=>{var O,_;g.setAttribute("src",(null!==(O=null===(_=M.icdt.config)||void 0===_?void 0:_.readfileuploadurl)&&void 0!==O?O:"")+g.getAttribute("path")),g.removeAttribute("path")})}}}},Mt=(V,Z,d,lt)=>{let wt=jQuery(lt||M.icdt.target).find("#"+V).get(0);return wt||(wt=window.document.createElementNS("http://www.w3.org/2000/svg",Z),wt.setAttribute("id",V),jQuery(wt).appendTo(lt||M.icdt.target)),jQuery(wt).attr((null==d?void 0:d.attribute)||{}),jQuery(wt).css((null==d?void 0:d.style)||{}),wt},_t=(V,Z)=>{let d=(0,T.v)(2),lt={fill:f.S3.fill,stroke:f.S3.stroke,"stroke-width":(0,T.v)(f.S3.strokeWidth)};return[{element:Mt("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:Z.x-d,y:Z.y-d,width:Z.width+2*d,height:Z.height+2*d},lt)},V),posType:"rect-center"}]},it=(V,Z)=>{let{size:d}=Z,lt=(0,T.v)(1),wt=(0,T.v)(2),Tt=(0,T.v)(5),Lt={stroke:f.NV.stroke,"stroke-width":(0,T.v)(f.NV.strokeWidth),"stroke-linecap":f.NV.strokeLinecap},Qt={fill:f.Mo.fill,stroke:f.Mo.stroke,"stroke-width":(0,T.v)(f.Mo.strokeWidth)},Ht={fill:f.In.fill,stroke:f.In.stroke,"stroke-width":(0,T.v)(f.In.strokeWidth),width:(0,T.v)(f.In.width),height:(0,T.v)(f.In.height)};return Mt("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:d.x-lt,y1:d.y,x2:d.x-lt,y2:d.y+d.height},Lt)},V),Mt("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-lt,x2:d.x+d.width,y2:d.y-lt},Lt)},V),Mt("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:d.x+d.width+lt,y1:d.y,x2:d.x+d.width+lt,y2:d.y+d.height},Lt)},V),Mt("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+lt,x2:d.x+d.width,y2:d.y+d.height+lt},Lt)},V),[{element:Mt("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Qt),style:{cursor:"move"}},V),posType:"rect-center"},{element:Mt("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:d.x-Tt,y:d.y-Tt},Ht),style:{cursor:"nw-resize"}},V),posType:"rect-top-left"},{element:Mt("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:d.x+d.width-wt,y:d.y-Tt},Ht),style:{cursor:"ne-resize"}},V),posType:"rect-top-right"},{element:Mt("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:d.x-Tt,y:d.y+d.height-wt},Ht),style:{cursor:"sw-resize"}},V),posType:"rect-bottom-left"},{element:Mt("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:d.x+d.width-wt,y:d.y+d.height-wt},Ht),style:{cursor:"se-resize"}},V),posType:"rect-bottom-right"},{element:Mt("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:d.x+d.width/2-wt-lt,y:d.y-Tt},Ht),style:{cursor:"n-resize"}},V),posType:"rect-top"},{element:Mt("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:d.x+d.width-wt,y:d.y+d.height/2-wt-lt},Ht),style:{cursor:"e-resize"}},V),posType:"rect-right"},{element:Mt("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:d.x+d.width/2-wt-lt,y:d.y+d.height-wt},Ht),style:{cursor:"s-resize"}},V),posType:"rect-bottom"},{element:Mt("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:d.x-Tt,y:d.y+d.height/2-wt-lt},Ht),style:{cursor:"w-resize"}},V),posType:"rect-left"}]},B=(V,Z,d)=>{let lt=(0,T.v)(1),wt={stroke:f.NV.stroke,"stroke-width":(0,T.v)(f.NV.strokeWidth),"stroke-linecap":f.NV.strokeLinecap},Tt={fill:f.Mo.fill,stroke:f.Mo.stroke,"stroke-width":(0,T.v)(f.Mo.strokeWidth)},Lt={fill:f.dt.fill,stroke:f.dt.stroke,"stroke-width":(0,T.v)(f.dt.strokeWidth)},te=(Mt("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:d.x-lt,y1:d.y,x2:d.x-lt,y2:d.y+d.height},wt)},V),Mt("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:d.x,y1:d.y-lt,x2:d.x+d.width,y2:d.y-lt},wt)},V),Mt("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:d.x+d.width+lt,y1:d.y,x2:d.x+d.width+lt,y2:d.y+d.height},wt)},V),Mt("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:d.x,y1:d.y+d.height+lt,x2:d.x+d.width,y2:d.y+d.height+lt},wt)},V),Mt("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:d.x,y:d.y,width:d.width,height:d.height},Tt)},V));return Z.forEach(Y=>{let{size:v}=Y;Mt("icdt-temp-select-rect-node-"+Y.id,"rect",{attribute:Object.assign({x:v.x,y:v.y,width:v.width,height:v.height},Lt)},V)}),[{element:te,posType:"rect-center"}]},pt=(V,Z)=>{let d=(0,T.v)(1),lt={stroke:f.NV.stroke,"stroke-width":(0,T.v)(f.NV.strokeWidth),"stroke-linecap":f.NV.strokeLinecap},wt={fill:f.Mo.fill,stroke:f.Mo.stroke,"stroke-width":(0,T.v)(f.Mo.strokeWidth)};return Mt("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:Z.x-d,y1:Z.y,x2:Z.x-d,y2:Z.y+Z.height},lt)},V),Mt("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:Z.x,y1:Z.y-d,x2:Z.x+Z.width,y2:Z.y-d},lt)},V),Mt("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:Z.x+Z.width+d,y1:Z.y,x2:Z.x+Z.width+d,y2:Z.y+Z.height},lt)},V),Mt("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:Z.x,y1:Z.y+Z.height+d,x2:Z.x+Z.width,y2:Z.y+Z.height+d},lt)},V),[{element:Mt("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:Z.x,y:Z.y,width:Z.width,height:Z.height},wt)},V),posType:"rect-center"}]},St=(V,Z)=>((0,T.v)(-1),(0,T.v)(f.h8.strokeWidth),(0,T.v)(f.h8.strokeDasharray),Mt("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:Z.x,y:Z.y,width:Z.width,height:Z.height,class:"cursor-draw"},{fill:f.MA.fill})},V),[]),Et=(V,Z)=>{let d={fill:f.k0.fill,stroke:f.k0.stroke,"stroke-width":(0,T.v)(f.k0.strokeWidth),"stroke-dasharray":(0,T.v)(f.k0.strokeDasharray)};jQuery(V).empty(),Z.forEach(lt=>{var wt,Tt;let{size:Lt}=lt;if(!lt.idx)return;Mt("icdt-temp-index-rect-node-"+lt.id,"rect",{attribute:Object.assign({x:Lt.x-5,y:Lt.y-5,width:Lt.width+10,height:Lt.height+10},d)},V);let{element:Qt}=(0,u.e)(Math.ceil(1e9*Math.random()),{size:{x:Lt.x-76,y:Lt.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Th\u1ee9 t\u1ef1 xu\u1ea5t hi\u1ec7n">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(wt=lt.idx)&&void 0!==wt?wt:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Th\u1eddi gian \u0111\u1ee3i(s), n\u1ebfu gi\xe1 tr\u1ecb = 0 s\u1ebd chuy\u1ec3n sang \u0111\u1ee3i ho\xe0n t\u1ea5t ho\u1ea1t \u0111\u1ed9ng v\xe0 \xe2m thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(Tt=lt.time)&&void 0!==Tt?Tt:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="H\u1ee7y thi\u1ebft l\u1eadp" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},V);Qt.classList.add("node-input"),jQuery(Qt).on("change",'input[name="idx"]',Ht=>{var Pt;lt.idx=parseInt(null!==(Pt=Ht.target.value)&&void 0!==Pt?Pt:"0")}).on("change",'input[name="time"]',Ht=>{var Pt;lt.time=parseFloat(null!==(Pt=Ht.target.value)&&void 0!==Pt?Pt:"0")}).on("click",'button[name="remove"]',Ht=>{lt.idx=0,lt.time=null,Et(V,Z)})})},rt=(V,Z)=>{var d,lt,wt,Tt,Lt,Qt;let{color:Ht,opacity:Pt,path:vt,url:te,base64:Y}=null!==(d=null==Z||null===(lt=Z.svg)||void 0===lt?void 0:lt.background)&&void 0!==d?d:{},{x:v,y:q,width:ut,height:dt}=null!==(wt=null==Z||null===(Tt=Z.svg)||void 0===Tt?void 0:Tt.viewBox)&&void 0!==wt?wt:{x:0,y:0,width:0,height:0};(0,K.$)(void 0,{size:{x:0,y:-21,width:ut,height:dt},attribute:{fill:"#999",fontSize:14,class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(Lt=null!==(Qt=null==Z?void 0:Z.name)&&void 0!==Qt?Qt:null==Z?void 0:Z.code)&&void 0!==Lt?Lt:void 0}}},V),(0,A.f)(void 0,{size:{x:v,y:q,width:ut,height:dt},attribute:{fill:"#fff",stroke:"#999",strokeWidth:1,strokeDasharray:10,class:"hide-on-viewer"}},V),Ht&&(0,A.f)(void 0,{size:{x:v,y:q,width:ut,height:dt},attribute:{fill:Ht,fillOpacity:Pt}},V),vt&&(0,J.G)(void 0,{size:{x:v,y:q,width:ut,height:dt},source:{type:"image",image:{path:vt,url:te,base64:Y}}},V)},$t=(V,Z)=>{var d;switch(jQuery(V).empty(),null===(d=Z.test)||void 0===d?void 0:d.type){case"truefalse":{var lt,wt,Tt,Lt;let X=null==Z||null===(lt=Z.test)||void 0===lt||null===(lt=lt.answer)||void 0===lt||null===(lt=lt.truefalse)||void 0===lt?void 0:lt.value,Q=null===(wt=Z.svg)||void 0===wt?void 0:wt.nodes.find(H=>{var x;return"submit"==(null===(x=H.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)});null===(Tt=Z.svg)||void 0===Tt||Tt.nodes.filter(H=>{var x;return"truefalse"==(null===(x=H.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)&&(H.id!=X||!Q)}).forEach(H=>{var x;let{x:gt,y:It,width:mt,height:Rt}=null!==(x=null==H?void 0:H.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,w._)(Math.ceil(1e9*Math.random()),{size:{x:gt-.5,y:It-.5,width:mt+1,height:Rt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},V)}),null!=Z&&null!==(Lt=Z.test)&&void 0!==Lt&&null!==(Lt=Lt.answer)&&void 0!==Lt&&Lt.truefalse&&X&&Q&&(H=>{let x=I.$.findNode(X),{x:gt,y:It,width:mt,height:Rt}=null!==(H=null==x?void 0:x.size)&&void 0!==H?H:{x:0,y:0,width:0,height:0};(0,w._)(Math.ceil(1e9*Math.random()),{size:{x:gt-2,y:It-2,width:mt+4,height:Rt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},V)})();break}case"singlechoice":{var Qt,Ht,Pt,vt;let X=null==Z||null===(Qt=Z.test)||void 0===Qt||null===(Qt=Qt.answer)||void 0===Qt||null===(Qt=Qt.singlechoice)||void 0===Qt?void 0:Qt.value,Q=null===(Ht=Z.svg)||void 0===Ht?void 0:Ht.nodes.find(H=>{var x;return"submit"==(null===(x=H.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)});null===(Pt=Z.svg)||void 0===Pt||Pt.nodes.filter(H=>{var x;return"singlechoice"==(null===(x=H.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)&&(H.id!=X||!Q)}).forEach(H=>{var x;let{x:gt,y:It,width:mt,height:Rt}=null!==(x=null==H?void 0:H.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,w._)(Math.ceil(1e9*Math.random()),{size:{x:gt-.5,y:It-.5,width:mt+1,height:Rt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},V)}),null!=Z&&null!==(vt=Z.test)&&void 0!==vt&&null!==(vt=vt.answer)&&void 0!==vt&&vt.singlechoice&&X&&Q&&(H=>{let x=I.$.findNode(X),{x:gt,y:It,width:mt,height:Rt}=null!==(H=null==x?void 0:x.size)&&void 0!==H?H:{x:0,y:0,width:0,height:0};(0,w._)(Math.ceil(1e9*Math.random()),{size:{x:gt-2,y:It-2,width:mt+4,height:Rt+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},V)})();break}case"multichoice":{var te,Y,v,q,ut;let X=null!==(te=null==Z||null===(Y=Z.test)||void 0===Y||null===(Y=Y.answer)||void 0===Y||null===(Y=Y.multichoice)||void 0===Y?void 0:Y.map(H=>H.value))&&void 0!==te?te:[],Q=null===(v=Z.svg)||void 0===v?void 0:v.nodes.find(H=>{var x;return"submit"==(null===(x=H.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)});var dt;null===(q=Z.svg)||void 0===q||q.nodes.filter(H=>{var x;return!("multichoice"!=(null===(x=H.source)||void 0===x||null===(x=x.test)||void 0===x?void 0:x.type)||X.includes(H.id)&&Q)}).forEach(H=>{var x;let{x:gt,y:It,width:mt,height:Rt}=null!==(x=null==H?void 0:H.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,A.f)(Math.ceil(1e9*Math.random()),{size:{x:gt-.5,y:It-.5,width:mt+1,height:Rt+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},V)}),null!=Z&&null!==(ut=Z.test)&&void 0!==ut&&null!==(ut=ut.answer)&&void 0!==ut&&ut.multichoice&&X.length&&Q&&(null==Z||null===(dt=Z.test)||void 0===dt||null===(dt=dt.answer)||void 0===dt||dt.multichoice.forEach(H=>{var x;let z=I.$.findNode(H.value),{x:It,y:mt,width:Rt,height:Ut}=null!==(x=null==z?void 0:z.size)&&void 0!==x?x:{x:0,y:0,width:0,height:0};(0,A.f)(Math.ceil(1e9*Math.random()),{size:{x:It-2,y:mt-2,width:Rt+4,height:Ut+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},V)}));break}}}},370:(ae,Dt,y)=>{y.d(Dt,{e:()=>st});const st=b=>{switch(null==b?void 0:b.type){case 901:return"assets/iframe/lib/mk-image-viewer/viewer.html?url="+b.readfileuploadurl+b.path;case 902:return"assets/iframe/lib/mk-audio-player/player.html?url="+b.readfileuploadurl+b.path;case 903:return"assets/iframe/lib/mk-video-player/player.html?url="+b.readfileuploadurl+b.path;case 908:return"https://view.officeapps.live.com/op/view.aspx?src="+b.readfileuploadurl+b.path;case 909:return"assets/iframe/lib/PDFReader/web/viewer.html?file="+b.readfileuploadurl+b.path;case 906:case 911:case 910:return""+b.readfileuploadurl+b.path;case 905:case 912:var h;return"imsmanifest.xml"==(null===(h=b.path)||void 0===h||null===(h=h.split("/"))||void 0===h?void 0:h.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+b.readfileuploadurl+b.path:""+b.readfileuploadurl+b.path;case 907:case 900:return""+b.readfileuploadurl+b.path;case 904:switch(b.oss){case 1003:return"assets/iframe/lib/ScormPool_Player/player.html?url="+b.url;case 1002:var R;return null!==(R=U(b.url))&&void 0!==R?R:"";case 1005:var P;return null!==(P=b.url)&&void 0!==P?P:"";default:var f;return null!==(f=b.url)&&void 0!==f?f:""}default:return""+b.readfileuploadurl+b.path}},U=b=>{let h=yt(b);return h?"https://www.youtube.com/embed/"+h+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},yt=b=>{let h=null==b?void 0:b.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return h&&h.length>=2?h[1]:null}},511:(ae,Dt,y)=>{function C(){}function k(t){return null==t?C:function(){return this.querySelector(t)}}function yt(){return[]}function b(t){return null==t?yt:function(){return this.querySelectorAll(t)}}function P(t){return function(){return this.matches(t)}}function f(t){return function(e){return e.matches(t)}}y.d(Dt,{$0Z:()=>aa,jvg:()=>la});var M=Array.prototype.find;function A(){return this.firstElementChild}var w=Array.prototype.filter;function I(){return Array.from(this.children)}function tt(t){return new Array(t.length)}function at(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ot(t,e,l,s,c,E){for(var W,S=0,F=e.length,ot=E.length;S<ot;++S)(W=e[S])?(W.__data__=E[S],s[S]=W):l[S]=new at(t,E[S]);for(;S<F;++S)(W=e[S])&&(c[S]=W)}function At(t,e,l,s,c,E,S){var W,F,Xt,ot=new Map,ft=e.length,zt=E.length,Gt=new Array(ft);for(W=0;W<ft;++W)(F=e[W])&&(Gt[W]=Xt=S.call(F,F.__data__,W,e)+"",ot.has(Xt)?c[W]=F:ot.set(Xt,F));for(W=0;W<zt;++W)Xt=S.call(t,E[W],W,E)+"",(F=ot.get(Xt))?(s[W]=F,F.__data__=E[W],ot.delete(Xt)):l[W]=new at(t,E[W]);for(W=0;W<ft;++W)(F=e[W])&&ot.get(Gt[W])===F&&(c[W]=F)}function Kt(t){return t.__data__}function Mt(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Et(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}at.prototype={constructor:at,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var wt="http://www.w3.org/1999/xhtml";const Tt={svg:"http://www.w3.org/2000/svg",xhtml:wt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Lt(t){var e=t+="",l=e.indexOf(":");return l>=0&&"xmlns"!==(e=t.slice(0,l))&&(t=t.slice(l+1)),Tt.hasOwnProperty(e)?{space:Tt[e],local:t}:t}function Qt(t){return function(){this.removeAttribute(t)}}function Ht(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pt(t,e){return function(){this.setAttribute(t,e)}}function vt(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function te(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttribute(t):this.setAttribute(t,l)}}function Y(t,e){return function(){var l=e.apply(this,arguments);null==l?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,l)}}function q(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ut(t){return function(){this.style.removeProperty(t)}}function dt(t,e,l){return function(){this.style.setProperty(t,e,l)}}function X(t,e,l){return function(){var s=e.apply(this,arguments);null==s?this.style.removeProperty(t):this.style.setProperty(t,s,l)}}function H(t,e){return t.style.getPropertyValue(e)||q(t).getComputedStyle(t,null).getPropertyValue(e)}function x(t){return function(){delete this[t]}}function z(t,e){return function(){this[t]=e}}function gt(t,e){return function(){var l=e.apply(this,arguments);null==l?delete this[t]:this[t]=l}}function mt(t){return t.trim().split(/^|\s+/)}function Rt(t){return t.classList||new Ut(t)}function Ut(t){this._node=t,this._names=mt(t.getAttribute("class")||"")}function Wt(t,e){for(var l=Rt(t),s=-1,c=e.length;++s<c;)l.add(e[s])}function Vt(t,e){for(var l=Rt(t),s=-1,c=e.length;++s<c;)l.remove(e[s])}function qt(t){return function(){Wt(this,t)}}function ce(t){return function(){Vt(this,t)}}function pe(t,e){return function(){(e.apply(this,arguments)?Wt:Vt)(this,t)}}function se(){this.textContent=""}function xe(t){return function(){this.textContent=t}}function Qe(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ve(){this.innerHTML=""}function Je(t){return function(){this.innerHTML=t}}function ei(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ze(){this.nextSibling&&this.parentNode.appendChild(this)}function Ue(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ye(t){return function(){var e=this.ownerDocument,l=this.namespaceURI;return l===wt&&e.documentElement.namespaceURI===wt?e.createElement(t):e.createElementNS(l,t)}}function He(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ge(t){var e=Lt(t);return(e.local?He:Ye)(e)}function bt(){return null}function i(){var t=this.parentNode;t&&t.removeChild(this)}function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function a(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function O(t){return function(){var e=this.__on;if(e){for(var E,l=0,s=-1,c=e.length;l<c;++l)E=e[l],t.type&&E.type!==t.type||E.name!==t.name?e[++s]=E:this.removeEventListener(E.type,E.listener,E.options);++s?e.length=s:delete this.__on}}}function _(t,e,l){return function(){var c,s=this.__on,E=function m(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var S=0,W=s.length;S<W;++S)if((c=s[S]).type===t.type&&c.name===t.name)return this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=E,c.options=l),void(c.value=e);this.addEventListener(t.type,E,l),c={type:t.type,name:t.name,value:e,listener:E,options:l},s?s.push(c):this.__on=[c]}}function j(t,e,l){var s=q(t),c=s.CustomEvent;"function"==typeof c?c=new c(e,l):(c=s.document.createEvent("Event"),l?(c.initEvent(e,l.bubbles,l.cancelable),c.detail=l.detail):c.initEvent(e,!1,!1)),t.dispatchEvent(c)}function ht(t,e){return function(){return j(this,t,e)}}function ct(t,e){return function(){return j(this,t,e.apply(this,arguments))}}Ut.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Zt=[null];function fe(t,e){this._groups=t,this._parents=e}function ge(){return new fe([[document.documentElement]],Zt)}fe.prototype=ge.prototype={constructor:fe,select:function st(t){"function"!=typeof t&&(t=k(t));for(var e=this._groups,l=e.length,s=new Array(l),c=0;c<l;++c)for(var F,ot,E=e[c],S=E.length,W=s[c]=new Array(S),ft=0;ft<S;++ft)(F=E[ft])&&(ot=t.call(F,F.__data__,ft,E))&&("__data__"in F&&(ot.__data__=F.__data__),W[ft]=ot);return new fe(s,this._parents)},selectAll:function R(t){t="function"==typeof t?function h(t){return function(){return function U(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):b(t);for(var e=this._groups,l=e.length,s=[],c=[],E=0;E<l;++E)for(var F,S=e[E],W=S.length,ot=0;ot<W;++ot)(F=S[ot])&&(s.push(t.call(F,F.__data__,ot,S)),c.push(F));return new fe(s,c)},selectChild:function J(t){return this.select(null==t?A:function T(t){return function(){return M.call(this.children,t)}}("function"==typeof t?t:f(t)))},selectChildren:function K(t){return this.selectAll(null==t?I:function u(t){return function(){return w.call(this.children,t)}}("function"==typeof t?t:f(t)))},filter:function N(t){"function"!=typeof t&&(t=P(t));for(var e=this._groups,l=e.length,s=new Array(l),c=0;c<l;++c)for(var F,E=e[c],S=E.length,W=s[c]=[],ot=0;ot<S;++ot)(F=E[ot])&&t.call(F,F.__data__,ot,E)&&W.push(F);return new fe(s,this._parents)},data:function Ct(t,e){if(!arguments.length)return Array.from(this,Kt);var l=e?At:Ot,s=this._parents,c=this._groups;"function"!=typeof t&&(t=function L(t){return function(){return t}}(t));for(var E=c.length,S=new Array(E),W=new Array(E),F=new Array(E),ot=0;ot<E;++ot){var ft=s[ot],zt=c[ot],Gt=zt.length,Xt=Mt(t.call(ft,ft&&ft.__data__,ot,s)),me=Xt.length,Oe=W[ot]=new Array(me),Bt=S[ot]=new Array(me);l(ft,zt,Oe,Bt,F[ot]=new Array(Gt),Xt,e);for(var de,ve,ne=0,Yt=0;ne<me;++ne)if(de=Oe[ne]){for(ne>=Yt&&(Yt=ne+1);!(ve=Bt[Yt])&&++Yt<me;);de._next=ve||null}}return(S=new fe(S,s))._enter=W,S._exit=F,S},enter:function et(){return new fe(this._enter||this._groups.map(tt),this._parents)},exit:function _t(){return new fe(this._exit||this._groups.map(tt),this._parents)},join:function it(t,e,l){var s=this.enter(),c=this,E=this.exit();return"function"==typeof t?(s=t(s))&&(s=s.selection()):s=s.append(t+""),null!=e&&(c=e(c))&&(c=c.selection()),null==l?E.remove():l(E),s&&c?s.merge(c).order():c},merge:function B(t){for(var e=t.selection?t.selection():t,l=this._groups,s=e._groups,c=l.length,S=Math.min(c,s.length),W=new Array(c),F=0;F<S;++F)for(var Xt,ot=l[F],ft=s[F],zt=ot.length,Gt=W[F]=new Array(zt),me=0;me<zt;++me)(Xt=ot[me]||ft[me])&&(Gt[me]=Xt);for(;F<c;++F)W[F]=l[F];return new fe(W,this._parents)},selection:function we(){return this},order:function pt(){for(var t=this._groups,e=-1,l=t.length;++e<l;)for(var S,s=t[e],c=s.length-1,E=s[c];--c>=0;)(S=s[c])&&(E&&4^S.compareDocumentPosition(E)&&E.parentNode.insertBefore(S,E),E=S);return this},sort:function St(t){function e(zt,Gt){return zt&&Gt?t(zt.__data__,Gt.__data__):!zt-!Gt}t||(t=Et);for(var l=this._groups,s=l.length,c=new Array(s),E=0;E<s;++E){for(var ot,S=l[E],W=S.length,F=c[E]=new Array(W),ft=0;ft<W;++ft)(ot=S[ft])&&(F[ft]=ot);F.sort(e)}return new fe(c,this._parents).order()},call:function rt(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function $t(){return Array.from(this)},node:function V(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var s=t[e],c=0,E=s.length;c<E;++c){var S=s[c];if(S)return S}return null},size:function Z(){let t=0;for(const e of this)++t;return t},empty:function d(){return!this.node()},each:function lt(t){for(var e=this._groups,l=0,s=e.length;l<s;++l)for(var W,c=e[l],E=0,S=c.length;E<S;++E)(W=c[E])&&t.call(W,W.__data__,E,c);return this},attr:function v(t,e){var l=Lt(t);if(arguments.length<2){var s=this.node();return l.local?s.getAttributeNS(l.space,l.local):s.getAttribute(l)}return this.each((null==e?l.local?Ht:Qt:"function"==typeof e?l.local?Y:te:l.local?vt:Pt)(l,e))},style:function Q(t,e,l){return arguments.length>1?this.each((null==e?ut:"function"==typeof e?X:dt)(t,e,null==l?"":l)):H(this.node(),t)},property:function It(t,e){return arguments.length>1?this.each((null==e?x:"function"==typeof e?gt:z)(t,e)):this.node()[t]},classed:function oe(t,e){var l=mt(t+"");if(arguments.length<2){for(var s=Rt(this.node()),c=-1,E=l.length;++c<E;)if(!s.contains(l[c]))return!1;return!0}return this.each(("function"==typeof e?pe:e?qt:ce)(l,e))},text:function Pe(t){return arguments.length?this.each(null==t?se:("function"==typeof t?Qe:xe)(t)):this.node().textContent},html:function Ee(t){return arguments.length?this.each(null==t?Ve:("function"==typeof t?ei:Je)(t)):this.node().innerHTML},raise:function De(){return this.each(Ze)},lower:function Xe(){return this.each(Ue)},append:function qe(t){var e="function"==typeof t?t:Ge(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function D(t,e){var l="function"==typeof t?t:Ge(t),s=null==e?bt:"function"==typeof e?e:k(e);return this.select(function(){return this.insertBefore(l.apply(this,arguments),s.apply(this,arguments)||null)})},remove:function n(){return this.each(i)},clone:function o(t){return this.select(t?a:r)},datum:function p(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function G(t,e,l){var c,S,s=function g(t){return t.trim().split(/^|\s+/).map(function(e){var l="",s=e.indexOf(".");return s>=0&&(l=e.slice(s+1),e=e.slice(0,s)),{type:e,name:l}})}(t+""),E=s.length;if(!(arguments.length<2)){for(W=e?_:O,c=0;c<E;++c)this.each(W(s[c],e,l));return this}var W=this.node().__on;if(W)for(var ft,F=0,ot=W.length;F<ot;++F)for(c=0,ft=W[F];c<E;++c)if((S=s[c]).type===ft.type&&S.name===ft.name)return ft.value},dispatch:function xt(t,e){return this.each(("function"==typeof e?ct:ht)(t,e))},[Symbol.iterator]:function*jt(){for(var t=this._groups,e=0,l=t.length;e<l;++e)for(var S,s=t[e],c=0,E=s.length;c<E;++c)(S=s[c])&&(yield S)}};const ye=ge;var Se={value:()=>{}};function vn(){for(var s,t=0,e=arguments.length,l={};t<e;++t){if(!(s=arguments[t]+"")||s in l||/[\s.]/.test(s))throw new Error("illegal type: "+s);l[s]=[]}return new Ri(l)}function Ri(t){this._=t}function ar(t,e){for(var c,l=0,s=t.length;l<s;++l)if((c=t[l]).name===e)return c.value}function gn(t,e,l){for(var s=0,c=t.length;s<c;++s)if(t[s].name===e){t[s]=Se,t=t.slice(0,s).concat(t.slice(s+1));break}return null!=l&&t.push({name:e,value:l}),t}Ri.prototype=vn.prototype={constructor:Ri,on:function(t,e){var c,l=this._,s=function lr(t,e){return t.trim().split(/^|\s+/).map(function(l){var s="",c=l.indexOf(".");if(c>=0&&(s=l.slice(c+1),l=l.slice(0,c)),l&&!e.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:s}})}(t+"",l),E=-1,S=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++E<S;)if(c=(t=s[E]).type)l[c]=gn(l[c],t.name,e);else if(null==e)for(c in l)l[c]=gn(l[c],t.name,null);return this}for(;++E<S;)if((c=(t=s[E]).type)&&(c=ar(l[c],t.name)))return c},copy:function(){var t={},e=this._;for(var l in e)t[l]=e[l].slice();return new Ri(t)},call:function(t,e){if((c=arguments.length-2)>0)for(var c,E,l=new Array(c),s=0;s<c;++s)l[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,c=(E=this._[t]).length;s<c;++s)E[s].value.apply(e,l)},apply:function(t,e,l){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],c=0,E=s.length;c<E;++c)s[c].value.apply(e,l)}};const or=vn;var Ni,Oi,gi=0,xi=0,Ei=0,yn=1e3,Li=0,ui=0,Di=0,Si="object"==typeof performance&&performance.now?performance:Date,pn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return ui||(pn(sr),ui=Si.now()+Di)}function sr(){ui=0}function ji(){this._call=this._time=this._next=null}function mn(t,e,l){var s=new ji;return s.restart(t,e,l),s}function _n(){ui=(Li=Si.now())+Di,gi=xi=0;try{!function dr(){Xi(),++gi;for(var e,t=Ni;t;)(e=ui-t._time)>=0&&t._call.call(void 0,e),t=t._next;--gi}()}finally{gi=0,function hr(){for(var t,l,e=Ni,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(l=e._next,e._next=null,e=t?t._next=l:Ni=l);Oi=t,Yi(s)}(),ui=0}}function ur(){var t=Si.now(),e=t-Li;e>yn&&(Di-=e,Li=t)}function Yi(t){gi||(xi&&(xi=clearTimeout(xi)),t-ui>24?(t<1/0&&(xi=setTimeout(_n,t-Si.now()-Di)),Ei&&(Ei=clearInterval(Ei))):(Ei||(Li=Si.now(),Ei=setInterval(ur,yn)),gi=1,pn(_n)))}function wn(t,e,l){var s=new ji;return s.restart(c=>{s.stop(),t(c+e)},e=null==e?0:+e,l),s}ji.prototype=mn.prototype={constructor:ji,restart:function(t,e,l){if("function"!=typeof t)throw new TypeError("callback is not a function");l=(null==l?Xi():+l)+(null==e?0:+e),!this._next&&Oi!==this&&(Oi?Oi._next=this:Ni=this,Oi=this),this._call=t,this._time=l,Yi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Yi())}};var cr=or("start","end","cancel","interrupt"),fr=[],bn=0,Bi=3;function zi(t,e,l,s,c,E){var S=t.__transition;if(S){if(l in S)return}else t.__transition={};!function vr(t,e,l){var c,s=t.__transition;function S(ot){var ft,zt,Gt,Xt;if(1!==l.state)return F();for(ft in s)if((Xt=s[ft]).name===l.name){if(Xt.state===Bi)return wn(S);4===Xt.state?(Xt.state=6,Xt.timer.stop(),Xt.on.call("interrupt",t,t.__data__,Xt.index,Xt.group),delete s[ft]):+ft<e&&(Xt.state=6,Xt.timer.stop(),Xt.on.call("cancel",t,t.__data__,Xt.index,Xt.group),delete s[ft])}if(wn(function(){l.state===Bi&&(l.state=4,l.timer.restart(W,l.delay,l.time),W(ot))}),l.state=2,l.on.call("start",t,t.__data__,l.index,l.group),2===l.state){for(l.state=Bi,c=new Array(Gt=l.tween.length),ft=0,zt=-1;ft<Gt;++ft)(Xt=l.tween[ft].value.call(t,t.__data__,l.index,l.group))&&(c[++zt]=Xt);c.length=zt+1}}function W(ot){for(var ft=ot<l.duration?l.ease.call(null,ot/l.duration):(l.timer.restart(F),l.state=5,1),zt=-1,Gt=c.length;++zt<Gt;)c[zt].call(t,ft);5===l.state&&(l.on.call("end",t,t.__data__,l.index,l.group),F())}function F(){for(var ot in l.state=6,l.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=l,l.timer=mn(function E(ot){l.state=1,l.timer.restart(S,l.delay,l.time),l.delay<=ot&&S(ot-l.delay)},0,l.time)}(t,l,{name:e,index:s,group:c,on:cr,tween:fr,time:E.time,delay:E.delay,duration:E.duration,ease:E.ease,timer:null,state:bn})}function tn(t,e){var l=$e(t,e);if(l.state>bn)throw new Error("too late; already scheduled");return l}function ii(t,e){var l=$e(t,e);if(l.state>Bi)throw new Error("too late; already running");return l}function $e(t,e){var l=t.__transition;if(!l||!(l=l[e]))throw new Error("transition not found");return l}function si(t,e){return t=+t,e=+e,function(l){return t*(1-l)+e*l}}var Ui,On=180/Math.PI,en={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Sn(t,e,l,s,c,E){var S,W,F;return(S=Math.sqrt(t*t+e*e))&&(t/=S,e/=S),(F=t*l+e*s)&&(l-=t*F,s-=e*F),(W=Math.sqrt(l*l+s*s))&&(l/=W,s/=W,F/=W),t*s<e*l&&(t=-t,e=-e,F=-F,S=-S),{translateX:c,translateY:E,rotate:Math.atan2(e,t)*On,skewX:Math.atan(F)*On,scaleX:S,scaleY:W}}function kn(t,e,l,s){function c(ot){return ot.length?ot.pop()+" ":""}return function(ot,ft){var zt=[],Gt=[];return ot=t(ot),ft=t(ft),function E(ot,ft,zt,Gt,Xt,me){if(ot!==zt||ft!==Gt){var Oe=Xt.push("translate(",null,e,null,l);me.push({i:Oe-4,x:si(ot,zt)},{i:Oe-2,x:si(ft,Gt)})}else(zt||Gt)&&Xt.push("translate("+zt+e+Gt+l)}(ot.translateX,ot.translateY,ft.translateX,ft.translateY,zt,Gt),function S(ot,ft,zt,Gt){ot!==ft?(ot-ft>180?ft+=360:ft-ot>180&&(ot+=360),Gt.push({i:zt.push(c(zt)+"rotate(",null,s)-2,x:si(ot,ft)})):ft&&zt.push(c(zt)+"rotate("+ft+s)}(ot.rotate,ft.rotate,zt,Gt),function W(ot,ft,zt,Gt){ot!==ft?Gt.push({i:zt.push(c(zt)+"skewX(",null,s)-2,x:si(ot,ft)}):ft&&zt.push(c(zt)+"skewX("+ft+s)}(ot.skewX,ft.skewX,zt,Gt),function F(ot,ft,zt,Gt,Xt,me){if(ot!==zt||ft!==Gt){var Oe=Xt.push(c(Xt)+"scale(",null,",",null,")");me.push({i:Oe-4,x:si(ot,zt)},{i:Oe-2,x:si(ft,Gt)})}else(1!==zt||1!==Gt)&&Xt.push(c(Xt)+"scale("+zt+","+Gt+")")}(ot.scaleX,ot.scaleY,ft.scaleX,ft.scaleY,zt,Gt),ot=ft=null,function(Xt){for(var Bt,me=-1,Oe=Gt.length;++me<Oe;)zt[(Bt=Gt[me]).i]=Bt.x(Xt);return zt.join("")}}}var _r=kn(function pr(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?en:Sn(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),wr=kn(function mr(t){return null!=t&&(Ui||(Ui=document.createElementNS("http://www.w3.org/2000/svg","g")),Ui.setAttribute("transform",t),t=Ui.transform.baseVal.consolidate())?Sn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):en},", ",")",")");function br(t,e){var l,s;return function(){var c=ii(this,t),E=c.tween;if(E!==l)for(var S=0,W=(s=l=E).length;S<W;++S)if(s[S].name===e){(s=s.slice()).splice(S,1);break}c.tween=s}}function xr(t,e,l){var s,c;if("function"!=typeof l)throw new Error;return function(){var E=ii(this,t),S=E.tween;if(S!==s){c=(s=S).slice();for(var W={name:e,value:l},F=0,ot=c.length;F<ot;++F)if(c[F].name===e){c[F]=W;break}F===ot&&c.push(W)}E.tween=c}}function nn(t,e,l){var s=t._id;return t.each(function(){var c=ii(this,s);(c.value||(c.value={}))[e]=l.apply(this,arguments)}),function(c){return $e(c,s).value[e]}}function rn(t,e,l){t.prototype=e.prototype=l,l.constructor=t}function Tn(t,e){var l=Object.create(t.prototype);for(var s in e)l[s]=e[s];return l}function ki(){}var Gi=1/.7,yi="\\s*([+-]?\\d+)\\s*",Ci="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ni="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Or=/^#([0-9a-f]{3,8})$/,Sr=new RegExp(`^rgb\\(${yi},${yi},${yi}\\)$`),kr=new RegExp(`^rgb\\(${ni},${ni},${ni}\\)$`),Tr=new RegExp(`^rgba\\(${yi},${yi},${yi},${Ci}\\)$`),Cr=new RegExp(`^rgba\\(${ni},${ni},${ni},${Ci}\\)$`),Ar=new RegExp(`^hsl\\(${Ci},${ni},${ni}\\)$`),Mr=new RegExp(`^hsla\\(${Ci},${ni},${ni},${Ci}\\)$`),Cn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function An(){return this.rgb().formatHex()}function Mn(){return this.rgb().formatRgb()}function Ai(t){var e,l;return t=(t+"").trim().toLowerCase(),(e=Or.exec(t))?(l=e[1].length,e=parseInt(e[1],16),6===l?In(e):3===l?new Be(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===l?Wi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===l?Wi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Sr.exec(t))?new Be(e[1],e[2],e[3],1):(e=kr.exec(t))?new Be(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Tr.exec(t))?Wi(e[1],e[2],e[3],e[4]):(e=Cr.exec(t))?Wi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Ar.exec(t))?Nn(e[1],e[2]/100,e[3]/100,1):(e=Mr.exec(t))?Nn(e[1],e[2]/100,e[3]/100,e[4]):Cn.hasOwnProperty(t)?In(Cn[t]):"transparent"===t?new Be(NaN,NaN,NaN,0):null}function In(t){return new Be(t>>16&255,t>>8&255,255&t,1)}function Wi(t,e,l,s){return s<=0&&(t=e=l=NaN),new Be(t,e,l,s)}function Fi(t,e,l,s){return 1===arguments.length?function Rr(t){return t instanceof ki||(t=Ai(t)),t?new Be((t=t.rgb()).r,t.g,t.b,t.opacity):new Be}(t):new Be(t,e,l,null==s?1:s)}function Be(t,e,l,s){this.r=+t,this.g=+e,this.b=+l,this.opacity=+s}function Pn(){return`#${ci(this.r)}${ci(this.g)}${ci(this.b)}`}function Rn(){const t=Qi(this.opacity);return`${1===t?"rgb(":"rgba("}${hi(this.r)}, ${hi(this.g)}, ${hi(this.b)}${1===t?")":`, ${t})`}`}function Qi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function hi(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ci(t){return((t=hi(t))<16?"0":"")+t.toString(16)}function Nn(t,e,l,s){return s<=0?t=e=l=NaN:l<=0||l>=1?t=e=NaN:e<=0&&(t=NaN),new ti(t,e,l,s)}function Ln(t){if(t instanceof ti)return new ti(t.h,t.s,t.l,t.opacity);if(t instanceof ki||(t=Ai(t)),!t)return new ti;if(t instanceof ti)return t;var e=(t=t.rgb()).r/255,l=t.g/255,s=t.b/255,c=Math.min(e,l,s),E=Math.max(e,l,s),S=NaN,W=E-c,F=(E+c)/2;return W?(S=e===E?(l-s)/W+6*(l<s):l===E?(s-e)/W+2:(e-l)/W+4,W/=F<.5?E+c:2-E-c,S*=60):W=F>0&&F<1?0:S,new ti(S,W,F,t.opacity)}function ti(t,e,l,s){this.h=+t,this.s=+e,this.l=+l,this.opacity=+s}function Dn(t){return(t=(t||0)%360)<0?t+360:t}function Hi(t){return Math.max(0,Math.min(1,t||0))}function ln(t,e,l){return 255*(t<60?e+(l-e)*t/60:t<180?l:t<240?e+(l-e)*(240-t)/60:e)}function jn(t,e,l,s,c){var E=t*t,S=E*t;return((1-3*t+3*E-S)*e+(4-6*E+3*S)*l+(1+3*t+3*E-3*S)*s+S*c)/6}rn(ki,Ai,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:An,formatHex:An,formatHex8:function Ir(){return this.rgb().formatHex8()},formatHsl:function Pr(){return Ln(this).formatHsl()},formatRgb:Mn,toString:Mn}),rn(Be,Fi,Tn(ki,{brighter(t){return t=null==t?Gi:Math.pow(Gi,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Be(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Be(hi(this.r),hi(this.g),hi(this.b),Qi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatHex8:function Nr(){return`#${ci(this.r)}${ci(this.g)}${ci(this.b)}${ci(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rn,toString:Rn})),rn(ti,function Lr(t,e,l,s){return 1===arguments.length?Ln(t):new ti(t,e,l,null==s?1:s)},Tn(ki,{brighter(t){return t=null==t?Gi:Math.pow(Gi,t),new ti(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new ti(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,l=this.l,s=l+(l<.5?l:1-l)*e,c=2*l-s;return new Be(ln(t>=240?t-240:t+120,c,s),ln(t,c,s),ln(t<120?t+240:t-120,c,s),this.opacity)},clamp(){return new ti(Dn(this.h),Hi(this.s),Hi(this.l),Qi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qi(this.opacity);return`${1===t?"hsl(":"hsla("}${Dn(this.h)}, ${100*Hi(this.s)}%, ${100*Hi(this.l)}%${1===t?")":`, ${t})`}`}}));const Bn=t=>()=>t;function zn(t,e){var l=e-t;return l?function Kn(t,e){return function(l){return t+l*e}}(t,l):Bn(isNaN(t)?e:t)}const Un=function t(e){var l=function Kr(t){return 1==(t=+t)?zn:function(e,l){return l-e?function Br(t,e,l){return t=Math.pow(t,l),e=Math.pow(e,l)-t,l=1/l,function(s){return Math.pow(t+s*e,l)}}(e,l,t):Bn(isNaN(e)?l:e)}}(e);function s(c,E){var S=l((c=Fi(c)).r,(E=Fi(E)).r),W=l(c.g,E.g),F=l(c.b,E.b),ot=zn(c.opacity,E.opacity);return function(ft){return c.r=S(ft),c.g=W(ft),c.b=F(ft),c.opacity=ot(ft),c+""}}return s.gamma=t,s}(1);function Gn(t){return function(e){var S,W,l=e.length,s=new Array(l),c=new Array(l),E=new Array(l);for(S=0;S<l;++S)W=Fi(e[S]),s[S]=W.r||0,c[S]=W.g||0,E[S]=W.b||0;return s=t(s),c=t(c),E=t(E),W.opacity=1,function(F){return W.r=s(F),W.g=c(F),W.b=E(F),W+""}}}Gn(function Dr(t){var e=t.length-1;return function(l){var s=l<=0?l=0:l>=1?(l=1,e-1):Math.floor(l*e),c=t[s],E=t[s+1];return jn((l-s/e)*e,s>0?t[s-1]:2*c-E,c,E,s<e-1?t[s+2]:2*E-c)}}),Gn(function jr(t){var e=t.length;return function(l){var s=Math.floor(((l%=1)<0?++l:l)*e);return jn((l-s/e)*e,t[(s+e-1)%e],t[s%e],t[(s+1)%e],t[(s+2)%e])}});var an=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(an.source,"g");function Gr(t,e){var s,c,E,l=an.lastIndex=on.lastIndex=0,S=-1,W=[],F=[];for(t+="",e+="";(s=an.exec(t))&&(c=on.exec(e));)(E=c.index)>l&&(E=e.slice(l,E),W[S]?W[S]+=E:W[++S]=E),(s=s[0])===(c=c[0])?W[S]?W[S]+=c:W[++S]=c:(W[++S]=null,F.push({i:S,x:si(s,c)})),l=on.lastIndex;return l<e.length&&(E=e.slice(l),W[S]?W[S]+=E:W[++S]=E),W.length<2?F[0]?function Ur(t){return function(e){return t(e)+""}}(F[0].x):function zr(t){return function(){return t}}(e):(e=F.length,function(ot){for(var zt,ft=0;ft<e;++ft)W[(zt=F[ft]).i]=zt.x(ot);return W.join("")})}function Wn(t,e){var l;return("number"==typeof e?si:e instanceof Ai?Un:(l=Ai(e))?(e=l,Un):Gr)(t,e)}function Wr(t){return function(){this.removeAttribute(t)}}function Fr(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qr(t,e,l){var s,E,c=l+"";return function(){var S=this.getAttribute(t);return S===c?null:S===s?E:E=e(s=S,l)}}function Hr(t,e,l){var s,E,c=l+"";return function(){var S=this.getAttributeNS(t.space,t.local);return S===c?null:S===s?E:E=e(s=S,l)}}function Vr(t,e,l){var s,c,E;return function(){var S,F,W=l(this);return null==W?void this.removeAttribute(t):(S=this.getAttribute(t))===(F=W+"")?null:S===s&&F===c?E:(c=F,E=e(s=S,W))}}function Jr(t,e,l){var s,c,E;return function(){var S,F,W=l(this);return null==W?void this.removeAttributeNS(t.space,t.local):(S=this.getAttributeNS(t.space,t.local))===(F=W+"")?null:S===s&&F===c?E:(c=F,E=e(s=S,W))}}function qr(t,e){var l,s;function c(){var E=e.apply(this,arguments);return E!==s&&(l=(s=E)&&function Yr(t,e){return function(l){this.setAttributeNS(t.space,t.local,e.call(this,l))}}(t,E)),l}return c._value=e,c}function $r(t,e){var l,s;function c(){var E=e.apply(this,arguments);return E!==s&&(l=(s=E)&&function Xr(t,e){return function(l){this.setAttribute(t,e.call(this,l))}}(t,E)),l}return c._value=e,c}function el(t,e){return function(){tn(this,t).delay=+e.apply(this,arguments)}}function il(t,e){return e=+e,function(){tn(this,t).delay=e}}function rl(t,e){return function(){ii(this,t).duration=+e.apply(this,arguments)}}function ll(t,e){return e=+e,function(){ii(this,t).duration=e}}var wl=ye.prototype.constructor;function Fn(t){return function(){this.style.removeProperty(t)}}var Bl=0;function li(t,e,l,s){this._groups=t,this._parents=e,this._name=l,this._id=s}function Qn(){return++Bl}var ai=ye.prototype;li.prototype=function Kl(t){return ye().transition(t)}.prototype={constructor:li,select:function ml(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=k(t));for(var s=this._groups,c=s.length,E=new Array(c),S=0;S<c;++S)for(var ft,zt,W=s[S],F=W.length,ot=E[S]=new Array(F),Gt=0;Gt<F;++Gt)(ft=W[Gt])&&(zt=t.call(ft,ft.__data__,Gt,W))&&("__data__"in ft&&(zt.__data__=ft.__data__),ot[Gt]=zt,zi(ot[Gt],e,l,Gt,ot,$e(ft,l)));return new li(E,this._parents,e,l)},selectAll:function _l(t){var e=this._name,l=this._id;"function"!=typeof t&&(t=b(t));for(var s=this._groups,c=s.length,E=[],S=[],W=0;W<c;++W)for(var ft,F=s[W],ot=F.length,zt=0;zt<ot;++zt)if(ft=F[zt]){for(var Xt,Gt=t.call(ft,ft.__data__,zt,F),me=$e(ft,l),Oe=0,Bt=Gt.length;Oe<Bt;++Oe)(Xt=Gt[Oe])&&zi(Xt,e,l,Oe,Gt,me);E.push(Gt),S.push(ft)}return new li(E,S,e,l)},selectChild:ai.selectChild,selectChildren:ai.selectChildren,filter:function hl(t){"function"!=typeof t&&(t=P(t));for(var e=this._groups,l=e.length,s=new Array(l),c=0;c<l;++c)for(var F,E=e[c],S=E.length,W=s[c]=[],ot=0;ot<S;++ot)(F=E[ot])&&t.call(F,F.__data__,ot,E)&&W.push(F);return new li(s,this._parents,this._name,this._id)},merge:function cl(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,l=t._groups,s=e.length,E=Math.min(s,l.length),S=new Array(s),W=0;W<E;++W)for(var Gt,F=e[W],ot=l[W],ft=F.length,zt=S[W]=new Array(ft),Xt=0;Xt<ft;++Xt)(Gt=F[Xt]||ot[Xt])&&(zt[Xt]=Gt);for(;W<s;++W)S[W]=e[W];return new li(S,this._parents,this._name,this._id)},selection:function bl(){return new wl(this._groups,this._parents)},transition:function Dl(){for(var t=this._name,e=this._id,l=Qn(),s=this._groups,c=s.length,E=0;E<c;++E)for(var F,S=s[E],W=S.length,ot=0;ot<W;++ot)if(F=S[ot]){var ft=$e(F,e);zi(F,t,l,ot,S,{time:ft.time+ft.delay+ft.duration,delay:0,duration:ft.duration,ease:ft.ease})}return new li(s,this._parents,t,l)},call:ai.call,nodes:ai.nodes,node:ai.node,size:ai.size,empty:ai.empty,each:ai.each,on:function gl(t,e){var l=this._id;return arguments.length<2?$e(this.node(),l).on.on(t):this.each(function vl(t,e,l){var s,c,E=function fl(t){return(t+"").trim().split(/^|\s+/).every(function(e){var l=e.indexOf(".");return l>=0&&(e=e.slice(0,l)),!e||"start"===e})}(e)?tn:ii;return function(){var S=E(this,t),W=S.on;W!==s&&(c=(s=W).copy()).on(e,l),S.on=c}}(l,t,e))},attr:function Zr(t,e){var l=Lt(t),s="transform"===l?wr:Wn;return this.attrTween(t,"function"==typeof e?(l.local?Jr:Vr)(l,s,nn(this,"attr."+t,e)):null==e?(l.local?Fr:Wr)(l):(l.local?Hr:Qr)(l,s,e))},attrTween:function tl(t,e){var l="attr."+t;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==e)return this.tween(l,null);if("function"!=typeof e)throw new Error;var s=Lt(t);return this.tween(l,(s.local?qr:$r)(s,e))},style:function kl(t,e,l){var s="transform"==(t+="")?_r:Wn;return null==e?this.styleTween(t,function xl(t,e){var l,s,c;return function(){var E=H(this,t),S=(this.style.removeProperty(t),H(this,t));return E===S?null:E===l&&S===s?c:c=e(l=E,s=S)}}(t,s)).on("end.style."+t,Fn(t)):"function"==typeof e?this.styleTween(t,function Ol(t,e,l){var s,c,E;return function(){var S=H(this,t),W=l(this),F=W+"";return null==W&&(this.style.removeProperty(t),F=W=H(this,t)),S===F?null:S===s&&F===c?E:(c=F,E=e(s=S,W))}}(t,s,nn(this,"style."+t,e))).each(function Sl(t,e){var l,s,c,W,E="style."+e,S="end."+E;return function(){var F=ii(this,t),ot=F.on,ft=null==F.value[E]?W||(W=Fn(e)):void 0;(ot!==l||c!==ft)&&(s=(l=ot).copy()).on(S,c=ft),F.on=s}}(this._id,t)):this.styleTween(t,function El(t,e,l){var s,E,c=l+"";return function(){var S=H(this,t);return S===c?null:S===s?E:E=e(s=S,l)}}(t,s,e),l).on("end.style."+t,null)},styleTween:function Al(t,e,l){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(null==e)return this.tween(s,null);if("function"!=typeof e)throw new Error;return this.tween(s,function Cl(t,e,l){var s,c;function E(){var S=e.apply(this,arguments);return S!==c&&(s=(c=S)&&function Tl(t,e,l){return function(s){this.style.setProperty(t,e.call(this,s),l)}}(t,S,l)),s}return E._value=e,E}(t,e,null==l?"":l))},text:function Pl(t){return this.tween("text","function"==typeof t?function Il(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(nn(this,"text",t)):function Ml(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function Ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function Nl(t){var e,l;function s(){var c=t.apply(this,arguments);return c!==l&&(e=(l=c)&&function Rl(t){return function(e){this.textContent=t.call(this,e)}}(c)),e}return s._value=t,s}(t))},remove:function pl(){return this.on("end.remove",function yl(t){return function(){var e=this.parentNode;for(var l in this.__transition)if(+l!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function Er(t,e){var l=this._id;if(t+="",arguments.length<2){for(var S,s=$e(this.node(),l).tween,c=0,E=s.length;c<E;++c)if((S=s[c]).name===t)return S.value;return null}return this.each((null==e?br:xr)(l,t,e))},delay:function nl(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?el:il)(e,t)):$e(this.node(),e).delay},duration:function al(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:ll)(e,t)):$e(this.node(),e).duration},ease:function sl(t){var e=this._id;return arguments.length?this.each(function ol(t,e){if("function"!=typeof e)throw new Error;return function(){ii(this,t).ease=e}}(e,t)):$e(this.node(),e).ease},easeVarying:function ul(t){if("function"!=typeof t)throw new Error;return this.each(function dl(t,e){return function(){var l=e.apply(this,arguments);if("function"!=typeof l)throw new Error;ii(this,t).ease=l}}(this._id,t))},end:function jl(){var t,e,l=this,s=l._id,c=l.size();return new Promise(function(E,S){var W={value:S},F={value:function(){0==--c&&E()}};l.each(function(){var ot=ii(this,s),ft=ot.on;ft!==t&&((e=(t=ft).copy())._.cancel.push(W),e._.interrupt.push(W),e._.end.push(F)),ot.on=e}),0===c&&E()})},[Symbol.iterator]:ai[Symbol.iterator]};var Ul={time:null,delay:0,duration:250,ease:function zl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Gl(t,e){for(var l;!(l=t.__transition)||!(l=l[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return l}ye.prototype.interrupt=function yr(t){return this.each(function(){!function gr(t,e){var s,c,S,l=t.__transition,E=!0;if(l){for(S in e=null==e?null:e+"",l)(s=l[S]).name===e?(c=s.state>2&&s.state<5,s.state=6,s.timer.stop(),s.on.call(c?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete l[S]):E=!1;E&&delete t.__transition}}(this,t)})},ye.prototype.transition=function Wl(t){var e,l;t instanceof li?(e=t._id,t=t._name):(e=Qn(),(l=Ul).time=Xi(),t=null==t?null:t+"");for(var s=this._groups,c=s.length,E=0;E<c;++E)for(var F,S=s[E],W=S.length,ot=0;ot<W;++ot)(F=S[ot])&&zi(F,t,e,ot,S,l||Gl(F,e));return new li(s,this._parents,t,e)};Math;function Mi(t){return{type:t}}function _i(t){return function(){return t}}function Yn(t){this._context=t}function ql(t){return new Yn(t)}["w","e"].map(Mi),["n","s"].map(Mi),["n","w","e","s","nw","ne","sw","se"].map(Mi),Yn.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const cn=Math.PI,fn=2*cn,fi=1e-6,$l=fn-fi;function qn(t){this._+=t[0];for(let e=1,l=t.length;e<l;++e)this._+=arguments[e]+t[e]}class Zi{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?qn:function ta(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return qn;const l=10**e;return function(s){this._+=s[0];for(let c=1,E=s.length;c<E;++c)this._+=Math.round(arguments[c]*l)/l+s[c]}}(e)}moveTo(e,l){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,l){this._append`L${this._x1=+e},${this._y1=+l}`}quadraticCurveTo(e,l,s,c){this._append`Q${+e},${+l},${this._x1=+s},${this._y1=+c}`}bezierCurveTo(e,l,s,c,E,S){this._append`C${+e},${+l},${+s},${+c},${this._x1=+E},${this._y1=+S}`}arcTo(e,l,s,c,E){if(e=+e,l=+l,s=+s,c=+c,(E=+E)<0)throw new Error(`negative radius: ${E}`);let S=this._x1,W=this._y1,F=s-e,ot=c-l,ft=S-e,zt=W-l,Gt=ft*ft+zt*zt;if(null===this._x1)this._append`M${this._x1=e},${this._y1=l}`;else if(Gt>fi)if(Math.abs(zt*F-ot*ft)>fi&&E){let Xt=s-S,me=c-W,Oe=F*F+ot*ot,Bt=Xt*Xt+me*me,Nt=Math.sqrt(Oe),ne=Math.sqrt(Gt),Yt=E*Math.tan((cn-Math.acos((Oe+Gt-Bt)/(2*Nt*ne)))/2),de=Yt/ne,ve=Yt/Nt;Math.abs(de-1)>fi&&this._append`L${e+de*ft},${l+de*zt}`,this._append`A${E},${E},0,0,${+(zt*Xt>ft*me)},${this._x1=e+ve*F},${this._y1=l+ve*ot}`}else this._append`L${this._x1=e},${this._y1=l}`}arc(e,l,s,c,E,S){if(e=+e,l=+l,S=!!S,(s=+s)<0)throw new Error(`negative radius: ${s}`);let W=s*Math.cos(c),F=s*Math.sin(c),ot=e+W,ft=l+F,zt=1^S,Gt=S?c-E:E-c;null===this._x1?this._append`M${ot},${ft}`:(Math.abs(this._x1-ot)>fi||Math.abs(this._y1-ft)>fi)&&this._append`L${ot},${ft}`,s&&(Gt<0&&(Gt=Gt%fn+fn),Gt>$l?this._append`A${s},${s},0,1,${zt},${e-W},${l-F}A${s},${s},0,1,${zt},${this._x1=ot},${this._y1=ft}`:Gt>fi&&this._append`A${s},${s},0,${+(Gt>=cn)},${zt},${this._x1=e+s*Math.cos(E)},${this._y1=l+s*Math.sin(E)}`)}rect(e,l,s,c){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+l}h${s=+s}v${+c}h${-s}Z`}toString(){return this._}}function na(t){return t[0]}function ra(t){return t[1]}function la(t,e){var l=_i(!0),s=null,c=ql,E=null,S=function ia(t){let e=3;return t.digits=function(l){if(!arguments.length)return e;if(null==l)e=null;else{const s=Math.floor(l);if(!(s>=0))throw new RangeError(`invalid digits: ${l}`);e=s}return t},()=>new Zi(e)}(W);function W(F){var ot,zt,Xt,ft=(F=function Yl(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(F)).length,Gt=!1;for(null==s&&(E=c(Xt=S())),ot=0;ot<=ft;++ot)!(ot<ft&&l(zt=F[ot],ot,F))===Gt&&((Gt=!Gt)?E.lineStart():E.lineEnd()),Gt&&E.point(+t(zt,ot,F),+e(zt,ot,F));if(Xt)return E=null,Xt+""||null}return t="function"==typeof t?t:void 0===t?na:_i(t),e="function"==typeof e?e:void 0===e?ra:_i(e),W.x=function(F){return arguments.length?(t="function"==typeof F?F:_i(+F),W):t},W.y=function(F){return arguments.length?(e="function"==typeof F?F:_i(+F),W):e},W.defined=function(F){return arguments.length?(l="function"==typeof F?F:_i(!!F),W):l},W.curve=function(F){return arguments.length?(c=F,null!=s&&(E=c(s)),W):c},W.context=function(F){return arguments.length?(null==F?s=E=null:E=c(s=F),W):s},W}function $n(t,e,l){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+l)/6)}function tr(t){this._context=t}function aa(t){return new tr(t)}function wi(t,e,l){this.k=t,this.x=e,this.y=l}tr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$n(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$n(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},wi.prototype={constructor:wi,scale:function(t){return 1===t?this:new wi(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new wi(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new wi(1,0,0)}}]);